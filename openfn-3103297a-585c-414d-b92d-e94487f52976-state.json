{
  "id": "3103297a-585c-414d-b92d-e94487f52976",
  "name": "catalyst",
  "description": null,
  "concurrency": null,
  "inserted_at": "2024-04-30T14:09:46Z",
  "updated_at": "2025-01-28T09:08:29Z",
  "scheduled_deletion": null,
  "project_credentials": {
    "ymugenga@tns.org-Salesforce-Integration": {
      "id": "55f298ba-f7d3-442c-9c27-ff1825d583f6",
      "name": "Salesforce Integration",
      "owner": "ymugenga@tns.org"
    }
  },
  "history_retention_period": null,
  "dataclip_retention_period": null,
  "retention_policy": "retain_all",
  "collections": {},
  "requires_mfa": false,
  "workflows": {
    "Coffee---ZW-IFC-2024C---SalesForce----CommCare---Training-Participants": {
      "id": "e5e26f52-ec63-48a9-b837-7d9b82d6f33b",
      "name": "Coffee - ZW IFC 2024C - SalesForce -- CommCare - Training Participants",
      "inserted_at": "2025-01-25T14:25:42.913296Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "89ee7717-4592-4b2e-aaa2-80661e1de68b",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---ZW-IFC-2024C---SalesForce----CommCare---Training-Participants": {
          "id": "477a8bdb-1958-4c17-975d-6a7e5c56d619",
          "name": "Coffee - ZW IFC 2024C - SalesForce -- CommCare - Training Participants",
          "body": "// JOB PURPOSE :: This is a job for sending Participants for Coffee KE - Nespresso 2023C\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - KE Nespresso 2023C\n// JOB NAME :: Production | Participants - KE Nespresso 2023C | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Participant\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_ke_2023c\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n// EDITED :: Emmanuel Mwaka | emwaka@tns.org\n\neach(\n    \"$.data.participants[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/3E266629-AFD8-4A1C-8825-1DCDDF24E5A8\",\n            \"uiVersion\": \"1\",\n            \"version\": \"325\",\n            \"name\": \"New Participant\",\n          };\n        }),\n        field(\"Name\", function(state){\n          var name = '';\n          if(dataValue(\"participantName\")(state) !== null) {\n            name = dataValue(\"participantName\")(state);\n          }\n          if(dataValue(\"participantMiddleName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantMiddleName\")(state);\n          }\n          if(dataValue(\"participantLastName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantLastName\")(state);\n          }\n          return name;\n        }),\n        field(\"First_Name\", dataValue(\"participantName\")),\n        field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n        field(\"Last_Name\", dataValue(\"participantLastName\")),\n        field(\"Age\", dataValue(\"participantAge\")),\n        field(\"Gender\", dataValue(\"participantGender\")),\n        field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n        field(\"Farmer_Id\", dataValue(\"tnsId\")),\n        field(\"Farmer_Number\", function(state){\n          var tnsId = dataValue(\"tnsId\")(state);\n          var farmerNumber = \"0\" + tnsId.substr(tnsId.length-1,1);\n          return farmerNumber;\n        }),\n        field(\"Grower_Number\", dataValue(\"participantOtherIDNumber\")),\n        field(\"Household_Id\", dataValue(\"householdId\")),\n        field(\"Household_Number\", dataValue(\"HHID\")),\n        field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n        field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n        field(\"Status\", dataValue(\"status\")),\n        field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n        field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n        field(\"Name_Household_Concat\", function(state){\n          var name = '';\n          var tnsId = dataValue(\"tnsId\")(state);\n          var hhNumber = dataValue(\"HHID\")(state);\n          var farmerNumber = \"0\" + tnsId.substr(tnsId.length-1,1);\n          \n          if(dataValue(\"participantName\")(state) !== null) {\n            name = dataValue(\"participantName\")(state);\n          }\n          if(dataValue(\"participantMiddleName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantMiddleName\")(state);\n          }\n          if(dataValue(\"participantLastName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantLastName\")(state);\n          }\n          return name+' '+hhNumber+'-'+farmerNumber;\n        }),\n        \n        field(\"n0:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"commCareCaseId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": function(){\n                var name = '';\n                if(dataValue(\"participantName\")(state) !== null) {\n                  name = dataValue(\"participantName\")(state);\n                }\n                if(dataValue(\"participantMiddleName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantMiddleName\")(state);\n                }\n                if(dataValue(\"participantLastName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantLastName\")(state);\n                }\n                return name;\n              },\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_zw_2024c_participant\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n              \"n0:First_Name\": dataValue(\"participantName\")(state),\n              \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n              \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n              \"n0:Age\": dataValue(\"participantAge\")(state),\n              \"n0:Gender\": dataValue(\"participantGender\")(state),\n              \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n              \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n              \"n0:Farmer_Number\": function(){\n                var tnsId = dataValue(\"tnsId\")(state);\n                var farmerNumber = tnsId.substr(tnsId.length-1,1);\n                return farmerNumber;\n              },\n              \"n0:Grower_Number\": dataValue(\"participantOtherIDNumber\")(state),\n              \"n0:Household_Id\": dataValue(\"householdId\")(state),\n              \"n0:Household_Number\": dataValue(\"HHID\")(state),\n              \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n              \"n0:Status\": dataValue(\"status\")(state),\n              \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n              \"n0:Name_Household_Concat\": function(){\n                var name = '';\n                var tnsId = dataValue(\"tnsId\")(state);\n                var hhNumber = dataValue(\"HHID\")(state);\n                var farmerNumber = tnsId.substr(tnsId.length-1,1);\n                \n                if(dataValue(\"participantName\")(state) !== null) {\n                  name = dataValue(\"participantName\")(state);\n                }\n                if(dataValue(\"participantMiddleName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantMiddleName\")(state);\n                }\n                if(dataValue(\"participantLastName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantLastName\")(state);\n                }\n                return name+' '+hhNumber+'-'+farmerNumber;\n              },\n              \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n              \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n            },\n            \"n0:index\": {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_zw_2024c_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupId\")(state)\n              }\n            }\n          };\n        }),\n        field(\"n1:meta\", function(state) {\n          return {\n            \"@\": {\n              \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n            },\n            \"n1:deviceID\": \"867066029216796\",\n            \"n1:timeStart\": new Date().toISOString(),\n            \"n1:timeEnd\": new Date().toISOString(),\n            \"n1:username\": \"api\",\n            \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );\n  \n  //Version Control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---ZW-IFC-2024C---SalesForce----CommCare---Training-Participants": {
          "enabled": true,
          "id": "6be44b76-7f9a-4e69-808b-949baabc22de",
          "target_job_id": "477a8bdb-1958-4c17-975d-6a7e5c56d619",
          "source_trigger_id": "89ee7717-4592-4b2e-aaa2-80661e1de68b",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW IFC 2024C SalesForce CommCare Training Participants",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zw_2024c\""
        }
      }
    },
    "Global---Household-Sampling---SalesForce----CommCare": {
      "id": "f20e9a84-0045-4592-a437-315ef558ab3b",
      "name": "Global - Household Sampling - SalesForce -- CommCare",
      "inserted_at": "2025-01-25T14:27:51.209987Z",
      "lock_version": 4,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "cd7e3976-035d-4b31-84c2-36d44360991e",
          "type": "webhook"
        }
      },
      "jobs": {
        "Global---Household-Sampling---SalesForce----CommCare": {
          "id": "254bd8be-8826-4c2e-9492-13f645deda75",
          "name": "Global - Household Sampling - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending sampled households\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: All Apps\n// JOB NAME ::  Global - Household Sampling - SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Household Sampling\",\"source\":\"SF\" }\n// AUTHOR :: Yves Mugenga | ymugenga@tns.org\n\nfn(state => {\n\n  const uniqueProjectKey = state.data.uniqueProjectKey;\n\n  return {\n    ...state,\n    uniqueProjectKey\n  };\n});\n\neach(\n  \"$.data.households[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3E266629-AFD8-4A1C-8825-1DCDDF24E5A8\",\n          \"uiVersion\": \"1\",\n          \"version\": \"325\",\n          \"name\": \"New Household Sample\",\n        };\n      }),\n      field(\"Name\", dataValue(\"householdName\")),\n      field(\"Number_Of_Members\", dataValue(\"numberOfMembers\")),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"FV_AA_Visited\", dataValue(\"fvAAVisited\")),\n      field(\"FV_AA_Sampled\", dataValue(\"fvAASampled\")),\n      field(\"FV_AA_Current_Sampling_Round\", dataValue(\"fvAACurrentSamplingRound\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n      field(\"Status\", dataValue(\"householdStatus\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Module_Name\", dataValue(\"moduleName\")),\n      field(\"Module_Number\", dataValue(\"moduleNumber\")),\n      field(\"Household_Participants\", dataValue(\"householdParticipants\")),\n\n      \n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"householdName\"),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": function(state){\n              return state.uniqueProjectKey + \"_household_samples\";\n            }\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name\": dataValue(\"householdName\")(state),\n            \"n0:Number_Of_Members\": dataValue(\"numberOfMembers\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:FV_AA_Visited\": dataValue(\"fvAAVisited\")(state),\n            \"n0:FV_AA_Sampled\": dataValue(\"fvAASampled\")(state),\n            \"n0:FV_AA_Current_Sampling_Round\": dataValue(\"fvAACurrentSamplingRound\")(state),\n            \"n0:Status\": dataValue(\"householdStatus\")(state),\n            \"n0:Module_Name\": dataValue(\"moduleName\")(state),\n            \"n0:Module_Number\": dataValue(\"moduleNumber\")(state),\n            \"n0:Household_Participants\": dataValue(\"householdParticipants\")(state),\n            \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                //\"case_type\": \"the_avengers_initiative_training_group\",\n                \"case_type\": function(state){\n                    // You might need to add conditions here for older projects\n                    return state.uniqueProjectKey + \"_training_group\";\n                }\n                \n              },\n              \"#\": dataValue(\"trainingGroupId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n1:deviceID\": \"867066029216796\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-commcare@v1.6.9",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Global---Household-Sampling---SalesForce----CommCare": {
          "enabled": true,
          "id": "91890b47-8ee2-4843-8795-de8faabf04f7",
          "target_job_id": "254bd8be-8826-4c2e-9492-13f645deda75",
          "source_trigger_id": "cd7e3976-035d-4b31-84c2-36d44360991e",
          "condition_type": "js_expression",
          "condition_label": "Global Households Sampling SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Household Sampling\" && state.data.source == \"SF\""
        }
      }
    },
    "Production---Coffee-BDI-Kahawatu-2024C---SalesForce----CommCare---Training-Participants": {
      "id": "d13d12e2-cc8c-4c8f-b7b0-244dcb57e71c",
      "name": "Production - Coffee BDI Kahawatu 2024C - SalesForce -- CommCare - Training Participants",
      "inserted_at": "2025-01-25T14:28:22.578054Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "ab79f6e8-8a83-4017-8520-5a8ea4e597c5",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-BDI-Kahawatu-2024C---SalesForce----CommCare---Training-Participants": {
          "id": "5484373f-594f-4f2c-93fc-c093fb8ec0bd",
          "name": "Production - Coffee BDI Kahawatu 2024C - SalesForce -- CommCare - Training Participants",
          "body": "//Training Participants\n//Coffee :: BDI Kahawatu 2024C | SalesForce --> CommCare | Training Participants\n//{\"jobType\":\"Participant\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_bdi_kahawatu_2024c\"}\n\neach(\n  \"$.data.participants[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/1768D5C8-3EE4-4D7B-AE17-FE0AC9A0E60D\",\n          \"uiVersion\": \"1\",\n          \"version\": \"325\",\n          \"name\": \"New Participant\",\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name;\n      }),\n      field(\"First_Name\", dataValue(\"participantName\")),\n      field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n      field(\"Last_Name\", dataValue(\"participantLastName\")),\n      field(\"Age\", dataValue(\"participantAge\")),\n      field(\"Gender\", dataValue(\"participantGender\")),\n      field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n      field(\"Farmer_Id\", dataValue(\"tnsId\")),\n      field(\"Farmer_Number\", function(state){\n        var tnsId = dataValue(\"tnsId\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        return farmerNumber;\n      }),\n      field(\"National_ID_Number\", dataValue(\"participantOtherIDNumber\")),\n      field(\"Household_Id\", dataValue(\"householdId\")),\n      field(\"Household_Number\", dataValue(\"HHID\")),\n      field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n      field(\"Status\", dataValue(\"status\")),\n      field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Name_Household_Concat\", function(state){\n        var name = '';\n        var tnsId = dataValue(\"tnsId\")(state);\n        var hhNumber = dataValue(\"HHID\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        \n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name+' '+hhNumber+'-'+farmerNumber;\n      }),\n      \n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_bdi_kahawatu_2024c_participant\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:First_Name\": dataValue(\"participantName\")(state),\n            \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n            \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n            \"n0:Age\": dataValue(\"participantAge\")(state),\n            \"n0:Gender\": dataValue(\"participantGender\")(state),\n            \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n            \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Farmer_Number\": function(){\n              var tnsId = dataValue(\"tnsId\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              return farmerNumber;\n            },\n            \"n0:National_ID_Number\": dataValue(\"participantOtherIDNumber\")(state),\n            \"n0:Household_Id\": dataValue(\"householdId\")(state),\n            \"n0:Household_Number\": dataValue(\"HHID\")(state),\n            \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n            \"n0:Status\": dataValue(\"status\")(state),\n            \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n            \"n0:Name_Household_Concat\": function(){\n              var name = '';\n              var tnsId = dataValue(\"tnsId\")(state);\n              var hhNumber = dataValue(\"HHID\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              \n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name+' '+hhNumber+'-'+farmerNumber;\n            },\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_bdi_kahawatu_2024c_training_group\"\n              },\n              \"#\": dataValue(\"trainingGroupId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n1:deviceID\": \"867066029216796\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-BDI-Kahawatu-2024C---SalesForce----CommCare---Training-Participants": {
          "enabled": true,
          "id": "7cb6b6e9-1d59-4069-baa9-04156c2755a5",
          "target_job_id": "5484373f-594f-4f2c-93fc-c093fb8ec0bd",
          "source_trigger_id": "ab79f6e8-8a83-4017-8520-5a8ea4e597c5",
          "condition_type": "js_expression",
          "condition_label": "Coffee BDI Kahawatu 2024C SalesForce CommCare Training Participants",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_bdi_kahawatu_2024c\""
        }
      }
    },
    "Production---Coffee-BDI-TNS-2024C---SalesForce----CommCare---Training-Participants": {
      "id": "67ec9cc8-82c8-406e-a562-af3822bfc56d",
      "name": "Production - Coffee BDI TNS 2024C - SalesForce -- CommCare - Training Participants",
      "inserted_at": "2025-01-25T14:31:35.710093Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "acdacfae-819d-4ee1-a0e3-6b3c071ff857",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-BDI-TNS-2024C---SalesForce----CommCare---Training-Participants": {
          "id": "e6034655-b75e-4ea3-8349-75751195b210",
          "name": "Production - Coffee BDI TNS 2024C - SalesForce -- CommCare - Training Participants",
          "body": "//PARTICIPANTS REGISTRATION JOB {SALESFORCE TO COMMCARE}\neach(\n  \"$.data.participants[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/22A693D2-7F34-4B8D-AE12-8A4A57C8868F\",\n          \"uiVersion\": \"1\",\n          \"version\": \"325\",\n          \"name\": \"New Participant\",\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name;\n      }),\n      field(\"First_Name\", dataValue(\"participantName\")),\n      field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n      field(\"Last_Name\", dataValue(\"participantLastName\")),\n      field(\"Age\", dataValue(\"participantAge\")),\n      field(\"Gender\", dataValue(\"participantGender\")),\n      field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n      field(\"Farmer_Id\", dataValue(\"tnsId\")),\n      field(\"Farmer_Number\", function(state){\n        var tnsId = dataValue(\"tnsId\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        return farmerNumber;\n      }),\n      field(\"National_ID_Number\", dataValue(\"participantOtherIDNumber\")),\n      field(\"Household_Id\", dataValue(\"householdId\")),\n      field(\"Household_Number\", dataValue(\"HHID\")),\n      field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n      field(\"Status\", dataValue(\"status\")),\n      field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Name_Household_Concat\", function(state){\n        var name = '';\n        var tnsId = dataValue(\"tnsId\")(state);\n        var hhNumber = dataValue(\"HHID\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        \n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name+' '+hhNumber+'-'+farmerNumber;\n      }),\n      \n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_bdi_tns_2024c_participant\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:First_Name\": dataValue(\"participantName\")(state),\n            \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n            \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n            \"n0:Age\": dataValue(\"participantAge\")(state),\n            \"n0:Gender\": dataValue(\"participantGender\")(state),\n            \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n            \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Farmer_Number\": function(){\n              var tnsId = dataValue(\"tnsId\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              return farmerNumber;\n            },\n            \"n0:National_ID_Number\": dataValue(\"participantOtherIDNumber\")(state),\n            \"n0:Household_Id\": dataValue(\"householdId\")(state),\n            \"n0:Household_Number\": dataValue(\"HHID\")(state),\n            \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n            \"n0:Status\": dataValue(\"status\")(state),\n            \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n            \"n0:Name_Household_Concat\": function(){\n              var name = '';\n              var tnsId = dataValue(\"tnsId\")(state);\n              var hhNumber = dataValue(\"HHID\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              \n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name+' '+hhNumber+'-'+farmerNumber;\n            },\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_bdi_tns_2024c_training_group\"\n              },\n              \"#\": dataValue(\"trainingGroupId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n1:deviceID\": \"867066029216796\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-BDI-TNS-2024C---SalesForce----CommCare---Training-Participants": {
          "enabled": true,
          "id": "40920aca-50af-41d1-b494-294734d29272",
          "target_job_id": "e6034655-b75e-4ea3-8349-75751195b210",
          "source_trigger_id": "acdacfae-819d-4ee1-a0e3-6b3c071ff857",
          "condition_type": "js_expression",
          "condition_label": "Coffee BDI TNS 2024C SalesForce CommCare Training Participants",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_bdi_tns_2024c\""
        }
      }
    },
    "Production---Coffee-KE-2023C---SalesForce----CommCare---Training-Sessions": {
      "id": "d512de06-cef2-4389-a32c-e1538db5691c",
      "name": "Production - Coffee KE 2023C - SalesForce -- CommCare - Training Sessions",
      "inserted_at": "2025-01-25T14:32:59.672300Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "b9305a13-7c4c-4cf6-84fe-a7bf79fde34d",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-KE-2023C---SalesForce----CommCare---Training-Sessions": {
          "id": "234a8a5a-6826-441c-a060-0b75dbc12540",
          "name": "Production - Coffee KE 2023C - SalesForce -- CommCare - Training Sessions",
          "body": "// Your job goes here.\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_ke_2023c_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_ke_2023c_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@v1.5.1",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-KE-2023C---SalesForce----CommCare---Training-Sessions": {
          "enabled": true,
          "id": "8db19cf0-6162-4486-bb0f-62504a939bd6",
          "target_job_id": "234a8a5a-6826-441c-a060-0b75dbc12540",
          "source_trigger_id": "b9305a13-7c4c-4cf6-84fe-a7bf79fde34d",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE 2023C SalesForce CommCare Training Sessions",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2023c\""
        }
      }
    },
    "Production---Coffee-KE-2024AC---SalesForce----CommCare---Training-Groups": {
      "id": "9dc2b88b-ee27-4c63-b9c5-8a5c831fa0b0",
      "name": "Production - Coffee KE 2024AC - SalesForce -- CommCare - Training Groups",
      "inserted_at": "2025-01-25T14:33:23.789001Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "a4f1a263-e898-494e-a976-44336b0c4bd4",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-KE-2024AC---SalesForce----CommCare---Training-Groups": {
          "id": "4741dd03-2f7d-4e33-af34-bcc04e631edb",
          "name": "Production - Coffee KE 2024AC - SalesForce -- CommCare - Training Groups",
          "body": "// Your job goes here.\neach(\n    \"$.data.trainingGroups[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"name\": \"New Training Group\",\n            \"uiVersion\": \"1\",\n            \"version\": \"1\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/B9AE4CBF-B571-4038-9C90-3D5D47DFDB90\",\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n          };\n        }),\n        field(\"Name\", dataValue(\"trainingGroupName\")),\n        field(\"FFG_Number\", dataValue(\"tnsId\")),\n        field(\"Location\", dataValue(\"locationName\")),\n        field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n        field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n        field(\"Household_Counter\", dataValue(\"householdCounter\")),\n        field(\"Name_Id_Concat\", function(state) {\n          return (\n            //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n            dataValue(\"trainingGroupName\")(state)\n          );\n        }),\n        field(\"Parent_Id\", dataValue(\"staffId\")),\n        field(\"n0:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"trainingGroupId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_ke_2024ac_training_group\"\n            },\n            \"n0:update\": {\n              \"n0:Location\": dataValue(\"locationName\")(state),\n              \"n0:Market\": dataValue(\"market\")(state),\n              \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n              \"n0:Name_Id_Concat\": function(){\n                //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n                var name = dataValue(\"trainingGroupName\")(state);\n                return name;\n              },\n              \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n              \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n              \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n              \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n            },\n            \"n0:index\": {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_ke_2024ac_staff\"\n                },\n                \"#\": dataValue(\"staffId\")(state)\n              }\n            }\n          };\n        }),\n        field(\"n1:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"trainingGroupId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n            }\n          };\n        }),\n        field(\"n2:meta\", function(state) {\n          return {\n            \"@\": {\n              \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n            },\n            \"n2:deviceID\": \"PIMA API\",\n            \"n2:timeStart\": new Date().toISOString(),\n            \"n2:timeEnd\": new Date().toISOString(),\n            \"n2:username\": \"api\",\n            \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );\n",
          "adaptor": "@openfn/language-commcare@v1.6.9",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-KE-2024AC---SalesForce----CommCare---Training-Groups": {
          "enabled": true,
          "id": "632544bb-e581-4da5-b382-9c292addf2c9",
          "target_job_id": "4741dd03-2f7d-4e33-af34-bcc04e631edb",
          "source_trigger_id": "a4f1a263-e898-494e-a976-44336b0c4bd4",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE 2024AC SalesForce CommCare Training Groups",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2024ac\""
        }
      }
    },
    "Production---Coffee-Regrow-YG-Ag-C2023---Demo-Plot-Observations---CommCare----SalesForce": {
      "id": "3c73d26f-6a06-4a40-93b5-776a8059340a",
      "name": "Production - Coffee Regrow YG Ag C2023 - Demo Plot Observations - CommCare -- SalesForce",
      "inserted_at": "2025-01-25T14:34:32.055996Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "f4673cf4-e240-4d41-95e5-311d0c8ce9f2",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-Regrow-YG-Ag-C2023---Demo-Plot-Observations---CommCare----SalesForce": {
          "id": "f6a5c73a-c090-460c-83ca-a40c94742c2a",
          "name": "Production - Coffee Regrow YG Ag C2023 - Demo Plot Observations - CommCare -- SalesForce",
          "body": "//Demo Plot Observations\n//Production - Coffee Regrow Yirga Agronomy C2022 | Demo Plot Observations | CommCare --> SalesForce\n\n\neach(\n\"$.data\",\n  upsert(\"Observation__c\", \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"id\")),\n      field(\"Observer__c\", dataValue(\"form.observer\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n      field(\"RecordTypeId\", dataValue(\"form.record_type\")),\n      field(\"Date__c\", dataValue(\"form.date\")),\n      field(\"Comments_1__c\", dataValue(\"form.visit_comments\")),\n      field(\"Demo_Plot_Photo__c\", function(state) {\n        var dempPlotPhotoUrl = '';\n        if(dataValue(\"form.Demo_Plot_Photo\")(state) !== undefined && dataValue(\"form.Demo_Plot_Photo\")(state) !== '') {\n          dempPlotPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Demo_Plot_Photo\")(state);  \n        }\n        return dempPlotPhotoUrl;\n      }),\n      \n      field(\"Observer_Signature__c\", function(state) {\n        var observerSignatureUrl = '';\n        if(dataValue(\"form.agronomy_advisor_signature\")(state) !== undefined && dataValue(\"form.agronomy_advisor_signature\")(state) !== '') {\n          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.agronomy_advisor_signature\")(state);  \n        }\n        return observerSignatureUrl;\n      }),\n      \n      field(\"Observation_Location__Latitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[0]; \n        }\n      }),\n      field(\"Observation_Location__Longitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[1]; \n        }\n      }),\n      field(\"Altitude__c\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[2]; \n        }\n      })\n    )\n  )\n),\n\n//HERE WE CAPTURE ALL THE DPO OBSERVATION RESULTS\n// Creates results for Stumped Trees\n\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_regrow_2023__stumped_trees\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_regrow_2023__stumped_trees\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.stumped.stumped_trees\"))\n  ))),\n\n// Create results for Sucker Selection\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_regrow_2023__sucker_selection_taken_place\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_regrow_2023__sucker_selection_taken_place\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.sucker_selection.Sucker_Selection_Taken_Place\")),\n    field(\"Result_number__c\", dataValue(\"form.best_practice_questions.sucker_selection.number_of_suckers\"))\n    \n  ))),\n\n\n\n// Create results for Compost Heap\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_regrow_2023__compost_heap\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_regrow_2023__compost_heap\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.compost_heap.present_compost_heap\")),\n    field(\"Compost_Photo__c\", function(state) {\n        var compostPhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state) !== '') {\n          compostPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state);  \n        }\n        return compostPhotoUrl;\n      })\n      \n    \n  ))),\n\n\n// Create results for Weed Management\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_regrow_2023__weed_management\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_regrow_2023__weed_management\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\")),\n    field(\"Result_Text__c\", dataValue(\"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\")),\n    field(\"Result_Text_Two__c\", dataValue(\"form.best_practice_questions.weed_management.how_big_are_the_weeds\")),\n    field(\"Weed_Management_Photo__c\", function(state) {\n        var weedsPhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state) !== '') {\n          weedsPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state);  \n        }\n        return weedsPhotoUrl;\n      })\n  ))),\n\n\n// Create results for Shade Management\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_regrow_2023__shade_management\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_regrow_2023__shade_management\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.shade_management.level_of_shade_present\")),\n    field(\"Shade_Management_Photo__c\", function(state) {\n        var shadePhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state) !== '') {\n          shadePhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state);  \n        }\n        return shadePhotoUrl;\n      })\n  ))),\n\n\n// Create results for Mulch\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_regrow_2023__mulch\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_regrow_2023__mulch\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.mulch.mulch_under_the_canopy\")),\n    field(\"Result_Text__c\", dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\"))\n  ))),\n\n\n// Create results for Vetiver Planted\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_regrow_2023__vetiver_planted\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_regrow_2023__vetiver_planted\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\"))\n  )));\n\n/*\n// Create results for Shade_Trees_Planted {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__shade_trees_planted\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__shade_trees_planted\"),\n    field(\"Result__c\", dataValue(\"form.Shade_Trees_Planted\"))\n  ))),\n\n\n// Create results for Compost_Heap {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__compost_heap\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__compost_heap\"),\n    field(\"Result__c\", dataValue(\"form.Compost_Heap\")),\n    field(\"Photo_URL__c\", function(state) {\n        var compostHeapPhotoUrl = '';\n        if(dataValue(\"form.Photo_of_Compost_Heap\")(state) !== undefined && dataValue(\"form.Photo_of_Compost_Heap\")(state) !== '') {\n          compostHeapPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo_of_Compost_Heap\")(state);  \n        }\n        return compostHeapPhotoUrl;\n      })\n  ))),\n\n\n// Create results for Vertiver_Grass_on_Demo_Plot {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__vertiver_grass_on_demo_plot\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__vertiver_grass_on_demo_plot\"),\n    field(\"Result__c\", dataValue(\"form.Vertiver_Grass_on_Demo_Plot\"))\n  )));\n\n// Version control\n*/\n",
          "adaptor": "@openfn/language-salesforce@v2.12.0",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-Regrow-YG-Ag-C2023---Demo-Plot-Observations---CommCare----SalesForce": {
          "enabled": true,
          "id": "691ed0df-0214-4d26-8250-3816d563ee42",
          "target_job_id": "f6a5c73a-c090-460c-83ca-a40c94742c2a",
          "source_trigger_id": "f4673cf4-e240-4d41-95e5-311d0c8ce9f2",
          "condition_type": "js_expression",
          "condition_label": "Coffee Regrow Yirga C2023 Demo Plot Observations CommCare SalesForce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Demo Plot Observation\" && state.data[\"app_id\"] == \"e9fb922a1526447b9485b26c4a1b8eb5\""
        }
      }
    },
    "Production---Coffee-ZIM---CommCare----SalesForce---Training-Attendance": {
      "id": "00333986-c560-4fae-8bc3-2be0585b584d",
      "name": "Production - Coffee ZIM - CommCare -- SalesForce - Training Attendance",
      "inserted_at": "2025-01-25T14:35:19.835962Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "447fdb67-6306-45f7-8fb1-23691dd4dc5e",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-ZIM---CommCare----SalesForce---Training-Attendance": {
          "id": "3b09520c-c17c-425f-bc75-04076db7e99b",
          "name": "Production - Coffee ZIM - CommCare -- SalesForce - Training Attendance",
          "body": "//Production - Coffee ZIM | CommCare --> SalesForce | Training Attendance\n//{\"form\":{\"survey_type\":\"Training Attendance\"},\"app_id\":\"b75286e874c74eb09b8da436709d7f3c\"}\n\neach(\n  \"$.data\",\n  upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n    fields(\n      field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Number_in_Attendance__c\", dataValue(\"form.attendance_count\")),\n      field(\"Session_Photo_URL__c\", function(state) {\n          var photoUrl = '';\n          if(dataValue(\"form.photo\")(state) !== undefined && dataValue(\"form.photo\")(state) !== '') {\n            photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.photo\")(state);  \n          }\n          return photoUrl;\n      }),\n      field(\"Date__c\", dataValue(\"form.date\")),\n      field('Location_GPS__Latitude__s', (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[0];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return '';\n      }),\n      field('Location_GPS__Longitude__s', (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[1];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return '';\n      }),\n      field('Altitude__c', (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[2];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return '';\n      })\n      )\n    )\n  );\n\nbeta.each(\n  function(state) {\n    if (state.data.form.present_participants) {\n      return state.data.form.present_participants.split(\" \").map(\n        function(pId) {\n          return {\n            participant: pId,\n            session: dataValue(\"form.training_session\")(state),\n            submission: dataValue(\"form.training_session\")(state)+pId,\n            sessionPhoto: dataValue(\"form.photo\")(state)\n          };\n        }\n      );\n    }\n  },\n  upsert(\"Attendance__c\", \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"submission\")),\n      field(\"Status__c\", \"Present\"),\n      relationship(\"Training_Session__r\", \"CommCare_Case_Id__c\", dataValue(\"session\")),\n      relationship(\"Participant__r\", \"CommCare_Case_Id__c\", dataValue(\"participant\"))\n    )\n  )\n);\neach(\n  \"$.data\",\n  upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n    fields(\n      field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n      field(\"Updated_from_CommCare__c\", true)\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-salesforce@v1.3.2",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-ZIM---CommCare----SalesForce---Training-Attendance": {
          "enabled": true,
          "id": "d9ac72d9-ee9d-4bb6-a8c6-10853c36d200",
          "target_job_id": "3b09520c-c17c-425f-bc75-04076db7e99b",
          "source_trigger_id": "447fdb67-6306-45f7-8fb1-23691dd4dc5e",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee ZIM CommCare SalesForce Training Attendance",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Training Attendance\" && state.data[\"app_id\"] == \"b75286e874c74eb09b8da436709d7f3c\""
        }
      }
    },
    "Production---Participants---KE-Nespresso-2024AC---SalesForce----CommCare": {
      "id": "c18f7bb2-b49f-4e56-981a-2239805f1674",
      "name": "Production - Participants - KE Nespresso 2024AC - SalesForce -- CommCare",
      "inserted_at": "2025-01-25T14:44:26.435709Z",
      "lock_version": 2,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "76c83c8a-a600-4075-a787-ef72d4c56345",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Participants---KE-Nespresso-2024AC---SalesForce----CommCare": {
          "id": "23c0ca43-68d4-45d2-af95-6711d8fe178e",
          "name": "Production - Participants - KE Nespresso 2024AC - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending Participants for Coffee KE - Nespresso 2023C\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - KE Nespresso 2023C\n// JOB NAME :: Production | Participants - KE Nespresso 2023C | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Participant\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_ke_2023c\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n// EDITED :: Emmanuel Mwaka | emwaka@tns.org\n\neach(\n    \"$.data.participants[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/3E266629-AFD8-4A1C-8825-1DCDDF24E5A8\",\n            \"uiVersion\": \"1\",\n            \"version\": \"325\",\n            \"name\": \"New Participant\",\n          };\n        }),\n        field(\"Name\", function(state){\n          var name = '';\n          if(dataValue(\"participantName\")(state) !== null) {\n            name = dataValue(\"participantName\")(state);\n          }\n          if(dataValue(\"participantMiddleName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantMiddleName\")(state);\n          }\n          if(dataValue(\"participantLastName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantLastName\")(state);\n          }\n          return name;\n        }),\n        field(\"First_Name\", dataValue(\"participantName\")),\n        field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n        field(\"Last_Name\", dataValue(\"participantLastName\")),\n        field(\"Age\", dataValue(\"participantAge\")),\n        field(\"Gender\", dataValue(\"participantGender\")),\n        field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n        field(\"Farmer_Id\", dataValue(\"tnsId\")),\n        field(\"Farmer_Number\", function(state){\n          var tnsId = dataValue(\"tnsId\")(state);\n          var farmerNumber = \"0\" + tnsId.substr(tnsId.length-1,1);\n          return farmerNumber;\n        }),\n        field(\"Cooperative_Membership_Number\", dataValue(\"participantOtherIDNumber\")),\n        field(\"Household_Id\", dataValue(\"householdId\")),\n        field(\"Household_Number\", dataValue(\"HHID\")),\n        field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n        field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n        field(\"Status\", dataValue(\"status\")),\n        field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n        field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n        field(\"Name_Household_Concat\", function(state){\n          var name = '';\n          var tnsId = dataValue(\"tnsId\")(state);\n          var hhNumber = dataValue(\"HHID\")(state);\n          var farmerNumber = \"0\" + tnsId.substr(tnsId.length-1,1);\n          \n          if(dataValue(\"participantName\")(state) !== null) {\n            name = dataValue(\"participantName\")(state);\n          }\n          if(dataValue(\"participantMiddleName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantMiddleName\")(state);\n          }\n          if(dataValue(\"participantLastName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantLastName\")(state);\n          }\n          return name+' '+hhNumber+'-'+farmerNumber;\n        }),\n        \n        field(\"n0:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"commCareCaseId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": function(){\n                var name = '';\n                if(dataValue(\"participantName\")(state) !== null) {\n                  name = dataValue(\"participantName\")(state);\n                }\n                if(dataValue(\"participantMiddleName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantMiddleName\")(state);\n                }\n                if(dataValue(\"participantLastName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantLastName\")(state);\n                }\n                return name;\n              },\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_ke_2024ac_participant\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n              \"n0:First_Name\": dataValue(\"participantName\")(state),\n              \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n              \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n              \"n0:Age\": dataValue(\"participantAge\")(state),\n              \"n0:Gender\": dataValue(\"participantGender\")(state),\n              \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n              \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n              \"n0:Farmer_Number\": function(){\n                var tnsId = dataValue(\"tnsId\")(state);\n                var farmerNumber = tnsId.substr(tnsId.length-1,1);\n                return farmerNumber;\n              },\n              \"n0:Cooperative_Membership_Number\": dataValue(\"participantOtherIDNumber\")(state),\n              \"n0:Household_Id\": dataValue(\"householdId\")(state),\n              \"n0:Household_Number\": dataValue(\"HHID\")(state),\n              \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n              \"n0:Status\": dataValue(\"status\")(state),\n              \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n              \"n0:Name_Household_Concat\": function(){\n                var name = '';\n                var tnsId = dataValue(\"tnsId\")(state);\n                var hhNumber = dataValue(\"HHID\")(state);\n                var farmerNumber = tnsId.substr(tnsId.length-1,1);\n                \n                if(dataValue(\"participantName\")(state) !== null) {\n                  name = dataValue(\"participantName\")(state);\n                }\n                if(dataValue(\"participantMiddleName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantMiddleName\")(state);\n                }\n                if(dataValue(\"participantLastName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantLastName\")(state);\n                }\n                return name+' '+hhNumber+'-'+farmerNumber;\n              },\n              \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n              \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n            },\n            \"n0:index\": {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_ke_2024ac_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupId\")(state)\n              }\n            }\n          };\n        }),\n        field(\"n1:meta\", function(state) {\n          return {\n            \"@\": {\n              \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n            },\n            \"n1:deviceID\": \"867066029216796\",\n            \"n1:timeStart\": new Date().toISOString(),\n            \"n1:timeEnd\": new Date().toISOString(),\n            \"n1:username\": \"api\",\n            \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );\n  \n  //Version Control\n",
          "adaptor": "@openfn/language-commcare@v1.6.9",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Participants---KE-Nespresso-2024AC---SalesForce----CommCare": {
          "enabled": true,
          "id": "ca8eafbc-81f4-421e-93a6-2ad40006bfbe",
          "target_job_id": "23c0ca43-68d4-45d2-af95-6711d8fe178e",
          "source_trigger_id": "76c83c8a-a600-4075-a787-ef72d4c56345",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE 2024AC SalesForce CommCare Participants",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2024ac\""
        }
      }
    },
    "Production---Participants---KE-Nespresso-2024BC---SalesForce----CommCare": {
      "id": "a3275e4c-972e-421f-b4d7-931e3009c3b4",
      "name": "Production - Participants - KE Nespresso 2024BC - SalesForce -- CommCare",
      "inserted_at": "2025-01-25T14:44:30.777521Z",
      "lock_version": 2,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "1b83aedb-cff8-44f3-94c3-5154e74c7a02",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Participants---KE-Nespresso-2024BC---SalesForce----CommCare": {
          "id": "09762c31-419d-4772-b739-7e42d6ef05ad",
          "name": "Production - Participants - KE Nespresso 2024BC - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending Participants for Coffee KE - Nespresso 2024BC\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - KE Nespresso 2024BC\n// JOB NAME :: Production | Participants - KE Nespresso 2024BC | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Participant\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_ke_2023c\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n// EDITED :: Emmanuel Mwaka | emwaka@tns.org\n\neach(\n    \"$.data.participants[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/3E266629-AFD8-4A1C-8825-1DCDDF24E5A8\",\n            \"uiVersion\": \"1\",\n            \"version\": \"325\",\n            \"name\": \"New Participant\",\n          };\n        }),\n        field(\"Name\", function(state){\n          var name = '';\n          if(dataValue(\"participantName\")(state) !== null) {\n            name = dataValue(\"participantName\")(state);\n          }\n          if(dataValue(\"participantMiddleName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantMiddleName\")(state);\n          }\n          if(dataValue(\"participantLastName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantLastName\")(state);\n          }\n          return name;\n        }),\n        field(\"First_Name\", dataValue(\"participantName\")),\n        field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n        field(\"Last_Name\", dataValue(\"participantLastName\")),\n        field(\"Age\", dataValue(\"participantAge\")),\n        field(\"Gender\", dataValue(\"participantGender\")),\n        field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n        field(\"Farmer_Id\", dataValue(\"tnsId\")),\n        field(\"Farmer_Number\", function(state){\n          var tnsId = dataValue(\"tnsId\")(state);\n          var farmerNumber = \"0\" + tnsId.substr(tnsId.length-1,1);\n          return farmerNumber;\n        }),\n        field(\"Cooperative_Membership_Number\", dataValue(\"participantOtherIDNumber\")),\n        field(\"Household_Id\", dataValue(\"householdId\")),\n        field(\"Household_Number\", dataValue(\"HHID\")),\n        field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n        field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n        field(\"Status\", dataValue(\"status\")),\n        field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n        field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n        field(\"Name_Household_Concat\", function(state){\n          var name = '';\n          var tnsId = dataValue(\"tnsId\")(state);\n          var hhNumber = dataValue(\"HHID\")(state);\n          var farmerNumber = \"0\" + tnsId.substr(tnsId.length-1,1);\n          \n          if(dataValue(\"participantName\")(state) !== null) {\n            name = dataValue(\"participantName\")(state);\n          }\n          if(dataValue(\"participantMiddleName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantMiddleName\")(state);\n          }\n          if(dataValue(\"participantLastName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantLastName\")(state);\n          }\n          return name+' '+hhNumber+'-'+farmerNumber;\n        }),\n        \n        field(\"n0:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"commCareCaseId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": function(){\n                var name = '';\n                if(dataValue(\"participantName\")(state) !== null) {\n                  name = dataValue(\"participantName\")(state);\n                }\n                if(dataValue(\"participantMiddleName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantMiddleName\")(state);\n                }\n                if(dataValue(\"participantLastName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantLastName\")(state);\n                }\n                return name;\n              },\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_ke_2024bc_participant\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n              \"n0:First_Name\": dataValue(\"participantName\")(state),\n              \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n              \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n              \"n0:Age\": dataValue(\"participantAge\")(state),\n              \"n0:Gender\": dataValue(\"participantGender\")(state),\n              \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n              \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n              \"n0:Farmer_Number\": function(){\n                var tnsId = dataValue(\"tnsId\")(state);\n                var farmerNumber = tnsId.substr(tnsId.length-1,1);\n                return farmerNumber;\n              },\n              \"n0:Cooperative_Membership_Number\": dataValue(\"participantOtherIDNumber\")(state),\n              \"n0:Household_Id\": dataValue(\"householdId\")(state),\n              \"n0:Household_Number\": dataValue(\"HHID\")(state),\n              \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n              \"n0:Status\": dataValue(\"status\")(state),\n              \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n              \"n0:Name_Household_Concat\": function(){\n                var name = '';\n                var tnsId = dataValue(\"tnsId\")(state);\n                var hhNumber = dataValue(\"HHID\")(state);\n                var farmerNumber = tnsId.substr(tnsId.length-1,1);\n                \n                if(dataValue(\"participantName\")(state) !== null) {\n                  name = dataValue(\"participantName\")(state);\n                }\n                if(dataValue(\"participantMiddleName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantMiddleName\")(state);\n                }\n                if(dataValue(\"participantLastName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantLastName\")(state);\n                }\n                return name+' '+hhNumber+'-'+farmerNumber;\n              },\n              \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n              \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n            },\n            \"n0:index\": {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_ke_2024bc_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupId\")(state)\n              }\n            }\n          };\n        }),\n        field(\"n1:meta\", function(state) {\n          return {\n            \"@\": {\n              \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n            },\n            \"n1:deviceID\": \"867066029216796\",\n            \"n1:timeStart\": new Date().toISOString(),\n            \"n1:timeEnd\": new Date().toISOString(),\n            \"n1:username\": \"api\",\n            \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );\n  \n  //Version Control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Participants---KE-Nespresso-2024BC---SalesForce----CommCare": {
          "enabled": true,
          "id": "fb9698e8-dade-4e4c-a7ad-de8204cd8e40",
          "target_job_id": "09762c31-419d-4772-b739-7e42d6ef05ad",
          "source_trigger_id": "1b83aedb-cff8-44f3-94c3-5154e74c7a02",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE 2024BC SalesForce CommCare Participants",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2024bc\""
        }
      }
    },
    "Production---Project-Role---ET-GAC-CREW-C2025---SalesForce----CommCare": {
      "id": "eac4502f-7b1f-4d69-8e88-aee527079a09",
      "name": "Production - Project Role - ET GAC CREW C2025 - SalesForce -- CommCare",
      "inserted_at": "2025-01-25T14:44:35.982263Z",
      "lock_version": 2,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "d31002b1-c04b-4a7f-9bd8-fc91b5d9957e",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Project-Role---ET-GAC-CREW-C2025---SalesForce----CommCare": {
          "id": "c4c2e85c-2929-41a4-8b0d-36b153d7bf1a",
          "name": "Production - Project Role - ET GAC CREW C2025 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending project roles\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET GAC CREW C2025\n// JOB NAME :: Production | Project Role - ET GAC CREW C2025 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_hwg_jcp_crew_c2025\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/CBD34B15-1442-4548-9B2D-C9937E3CB347\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"FFGs_Observed\", null),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_hwg_jcp_crew_c2025_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:FFGs_Observed\": null,\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Project-Role---ET-GAC-CREW-C2025---SalesForce----CommCare": {
          "enabled": true,
          "id": "08cdbe2e-297f-4949-8686-343c38cd5492",
          "target_job_id": "c4c2e85c-2929-41a4-8b0d-36b153d7bf1a",
          "source_trigger_id": "d31002b1-c04b-4a7f-9bd8-fc91b5d9957e",
          "condition_type": "js_expression",
          "condition_label": "Production Project Role ET GAC CREW C2025 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_hwg_jcp_crew_c2025\""
        }
      }
    },
    "Production---Participants---ET-Regrow-TG--Ag--C2024---SalesForce----CommCare": {
      "id": "8f151eeb-8fa5-429f-9669-dbf6bc7ff382",
      "name": "Production - Participants - ET Regrow TG -Ag- C2024 - SalesForce -- CommCare",
      "inserted_at": "2025-01-25T14:45:09.575808Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "1dac3342-f3fa-49d6-9e49-e1f7f926e3ea",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Participants---ET-Regrow-TG--Ag--C2024---SalesForce----CommCare": {
          "id": "08dcc6de-4072-4699-b187-ecec28c2ad74",
          "name": "Production - Participants - ET Regrow TG -Ag- C2024 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending Participants for Coffee ET - Regrow Yirga Agronomy C2024\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET Regrow Yirga (Ag) C2024\n// JOB NAME :: Production | Participants - ET Regrow YG (Ag) C2024 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_regrow_ag_c3\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n\neach(\n  \"$.data.participants[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3E266629-AFD8-4A1C-8825-1DCDDF24E5A8\",\n          \"uiVersion\": \"1\",\n          \"version\": \"325\",\n          \"name\": \"New Participant\",\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name;\n      }),\n      field(\"First_Name\", dataValue(\"participantName\")),\n      field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n      field(\"Last_Name\", dataValue(\"participantLastName\")),\n      field(\"Age\", dataValue(\"participantAge\")),\n      field(\"Gender\", dataValue(\"participantGender\")),\n      field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n      field(\"Farmer_Id\", dataValue(\"tnsId\")),\n      field(\"Farmer_Number\", function(state){\n        var tnsId = dataValue(\"tnsId\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        return farmerNumber;\n      }),\n      field(\"Cooperative_Membership_Number\", dataValue(\"participantOtherIDNumber\")),\n      field(\"Household_Id\", dataValue(\"householdId\")),\n      field(\"Household_Number\", dataValue(\"householdName\")),\n      field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n      field(\"Status\", dataValue(\"status\")),\n      field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Name_Household_Concat\", function(state){\n        var name = '';\n        var tnsId = dataValue(\"tnsId\")(state);\n        var hhNumber = dataValue(\"householdName\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        \n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name+' '+hhNumber+'-'+farmerNumber;\n      }),\n      \n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_regrow_ag_c3_participant\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:First_Name\": dataValue(\"participantName\")(state),\n            \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n            \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n            \"n0:Age\": dataValue(\"participantAge\")(state),\n            \"n0:Gender\": dataValue(\"participantGender\")(state),\n            \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n            \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Farmer_Number\": function(){\n              var tnsId = dataValue(\"tnsId\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              return farmerNumber;\n            },\n            \"n0:Cooperative_Membership_Number\": dataValue(\"participantOtherIDNumber\")(state),\n            \"n0:Household_Id\": dataValue(\"householdId\")(state),\n            \"n0:Household_Number\": dataValue(\"householdName\")(state),\n            \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n            \"n0:Status\": dataValue(\"status\")(state),\n            \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n            \"n0:Name_Household_Concat\": function(){\n              var name = '';\n              var tnsId = dataValue(\"tnsId\")(state);\n              var hhNumber = dataValue(\"householdName\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              \n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name+' '+hhNumber+'-'+farmerNumber;\n            },\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_et_regrow_ag_c3_training_group\"\n              },\n              \"#\": dataValue(\"trainingGroupId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n1:deviceID\": \"867066029216796\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Participants---ET-Regrow-TG--Ag--C2024---SalesForce----CommCare": {
          "enabled": true,
          "id": "1c62d298-4f8d-4b81-9e3a-0820571ecf5f",
          "target_job_id": "08dcc6de-4072-4699-b187-ecec28c2ad74",
          "source_trigger_id": "1dac3342-f3fa-49d6-9e49-e1f7f926e3ea",
          "condition_type": "js_expression",
          "condition_label": "Production Participants Regrow Yirga C2024 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_regrow_ag_c3\""
        }
      }
    },
    "Production---Participants---KE-Nespresso-2023C---SalesForce----CommCare": {
      "id": "9f52366b-cb17-4000-998c-579e8e578eac",
      "name": "Production - Participants - KE Nespresso 2023C - SalesForce -- CommCare",
      "inserted_at": "2025-01-25T14:45:22.318511Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "f8bc3a6f-09d9-47f3-aa32-12f1e8bc064e",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Participants---KE-Nespresso-2023C---SalesForce----CommCare": {
          "id": "ed136a38-6fb9-4771-8130-4226ff6e12a3",
          "name": "Production - Participants - KE Nespresso 2023C - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending Participants for Coffee KE - Nespresso 2023C\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - KE Nespresso 2023C\n// JOB NAME :: Production | Participants - KE Nespresso 2023C | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Participant\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_ke_2023c\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n// EDITED :: Emmanuel Mwaka | emwaka@tns.org\n\neach(\n    \"$.data.participants[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/3E266629-AFD8-4A1C-8825-1DCDDF24E5A8\",\n            \"uiVersion\": \"1\",\n            \"version\": \"325\",\n            \"name\": \"New Participant\",\n          };\n        }),\n        field(\"Name\", function(state){\n          var name = '';\n          if(dataValue(\"participantName\")(state) !== null) {\n            name = dataValue(\"participantName\")(state);\n          }\n          if(dataValue(\"participantMiddleName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantMiddleName\")(state);\n          }\n          if(dataValue(\"participantLastName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantLastName\")(state);\n          }\n          return name;\n        }),\n        field(\"First_Name\", dataValue(\"participantName\")),\n        field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n        field(\"Last_Name\", dataValue(\"participantLastName\")),\n        field(\"Age\", dataValue(\"participantAge\")),\n        field(\"Gender\", dataValue(\"participantGender\")),\n        field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n        field(\"Farmer_Id\", dataValue(\"tnsId\")),\n        field(\"Farmer_Number\", function(state){\n          var tnsId = dataValue(\"tnsId\")(state);\n          var farmerNumber = tnsId.substr(tnsId.length-1,1);\n          return farmerNumber;\n        }),\n        field(\"Cooperative_Membership_Number\", dataValue(\"participantOtherIDNumber\")),\n        field(\"Household_Id\", dataValue(\"householdId\")),\n        field(\"Household_Number\", dataValue(\"householdName\")),\n        field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n        field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n        field(\"Status\", dataValue(\"status\")),\n        field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n        field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n        field(\"Name_Household_Concat\", function(state){\n          var name = '';\n          var tnsId = dataValue(\"tnsId\")(state);\n          var hhNumber = dataValue(\"householdName\")(state);\n          var farmerNumber = tnsId.substr(tnsId.length-1,1);\n          \n          if(dataValue(\"participantName\")(state) !== null) {\n            name = dataValue(\"participantName\")(state);\n          }\n          if(dataValue(\"participantMiddleName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantMiddleName\")(state);\n          }\n          if(dataValue(\"participantLastName\")(state) !== null) {\n            name = name+' '+dataValue(\"participantLastName\")(state);\n          }\n          return name+' '+hhNumber+'-'+farmerNumber;\n        }),\n        \n        field(\"n0:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"commCareCaseId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": function(){\n                var name = '';\n                if(dataValue(\"participantName\")(state) !== null) {\n                  name = dataValue(\"participantName\")(state);\n                }\n                if(dataValue(\"participantMiddleName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantMiddleName\")(state);\n                }\n                if(dataValue(\"participantLastName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantLastName\")(state);\n                }\n                return name;\n              },\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_ke_2023c_participant\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n              \"n0:First_Name\": dataValue(\"participantName\")(state),\n              \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n              \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n              \"n0:Age\": dataValue(\"participantAge\")(state),\n              \"n0:Gender\": dataValue(\"participantGender\")(state),\n              \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n              \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n              \"n0:Farmer_Number\": function(){\n                var tnsId = dataValue(\"tnsId\")(state);\n                var farmerNumber = tnsId.substr(tnsId.length-1,1);\n                return farmerNumber;\n              },\n              \"n0:Cooperative_Membership_Number\": dataValue(\"participantOtherIDNumber\")(state),\n              \"n0:Household_Id\": dataValue(\"householdId\")(state),\n              \"n0:Household_Number\": dataValue(\"householdName\")(state),\n              \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n              \"n0:Status\": dataValue(\"status\")(state),\n              \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n              \"n0:Name_Household_Concat\": function(){\n                var name = '';\n                var tnsId = dataValue(\"tnsId\")(state);\n                var hhNumber = dataValue(\"householdName\")(state);\n                var farmerNumber = tnsId.substr(tnsId.length-1,1);\n                \n                if(dataValue(\"participantName\")(state) !== null) {\n                  name = dataValue(\"participantName\")(state);\n                }\n                if(dataValue(\"participantMiddleName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantMiddleName\")(state);\n                }\n                if(dataValue(\"participantLastName\")(state) !== null) {\n                  name = name+' '+dataValue(\"participantLastName\")(state);\n                }\n                return name+' '+hhNumber+'-'+farmerNumber;\n              },\n              \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n              \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n            },\n            \"n0:index\": {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_ke_2023C_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupId\")(state)\n              }\n            }\n          };\n        }),\n        field(\"n1:meta\", function(state) {\n          return {\n            \"@\": {\n              \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n            },\n            \"n1:deviceID\": \"867066029216796\",\n            \"n1:timeStart\": new Date().toISOString(),\n            \"n1:timeEnd\": new Date().toISOString(),\n            \"n1:username\": \"api\",\n            \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );\n  \n  //Version Control\n",
          "adaptor": "@openfn/language-commcare@v1.6.9",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Participants---KE-Nespresso-2023C---SalesForce----CommCare": {
          "enabled": true,
          "id": "e51fb3f6-36eb-45d0-8f6d-de0d57eeb60d",
          "target_job_id": "ed136a38-6fb9-4771-8130-4226ff6e12a3",
          "source_trigger_id": "f8bc3a6f-09d9-47f3-aa32-12f1e8bc064e",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE 2023C SalesForce CommCare Participants",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2023c\""
        }
      }
    },
    "Production---Training-Observation---CommCare----Salesforce---Agronomy-Projects": {
      "id": "0f567dc2-143b-43c1-bb64-36f1469edc8d",
      "name": "Production - Training Observation - CommCare -- Salesforce - Agronomy Projects",
      "inserted_at": "2025-01-25T14:46:47.558698Z",
      "lock_version": 2,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "0bd11b6a-edb2-4fb2-8f0e-7e5484a76e7f",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Training-Observation---CommCare----Salesforce---Agronomy-Projects": {
          "id": "9a880757-83ac-4ab1-b05e-13d6e73e0cb5",
          "name": "Production - Training Observation - CommCare -- Salesforce - Agronomy Projects",
          "body": "//TRAINING OBSERVATION JOB FOR ALL AGRONOMY PROJECTS\n\n\n//Ethiopia Nespresso, Regrow and HWG (Agronomy) Training Observation\nif(state.data.app_id == \"f079b0daae1d4d34a89e331dc5a72fbd\"|| \n    state.data.app_id == \"ff36e62b9fcc46628ec1be58d50abb5f\"||\n    state.data.app_id==\"87d0e772c7164d1c8f5aad2bda9a9892\" || \n    state.data.app_id ==\"0f123c9b44e04a8f93f94049c01ce6b3\" || \n    state.data.app_id == \"e226fd89f1ff41debde611a81daa9970\" || \n    state.data.app_id == \"e9fb922a1526447b9485b26c4a1b8eb5\" || \n    state.data.app_id == \"8f77f25440e5412ba0820a39271374f0\" || \n    state.data.app_id == \"d63cdcf6b9d849548413ca356871cd3a\" ||\n    state.data.app_id == \"dd10fc19040d40f0be48a447e1d2727c\"\n    ){\n\t\n\t//Create the observation record first prior\n\t//to creating the observation result records.\n  console.log(\"SHOULD WORK HERE\");\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation__c\", \"Submission_ID__c\",\n\t    fields(\n\t      field(\"Submission_ID__c\", dataValue(\"id\")),\n\t      field(\"Observer__c\", dataValue(\"form.Observer\")),\n\t      field(\"Trainer__c\", dataValue(\"form.trainer_salesforce_id\")),\n\t      field(\"Training_Group__c\", dataValue(\"form.Which_Group_Is_Farmer_Trainer_Teaching\")),\n\t      field(\"Training_Session__c\", dataValue(\"form.selected_session\")),\n\t      field(\"RecordTypeId\", dataValue(\"form.Record_Type\")),\n\t      field(\"Date__c\", dataValue(\"form.Date\")),\n\t      \n\t      field(\"Male_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Male_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Female_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Female_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Number_of_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Total_Participants_In_Attendance\")(state));\n\t      }),\n\t      \n\t      // field(\"Shared_Action_Plan__c\", dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan\")),\n\t      field(\"Shared_Action_Plan__c\", \n\t      function(state){\n\t        if(dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan\")(state) !== undefined) {\n\t          return dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan\")(state);\n\t        } else {\n\t          return '';\n\t        }\n\t      }),\n\t      field(\"Shared_Action_Plan_Comments__c\", function(state){\n\t        if(dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state) !== undefined) {\n\t          return dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state);\n\t        } else {\n\t          return '';\n\t        }\n\t      }),\n\t      field(\"Did_Well__c\", dataValue(\"form.Current_Session_Review.Did_Well\")),\n\t      field(\"To_Improve__c\", dataValue(\"form.Current_Session_Review.To_Improve\")),\n\t      \n\t      field(\"Photo_of_Facilitator_URL__c\", function(state) {\n\t        var photoUrl = '';\n\t        if(dataValue(\"form.Photo\")(state) !== undefined && dataValue(\"form.Photo\")(state) !== '') {\n\t          photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo\")(state);  \n\t        }\n\t        return photoUrl;\n\t      }),\n\t      field(\"Farmer_Trainer_Signature__c\", function(state) {\n\t        var trainerSignatureUrl = '';\n\t        if(dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== undefined && dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== '') {\n\t          trainerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state);  \n\t        }\n\t        return trainerSignatureUrl;\n\t      }),\n\t      field(\"Observer_Signature__c\", function(state) {\n\t        var observerSignatureUrl = '';\n\t        if(dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== undefined && dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== '') {\n\t          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state);  \n\t        }\n\t        return observerSignatureUrl;\n\t      }),\n\t      \n\t      field(\"Observation_Location__Latitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[0]; \n\t        }\n\t      }),\n\t      field(\"Observation_Location__Longitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[1]; \n\t        }\n\t      }),\n\t      field(\"Altitude__c\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[2]; \n\t        }\n\t      })\n\t      \n\t      \n\t    )\n\t  )),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- PREPARE AND IMPLEMENT AGRONOMY PRACTICE\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_prepare_and_implement_agronomy_practice-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_prepare_and_implement_agronomy_practice-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_prepare_and_implement_agronomy_practice-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- TEACHING CLARITY AND EFFECTIVENESS\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_teaching_clarity_and_effectiveness-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_teaching_clarity_and_effectiveness-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_teaching_clarity_and_effectiveness-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- KNOWLEDGE OF TRAINER ON AGRONOMY\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_knowledge_of_trainer_on_agronomy-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_knowledge_of_trainer_on_agronomy-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_knowledge_of_trainer_on_agronomy-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH TRAINING OBSERVATION CRITERIA\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_shows_professionalism\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_shows_professionalism\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_is_prepared_and_organized\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_is_prepared_and_organized\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",   \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_engages_participants\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_engages_participants\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_facilitates_openings_and_closings\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_facilitates_openings_and_closings\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_leads_activities\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_leads_activities\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_leads_discussions\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_leads_discussions\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_follows_lesson_plans\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_follows_lesson_plans\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeet_manages_time\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeet_manages_time\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time_Comments\"))\n\t  )));\n\t\n}\n\n//Majang Forest Training Observation\nelse if(state.data.app_id == \"da5e5dd32b6a4a68b8c6e0f80fe42650\"){\n\t\n\t//Create the observation record first prior\n\t//to creating the observation result records.\n  console.log(\"SHOULD NOT WORK HERE\");\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation__c\", \"Submission_ID__c\",\n\t    fields(\n\t      field(\"Submission_ID__c\", dataValue(\"id\")),\n\t      field(\"Observer__c\", dataValue(\"form.Observer\")),\n\t      field(\"Trainer__c\", dataValue(\"form.trainer_salesforce_id\")),\n\t      field(\"Training_Group__c\", dataValue(\"form.Which_Group_Is_Farmer_Trainer_Teaching\")),\n\t      field(\"Training_Session__c\", dataValue(\"form.selected_session\")),\n\t      field(\"RecordTypeId\", dataValue(\"form.Record_Type\")),\n\t      field(\"Date__c\", dataValue(\"form.Date\")),\n\n\t      field(\"Male_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Male_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Female_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Female_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Number_of_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Total_Participants_In_Attendance\")(state));\n\t      }),\n\n\t      field(\"Shared_Action_Plan__c\", dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan\")),\n\t      field(\"Shared_Action_Plan_Comments__c\", function(state){\n\t        if(dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state) !== undefined) {\n\t          return dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state);\n\t        } else {\n\t          return '';\n\t        }\n\t      }),\n\t      field(\"Did_Well__c\", dataValue(\"form.Current_Session_Review.Did_Well\")),\n\t      field(\"To_Improve__c\", dataValue(\"form.Current_Session_Review.To_Improve\")),\n\n\t      field(\"Photo_of_Facilitator_URL__c\", function(state) {\n\t        var photoUrl = '';\n\t        if(dataValue(\"form.Photo\")(state) !== undefined && dataValue(\"form.Photo\")(state) !== '') {\n\t          photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo\")(state);\n\t        }\n\t        return photoUrl;\n\t      }),\n\t      field(\"Farmer_Trainer_Signature__c\", function(state) {\n\t        var trainerSignatureUrl = '';\n\t        if(dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== undefined && dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== '') {\n\t          trainerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state);\n\t        }\n\t        return trainerSignatureUrl;\n\t      }),\n\t      field(\"Observer_Signature__c\", function(state) {\n\t        var observerSignatureUrl = '';\n\t        if(dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== undefined && dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== '') {\n\t          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state);\n\t        }\n\t        return observerSignatureUrl;\n\t      }),\n\n\t      field(\"Observation_Location__Latitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[0];\n\t        }\n\t      }),\n\t      field(\"Observation_Location__Longitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[1];\n\t        }\n\t      }),\n\t      field(\"Altitude__c\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[2];\n\t        }\n\t      })\n\n\n\t    )\n\t  )),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- PREPARE AND IMPLEMENT AGRONOMY PRACTICE\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_prepare_and_implement_agronomy_practice-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_prepare_and_implement_agronomy_practice-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_prepare_and_implement_agronomy_practice-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- TEACHING CLARITY AND EFFECTIVENESS\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_teaching_clarity_and_effectiveness-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_teaching_clarity_and_effectiveness-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_teaching_clarity_and_effectiveness-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- KNOWLEDGE OF TRAINER ON AGRONOMY\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_knowledge_of_trainer_on_agronomy-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_knowledge_of_trainer_on_agronomy-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_knowledge_of_trainer_on_agronomy-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH TRAINING OBSERVATION CRITERIA\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_shows_professionalism\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_shows_professionalism\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_is_prepared_and_organized\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_is_prepared_and_organized\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_engages_participants\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_engages_participants\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_facilitates_openings_and_closings\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_facilitates_openings_and_closings\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_leads_activities\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_leads_activities\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_leads_discussions\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_leads_discussions\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_follows_lesson_plans\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_follows_lesson_plans\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeemf_manages_time\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeemf_manages_time\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time_Comments\"))\n\t  )));\n\n}\n\n//Uganda Agronomy Training Observation\nelse if(state.data.app_id == \"bca69b9caad5441bb9c782e91d829e4b\" || state.data.app_id == \"03a969f33e9648cb88c36114896f3cbe\"){\n\t\n\t//Create the observation record first prior\n\t//to creating the observation result records.\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation__c\", \"Submission_ID__c\",\n\t    fields(\n\t      field(\"Submission_ID__c\", dataValue(\"id\")),\n\t      field(\"Observer__c\", dataValue(\"form.observer\")),\n\t      field(\"Trainer__c\", dataValue(\"form.trainer_salesforce_id\")),\n\t      field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n\t      field(\"Training_Session__c\", dataValue(\"form.selected_session\")),\n\t      field(\"RecordTypeId\", dataValue(\"form.record_type\")),\n\t      field(\"Date__c\", dataValue(\"form.date\")),\n\t      field(\"Observation_Type__c\", dataValue(\"form.type_of_training_observation\")),\n\t      \n\t      field(\"Male_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Male_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Female_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Female_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Number_of_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Total_Participants_In_Attendance\")(state));\n\t      }),\n\t      \n\t      /**\n\t      field(\"Shared_Action_Plan__c\", dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan\")),\n\t      field(\"Shared_Action_Plan_Comments__c\", function(state){\n\t        if(dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state) !== undefined) {\n\t          return dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state);\n\t        } else {\n\t          return '';\n\t        }\n\t      }),\n\t      */\n\n\t      field(\"Did_Well__c\", dataValue(\"form.Current_Session_Review.Did_Well\")),\n\t      field(\"To_Improve__c\", dataValue(\"form.Current_Session_Review.To_Improve\")),\n\t      \n\t      field(\"Photo_of_Facilitator_URL__c\", function(state) {\n\t        var photoUrl = '';\n\t        if(dataValue(\"form.Photo\")(state) !== undefined && dataValue(\"form.Photo\")(state) !== '') {\n\t          photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo\")(state);  \n\t        }\n\t        return photoUrl;\n\t      }),\n\t      field(\"Farmer_Trainer_Signature__c\", function(state) {\n\t        var trainerSignatureUrl = '';\n\t        if(dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== undefined && dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== '') {\n\t          trainerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state);  \n\t        }\n\t        return trainerSignatureUrl;\n\t      }),\n\t      field(\"Observer_Signature__c\", function(state) {\n\t        var observerSignatureUrl = '';\n\t        if(dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== undefined && dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== '') {\n\t          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state);  \n\t        }\n\t        return observerSignatureUrl;\n\t      }),\n\t      \n\t      field(\"Observation_Location__Latitude__s\", function(state) {\n\t  \t\t    if(dataValue(\"form.gps_information.gps_coordinates\")(state) !== undefined && dataValue(\"form.gps_information.gps_coordinates\")(state) !== '') {\n\t  \t\t        var coordinates = dataValue(\"form.gps_information.gps_coordinates\")(state).split(' ');\n\t  \t\t        return coordinates[0]; \n\t  \n\t  \t\t  \t} else if(dataValue(\"form.gps_information_retry.gps_coordinates\")(state) !== undefined && dataValue(\"form.gps_information_retry.gps_coordinates\")(state) !== ''){\n\t  \t\t        var coordinates = dataValue(\"form.gps_information_retry.gps_coordinates\")(state).split(' ');\n\t  \t\t        return coordinates[0];\n\t  \t\t    }\n\t  \t\t}),\n\t  \t\tfield(\"Observation_Location__Longitude__s\", function(state) {\n\t  \t\t    if(dataValue(\"form.gps_information.gps_coordinates\")(state) !== undefined && dataValue(\"form.gps_information.gps_coordinates\")(state) !== '') {\n\t  \t\t        var coordinates = dataValue(\"form.gps_information.gps_coordinates\")(state).split(' ');\n\t  \t\t        return coordinates[1]; \n\t  \n\t  \t\t  \t} else if(dataValue(\"form.gps_information_retry.gps_coordinates\")(state) !== undefined && dataValue(\"form.gps_information_retry.gps_coordinates\")(state) !== ''){\n\t  \t\t        var coordinates = dataValue(\"form.gps_information_retry.gps_coordinates\")(state).split(' ');\n\t  \t\t        return coordinates[1];\n\t  \t\t    }\n\t  \t\t}),\n\t  \t\tfield(\"Altitude__c\", function(state) {\n\t  \t\t    if(dataValue(\"form.gps_information.gps_coordinates\")(state) !== undefined && dataValue(\"form.gps_information.gps_coordinates\")(state) !== '') {\n\t  \t\t        var coordinates = dataValue(\"form.gps_information.gps_coordinates\")(state).split(' ');\n\t  \t\t        return coordinates[2]; \n\t  \n\t  \t\t  \t} else if(dataValue(\"form.gps_information_retry.gps_coordinates\")(state) !== undefined && dataValue(\"form.gps_information_retry.gps_coordinates\")(state) !== ''){\n\t  \t\t        var coordinates = dataValue(\"form.gps_information_retry.gps_coordinates\")(state).split(' ');\n\t  \t\t        return coordinates[2];\n\t  \t\t    }\n\t  \t\t})\n\t      \n\t      \n\t    )\n\t  )),\n\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- PREPARE AND IMPLEMENT BUSINESS PRACTICE\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeug_knowledge_of_trainer_on_business_practice-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeug_knowledge_of_trainer_on_business_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Knowledge_Of_Trainer_On_Business_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeug_knowledge_of_trainer_on_business_practice-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeug_knowledge_of_trainer_on_business_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Knowledge_Of_Trainer_On_Business_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeug_knowledge_of_trainer_on_business_practice-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeug_knowledge_of_trainer_on_business_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Knowledge_Of_Trainer_On_Business_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH TRAINING OBSERVATION CRITERIA\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeug_shows_professionalism\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeug_shows_professionalism\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeug_is_prepared_and_organized\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeug_is_prepared_and_organized\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",   \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeug_engages_participants\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeug_engages_participants\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeug_facilitates_openings_and_closings\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeug_facilitates_openings_and_closings\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeug_leads_activities\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeug_leads_activities\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeug_leads_discussions\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeug_leads_discussions\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeug_follows_lesson_plans\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeug_follows_lesson_plans\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeug_manages_time\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeug_manages_time\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time_Comments\"))\n\t  )));\n\n}\n\n//DRC Agronomy Training Observation\nelse if(state.data.app_id == \"eeddc901b4aa4652b7252240152b20d5\" || state.data.app_id == \"5372957f094346659170e319aa0ed456\" || state.data.app_id == \"163fe0239f924d18aaf70e6292a48677\"){\n\t//Training Observations\n\t//Production - Coffee DRC | CommCare --> SalesForce | Training Observations\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation__c\", \"Submission_ID__c\",\n\t    fields(\n\t      field(\"Submission_ID__c\", dataValue(\"id\")),\n\t      field(\"Observer__c\", dataValue(\"form.Observer\")),\n\t      field(\"Trainer__c\", dataValue(\"form.trainer_salesforce_id\")),\n\t      field(\"Training_Group__c\", dataValue(\"form.Which_Group_Is_Farmer_Trainer_Teaching\")),\n\t      field(\"Training_Session__c\", dataValue(\"form.selected_session\")),\n\t      field(\"RecordTypeId\", dataValue(\"form.Record_Type\")),\n\t      field(\"Date__c\", dataValue(\"form.Date\")),\n\t      field(\"Observation_Type__c\", dataValue(\"form.type_of_training_observation\")),\n\t      \n\t      field(\"Male_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Male_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Female_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Female_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Number_of_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Total_Participants_In_Attendance\")(state));\n\t      }),\n\t      \n\t      field(\"Shared_Action_Plan__c\", dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan\")),\n\t      field(\"Shared_Action_Plan_Comments__c\", function(state){\n\t        if(dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state) !== undefined) {\n\t          return dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state);\n\t        } else {\n\t          return '';\n\t        }\n\t      }),\n\t      field(\"Did_Well__c\", dataValue(\"form.Current_Session_Review.Did_Well\")),\n\t      field(\"To_Improve__c\", dataValue(\"form.Current_Session_Review.To_Improve\")),\n\t      \n\t      field(\"Photo_of_Facilitator_URL__c\", function(state) {\n\t        var photoUrl = '';\n\t        if(dataValue(\"form.Photo\")(state) !== undefined && dataValue(\"form.Photo\")(state) !== '') {\n\t          photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo\")(state);  \n\t        }\n\t        return photoUrl;\n\t      }),\n\t      field(\"Farmer_Trainer_Signature__c\", function(state) {\n\t        var trainerSignatureUrl = '';\n\t        if(dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== undefined && dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== '') {\n\t          trainerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state);  \n\t        }\n\t        return trainerSignatureUrl;\n\t      }),\n\t      field(\"Observer_Signature__c\", function(state) {\n\t        var observerSignatureUrl = '';\n\t        if(dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== undefined && dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== '') {\n\t          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state);  \n\t        }\n\t        return observerSignatureUrl;\n\t      }),\n\t      \n\t      field(\"Observation_Location__Latitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[0]; \n\t        }\n\t      }),\n\t      field(\"Observation_Location__Longitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[1]; \n\t        }\n\t      }),\n\t      field(\"Altitude__c\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[2]; \n\t        }\n\t      })\n\t      \n\t      \n\t    )\n\t  )),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- PREPARE AND IMPLEMENT AGRONOMY PRACTICE\n\t \n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_prepare_and_implement_agronomy_practice-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_prepare_and_implement_agronomy_practice-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_prepare_and_implement_agronomy_practice-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- TEACHING CLARITY AND EFFECTIVENESS\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_teaching_clarity_and_effectiveness-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_teaching_clarity_and_effectiveness-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_teaching_clarity_and_effectiveness-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- KNOWLEDGE OF TRAINER ON AGRONOMY\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_knowledge_of_trainer_on_agronomy-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_knowledge_of_trainer_on_agronomy-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_knowledge_of_trainer_on_agronomy-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH TRAINING OBSERVATION CRITERIA\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_shows_professionalism\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_shows_professionalism\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_is_prepared_and_organized\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_is_prepared_and_organized\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",   \n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_engages_participants\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_engages_participants\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_facilitates_openings_and_closings\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_facilitates_openings_and_closings\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_leads_activities\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_leads_activities\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_leads_discussions\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_leads_discussions\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_follows_lesson_plans\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_follows_lesson_plans\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_drc_manages_time\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_manages_time\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time_Comments\"))\n\t  )));\n\t  \n}\n\n//Zimbabwe Agronomy Training Observation\nelse if(state.data.app_id == \"b75286e874c74eb09b8da436709d7f3c\" || state.data.app_id == \"c14d231df6e142deb9bdd44319287437\" || state.data.app_id == \"2b0b8dc3eff145889eaa3d085bfaadaf\"){\n\t\n\t//Training Observation\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation__c\", \"Submission_ID__c\",\n\t    fields(\n\t      field(\"Submission_ID__c\", dataValue(\"id\")),\n\t      field(\"Observer__c\", dataValue(\"form.Observer\")),\n\t      field(\"Trainer__c\", dataValue(\"form.trainer_salesforce_id\")),\n\t      field(\"Training_Group__c\", dataValue(\"form.Which_Group_Is_Farmer_Trainer_Teaching\")),\n\t      field(\"Training_Session__c\", dataValue(\"form.selected_session\")),\n\t      field(\"RecordTypeId\", dataValue(\"form.Record_Type\")),\n\t      field(\"Date__c\", dataValue(\"form.Date\")),\n\t      field(\"Observation_Type__c\", dataValue(\"form.type_of_training_observation\")),\n\t      \n\t      field(\"Male_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Male_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Female_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Female_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Number_of_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Total_Participants_In_Attendance\")(state));\n\t      }),\n\t      \n\t      field(\"Shared_Action_Plan__c\", dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan\")),\n\t      field(\"Shared_Action_Plan_Comments__c\", function(state){\n\t        if(dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state) !== undefined) {\n\t          return dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state);\n\t        } else {\n\t          return '';\n\t        }\n\t      }),\n\t      field(\"Did_Well__c\", dataValue(\"form.Current_Session_Review.Did_Well\")),\n\t      field(\"To_Improve__c\", dataValue(\"form.Current_Session_Review.To_Improve\")),\n\t      \n\t      field(\"Photo_of_Facilitator_URL__c\", function(state) {\n\t        var photoUrl = '';\n\t        if(dataValue(\"form.Photo\")(state) !== undefined && dataValue(\"form.Photo\")(state) !== '') {\n\t          photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo\")(state);  \n\t        }\n\t        return photoUrl;\n\t      }),\n\t      field(\"Farmer_Trainer_Signature__c\", function(state) {\n\t        var trainerSignatureUrl = '';\n\t        if(dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== undefined && dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== '') {\n\t          trainerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state);  \n\t        }\n\t        return trainerSignatureUrl;\n\t      }),\n\t      field(\"Observer_Signature__c\", function(state) {\n\t        var observerSignatureUrl = '';\n\t        if(dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== undefined && dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== '') {\n\t          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state);  \n\t        }\n\t        return observerSignatureUrl;\n\t      }),\n\t      \n\t      field(\"Observation_Location__Latitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[0]; \n\t        }\n\t      }),\n\t      field(\"Observation_Location__Longitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[1]; \n\t        }\n\t      }),\n\t      field(\"Altitude__c\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[2]; \n\t        }\n\t      })\n\t      \n\t      \n\t    )\n\t  )),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- PREPARE AND IMPLEMENT AGRONOMY PRACTICE\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_prepare_and_implement_agronomy_practice-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_prepare_and_implement_agronomy_practice-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_prepare_and_implement_agronomy_practice-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- TEACHING CLARITY AND EFFECTIVENESS\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_teaching_clarity_and_effectiveness-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_teaching_clarity_and_effectiveness-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_teaching_clarity_and_effectiveness-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- KNOWLEDGE OF TRAINER ON AGRONOMY\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_knowledge_of_trainer_on_agronomy-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_knowledge_of_trainer_on_agronomy-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_knowledge_of_trainer_on_agronomy-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH TRAINING OBSERVATION CRITERIA\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_shows_professionalism\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_shows_professionalism\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_is_prepared_and_organized\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_is_prepared_and_organized\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",   \n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_engages_participants\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_engages_participants\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_facilitates_openings_and_closings\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_facilitates_openings_and_closings\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_leads_activities\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_leads_activities\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_leads_discussions\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_leads_discussions\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_follows_lesson_plans\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_follows_lesson_plans\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_zim_manages_time\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_manages_time\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time_Comments\"))\n\t  )));\n\n}\n\n//Kenya Nespresso Training Observation\nelse if(state.data.app_id == \"30cee26f064e403388e334ae7b0c403b\" || state.data.app_id == \"4302942f5eb84ab6b73fc1fd607cda1f\" || state.data.app_id == \"ae6ad2d1fb104da5be0dbb1d431db8b4\"){\n\n\t//Create the observation record first prior\n\t//to creating the observation result records.\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation__c\", \"Submission_ID__c\",\n\t    fields(\n\t      field(\"Submission_ID__c\", dataValue(\"id\")),\n\t      field(\"Observer__c\", dataValue(\"form.Observer\")),\n\t      field(\"Trainer__c\", dataValue(\"form.trainer_salesforce_id\")),\n\t      field(\"Training_Group__c\", dataValue(\"form.Which_Group_Is_Farmer_Trainer_Teaching\")),\n\t      field(\"Training_Session__c\", dataValue(\"form.selected_session\")),\n\t      field(\"RecordTypeId\", dataValue(\"form.Record_Type\")),\n\t      field(\"Date__c\", dataValue(\"form.Date\")),\n\t      \n\t      field(\"Male_Participants__c\", function(state){\n\t        console.log(\"Male PARTICIPANT\")\n\t        return parseInt(dataValue(\"form.Current_session_participants.Male_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Female_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Female_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Number_of_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Total_Participants_In_Attendance\")(state));\n\t      }),\n\t      \n\t      field(\"Shared_Action_Plan__c\", dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan\")),\n\t      field(\"Shared_Action_Plan_Comments__c\", function(state){\n\t        if(dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state) !== undefined) {\n\t          return dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state);\n\t        } else {\n\t          return '';\n\t        }\n\t      }),\n\t      field(\"Did_Well__c\", dataValue(\"form.Current_Session_Review.Did_Well\")),\n\t      field(\"To_Improve__c\", dataValue(\"form.Current_Session_Review.To_Improve\")),\n\t      \n\t      field(\"Photo_of_Facilitator_URL__c\", function(state) {\n\t        var photoUrl = '';\n\t        if(dataValue(\"form.Photo\")(state) !== undefined && dataValue(\"form.Photo\")(state) !== '') {\n\t          photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo\")(state);  \n\t        }\n\t        return photoUrl;\n\t      }),\n\t      field(\"Farmer_Trainer_Signature__c\", function(state) {\n\t        var trainerSignatureUrl = '';\n\t        if(dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== undefined && dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== '') {\n\t          trainerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state);  \n\t        }\n\t        return trainerSignatureUrl;\n\t      }),\n\t      field(\"Observer_Signature__c\", function(state) {\n\t        var observerSignatureUrl = '';\n\t        if(dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== undefined && dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== '') {\n\t          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state);  \n\t        }\n\t        return observerSignatureUrl;\n\t      }),\n\t      \n\t      field(\"Observation_Location__Latitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[0]; \n\t        }\n\t      }),\n\t      field(\"Observation_Location__Longitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[1]; \n\t        }\n\t      }),\n\t      field(\"Altitude__c\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[2]; \n\t        }\n\t      })\n\t      \n\t      \n\t    )\n\t  )),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- PREPARE AND IMPLEMENT AGRONOMY PRACTICE\n\t  console.log(\"Last Last by Burna Boy 2!\");\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      console.log(\"Observation_Result__c\");\n\t      return dataValue(\"id\")(state) + \"coffeeke_prepare_and_implement_agronomy_practice-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_prepare_and_implement_agronomy_practice-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_prepare_and_implement_agronomy_practice-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- TEACHING CLARITY AND EFFECTIVENESS\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_teaching_clarity_and_effectiveness-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_teaching_clarity_and_effectiveness-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_teaching_clarity_and_effectiveness-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- KNOWLEDGE OF TRAINER ON AGRONOMY\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_knowledge_of_trainer_on_agronomy-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_knowledge_of_trainer_on_agronomy-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_knowledge_of_trainer_on_agronomy-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH TRAINING OBSERVATION CRITERIA\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_shows_professionalism\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_shows_professionalism\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_is_prepared_and_organized\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_is_prepared_and_organized\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",   \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_engages_participants\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_engages_participants\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_facilitates_openings_and_closings\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_facilitates_openings_and_closings\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_leads_activities\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_leads_activities\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_leads_discussions\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_leads_discussions\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_follows_lesson_plans\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_follows_lesson_plans\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffeeke_manages_time\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffeeke_manages_time\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time_Comments\"))\n\t  )));\n\t\n}\n\n//ET Herz Training Observation\nelse if(state.data.app_id == \"22d766b8c673413eab2d9042dfc904e0\" || state.data.app_id == \"7f47bffde10d46598276b14748298190\"){\n\n\t//Create the observation record first prior\n\t//to creating the observation result records.\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation__c\", \"Submission_ID__c\",\n\t    fields(\n\t      field(\"Submission_ID__c\", dataValue(\"id\")),\n\t      field(\"Observer__c\", dataValue(\"form.Observer\")),\n\t      field(\"Trainer__c\", dataValue(\"form.trainer_salesforce_id\")),\n\t      field(\"Training_Group__c\", dataValue(\"form.Which_Group_Is_Farmer_Trainer_Teaching\")),\n\t      field(\"Training_Session__c\", dataValue(\"form.selected_session\")),\n\t      field(\"RecordTypeId\", dataValue(\"form.Record_Type\")),\n\t      field(\"Date__c\", dataValue(\"form.Date\")),\n\t      field(\"Observation_Type__c\", dataValue(\"form.type_of_training_observation\")),\n\t      \n\t      field(\"Male_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Male_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Female_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Female_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Number_of_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Total_Participants_In_Attendance\")(state));\n\t      }),\n\t      \n\t      field(\"Shared_Action_Plan__c\", dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan\")),\n\t      field(\"Shared_Action_Plan_Comments__c\", function(state){\n\t        if(dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state) !== undefined) {\n\t          return dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state);\n\t        } else {\n\t          return '';\n\t        }\n\t      }),\n\t      field(\"Did_Well__c\", dataValue(\"form.Current_Session_Review.Did_Well\")),\n\t      field(\"To_Improve__c\", dataValue(\"form.Current_Session_Review.To_Improve\")),\n\t      \n\t      field(\"Photo_of_Facilitator_URL__c\", function(state) {\n\t        var photoUrl = '';\n\t        if(dataValue(\"form.Photo\")(state) !== undefined && dataValue(\"form.Photo\")(state) !== '') {\n\t          photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo\")(state);  \n\t        }\n\t        return photoUrl;\n\t      }),\n\t      field(\"Farmer_Trainer_Signature__c\", function(state) {\n\t        var trainerSignatureUrl = '';\n\t        if(dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== undefined && dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== '') {\n\t          trainerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state);  \n\t        }\n\t        return trainerSignatureUrl;\n\t      }),\n\t      field(\"Observer_Signature__c\", function(state) {\n\t        var observerSignatureUrl = '';\n\t        if(dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== undefined && dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== '') {\n\t          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state);  \n\t        }\n\t        return observerSignatureUrl;\n\t      }),\n\t      \n\t      field(\"Observation_Location__Latitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[0]; \n\t        }\n\t      }),\n\t      field(\"Observation_Location__Longitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[1]; \n\t        }\n\t      }),\n\t      field(\"Altitude__c\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[2]; \n\t        }\n\t      })\n\t      \n\t      \n\t    )\n\t  )),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- PREPARE AND IMPLEMENT AGRONOMY PRACTICE\n\t  \n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_prepare_and_implement_agronomy_practice-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_prepare_and_implement_agronomy_practice-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_prepare_and_implement_agronomy_practice-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- TEACHING CLARITY AND EFFECTIVENESS\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_teaching_clarity_and_effectiveness-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_teaching_clarity_and_effectiveness-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_teaching_clarity_and_effectiveness-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- KNOWLEDGE OF TRAINER ON AGRONOMY\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_knowledge_of_trainer_on_agronomy-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_knowledge_of_trainer_on_agronomy-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_knowledge_of_trainer_on_agronomy-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH TRAINING OBSERVATION CRITERIA\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_shows_professionalism\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_shows_professionalism\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_is_prepared_and_organized\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_is_prepared_and_organized\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",   \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_engages_participants\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_engages_participants\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_facilitates_openings_and_closings\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_facilitates_openings_and_closings\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_leads_activities\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_leads_activities\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_leads_discussions\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_leads_discussions\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_follows_lesson_plans\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_follows_lesson_plans\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_herz_manages_time\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_herz_manages_time\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time_Comments\"))\n\t  )));\n\t\n}\n\n//ET JDE Training Observation\nelse if(state.data.app_id == \"30714a65ecab4d2da5aa78ca91cefcf5\"){\n\n\t//Create the observation record first prior\n\t//to creating the observation result records.\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation__c\", \"Submission_ID__c\",\n\t    fields(\n\t      field(\"Submission_ID__c\", dataValue(\"id\")),\n\t      field(\"Observer__c\", dataValue(\"form.Observer\")),\n\t      field(\"Trainer__c\", dataValue(\"form.trainer_salesforce_id\")),\n\t      field(\"Training_Group__c\", dataValue(\"form.Which_Group_Is_Farmer_Trainer_Teaching\")),\n\t      field(\"Training_Session__c\", dataValue(\"form.selected_session\")),\n\t      field(\"RecordTypeId\", dataValue(\"form.Record_Type\")),\n\t      field(\"Date__c\", dataValue(\"form.Date\")),\n\t      field(\"Observation_Type__c\", dataValue(\"form.type_of_training_observation\")),\n\t      \n\t      field(\"Male_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Male_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Female_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Female_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Number_of_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Total_Participants_In_Attendance\")(state));\n\t      }),\n\t      \n\t      field(\"Shared_Action_Plan__c\", dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan\")),\n\t      field(\"Shared_Action_Plan_Comments__c\", function(state){\n\t        if(dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state) !== undefined) {\n\t          return dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state);\n\t        } else {\n\t          return '';\n\t        }\n\t      }),\n\t      field(\"Did_Well__c\", dataValue(\"form.Current_Session_Review.Did_Well\")),\n\t      field(\"To_Improve__c\", dataValue(\"form.Current_Session_Review.To_Improve\")),\n\t      \n\t      field(\"Photo_of_Facilitator_URL__c\", function(state) {\n\t        var photoUrl = '';\n\t        if(dataValue(\"form.Photo\")(state) !== undefined && dataValue(\"form.Photo\")(state) !== '') {\n\t          photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo\")(state);  \n\t        }\n\t        return photoUrl;\n\t      }),\n\t      field(\"Farmer_Trainer_Signature__c\", function(state) {\n\t        var trainerSignatureUrl = '';\n\t        if(dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== undefined && dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== '') {\n\t          trainerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state);  \n\t        }\n\t        return trainerSignatureUrl;\n\t      }),\n\t      field(\"Observer_Signature__c\", function(state) {\n\t        var observerSignatureUrl = '';\n\t        if(dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== undefined && dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== '') {\n\t          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state);  \n\t        }\n\t        return observerSignatureUrl;\n\t      }),\n\t      \n\t      field(\"Observation_Location__Latitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[0]; \n\t        }\n\t      }),\n\t      field(\"Observation_Location__Longitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[1]; \n\t        }\n\t      }),\n\t      field(\"Altitude__c\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[2]; \n\t        }\n\t      })\n\t      \n\t      \n\t    )\n\t  )),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- PREPARE AND IMPLEMENT AGRONOMY PRACTICE\n\t  \n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_prepare_and_implement_agronomy_practice-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_prepare_and_implement_agronomy_practice-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_prepare_and_implement_agronomy_practice-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- TEACHING CLARITY AND EFFECTIVENESS\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_teaching_clarity_and_effectiveness-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_teaching_clarity_and_effectiveness-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_teaching_clarity_and_effectiveness-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- KNOWLEDGE OF TRAINER ON AGRONOMY\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_knowledge_of_trainer_on_agronomy-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_knowledge_of_trainer_on_agronomy-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_knowledge_of_trainer_on_agronomy-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH TRAINING OBSERVATION CRITERIA\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_shows_professionalism\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_shows_professionalism\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_is_prepared_and_organized\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_is_prepared_and_organized\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",   \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_engages_participants\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_engages_participants\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_facilitates_openings_and_closings\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_facilitates_openings_and_closings\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_leads_activities\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_leads_activities\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_leads_discussions\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_leads_discussions\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_follows_lesson_plans\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_follows_lesson_plans\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_jde_manages_time\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_jde_manages_time\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time_Comments\"))\n\t  )));\n\t\n}\n\n//ET UNIDO Training Observation\nelse if(state.data.app_id == \"4fd02c3be0104da29cba1844053b9301\"){\n\n\t//Create the observation record first prior\n\t//to creating the observation result records.\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation__c\", \"Submission_ID__c\",\n\t    fields(\n\t      field(\"Submission_ID__c\", dataValue(\"id\")),\n\t      field(\"Observer__c\", dataValue(\"form.Observer\")),\n\t      field(\"Trainer__c\", dataValue(\"form.trainer_salesforce_id\")),\n\t      field(\"Training_Group__c\", dataValue(\"form.Which_Group_Is_Farmer_Trainer_Teaching\")),\n\t      field(\"Training_Session__c\", dataValue(\"form.selected_session\")),\n\t      field(\"RecordTypeId\", dataValue(\"form.Record_Type\")),\n\t      field(\"Date__c\", dataValue(\"form.Date\")),\n\t      field(\"Observation_Type__c\", dataValue(\"form.type_of_training_observation\")),\n\t      \n\t      field(\"Male_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Male_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Female_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Female_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Number_of_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Total_Participants_In_Attendance\")(state));\n\t      }),\n\t      \n\t      field(\"Shared_Action_Plan__c\", dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan\")),\n\t      field(\"Shared_Action_Plan_Comments__c\", function(state){\n\t        if(dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state) !== undefined) {\n\t          return dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state);\n\t        } else {\n\t          return '';\n\t        }\n\t      }),\n\t      field(\"Did_Well__c\", dataValue(\"form.Current_Session_Review.Did_Well\")),\n\t      field(\"To_Improve__c\", dataValue(\"form.Current_Session_Review.To_Improve\")),\n\t      \n\t      field(\"Photo_of_Facilitator_URL__c\", function(state) {\n\t        var photoUrl = '';\n\t        if(dataValue(\"form.Photo\")(state) !== undefined && dataValue(\"form.Photo\")(state) !== '') {\n\t          photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo\")(state);  \n\t        }\n\t        return photoUrl;\n\t      }),\n\t      field(\"Farmer_Trainer_Signature__c\", function(state) {\n\t        var trainerSignatureUrl = '';\n\t        if(dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== undefined && dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== '') {\n\t          trainerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state);  \n\t        }\n\t        return trainerSignatureUrl;\n\t      }),\n\t      field(\"Observer_Signature__c\", function(state) {\n\t        var observerSignatureUrl = '';\n\t        if(dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== undefined && dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== '') {\n\t          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state);  \n\t        }\n\t        return observerSignatureUrl;\n\t      }),\n\t      \n\t      field(\"Observation_Location__Latitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[0]; \n\t        }\n\t      }),\n\t      field(\"Observation_Location__Longitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[1]; \n\t        }\n\t      }),\n\t      field(\"Altitude__c\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[2]; \n\t        }\n\t      })\n\t      \n\t      \n\t    )\n\t  )),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- PREPARE AND IMPLEMENT AGRONOMY PRACTICE\n\t  \n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_prepare_and_implement_agronomy_practice-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_prepare_and_implement_agronomy_practice-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_prepare_and_implement_agronomy_practice-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_prepare_and_implement_agronomy_practice\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- TEACHING CLARITY AND EFFECTIVENESS\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_teaching_clarity_and_effectiveness-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_teaching_clarity_and_effectiveness-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_teaching_clarity_and_effectiveness-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_teaching_clarity_and_effectiveness\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- KNOWLEDGE OF TRAINER ON AGRONOMY\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_knowledge_of_trainer_on_agronomy-p1\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_knowledge_of_trainer_on_agronomy-p2\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t    ))),\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_knowledge_of_trainer_on_agronomy-p3\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_knowledge_of_trainer_on_agronomy\"),\n\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t    ))),\n\n\t//CREATE OBSERVATION RESULTS FOR EACH TRAINING OBSERVATION CRITERIA\n\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_shows_professionalism\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_shows_professionalism\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_is_prepared_and_organized\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_is_prepared_and_organized\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",   \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_engages_participants\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_engages_participants\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_facilitates_openings_and_closings\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_facilitates_openings_and_closings\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_leads_activities\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_leads_activities\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_leads_discussions\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_leads_discussions\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_follows_lesson_plans\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_follows_lesson_plans\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans_Comments\"))\n\t  ))),\n\n\teach(\n\t  \"$.data\",  \n\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t    fields(\n\t    field(\"Submission_ID__c\", function(state) {\n\t      return dataValue(\"id\")(state) + \"coffee_ag_unido_manages_time\";\n\t    }),\n\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t      return state.references[state.references.length-1].id;\n\t    }),*/\n\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_ag_unido_manages_time\"),\n\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time\")),\n\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time_Comments\"))\n\t  )));\n\t\n}\n\n//Coffee PR-C2019 | PR-C2020 Training Observation\nelse if(state.data.app_id == \"4484e9ef07a9474fb092d1f1bd1f4826\" || state.data.app_id == \"32433b61b5a040b19c4c1ab8102d590d\"){\n\t\n\t//Create the observation record first prior\n\t//to creating the observation result records.\n\teach(\n\t  \"$.data\",\n\t  upsert(\"Observation__c\", \"Submission_ID__c\",\n\t    fields(\n\t      field(\"Submission_ID__c\", dataValue(\"id\")),\n\t      field(\"Observer__c\", dataValue(\"form.Observer\")),\n\t      field(\"Trainer__c\", dataValue(\"form.trainer_salesforce_id\")),\n\t      field(\"Training_Group__c\", dataValue(\"form.Which_Group_Is_Farmer_Trainer_Teaching\")),\n\t      field(\"Training_Session__c\", dataValue(\"form.selected_session\")),\n\t      field(\"RecordTypeId\", dataValue(\"form.Record_Type\")),\n\t      field(\"Date__c\", dataValue(\"form.Date\")),\n\t      \n\t      field(\"Male_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Male_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Female_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Female_Participants_In_Attendance\")(state));\n\t      }),\n\t      field(\"Number_of_Participants__c\", function(state){\n\t        return parseInt(dataValue(\"form.Current_session_participants.Total_Participants_In_Attendance\")(state));\n\t      }),\n\t      \n\t      field(\"Shared_Action_Plan__c\", dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan\")),\n\t      field(\"Shared_Action_Plan_Comments__c\", function(state){\n\t        if(dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state) !== undefined) {\n\t          return dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state);\n\t        } else {\n\t          return '';\n\t        }\n\t      }),\n\t      field(\"Did_Well__c\", dataValue(\"form.Current_Session_Review.Did_Well\")),\n\t      field(\"To_Improve__c\", dataValue(\"form.Current_Session_Review.To_Improve\")),\n\t      \n\t      field(\"Photo_of_Facilitator_URL__c\", function(state) {\n\t        var photoUrl = '';\n\t        if(dataValue(\"form.Photo\")(state) !== undefined && dataValue(\"form.Photo\")(state) !== '') {\n\t          photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo\")(state);  \n\t        }\n\t        return photoUrl;\n\t      }),\n\t      field(\"Farmer_Trainer_Signature__c\", function(state) {\n\t        var trainerSignatureUrl = '';\n\t        if(dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== undefined && dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== '') {\n\t          trainerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state);  \n\t        }\n\t        return trainerSignatureUrl;\n\t      }),\n\t      field(\"Observer_Signature__c\", function(state) {\n\t        var observerSignatureUrl = '';\n\t        if(dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== undefined && dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== '') {\n\t          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state);  \n\t        }\n\t        return observerSignatureUrl;\n\t      }),\n\t      \n\t      field(\"Observation_Location__Latitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[0]; \n\t        }\n\t      }),\n\t      field(\"Observation_Location__Longitude__s\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[1]; \n\t        }\n\t      }),\n\t      field(\"Altitude__c\", function(state) {\n\t        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n\t          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n\t          return coordinates[2]; \n\t        }\n\t      })\n\t      \n\t      \n\t    )\n\t  ));\n\n\t//process for PR C2019\n\tif(state.data.app_id == \"4484e9ef07a9474fb092d1f1bd1f4826\"){\n\n\t\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- PREPARE AND IMPLEMENT AGRONOMY PRACTICE\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_prepare_and_implement_agronomy_practice-p1\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_prepare_and_implement_agronomy_practice\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_prepare_and_implement_agronomy_practice-p2\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_prepare_and_implement_agronomy_practice\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_prepare_and_implement_agronomy_practice-p3\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_prepare_and_implement_agronomy_practice\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- TEACHING CLARITY AND EFFECTIVENESS\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_teaching_clarity_and_effectiveness-p1\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_teaching_clarity_and_effectiveness\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_teaching_clarity_and_effectiveness-p2\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_teaching_clarity_and_effectiveness\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_teaching_clarity_and_effectiveness-p3\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_teaching_clarity_and_effectiveness\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- KNOWLEDGE OF TRAINER ON AGRONOMY\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_knowledge_of_trainer_on_agronomy-p1\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_knowledge_of_trainer_on_agronomy\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_knowledge_of_trainer_on_agronomy-p2\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_knowledge_of_trainer_on_agronomy\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_knowledge_of_trainer_on_agronomy-p3\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_knowledge_of_trainer_on_agronomy\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\t//CREATE OBSERVATION RESULTS FOR EACH TRAINING OBSERVATION CRITERIA\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_shows_professionalism\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_shows_professionalism\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism_Comments\"))\n\t\t  ))),\n\n\t\teach(\n\t\t  \"$.data\",  \n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_is_prepared_and_organized\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_is_prepared_and_organized\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized_Comments\"))\n\t\t  ))),\n\n\t\teach(\n\t\t  \"$.data\",   \n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_engages_participants\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_engages_participants\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants_Comments\"))\n\t\t  ))),\n\n\t\teach(\n\t\t  \"$.data\",  \n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_facilitates_openings_and_closings\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_facilitates_openings_and_closings\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings_Comments\"))\n\t\t  ))),\n\n\t\teach(\n\t\t  \"$.data\",  \n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_leads_activities\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_leads_activities\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities_Comments\"))\n\t\t  ))),\n\n\t\teach(\n\t\t  \"$.data\",  \n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_leads_discussions\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_leads_discussions\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions_Comments\"))\n\t\t  ))),\n\n\t\teach(\n\t\t  \"$.data\",  \n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_follows_lesson_plans\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_follows_lesson_plans\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans_Comments\"))\n\t\t  ))),\n\n\t\teach(\n\t\t  \"$.data\",  \n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2019_manages_time\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2019_manages_time\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time_Comments\"))\n\t\t  )));\n\t\n\t}\n\n\n\t//process for PR C2020\n\telse if(state.data.app_id == \"32433b61b5a040b19c4c1ab8102d590d\"){\n\n\t\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- PREPARE AND IMPLEMENT AGRONOMY PRACTICE\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_prepare_and_implement_agronomy_practice-p1\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_prepare_and_implement_agronomy_practice\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_prepare_and_implement_agronomy_practice-p2\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_prepare_and_implement_agronomy_practice\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_prepare_and_implement_agronomy_practice-p3\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_prepare_and_implement_agronomy_practice\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- TEACHING CLARITY AND EFFECTIVENESS\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_teaching_clarity_and_effectiveness-p1\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_teaching_clarity_and_effectiveness\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_teaching_clarity_and_effectiveness-p2\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_teaching_clarity_and_effectiveness\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_teaching_clarity_and_effectiveness-p3\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_teaching_clarity_and_effectiveness\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Teaching_Clarity_And_Effectiveness\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\t//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- KNOWLEDGE OF TRAINER ON AGRONOMY\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_knowledge_of_trainer_on_agronomy-p1\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_knowledge_of_trainer_on_agronomy\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_knowledge_of_trainer_on_agronomy-p2\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_knowledge_of_trainer_on_agronomy\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_knowledge_of_trainer_on_agronomy-p3\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_knowledge_of_trainer_on_agronomy\"),\n\t\t    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n\t\t    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n\t\t    ))),\n\n\t\t//CREATE OBSERVATION RESULTS FOR EACH TRAINING OBSERVATION CRITERIA\n\t\teach(\n\t\t  \"$.data\",\n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_shows_professionalism\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_shows_professionalism\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism_Comments\"))\n\t\t  ))),\n\n\t\teach(\n\t\t  \"$.data\",  \n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_is_prepared_and_organized\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_is_prepared_and_organized\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized_Comments\"))\n\t\t  ))),\n\n\t\teach(\n\t\t  \"$.data\",   \n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_engages_participants\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_engages_participants\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants_Comments\"))\n\t\t  ))),\n\n\t\teach(\n\t\t  \"$.data\",  \n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_facilitates_openings_and_closings\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_facilitates_openings_and_closings\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings_Comments\"))\n\t\t  ))),\n\n\t\teach(\n\t\t  \"$.data\",  \n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_leads_activities\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_leads_activities\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities_Comments\"))\n\t\t  ))),\n\n\t\teach(\n\t\t  \"$.data\",  \n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_leads_discussions\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_leads_discussions\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions_Comments\"))\n\t\t  ))),\n\n\t\teach(\n\t\t  \"$.data\",  \n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_follows_lesson_plans\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_follows_lesson_plans\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans_Comments\"))\n\t\t  ))),\n\n\t\teach(\n\t\t  \"$.data\",  \n\t\t  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n\t\t    fields(\n\t\t    field(\"Submission_ID__c\", function(state) {\n\t\t      return dataValue(\"id\")(state) + \"coffee_pr_2020_manages_time\";\n\t\t    }),\n\t\t    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n\t\t      return state.references[state.references.length-1].id;\n\t\t    }),*/\n\t\t    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n\t\t    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_pr_2020_manages_time\"),\n\t\t    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time\")),\n\t\t    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time_Comments\"))\n\t\t  )));\n\n\t}\n\t\n}\n",
          "adaptor": "@openfn/language-salesforce@v1.3.2",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Training-Observation---CommCare----Salesforce---Agronomy-Projects": {
          "enabled": true,
          "id": "7477a918-781c-453f-a286-adba7316bb74",
          "target_job_id": "9a880757-83ac-4ab1-b05e-13d6e73e0cb5",
          "source_trigger_id": "0bd11b6a-edb2-4fb2-8f0e-7e5484a76e7f",
          "condition_type": "js_expression",
          "condition_label": "Production - Training Observation CommCare Salesforce Agronomy Projects",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Training Observation - Agronomy\""
        }
      }
    },
    "Production---Training-Sessions---ET-HWG-JCP-C2023---SalesForce----CommCare": {
      "id": "a98f6f34-d439-4f0d-8867-3087aab90c15",
      "name": "Production - Training Sessions - ET HWG JCP C2023 - SalesForce -- CommCare",
      "inserted_at": "2025-01-25T14:47:36.593775Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "fb5f97b0-03d1-4224-9acd-d3c1c9f7706c",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Training-Sessions---ET-HWG-JCP-C2023---SalesForce----CommCare": {
          "id": "cfd1570a-8e60-42ce-bc02-9014ba41956e",
          "name": "Production - Training Sessions - ET HWG JCP C2023 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending training groups for Coffee - ET HWG JCP C2023\n// DATA FLOW :: SalesForce --> TO --> CommCare\n// TARGET APPS :: // JOB PURPOSE :: Coffee - ET HWG JCP C2023\n// JOB NAME :: Production | Training Sessions - ET HWG JCP C2022 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Session\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_hwg_jcp_c2023\"}\n\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_et_hwg_jcp_c2023_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_et_hwg_jcp_c2023_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Training-Sessions---ET-HWG-JCP-C2023---SalesForce----CommCare": {
          "enabled": true,
          "id": "d59e0c0e-dc9b-4fee-af31-93a37859b7f2",
          "target_job_id": "cfd1570a-8e60-42ce-bc02-9014ba41956e",
          "source_trigger_id": "fb5f97b0-03d1-4224-9acd-d3c1c9f7706c",
          "condition_type": "js_expression",
          "condition_label": "Production Training Sessions HWG JCP C2023 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_hwg_jcp_c2023\""
        }
      }
    },
    "Production---Training-Sessions---ET-Regrow-YG--Ag--C2023---SalesForce----CommCare": {
      "id": "be2f585b-6070-4940-923e-95a20535f366",
      "name": "Production - Training Sessions - ET Regrow YG -Ag- C2023 - SalesForce -- CommCare",
      "inserted_at": "2025-01-25T14:47:45.307391Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "66d9c860-d85f-49ea-8fa3-db40c9432f19",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Training-Sessions---ET-Regrow-YG--Ag--C2023---SalesForce----CommCare": {
          "id": "3517af2c-8dc9-47dc-a462-61936b484d87",
          "name": "Production - Training Sessions - ET Regrow YG -Ag- C2023 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending training groups for Coffee ET - Regrow Yirga Agronomy C2023\n// DATA FLOW :: SalesForce --> TO --> CommCare\n// TARGET APPS :: // JOB PURPOSE :: Coffee - ET Regrow Yirga (Ag) C2023\n// JOB NAME :: Production | Training Sessions - ET Regrow YG (Ag) C2023 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Session\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_regrow_ag_c2\"}\n\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_et_regrow_ag_c2_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_et_regrow_ag_c2_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@v1.5.1",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Training-Sessions---ET-Regrow-YG--Ag--C2023---SalesForce----CommCare": {
          "enabled": true,
          "id": "a476e1c6-cc54-46a4-bead-6dc1f2c8e345",
          "target_job_id": "3517af2c-8dc9-47dc-a462-61936b484d87",
          "source_trigger_id": "66d9c860-d85f-49ea-8fa3-db40c9432f19",
          "condition_type": "js_expression",
          "condition_label": "Production Training Sessions Regrow Yirga C2023 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_regrow_ag_c2\""
        }
      }
    },
    "Production---Training-Sessions---ET-Regrow-YG--Ag--C2024---SalesForce----CommCare": {
      "id": "924f8836-9264-43e9-a773-61901a1ac730",
      "name": "Production - Training Sessions - ET Regrow YG -Ag- C2024 - SalesForce -- CommCare",
      "inserted_at": "2025-01-25T14:47:49.205922Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "95e4e8af-ce43-42fe-8f2c-8597d46a0be4",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Training-Sessions---ET-Regrow-YG--Ag--C2024---SalesForce----CommCare": {
          "id": "04721cec-64ba-4e43-a2ba-e5d0c7df12ca",
          "name": "Production - Training Sessions - ET Regrow YG -Ag- C2024 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending training groups for Coffee ET - Regrow Yirga Agronomy C2022\n// DATA FLOW :: SalesForce --> TO --> CommCare\n// TARGET APPS :: // JOB PURPOSE :: Coffee - ET Regrow Yirga (Ag) C2024\n// JOB NAME :: Production | Training Sessions - ET Regrow YG (Ag) C2024 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Session\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_regrow_ag_c3\"}\n\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_et_regrow_ag_c3_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_et_regrow_ag_c3_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Training-Sessions---ET-Regrow-YG--Ag--C2024---SalesForce----CommCare": {
          "enabled": true,
          "id": "754acb8b-d0a1-4ec3-99bf-5ba02e8e8e56",
          "target_job_id": "04721cec-64ba-4e43-a2ba-e5d0c7df12ca",
          "source_trigger_id": "95e4e8af-ce43-42fe-8f2c-8597d46a0be4",
          "condition_type": "js_expression",
          "condition_label": "Production | Training Sessions - Regrow Yirga C2024 | SalesForce --> CommCare",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_regrow_ag_c3\""
        }
      }
    },
    "Production---Farm-Visit---PR-2022---CommCare----Salesforce": {
      "id": "6b2c9796-cd1a-41c3-8316-7444d6f8c9e4",
      "name": "Production - Farm Visit - PR 2022 - CommCare -- Salesforce",
      "inserted_at": "2025-02-12T06:24:25.210459Z",
      "lock_version": 5,
      "triggers": {
        "webhook": {
          "enabled": true,
          "id": "1c68e9f5-7551-4c5f-a864-4ba8a4cf3cdc",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Farm-Visit---PR-2022---CommCare----Salesforce": {
          "id": "8cd877ba-ad08-4083-b747-d924f5084de7",
          "name": "Production - Farm Visit - PR 2022 - CommCare -- Salesforce",
          "body": "//FARM VISIT JOB FOR ALL PUERTO RICO PROJECTS\n//Production - Farm Visit :: PR 2022 | CommCare --> Salesforce | Farm Visit Full\n//PR C2020, PR C2019\n//if (state.data.app_id == \"e16e09252eb942a788bd6600e6ceeb28\") {\n\n//loop through participants and insert in database\n/*    beta.each(\n\n        function(state) {\n            if (state.data.form.present_participants) {\n                return state.data.form.present_participants.split(\" \").map(\n                    function(pId) {\n                        return {\n                            participant: pId,\n                            session: dataValue(\"form.training_session\")(state),\n                            att_submission: dataValue(\"form.training_session\")(state) + pId,\n                            fv_submission: \"FV-\" + dataValue(\"id\")(state),\n                            sessionPhoto: dataValue(\"form.photo\")(state)\n                        };\n                    }\n                );\n            }\n        },\n        upsert(\"FV_Attendance__c\", \"Submission_ID__c\",\n            fields(\n                field(\"Submission_ID__c\", dataValue(\"att_submission\")), //attendance submission_id\n                field(\"FV_Submission_ID__c\", dataValue(\"fv_submission\")), //farm visit submission_id\n                field(\"Status__c\", \"Present\"),\n                relationship(\"Training_Session__r\", \"CommCare_Case_Id__c\", dataValue(\"session\")),\n                relationship(\"Participant__r\", \"CommCare_Case_Id__c\", dataValue(\"participant\"))\n            )\n        )\n\n    );\n*/\n// Register new participants if they exist\n\n//insert household object\n  beta.each(\n    function(substate){\n      var createdObject = [];\n        \n      var form = dataValue('form')(substate);\n      \n      if(!form.hasOwnProperty(\"new_farmer\")){\n        console.log(\"Not Upserting Household: No New Farmer!\");\n        return [];\n      }\n      \n      if(dataValue('form.new_farmer')(substate) === \"1\"){\n        createdObject.push(state);\n      }\n      \n      return createdObject;\n    },\n    // Insert Household for New Farmer New Household OR New Farmer Existing Household but for Primary Member OR Existing Farmer Change in FFG but for Primary Member\n    upsert(\n      \"Household__c\",\n      \"Household_ID__c\",\n      fields(\n        field(\"Household_ID__c\", dataValue(\"form.participant_data.farmer_registration_details.Household_Id\")(state)),\n        field(\"Name\", dataValue(\"form.participant_data.farmer_registration_details.Household_Number\")(state)),\n        field(\"Training_Group__c\", dataValue(\"form.participant_data.farmer_registration_details.Training_Group_Id\")(state)),\n        field(\"Farm_Size__c\", dataValue(\"form.participant_data.farmer_registration_details.Farm_Size\")(state)),\n        field(\n          \"Farm_Size_Before__c\",\n          dataValue(\"form.participant_data.farm_size_3_years_and_older\")(state)\n        ),\n        field(\n          \"Farm_Size_After__c\",\n          dataValue(\"form.participant_data.farm_size_under_3_years\")(state)\n        )\n      )\n    )\n  );\n    //insert || update :: participant object :: new household created || existing household updated\n  beta.each(\n      function(substate){\n        var createdObject = [];\n        \n        var form = dataValue('form')(substate);\n        \n        if(!form.hasOwnProperty(\"new_farmer\")){\n          console.log(\"Not Upserting Participant: No New Farmer!\");\n          return [];\n        }\n        \n        if(dataValue('form.new_farmer')(substate) === \"1\"){\n          createdObject.push(state);\n        }\n        \n        return createdObject;\n      },\n      upsert(\n        \"Participant__c\",\n        \"CommCare_Case_Id__c\",\n        fields(\n          field(\"CommCare_Case_Id__c\", substate => {\n              var result = '';\n              if(1==1){\n                // console.log(\"1st Value: \" + dataValue(\"form['subcase_0'].case['@case_id']\")(state));\n                // console.log(\"2nd Value: \" + dataValue(\"form.subcase_0.case['@case_id']\")(state));\n                // console.log(\"3rd Value: \" + dataValue(\"form['subcase_0'].case['@case_id']\")(substate));\n                // console.log(\"4th Value: \" + dataValue(\"form.subcase_0.case['@case_id']\")(substate));\n                // console.log(\"5th Value: \" + state.data.form.subcase_0.case['@case_id']);\n                result = state.data.form['subcase_0'].case['@case_id'];\n              }\n              return result;\n            }),\n          field(\"TNS_Id__c\", dataValue(\"form.participant_data.farmer_registration_details.Farmer_Id\")(state)),\n          field(\"Age__c\", dataValue(\"form.participant_data.farmer_registration_details.Age\")(state)),\n          field(\"Name\", dataValue(\"form.participant_data.farmer_registration_details.First_Name\")(state)),\n          field(\"Middle_Name__c\", dataValue(\"form.participant_data.farmer_registration_details.Middle_Name\")(state)),\n          field(\"Last_Name__c\", dataValue(\"form.participant_data.farmer_registration_details.Last_Name\")(state)),\n          field(\"Gender__c\", dataValue(\"form.participant_data.farmer_registration_details.Gender\")(state)),\n          field(\"Status__c\", dataValue(\"form.participant_data.farmer_registration_details.Status\")(state)),\n          field(\"Farm_Size__c\", dataValue(\"form.participant_data.farmer_registration_details.Farm_Size\")(state)),\n          field(\"Sent_to_OpenFn_Status__c\", \"Complete\"),\n          field(\"Phone_Number__c\", dataValue(\"form.participant_data.farmer_registration_details.Phone_Number\")(state)),\n          field(\n            \"Primary_Household_Member__c\",\n            dataValue(\"form.participant_data.farmer_registration_details.Primary_Household_Member\")(state)\n          ),\n          field(\"Registration_Date__c\", dataValue(\"form.participant_data.farmer_registration_details.registration_date\")(state)),\n          field(\"Create_In_CommCare__c\", false),\n          relationship(\n            \"Household__r\",\n            \"Household_ID__c\",\n            dataValue(\"form.participant_data.farmer_registration_details.Household_Id\")(state)\n          ),\n          relationship(\n            \"Training_Group__r\",\n            \"CommCare_Case_Id__c\",\n            dataValue(\"form.participant_data.farmer_registration_details.Training_Group_Id\")(state)\n          )\n        )\n      )\n    );\n\n//insert the farm visit record\n  each(\n    \"$.data\",\n    upsert(\n      \"Farm_Visit__c\",\n      \"FV_Submission_ID__c\",\n      fields(\n        field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n        field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n        field(\"Farm_Visit_Type__c\", dataValue(\"form.survey_type\")),\n        field(\"Training_Group__c\", dataValue(\"form.case.@case_id\")),\n        relationship(\"Farm_Visited__r\", \"CommCare_Case_Id__c\", function(state){\n          var result = \"\";\n          if(!state.data.form.hasOwnProperty(\"new_farmer\")){\n            result = dataValue(\"form.farm_being_visted\")(state);\n            return result;\n          }\n          if(state.data.form.new_farmer == \"0\"){\n            result = dataValue(\"form.farm_being_visted\")(state);\n          } else if(state.data.form.new_farmer == \"1\") {\n            result = state.data.form['subcase_0'].case['@case_id'];\n          }\n          return result;\n        }),\n        field(\"Primary_Farmer_PIMA_ID__c\", dataValue(\"form.farm_being_visted\")),\n        field(\n          \"Visit_Has_Training__c\",\n          dataValue(\"form.is_this_a_farm_training_visit\")\n        ),\n        //  field(\"Training_Session__c\", dataValue(\"form.training_session\")),\n        field(\n          \"Other_Participants_Present__c\",\n          dataValue(\"form.any_other_participants_present\")\n        ),\n        field(\"Total_Farmers_Visited__c\", dataValue(\"form.attendance_count\")),\n        field(\"Date_Visited__c\", dataValue(\"form.date_of_visit\")),\n        field(\"visit_comments__c\", dataValue(\"form.farm_visit_comments\")),\n        field(\"Farmer_Trainer__c\", dataValue(\"form.trainer\")),\n        field(\n          \"No_of_curedas__c\",\n          dataValue(\"form.opening_questions.number_of_curedas\")\n        ),\n        field(\n          \"No_of_separate_coffee_fields__c\",\n          dataValue(\"form.opening_questions.number_of_separate_coffee_fields\")\n        ),\n        field(\"Field_Age__c\", dataValue(\"form.field_age\")),\n        field(\"Field_Size__c\", function (state) {\n          var fieldSize = \"\";\n          if (\n            dataValue(\"form.field_size\")(state) !== undefined &&\n            dataValue(\"form.field_size\")(state) !== \"\"\n          ) {\n            fieldSize = dataValue(\"form.field_size\");\n          } else if (\n            dataValue(\"form.field_size1\")(state) !== undefined &&\n            dataValue(\"form.field_size1\")(state) !== \"\"\n          ) {\n            fieldSize = dataValue(\"form.field_size1\");\n          }\n  \n          return fieldSize;\n        }),\n        field(\"Farm_Visit_Photo_Url__c\", function (state) {\n          var farmVisitPhotoUrl = \"\";\n          if (\n            dataValue(\"form.farm_visit_photo\")(state) !== undefined &&\n            dataValue(\"form.farm_visit_photo\")(state) !== \"\"\n          ) {\n            farmVisitPhotoUrl =\n              \"https://www.commcarehq.org/a/\" +\n              dataValue(\"domain\")(state) +\n              \"/api/form/attachment/\" +\n              dataValue(\"form.meta.instanceID\")(state) +\n              \"/\" +\n              dataValue(\"form.farm_visit_photo\")(state);\n          }\n          return farmVisitPhotoUrl;\n        }),\n        field(\"Signature__c\", function (state) {\n          var recorderSignatureUrl = \"\";\n          if (\n            dataValue(\"form.signature_of_farmer_trainer\")(state) !== undefined &&\n            dataValue(\"form.signature_of_farmer_trainer\")(state) !== \"\"\n          ) {\n            recorderSignatureUrl =\n              \"https://www.commcarehq.org/a/\" +\n              dataValue(\"domain\")(state) +\n              \"/api/form/attachment/\" +\n              dataValue(\"form.meta.instanceID\")(state) +\n              \"/\" +\n              dataValue(\"form.signature_of_farmer_trainer\")(state);\n          }\n          return recorderSignatureUrl;\n        }),\n        field(\"Location_GPS__Latitude__s\", (state) => {\n          // define this once, it's constant...\n          const coords = state.data.form.gps_coordinates;\n          // write your contional\n          if (coords) {\n            return coords.split(\" \")[0];\n          }\n          // the 'else' is unnecessary, return '' if there are no coords\n          return \"\";\n        }),\n        field(\"Location_GPS__Longitude__s\", (state) => {\n          // define this once, it's constant...\n          const coords = state.data.form.gps_coordinates;\n          // write your contional\n          if (coords) {\n            return coords.split(\" \")[1];\n          }\n          // the 'else' is unnecessary, return '' if there are no coords\n          return \"\";\n        }),\n        field(\"Altitude__c\", (state) => {\n          // define this once, it's constant...\n          const coords = state.data.form.gps_coordinates;\n          // write your contional\n          if (coords) {\n            return coords.split(\" \")[2];\n          }\n          // the 'else' is unnecessary, return '' if there are no coords\n          return \"\";\n        })\n      )\n    )\n  );\n  \n    // update FV with secondary Farmer\n    each(\n      \"$.data\",\n      upsertIf(\n        state.data.form.secondary_farmer !== \"\" && state.data.form.secondary_farmer_available == 'yes',\n        \"Farm_Visit__c\",\n        \"FV_Submission_ID__c\",\n        fields(\n          field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n          relationship(\"Secondary_Farmer__r\", \"CommCare_Case_Id__c\", dataValue(\"form.secondary_farmer\")),\n          field(\"Secondary_Farmer_PIMA_ID__c\", dataValue(\"form.secondary_farmer\"))\n          )\n        )\n      );\n\n //Best Practices :: Main Stem && Weeding &&  Shade Control && Record Keeping && Compost && Erosion Control && Nutrition\n  each(\n    \"$.data\",\n    upsert(\n      \"FV_Best_Practices__c\",\n      \"FV_Submission_ID__c\",\n      fields(\n        relationship(\"Farm_Visit__r\", \"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n        field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n        field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n  \n        //main stems\n        field(\n          \"number_of_main_stems_on_majority_trees__c\",\n          dataValue(\n            \"form.best_practice_questions.main_stems.number_of_main_stems_on_majority_trees\"\n          )\n        ),\n  \n        /*    field(\"number_of_main_stems_on_majority_trees__c\", function(state){\n                    \n                    var numberOfMainStems = dataValue(\"form.best_practice_questions.main_stems.number_of_main_stems_on_majority_trees\")(state);\n                    var returnNumberOfMainStems = 0;\n                    \n                    if (numberOfMainStems !== undefined && numberOfMainStems !== '') {\n                        returnNumberOfMainStems = numberOfMainStems;\n                    }\n                    \n                    return returnNumberOfMainStems;\n                    \n                  }),\n                  \n              */\n        field(\"photo_of_trees_and_average_main_stems__c\", function (state) {\n          var mainStemsPhotoURL = \"\";\n          if (\n            dataValue(\n              \"form.best_practice_questions.main_stems.trees_and_main_stems_photo\"\n            )(state) !== undefined &&\n            dataValue(\n              \"form.best_practice_questions.main_stems.trees_and_main_stems_photo\"\n            )(state) !== \"\"\n          ) {\n            mainStemsPhotoURL =\n              \"https://www.commcarehq.org/a/\" +\n              dataValue(\"domain\")(state) +\n              \"/api/form/attachment/\" +\n              dataValue(\"form.meta.instanceID\")(state) +\n              \"/\" +\n              dataValue(\n                \"form.best_practice_questions.main_stems.trees_and_main_stems_photo\"\n              )(state);\n          }\n          return mainStemsPhotoURL;\n        }),\n  \n        //nutrition\n        field(\"Color_of_coffee_tree_leaves__c\", function (state) {\n          var colorOfCoffeeLeaves = dataValue(\n            \"form.best_practice_questions.nutrition.are_the_leave_green_or_yellow_pale_green\"\n          )(state);\n          var returnColorOfCoffeeLeaves = \"\";\n  \n          if (\n            colorOfCoffeeLeaves !== undefined &&\n            colorOfCoffeeLeaves !== \"\" &&\n            colorOfCoffeeLeaves == 0\n          ) {\n            returnColorOfCoffeeLeaves =\n              \"5% or more (5 or more in 100) of the leaves are yellow, pale green or brown.\";\n          }\n  \n          if (\n            colorOfCoffeeLeaves !== undefined &&\n            colorOfCoffeeLeaves !== \"\" &&\n            colorOfCoffeeLeaves == 1\n          ) {\n            returnColorOfCoffeeLeaves =\n              \"Nearly all leaves are dark green and less than 5% (less than 5 in 100) are yellow, pale green, or brown.\";\n          }\n  \n          return returnColorOfCoffeeLeaves;\n        }),\n  \n        //weeding\n        field(\"how_many_weeds_under_canopy_and_how_big__c\", function (state) {\n          var weedsUnderCanopy = dataValue(\n            \"form.best_practice_questions.weeding.how_many_weeds_under_canopy_and_how_big_are_they\"\n          )(state);\n          var returnWeedsUnderCanopy = \"\";\n  \n          if (weedsUnderCanopy == 1) {\n            returnWeedsUnderCanopy =\n              \"Few small weeds (less than 30cm) under the tree canopy\";\n          }\n  \n          if (weedsUnderCanopy == 2) {\n            returnWeedsUnderCanopy =\n              \"Many small weeds under the tree canopy (ground is covered with weeds)\";\n          }\n  \n          if (weedsUnderCanopy == 3) {\n            returnWeedsUnderCanopy =\n              \"Many large weeds under the tree canopy (ground is covered with weeds)\";\n          }\n  \n          return returnWeedsUnderCanopy;\n        }),\n  \n        field(\n          \"Have_herbicides_been_used_on_the_field__c\",\n          dataValue(\"form.best_practice_questions.weeding.used_herbicides\")\n        ),\n        \n        field(\n          \"Do_you_need_to_spray_to_manage_leaf_rust__c\",\n          dataValue(\"form.best_practice_questions.pesticide_use.do_you_need_to_spray_to_manage_leaf_rust\")\n        ),\n        // field(\"Herbicide_products_used_on_farm__c\", function(state){\n  \n        //   var herbicideUsed = dataValue(\"form.best_practice_questions.weeding.which_product_have_you_used\");\n        //   var returnHerbicideUsed = \"\";\n  \n        //   if(herbicideUsed == 1){\n  \n        //     returnHerbicideUsed = \"Glyphosate (Honcho Plus, Round Up Ultra, GlyStar Plus, Credit, Compare and Save, TouchDown)\";\n  \n        //   }\n  \n        //   if(herbicideUsed == 2){\n  \n        //     returnHerbicideUsed = \"Paraquat (Gramaxon, Parazone, Parashot)\";\n  \n        //   }\n  \n        //   return returnHerbicideUsed;\n  \n        // }),\n  \n        field(\"photo_of_weeds_under_the_canopy__c\", function (state) {\n          var weedsPhotoUrl = dataValue(\n            \"form.best_practice_questions.weeding.weeds_under_the_canopy_photo\"\n          )(state);\n          var returnWeedsPhotoUrl = \"\";\n  \n          if (weedsPhotoUrl !== undefined && weedsPhotoUrl !== \"\") {\n            returnWeedsPhotoUrl =\n              \"https://www.commcarehq.org/a/\" +\n              dataValue(\"domain\")(state) +\n              \"/api/form/attachment/\" +\n              dataValue(\"form.meta.instanceID\")(state) +\n              \"/\" +\n              weedsPhotoUrl;\n          }\n  \n          return returnWeedsPhotoUrl;\n        }),\n  \n        //shade management\n        field(\"level_of_shade_present_on_the_farm__c\", function (state) {\n          var levelOfShadeOnPlot = dataValue(\n            \"form.best_practice_questions.shade_control.level_of_shade_present_on_the_farm\"\n          )(state);\n          var returnLevelOfShadeOnPlot = \"\";\n  \n          if (levelOfShadeOnPlot == 0) {\n            returnLevelOfShadeOnPlot = \"NO shade, less than 5%\";\n          }\n  \n          if (levelOfShadeOnPlot == 1) {\n            returnLevelOfShadeOnPlot = \"Light shade, 5 to 20%\";\n          }\n  \n          if (levelOfShadeOnPlot == 2) {\n            returnLevelOfShadeOnPlot = \"Medium shade, 20 to 40%\";\n          }\n  \n          if (levelOfShadeOnPlot == 3) {\n            returnLevelOfShadeOnPlot = \"Heavy shade, over 40%\";\n          }\n  \n          return returnLevelOfShadeOnPlot;\n        }),\n  \n        field(\"have_new_shade_been_planted_last_3_years__c\", function (state) {\n          var newShadePlanted = dataValue(\n            \"form.best_practice_questions.shade_control.new_shade_trees_in_the_last_3_years\"\n          )(state);\n          var returnNewShadePlanted = \"\";\n  \n          if (newShadePlanted == 0 || newShadePlanted == 2) {\n            returnNewShadePlanted = \"No\";\n          }\n  \n          if (newShadePlanted == 1) {\n            returnNewShadePlanted = \"Yes\";\n          }\n  \n          return returnNewShadePlanted;\n        }),\n  \n        field(\"photo_of_level_of_shade_on_the_plot__c\", function (state) {\n          var shadePhotoUrl = \"\";\n          if (\n            dataValue(\n              \"form.best_practice_questions.shade_control.photo_of_level_of_shade_on_the_plot\"\n            )(state) !== undefined &&\n            dataValue(\n              \"form.best_practice_questions.shade_control.photo_of_level_of_shade_on_the_plot\"\n            )(state) !== \"\"\n          ) {\n            shadePhotoUrl =\n              \"https://www.commcarehq.org/a/\" +\n              dataValue(\"domain\")(state) +\n              \"/api/form/attachment/\" +\n              dataValue(\"form.meta.instanceID\")(state) +\n              \"/\" +\n              dataValue(\"form.photo\")(state);\n          }\n  \n          return shadePhotoUrl;\n        }),\n  \n        //compost manure\n        field(\"do_you_have_compost_manure__c\", function (state) {\n          var haveCompostManure = dataValue(\n            \"form.best_practice_questions.compost.do_you_have_compost_manure\"\n          )(state);\n          var returnHaveCompostManure = \"\";\n  \n          if (\n            haveCompostManure !== undefined &&\n            haveCompostManure !== \"\" &&\n            haveCompostManure == 0\n          ) {\n            returnHaveCompostManure = \"No\";\n          }\n  \n          if (\n            haveCompostManure !== undefined &&\n            haveCompostManure !== \"\" &&\n            haveCompostManure == 1\n          ) {\n            returnHaveCompostManure = \"Yes\";\n          }\n  \n          return returnHaveCompostManure;\n        }),\n  \n        field(\"photo_of_the_compost_manure__c\", function (state) {\n          var compostPhotoUrl = \"\";\n          if (\n            dataValue(\n              \"form.best_practice_questions.compost.photo_of_the_compost_manure\"\n            )(state) !== undefined &&\n            dataValue(\n              \"form.best_practice_questions.compost.photo_of_the_compost_manure\"\n            )(state) !== \"\"\n          ) {\n            compostPhotoUrl =\n              \"https://www.commcarehq.org/a/\" +\n              dataValue(\"domain\")(state) +\n              \"/api/form/attachment/\" +\n              dataValue(\"form.meta.instanceID\")(state) +\n              \"/\" +\n              dataValue(\n                \"form.best_practice_questions.compost.photo_of_the_compost_manure\"\n              )(state);\n          }\n  \n          return compostPhotoUrl;\n        }),\n  \n        //erosion control\n        /*    field(\"take_a_photo_of_erosion_control__c\", function(state) {\n                    \n                    var erosionPhotoUrl = '';\n                    if(dataValue(\"form.best_practice_questions.erosion_control.photo_of_erosion_control_method\")(state) !== undefined && dataValue(\"form.best_practice_questions.erosion_control.photo_of_erosion_control_method\")(state) !== '') {\n                      erosionPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.erosion_control.photo_of_erosion_control_method\")(state);\n                      \n                    }\n                    \n                    return erosionPhotoUrl;\n                    \n                  }),\n              */\n        field(\"Stabilizing_Grasses_Photo_URL__c\", function (state) {\n          var sgPhotoURL = \"\";\n          if (\n            dataValue(\n              \"form.best_practice_questions.erosion_control.stabilizing_grasses_image\"\n            )(state) !== undefined &&\n            dataValue(\n              \"form.best_practice_questions.erosion_control.stabilizing_grasses_image\"\n            )(state) !== \"\"\n          ) {\n            sgPhotoURL =\n              \"https://www.commcarehq.org/a/\" +\n              dataValue(\"domain\")(state) +\n              \"/api/form/attachment/\" +\n              dataValue(\"form.meta.instanceID\")(state) +\n              \"/\" +\n              dataValue(\n                \"form.best_practice_questions.erosion_control.stabilizing_grasses_image\"\n              )(state);\n          }\n  \n          return sgPhotoURL;\n        }),\n        field(\"Mulch_Photo_URL__c\", function (state) {\n          var mulchPhotoURL = \"\";\n          if (\n            dataValue(\"form.best_practice_questions.erosion_control.mulch_image\")(\n              state\n            ) !== undefined &&\n            dataValue(\"form.best_practice_questions.erosion_control.mulch_image\")(\n              state\n            ) !== \"\"\n          ) {\n            mulchPhotoURL =\n              \"https://www.commcarehq.org/a/\" +\n              dataValue(\"domain\")(state) +\n              \"/api/form/attachment/\" +\n              dataValue(\"form.meta.instanceID\")(state) +\n              \"/\" +\n              dataValue(\n                \"form.best_practice_questions.erosion_control.mulch_image\"\n              )(state);\n          }\n  \n          return mulchPhotoURL;\n        }),\n        field(\"Water_Traps_Photo_URL__c\", function (state) {\n          var wtPhotoURL = \"\";\n          if (\n            dataValue(\n              \"form.best_practice_questions.erosion_control.water_traps_or_trenches_image\"\n            )(state) !== undefined &&\n            dataValue(\n              \"form.best_practice_questions.erosion_control.water_traps_or_trenches_image\"\n            )(state) !== \"\"\n          ) {\n            wtPhotoURL =\n              \"https://www.commcarehq.org/a/\" +\n              dataValue(\"domain\")(state) +\n              \"/api/form/attachment/\" +\n              dataValue(\"form.meta.instanceID\")(state) +\n              \"/\" +\n              dataValue(\n                \"form.best_practice_questions.erosion_control.water_traps_or_trenches_image\"\n              )(state);\n          }\n  \n          return wtPhotoURL;\n        }),\n        field(\"Physical_Barriers_Photo_URL__c\", function (state) {\n          var pbPhotoURL = \"\";\n          if (\n            dataValue(\n              \"form.best_practice_questions.erosion_control.physical_barriers_image\"\n            )(state) !== undefined &&\n            dataValue(\n              \"form.best_practice_questions.erosion_control.physical_barriers_image\"\n            )(state) !== \"\"\n          ) {\n            pbPhotoURL =\n              \"https://www.commcarehq.org/a/\" +\n              dataValue(\"domain\")(state) +\n              \"/api/form/attachment/\" +\n              dataValue(\"form.meta.instanceID\")(state) +\n              \"/\" +\n              dataValue(\n                \"form.best_practice_questions.erosion_control.physical_barriers_image\"\n              )(state);\n          }\n  \n          return pbPhotoURL;\n        }),\n        field(\"Terraces_Photo_URL__c\", function (state) {\n          var terracesPhotoURL = \"\";\n          if (\n            dataValue(\n              \"form.best_practice_questions.erosion_control.terraces_image\"\n            )(state) !== undefined &&\n            dataValue(\n              \"form.best_practice_questions.erosion_control.terraces_image\"\n            )(state) !== \"\"\n          ) {\n            terracesPhotoURL =\n              \"https://www.commcarehq.org/a/\" +\n              dataValue(\"domain\")(state) +\n              \"/api/form/attachment/\" +\n              dataValue(\"form.meta.instanceID\")(state) +\n              \"/\" +\n              dataValue(\n                \"form.best_practice_questions.erosion_control.terraces_image\"\n              )(state);\n          }\n  \n          return terracesPhotoURL;\n        }),\n        field(\"Contour_Planting_Photo_URL__c\", function (state) {\n          var cpPhotoURL = \"\";\n          if (\n            dataValue(\n              \"form.best_practice_questions.erosion_control.contour_planting_image\"\n            )(state) !== undefined &&\n            dataValue(\n              \"form.best_practice_questions.erosion_control.contour_planting_image\"\n            )(state) !== \"\"\n          ) {\n            cpPhotoURL =\n              \"https://www.commcarehq.org/a/\" +\n              dataValue(\"domain\")(state) +\n              \"/api/form/attachment/\" +\n              dataValue(\"form.meta.instanceID\")(state) +\n              \"/\" +\n              dataValue(\n                \"form.best_practice_questions.erosion_control.contour_planting_image\"\n              )(state);\n          }\n  \n          return cpPhotoURL;\n        }),\n        field(\"Cover_Crop_Photo_URL__c\", function (state) {\n          var ccPhotoURL = \"\";\n          if (\n            dataValue(\n              \"form.best_practice_questions.erosion_control.bean_or_arachis_cover_crop_image\"\n            )(state) !== undefined &&\n            dataValue(\n              \"form.best_practice_questions.erosion_control.bean_or_arachis_cover_crop_image\"\n            )(state) !== \"\"\n          ) {\n            ccPhotoURL =\n              \"https://www.commcarehq.org/a/\" +\n              dataValue(\"domain\")(state) +\n              \"/api/form/attachment/\" +\n              dataValue(\"form.meta.instanceID\")(state) +\n              \"/\" +\n              dataValue(\n                \"form.best_practice_questions.erosion_control.bean_or_arachis_cover_crop_image\"\n              )(state);\n          }\n  \n          return ccPhotoURL;\n        }),\n  \n        //record keeping\n        field(\"do_you_have_a_record_book__c\", function (state) {\n          var haveRecordBook = dataValue(\n            \"form.best_practice_questions.record_keeping.do_you_have_a_record_book\"\n          )(state);\n          var returnHaveRecordBook = \"\";\n  \n          if (haveRecordBook == 0) {\n            returnHaveRecordBook = \"No\";\n          }\n  \n          if (haveRecordBook == 1) {\n            returnHaveRecordBook = \"Yes\";\n          }\n  \n          return returnHaveRecordBook;\n        }),\n  \n        field(\"are_there_records_on_the_record_book__c\", function (state) {\n          var recordsOnRecordBook = dataValue(\n            \"form.best_practice_questions.record_keeping.are_there_records_on_the_record_book\"\n          )(state);\n          var returnRecordsOnRecordBook = \"\";\n  \n          if (\n            recordsOnRecordBook !== undefined &&\n            recordsOnRecordBook !== \"\" &&\n            recordsOnRecordBook == 0\n          ) {\n            returnRecordsOnRecordBook = \"No\";\n          }\n  \n          if (\n            recordsOnRecordBook !== undefined &&\n            recordsOnRecordBook !== \"\" &&\n            recordsOnRecordBook == 1\n          ) {\n            returnRecordsOnRecordBook = \"Yes\";\n          }\n  \n          return returnRecordsOnRecordBook;\n        }),\n  \n        field(\"take_a_photo_of_the_record_book__c\", function (state) {\n          var recordBookPhotoUrl = \"\";\n          if (\n            dataValue(\n              \"form.best_practice_questions.record_keeping.take_a_photo_of_the_record_book\"\n            )(state) !== undefined &&\n            dataValue(\n              \"form.best_practice_questions.record_keeping.take_a_photo_of_the_record_book\"\n            )(state) !== \"\"\n          ) {\n            recordBookPhotoUrl =\n              \"https://www.commcarehq.org/a/\" +\n                dataValue(\"domain\")(state) +\n                \"/api/form/attachment/\" +\n                dataValue(\"form.meta.instanceID\")(state) +\n                \"/\" +\n                dataValue(\n                  \"form.best_practice_questions.record_keeping.take_a_photo_of_the_record_book\"\n                )(state) !==\n                undefined &&\n              dataValue(\n                \"form.best_practice_questions.record_keeping.take_a_photo_of_the_record_book\"\n              )(state);\n          }\n  \n          return recordBookPhotoUrl;\n        })\n      )\n    )\n  );\n\n//Farm Visit Best Practice Results\n//loop through methods of erosion control and insert into database :: Erosion Control BP\nbeta.each(\n    function (state) {\n      //incoming erosion data\n      var best_practice_results_data = dataValue(\n        \"form.best_practice_questions.erosion_control.methods_of_erosion_control\"\n      )(state);\n  \n      if (best_practice_results_data !== undefined) {\n        return best_practice_results_data.split(\" \").map(function (resultId) {\n          return {\n            result_data: resultId,\n            best_result_submission:\n              \"FVBPN-\" + dataValue(\"id\")(state) + \"_erosion_\" + resultId,\n            farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n          };\n        });\n      }\n    },\n    upsert(\n      \"FV_Best_Practice_Results__c\",\n      \"Best_Practice_Result_Submission_ID__c\",\n      fields(\n\n        field(\n          \"Best_Practice_Result_Submission_ID__c\",\n          dataValue(\"best_result_submission\")\n        ), //best result submission ID\n        relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n        field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n        field(\"Best_Practice_Result_Type__c\", \"Erosion Control\"), //this is the actual result type\n        field(\"Best_Practice_Result_Description__c\", function (state) {\n          var returnResults = \"\";\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"1\"\n          ) {\n            returnResults = \"Stabilizing grasses\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"2\"\n          ) {\n            returnResults = \"Mulch\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"3\"\n          ) {\n            returnResults = \"Water traps or trenches\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"4\"\n          ) {\n            returnResults = \"Physical barriers. (e.g. rocks)\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"5\"\n          ) {\n            returnResults = \"Terraces\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"6\"\n          ) {\n            returnResults = \"Contour planting\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"7\"\n          ) {\n            returnResults = \"Bean or Arachis cover crop between the rows\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"0\"\n          ) {\n            returnResults = \"No erosion control method seen\";\n          }\n  \n          return returnResults;\n        })\n      )\n    )\n  );\n  \n  //loop through chemical/fertilizier applied and insert into database :: Nutrition BP\n  beta.each(\n    function (state) {\n      //incoming chemical/fertilizer used data\n      var best_practice_results_data = dataValue(\n        \"form.best_practice_questions.nutrition.type_chemical_applied_on_coffee_last_12_months\"\n      )(state);\n  \n      if (best_practice_results_data !== undefined) {\n        return best_practice_results_data.split(\" \").map(function (resultId) {\n          return {\n            result_data: resultId,\n            best_result_submission:\n              \"FVBPN-\" + dataValue(\"id\")(state) + \"_fertilizer_\" + resultId,\n            farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n          };\n        });\n      }\n    },\n    upsert(\n      \"FV_Best_Practice_Results__c\",\n      \"Best_Practice_Result_Submission_ID__c\",\n      fields(\n        field(\n          \"Best_Practice_Result_Submission_ID__c\",\n          dataValue(\"best_result_submission\")\n        ), //best result submission ID\n        relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n        field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n        field(\n          \"Best_Practice_Result_Type__c\",\n          \"Chemicals and Fertilizers Applied\"\n        ), //this is the actual result type\n        field(\"Best_Practice_Result_Description__c\", function (state) {\n          var returnResults = \"\";\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined && \n            (dataValue(\"result_data\")(state) == \"1\" || \n            dataValue(\"result_data\")(state) == \"2\")\n          ) {\n            returnResults = \"NPK 10:10:5-10\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            (dataValue(\"result_data\")(state) == \"3\" ||\n            dataValue(\"result_data\")(state) == \"4\" ||\n            dataValue(\"result_data\")(state) == \"5\" ||\n            dataValue(\"result_data\")(state) == \"6\" ||\n            dataValue(\"result_data\")(state) == \"7\")\n          ) {\n            returnResults = \"NPK 10:5:15-20\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            (dataValue(\"result_data\")(state) == \"8\" ||\n            dataValue(\"result_data\")(state) == \"9\" ||\n            dataValue(\"result_data\")(state) == \"10\")\n          ) {\n            returnResults = \"NPK 15:5:10-19\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"11\"\n          ) {\n            returnResults = \"NPK 15:15:15\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            (dataValue(\"result_data\")(state) == \"12\" ||\n            dataValue(\"result_data\")(state) == \"13\")\n          ) {\n            returnResults = \"NPK 20:5:10-20\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"14\"\n          ) {\n            returnResults = \"DAP\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"15\"\n          ) {\n            returnResults = \"Urea\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"16\"\n          ) {\n            returnResults = \"Compost or Manure\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"17\"\n          ) {\n            returnResults = \"Agricultural lime - Calcium Carbonate\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"18\"\n          ) {\n            returnResults = \"Nutrical (cal dolomita)\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"19\"\n          ) {\n            returnResults = \"Foliar Zinc or Boron\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"20\"\n          ) {\n            returnResults = \"General Foliar Feed (Nurish, Ferquido Ferqan)\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"0\"\n          ) {\n            returnResults = \"Did NOT apply any fertilizer in past 12 months\";\n          }\n  \n          return returnResults;\n        })\n      )\n    )\n  );\n  \n  //loop through methods of controlling coffee berry borer :: Integrated Pest and Disease Management BP\n  beta.each(\n    function (state) {\n      //incoming coffee berry borer data\n      var best_practice_results_data = dataValue(\n        \"form.best_practice_questions.pest_disease_management.methods_of_controlling_coffee_berry_borer\"\n      )(state);\n  \n      if (best_practice_results_data !== undefined) {\n        return best_practice_results_data.split(\" \").map(function (resultId) {\n          return {\n            result_data: resultId,\n            best_result_submission:\n              \"FVBPN-\" + dataValue(\"id\")(state) + \"_cbb_\" + resultId,\n            farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n          };\n        });\n      }\n    },\n    upsert(\n      \"FV_Best_Practice_Results__c\",\n      \"Best_Practice_Result_Submission_ID__c\",\n      fields(\n        field(\n          \"Best_Practice_Result_Submission_ID__c\",\n          dataValue(\"best_result_submission\")\n        ), //best result submission ID\n        relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n        field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n        field(\n          \"Best_Practice_Result_Type__c\",\n          \"Management of Coffee Berry Borer (CBB)\"\n        ), //this is the actual result type\n        field(\"Best_Practice_Result_Description__c\", function (state) {\n          var returnResults = \"\";\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"1\"\n          ) {\n            returnResults =\n              \"Reduce pesticide use and encourage natural predators\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"2\"\n          ) {\n            returnResults = \"Strip all berries at the end of harvest\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"3\"\n          ) {\n            returnResults = \"Harvest ripe cherries regularly\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"4\"\n          ) {\n            returnResults = \"Collect fallen berries\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"5\"\n          ) {\n            returnResults = \"Use berry borer traps\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"6\"\n          ) {\n            returnResults = \"Spray pesticides\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"0\"\n          ) {\n            returnResults = \"Does not know any methods\";\n          }\n  \n          return returnResults;\n        })\n      )\n    )\n  );\n  \n  //loop through methods of controlling leaf rust :: Integrated Pest and Disease Management\n  beta.each(\n    function (state) {\n      //incoming coffee leaf rust data\n      var best_practice_results_data = dataValue(\n        \"form.best_practice_questions.pest_disease_management.methods_of_controlling_coffee_leaf_rust\"\n      )(state);\n  \n      if (best_practice_results_data !== undefined) {\n        return best_practice_results_data.split(\" \").map(function (resultId) {\n          return {\n            result_data: resultId,\n            best_result_submission:\n              \"FVBPN-\" + dataValue(\"id\")(state) + \"_clr_\" + resultId,\n            farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n          };\n        });\n      }\n    },\n    upsert(\n      \"FV_Best_Practice_Results__c\",\n      \"Best_Practice_Result_Submission_ID__c\",\n      fields(\n        field(\n          \"Best_Practice_Result_Submission_ID__c\",\n          dataValue(\"best_result_submission\")\n        ), //best result submission ID\n        relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n        field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n        field(\n          \"Best_Practice_Result_Type__c\",\n          \"Management of Coffee Leaf Rust (CLR)\"\n        ), //this is the actual result type\n        field(\"Best_Practice_Result_Description__c\", function (state) {\n          var returnResults = \"\";\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"1\"\n          ) {\n            returnResults = \"Feed the tree well to keep it healthy\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"2\"\n          ) {\n            returnResults =\n              \"Use good agricultural practices such as weeding or mulching to reduce stress and keep trees healthy\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"3\"\n          ) {\n            returnResults = \"Prune or keep canopy open\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"4\"\n          ) {\n            returnResults = \"Spray fungicides\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"5\"\n          ) {\n            returnResults = \"Grow resistant varieties\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"0\"\n          ) {\n            returnResults = \"Does not know any methods\";\n          }\n  \n          return returnResults;\n        })\n      )\n    )\n  );\n  \n  // pesticide use\n  \n  // Loop through pests that cause problems on coffee farm\n  \n   beta.each(\n    function (state) {\n      //incoming pesticide use data\n      var best_practice_results_data =\n        dataValue(\n          \"form.best_practice_questions.pesticide_use.which_pests_cause_you_problems\"\n        )(state) || \"\";\n  \n      if (best_practice_results_data !== undefined) {\n        return best_practice_results_data.split(\" \").map(function (resultId) {\n          return {\n            result_data: resultId,\n            best_result_submission:\n              \"FVBPN-\" + dataValue(\"id\")(state) + \"_pesticide_use_\" + resultId,\n            farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n          };\n        });\n      }\n    },\n    upsert(\n      \"FV_Best_Practice_Results__c\",\n      \"Best_Practice_Result_Submission_ID__c\",\n      fields(\n        field(\n          \"Best_Practice_Result_Submission_ID__c\",\n          dataValue(\"best_result_submission\")\n        ), //best result submission ID\n        relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n        field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n        field(\"Best_Practice_Result_Type__c\", \"Pest Problems\"), //this is the actual result type\n        field(\"Best_Practice_Result_Description__c\", function (state) {\n          var returnResults = \"\";\n          \n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"1\"\n          ) {\n            returnResults = \"Leaf miner\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"2\"\n          ) {\n            returnResults = \"Coffee Berry Borer\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"3\"\n          ) {\n            returnResults = \"Scles and Mealy bugs\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"4\"\n          ) {\n            returnResults = \"None pest issue\";\n          }\n\n          return returnResults;\n        })\n      )\n    )\n  );\n  \n  // Loop through leaf miner or rust sprays\n  \n  beta.each(\n    function (state) {\n      //incoming pesticide use data\n      var best_practice_results_data =\n        dataValue(\n          \"form.best_practice_questions.pesticide_use.do_you_spray_any_of_the_following_on_your_farm_for_leaf_miner_or_rust\"\n        )(state) || \"\";\n  \n      if (best_practice_results_data !== undefined) {\n        return best_practice_results_data.split(\" \").map(function (resultId) {\n          return {\n            result_data: resultId,\n            best_result_submission:\n              \"FVBPN-\" + dataValue(\"id\")(state) + \"_pesticide_use_\" + resultId,\n            farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n          };\n        });\n      }\n    },\n    upsert(\n      \"FV_Best_Practice_Results__c\",\n      \"Best_Practice_Result_Submission_ID__c\",\n      fields(\n        field(\n          \"Best_Practice_Result_Submission_ID__c\",\n          dataValue(\"best_result_submission\")\n        ), //best result submission ID\n        relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n        field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n        field(\"Best_Practice_Result_Type__c\", \"Pesticide Sprays\"), //this is the actual result type\n        field(\"Best_Practice_Result_Description__c\", function (state) {\n          var returnResults = \"\";\n          \n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"1\"\n          ) {\n            returnResults = \"Products containing Imidacloprid\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"2\"\n          ) {\n            returnResults = \"Products containing Propiconazole\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"3\"\n          ) {\n            returnResults = \"None of the products used\";\n          }\n  \n\n          return returnResults;\n        })\n      )\n    )\n  );\n  \n  \n  //loop through pruning methods :: Pruning BP\n  beta.each(\n    function (state) {\n      //incoming pruning data\n      var best_practice_results_data =\n        dataValue(\n          \"form.best_practice_questions.pruning.pruning_method_on_majority_trees\"\n        )(state) || \"\";\n  \n      if (best_practice_results_data !== undefined) {\n        return best_practice_results_data.split(\" \").map(function (resultId) {\n          return {\n            result_data: resultId,\n            best_result_submission:\n              \"FVBPN-\" + dataValue(\"id\")(state) + \"_pruning_\" + resultId,\n            farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n            field_age: dataValue(\"form.field_age\")(state)\n          };\n        });\n      }\n    },\n    upsert(\n      \"FV_Best_Practice_Results__c\",\n      \"Best_Practice_Result_Submission_ID__c\",\n      fields(\n        field(\n          \"Best_Practice_Result_Submission_ID__c\",\n          dataValue(\"best_result_submission\")\n        ), //best result submission ID\n        relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n        field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n        field(\"Best_Practice_Result_Type__c\", \"Pruning\"), //this is the actual result type\n        field(\"Best_Practice_Result_Description__c\", function (state) {\n          var returnResults = \"\";\n          \n          var field_age = dataValue(\"field_age\")(state);\n          var numeric_field_age = parseInt(field_age);\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"1\"\n          ) {\n            returnResults = \"Centers opened\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"2\"\n          ) {\n            returnResults = \"Unwanted suckers removed\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"3\"\n          ) {\n            returnResults = \"Dead branches removed\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"4\"\n          ) {\n            returnResults = \"Branches touching the ground removed\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"5\"\n          ) {\n            returnResults = \"Broken / unproductive stems and/or branches removed\";\n          }\n  \n          if (\n            dataValue(\"result_data\")(state) !== undefined &&\n            dataValue(\"result_data\")(state) == \"0\"\n          ) {\n            returnResults = \"No pruning methods used\";\n          }\n          else if (numeric_field_age < 3){\n            returnResults = \"N/A\";\n          }\n  \n          return returnResults;\n        })\n      )\n    )\n  );\n  \n  beta.each(\n      function (state) {\n        //incoming pruning data\n        var best_practice_results_data =\n          dataValue(\n            \"form.best_practice_questions.weeding.which_product_have_you_used\"\n          )(state) || \"\";\n        // var otherProduct = dataValue(\"form.weeding.ask_which_other_product_have_you_used\")(state);\n        if (best_practice_results_data !== undefined) {\n          return best_practice_results_data.split(\" \").map(function (resultId) {\n            return {\n              result_data: resultId,\n              best_result_submission:\n                \"FVBPN-\" + dataValue(\"id\")(state) + \"_weeding_\" + resultId,\n              farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n              // other_submission: otherProduct\n            };\n          });\n        }\n      },\n      upsert(\n        \"FV_Best_Practice_Results__c\",\n        \"Best_Practice_Result_Submission_ID__c\",\n        fields(\n          field(\n            \"Best_Practice_Result_Submission_ID__c\",\n            dataValue(\"best_result_submission\")\n          ), //best result submission ID\n          relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n          field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n          field(\"Best_Practice_Result_Type__c\", \"Weeding\"), //this is the actual result type\n          field(\"Best_Practice_Result_Description__c\", function (state) {\n            var returnResults = \"\";\n    \n            if (\n              dataValue(\"result_data\")(state) !== undefined &&\n              dataValue(\"result_data\")(state) == \"1\"\n            ) {\n              returnResults =\n                \"Glyphosate (Honcho Plus, Round Up Ultra, GlyStar Plus, Credit, Compare and Save, TouchDown)\";\n            }\n    \n            if (\n              dataValue(\"result_data\")(state) !== undefined &&\n              dataValue(\"result_data\")(state) == \"2\"\n            ) {\n              returnResults = \"Paraquat (Gramaxon, Parazone, Parashot)\";\n            }\n    \n            // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n    \n            //     returnResults = dataValue(\"other_submission\");\n            //console.log(\"debug\", dataValue(\"result_data\")(state));\n            // }\n            return returnResults;\n          })\n        )\n      )\n    );\n  \n  //upsert training session\n  /*    each(\n          \"$.data\",\n          upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n              fields(\n                  field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n                  field(\"Updated_from_CommCare__c\", true)\n              )\n          )\n      );\n  */\n  \n  //}\n  \n",
          "adaptor": "@openfn/language-salesforce@4.6.5",
          "project_credential_id": "55f298ba-f7d3-442c-9c27-ff1825d583f6"
        }
      },
      "edges": {
        "webhook->Production---Farm-Visit---PR-2022---CommCare----Salesforce": {
          "enabled": true,
          "id": "d93b3e1c-0055-447e-b519-6ad43ee6cd70",
          "target_job_id": "8cd877ba-ad08-4083-b747-d924f5084de7",
          "source_trigger_id": "1c68e9f5-7551-4c5f-a864-4ba8a4cf3cdc",
          "condition_type": "js_expression",
          "condition_label": "Production - Farm Visit PR 2022 CommCare Salesforce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Farm Visit Full - PR\""
        }
      }
    },
    "Production---Farm-Visit---BU---CommCare----Salesforce": {
      "id": "83f3fbc6-85eb-4b1a-9f54-575656619c45",
      "name": "Production - Farm Visit - BU - CommCare -- Salesforce",
      "inserted_at": "2025-02-12T06:28:14.511442Z",
      "lock_version": 6,
      "triggers": {
        "webhook": {
          "enabled": true,
          "id": "a576cbac-b986-4125-8637-00a5f1ab99f9",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Farm-Visit---BU---CommCare----Salesforce": {
          "id": "d84c8654-9cf3-4aa9-8a7a-f9fd328290d5",
          "name": "Production - Farm Visit - BU - CommCare -- Salesforce",
          "body": "//FARM VISIT JOB FOR ALL BURUNDI PROJECTS\n//Production - Farm Visit :: BU 2024 | CommCare --> Salesforce | Farm Visit Full\n//Farm Visit Best Practice Results\n//loop through methods of erosion control and insert into database :: Erosion Control BP\n\n//insert the farm visit record FT-Level\neach(\n  \"$.data\",\n  upsertIf(\n    state.data.form[\"@name\"] == \"Farm Visit Full\",\n    \"Farm_Visit__c\",\n    \"FV_Submission_ID__c\",\n    fields(\n      field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n      field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n      field(\"Farm_Visit_Type__c\", dataValue(\"form.survey_type\")),\n      field(\"Training_Group__c\", dataValue(\"form.case.@case_id\")),\n      field(\"Primary_Farmer_PIMA_ID__c\", dataValue(\"form.farm_being_visted\")),\n      field(\"Date_Visited__c\", dataValue(\"form.date_of_visit\")),\n      field(\"visit_comments__c\", dataValue(\"form.farm_visit_comments\")),\n      field(\"Farmer_Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Shade_Tee_Species__c\", dataValue(\"form.shade_tree_species\")),\n      field(\n        \"No_of_separate_coffee_fields__c\",\n        dataValue(\"form.number_of_fields\")\n      ),\n      field(\"Field_Size__c\", dataValue(\"form.field_size\")),\n      field(\"Farm_Visit_Photo_Url__c\", function (state) {\n        var farmVisitPhotoUrl = \"\";\n        if (\n          dataValue(\"form.farm_visit_photo\")(state) !== undefined &&\n          dataValue(\"form.farm_visit_photo\")(state) !== \"\"\n        ) {\n          farmVisitPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.farm_visit_photo\")(state);\n        }\n        return farmVisitPhotoUrl;\n      }),\n      field(\"Signature__c\", function (state) {\n        var recorderSignatureUrl = \"\";\n        if (\n          dataValue(\"form.signature_of_farmer_trainer\")(state) !== undefined &&\n          dataValue(\"form.signature_of_farmer_trainer\")(state) !== \"\"\n        ) {\n          recorderSignatureUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.signature_of_farmer_trainer\")(state);\n        }\n        return recorderSignatureUrl;\n      }),\n      field(\"Location_GPS__Latitude__s\", (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[0];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return \"\";\n      }),\n      field(\"Location_GPS__Longitude__s\", (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[1];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return \"\";\n      }),\n      field(\"Altitude__c\", (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[2];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return \"\";\n      }),\n      relationship(\n        \"Farm_Visited__r\",\n        \"CommCare_Case_Id__c\",\n        dataValue(\"form.farm_being_visted\")\n      )\n      // relationship(\"Secondary_Farmer__r\", \"CommCare_Case_Id__c\", function(state){\n      //     var secondaryFarmer = '';\n      //     if(dataValue(\"form.secondary_farmer_available\")(state) == 'yes' && dataValue(\"form.secondary_farmer\")(state) !== ''){\n      //       secondaryFarmer = dataValue(\"form.secondary_farmer\");\n      //     }\n      //     return secondaryFarmer;\n      // })\n    )\n  )\n);\n\neach(\n  \"$.data\",\n  upsertIf(\n    state.data.form[\"@name\"] == \"Farm Visit - AA\",\n    \"Farm_Visit__c\",\n    \"FV_Submission_ID__c\",\n    fields(\n      field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n      field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n      field(\"Farm_Visit_Type__c\", dataValue(\"form.survey_type\")),\n      field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n      relationship(\"Farm_Visited__r\", \"CommCare_Case_Id__c\", function (state) {\n        const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n        if (visitedFarmers) {\n          return visitedFarmers.split(\" \")[0];\n        }\n      }),\n      field(\"Primary_Farmer_PIMA_ID__c\", function (state) {\n        const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n        if (visitedFarmers) {\n          return visitedFarmers.split(\" \")[0];\n        }\n      }),\n\n      // relationship(\"Secondary_Farmer__r\", \"CommCare_Case_Id__c\", function(state){\n      //   const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n      //   var result = null;\n      //   if(visitedFarmers.length > 1){\n      //     result = visitedFarmers.split(\" \")[1];\n      //   }\n      //   return result;\n      // }),\n\n      // field(\"Secondary_Farmer_PIMA_ID__c\", function(state){\n      //   const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n      //   var result = null;\n      //   if(visitedFarmers.length > 1){\n      //     result = visitedFarmers.split(\" \")[1];\n      //   }\n      //   return result;\n      // }),\n      field(\n        \"Visit_Has_Training__c\",\n        dataValue(\"form.is_this_a_farm_training_visit\")\n      ),\n      //  field(\"Training_Session__c\", dataValue(\"form.training_session\")),\n      // field(\"Other_Participants_Present__c\", dataValue(\"form.any_other_participants_present\")),\n      field(\"Total_Farmers_Visited__c\", dataValue(\"form.attendance_count\")),\n      field(\"Date_Visited__c\", dataValue(\"form.date_of_visit\")),\n      field(\"visit_comments__c\", dataValue(\"form.farm_visit_comments\")),\n      field(\"Farmer_Trainer__c\", dataValue(\"form.trainer\")),\n      field(\n        \"No_of_separate_coffee_fields__c\",\n        dataValue(\"form.opening_questions.number_of_separate_coffee_fields\")\n      ),\n      field(\"Field_Age__c\", dataValue(\"form.field_age\")),\n      field(\"Field_Size__c\", function (state) {\n        var fieldSize = \"\";\n        if (\n          dataValue(\"form.field_size\")(state) !== undefined &&\n          dataValue(\"form.field_size\")(state) !== \"\"\n        ) {\n          fieldSize = dataValue(\"form.field_size\");\n        } else if (\n          dataValue(\"form.field_size1\")(state) !== undefined &&\n          dataValue(\"form.field_size1\")(state) !== \"\"\n        ) {\n          fieldSize = dataValue(\"form.field_size1\");\n        }\n\n        return fieldSize;\n      }),\n      field(\"Farm_Visit_Photo_Url__c\", function (state) {\n        var farmVisitPhotoUrl = \"\";\n        if (\n          dataValue(\"form.farm_visit_photo\")(state) !== undefined &&\n          dataValue(\"form.farm_visit_photo\")(state) !== \"\"\n        ) {\n          farmVisitPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.farm_visit_photo\")(state);\n        }\n        return farmVisitPhotoUrl;\n      }),\n      field(\"Signature__c\", function (state) {\n        var recorderSignatureUrl = \"\";\n        if (\n          dataValue(\"form.signature_of_farmer_trainer\")(state) !== undefined &&\n          dataValue(\"form.signature_of_farmer_trainer\")(state) !== \"\"\n        ) {\n          recorderSignatureUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.signature_of_farmer_trainer\")(state);\n        }\n        return recorderSignatureUrl;\n      }),\n      field(\"Location_GPS__Latitude__s\", (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[0];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return \"\";\n      }),\n      field(\"Location_GPS__Longitude__s\", (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[1];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return \"\";\n      }),\n      field(\"Altitude__c\", (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[2];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return \"\";\n      }),\n      field(\"FV_AA_Farmer_1_Attended_Any_Training__c\", function (state) {\n        var result = \"\";\n        if (\n          dataValue(\"form.farmer_1_questions.attended_training\")(state) == 1\n        ) {\n          result = \"Yes\";\n        } else if (\n          dataValue(\"form.farmer_1_questions.attended_training\")(state) == 0\n        ) {\n          result = \"No\";\n        }\n        return result;\n      }),\n      field(\"FV_AA_Farmer_2_Attended_Any_Training__c\", function (state) {\n        var result = \"\";\n        if (\n          dataValue(\"form.farmer_2_questions.attended_training\")(state) == 1\n        ) {\n          result = \"Yes\";\n        } else if (\n          dataValue(\"form.farmer_2_questions.attended_training\")(state) == 0\n        ) {\n          result = \"No\";\n        }\n        return result;\n      }),\n      field(\n        \"FV_AA_Farmer_1_Trainings_Attended__c\",\n        dataValue(\"form.farmer_1_questions.number_of_trainings\")\n      ),\n      field(\n        \"FV_AA_Farmer_2_Trainings_Attended__c\",\n        dataValue(\"form.farmer_2_questions.number_of_trainings\")\n      ),\n      field(\"FV_AA_Visit_Done_By_AA__c\", \"Yes\"),\n      field(\"Training_Session__c\", dataValue(\"form.training_session\"))\n    )\n  )\n);\n\n// Update Household Record - FV AA\neach(\n  \"$.data\",\n  upsertIf(\n    state.data.form[\"@name\"] == \"Farm Visit - AA\",\n    \"Household__c\",\n    \"Id\",\n    fields(\n      field(\"Id\", state.data.form.case[\"@case_id\"]),\n      field(\n        \"FV_AA_Visited__c\",\n        dataValue(\"form.case.update.FV_AA_Visited\")(state)\n      ),\n      relationship(\n        \"Latest_Farm_Visit_Record__r\",\n        \"FV_Submission_ID__c\",\n        \"FV-\" + dataValue(\"id\")(state)\n      )\n    )\n  )\n);\n\n// update FV with secondary Farmer\neach(\n  \"$.data\",\n  upsertIf(\n    state.data.form.secondary_farmer !== \"\" &&\n      state.data.form.secondary_farmer_available == \"yes\",\n    \"Farm_Visit__c\",\n    \"FV_Submission_ID__c\",\n    fields(\n      field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n      relationship(\n        \"Secondary_Farmer__r\",\n        \"CommCare_Case_Id__c\",\n        dataValue(\"form.secondary_farmer\")\n      ),\n      field(\"Secondary_Farmer_PIMA_ID__c\", dataValue(\"form.secondary_farmer\"))\n    )\n  )\n);\n\n//Best Practices :: Main Stem && Weeding &&  Shade Control && Record Keeping && Compost && Erosion Control && Nutrition && Safe Use of Pesticides\neach(\n  \"$.data\",\n  upsert(\n    \"FV_Best_Practices__c\",\n    \"FV_Submission_ID__c\",\n    fields(\n      field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n      field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n      relationship(\"Farm_Visit__r\", \"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n\n      // 2.1 Main Stems\n      field(\n        \"number_of_main_stems_on_majority_trees__c\",\n        dataValue(\n          \"form.best_practice_questions.main_stems.number_of_main_stems_on_majority_trees\"\n        )\n      ),\n\n      // 2.2 Main Stems Photo\n      field(\"photo_of_trees_and_average_main_stems__c\", function (state) {\n        var mainStemsPhotoURL = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.main_stems.trees_and_main_stems_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.main_stems.trees_and_main_stems_photo\"\n          )(state) !== \"\"\n        ) {\n          mainStemsPhotoURL =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.main_stems.trees_and_main_stems_photo\"\n            )(state);\n        }\n        return mainStemsPhotoURL;\n      }),\n\n      // 4.1 Nutrition\n      field(\"Color_of_coffee_tree_leaves__c\", function (state) {\n        var colorOfCoffeeLeaves = dataValue(\n          \"form.best_practice_questions.nutrition.are_the_leave_green_or_yellow_pale_green\"\n        )(state);\n        var returnColorOfCoffeeLeaves = \"\";\n\n        if (\n          colorOfCoffeeLeaves !== undefined &&\n          colorOfCoffeeLeaves !== \"\" &&\n          colorOfCoffeeLeaves == 0\n        ) {\n          returnColorOfCoffeeLeaves =\n            \"5% or more (5 or more in 100) of the leaves are yellow, pale green or brown.\";\n        }\n\n        if (\n          colorOfCoffeeLeaves !== undefined &&\n          colorOfCoffeeLeaves !== \"\" &&\n          colorOfCoffeeLeaves == 1\n        ) {\n          returnColorOfCoffeeLeaves =\n            \"Nearly all leaves are dark green and less than 5% (less than 5 in 100) are yellow, pale green, or brown.\";\n        }\n\n        return returnColorOfCoffeeLeaves;\n      }),\n\n      // 5.1 Weeding\n      field(\"how_many_weeds_under_canopy_and_how_big__c\", function (state) {\n        var weedsUnderCanopy = dataValue(\n          \"form.best_practice_questions.weeding.how_many_weeds_under_canopy_and_how_big_are_they\"\n        )(state);\n        var returnWeedsUnderCanopy = \"\";\n\n        if (weedsUnderCanopy == 1) {\n          returnWeedsUnderCanopy =\n            \"Few small weeds (less than 30cm) under the tree canopy\";\n        }\n\n        if (weedsUnderCanopy == 2) {\n          returnWeedsUnderCanopy =\n            \"Many small weeds under the tree canopy (ground is covered with weeds)\";\n        }\n\n        if (weedsUnderCanopy == 3) {\n          returnWeedsUnderCanopy =\n            \"Many large weeds under the tree canopy (ground is covered with weeds)\";\n        }\n\n        return returnWeedsUnderCanopy;\n      }),\n\n      // 5.3 Used Herbicides\n      field(\n        \"Have_herbicides_been_used_on_the_field__c\",\n        dataValue(\"form.best_practice_questions.weeding.used_herbicides\")\n      ),\n\n      // 5.2 Weeding Photograph\n      field(\"photo_of_weeds_under_the_canopy__c\", function (state) {\n        var weedsPhotoUrl = dataValue(\n          \"form.best_practice_questions.weeding.weeds_under_the_canopy_photo\"\n        )(state);\n        var returnWeedsPhotoUrl = \"\";\n\n        if (weedsPhotoUrl !== undefined && weedsPhotoUrl !== \"\") {\n          returnWeedsPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            weedsPhotoUrl;\n        }\n\n        return returnWeedsPhotoUrl;\n      }),\n\n      // 7.1 Safe use of pesticides\n      field(\"used_pesticide__c\", function (state) {\n        var usedPesticide = dataValue(\n          \"form.best_practice_questions.safe_use_of_pesticides.used_pesticides\"\n        )(state);\n        var returnUsedPesticide = \"\";\n        if (usedPesticide == 1) {\n          returnUsedPesticide = \"Yes\";\n        } else if (usedPesticide == 0) {\n          returnUsedPesticide = \"No\";\n        }\n        return returnUsedPesticide;\n      }),\n\n      // 7.2 \n      field(\n        \"pesticide_number_of_times__c\",\n        dataValue(\n          \"form.best_practice_questions.safe_use_of_pesticides.pesticide_number_of_times\"\n        )\n      ),\n\n      // 7.3\n      field(\"pesticide_spray_type__c\", function (state) {\n        const sprayType = dataValue(\n          \"form.best_practice_questions.safe_use_of_pesticides.pesticide_spray_type\"\n        )(state);\n        var returnSprayType = \"\";\n\n        if (sprayType === \"1\") {\n          returnSprayType = \"Routine spray\";\n        } else if (sprayType === \"2\") {\n          returnSprayType = \"After scouting and seeing a pest\";\n        }\n        return returnSprayType;\n      }),\n\n      // 9.1 shade management\n      field(\"level_of_shade_present_on_the_farm__c\", function (state) {\n        var levelOfShadeOnPlot = dataValue(\n          \"form.best_practice_questions.shade_control.level_of_shade_present_on_the_farm\"\n        )(state);\n        var returnLevelOfShadeOnPlot = \"\";\n\n        if (levelOfShadeOnPlot == 0) {\n          returnLevelOfShadeOnPlot = \"NO shade, less than 5%\";\n        }\n\n        if (levelOfShadeOnPlot == 1) {\n          returnLevelOfShadeOnPlot = \"Light shade, 5 to 20%\";\n        }\n\n        if (levelOfShadeOnPlot == 2) {\n          returnLevelOfShadeOnPlot = \"Medium shade, 20 to 40%\";\n        }\n\n        if (levelOfShadeOnPlot == 3) {\n          returnLevelOfShadeOnPlot = \"Heavy shade, over 40%\";\n        }\n\n        return returnLevelOfShadeOnPlot;\n      }),\n\n      // 9.2 \n      field(\"photo_of_level_of_shade_on_the_plot__c\", function (state) {\n        var shadePhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.shade_control.photo_of_level_of_shade_on_the_plot\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_control.photo_of_level_of_shade_on_the_plot\"\n          )(state) !== \"\"\n        ) {\n          shadePhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.shade_control.photo_of_level_of_shade_on_the_plot\"\n            )(state);\n        }\n\n        return shadePhotoUrl;\n      }),\n\n      // 1.2\n      field(\"photo_of_the_compost_manure__c\", function (state) {\n        var compostPhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.compost.photo_of_the_compost_manure\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.compost.photo_of_the_compost_manure\"\n          )(state) !== \"\"\n        ) {\n          compostPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.compost.photo_of_the_compost_manure\"\n            )(state);\n        }\n\n        return compostPhotoUrl;\n      }),\n\n      //erosion control\n      field(\"Stabilizing_Grasses_Photo_URL__c\", function (state) {\n        var sgPhotoURL = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.erosion_control.stabilizing_grasses_image\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.erosion_control.stabilizing_grasses_image\"\n          )(state) !== \"\"\n        ) {\n          sgPhotoURL =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.erosion_control.stabilizing_grasses_image\"\n            )(state);\n        }\n\n        return sgPhotoURL;\n      }),\n      field(\"Mulch_Photo_URL__c\", function (state) {\n        var mulchPhotoURL = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.erosion_control.mulch_image\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.erosion_control.mulch_image\")(\n            state\n          ) !== \"\"\n        ) {\n          mulchPhotoURL =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.erosion_control.mulch_image\"\n            )(state);\n        }\n\n        return mulchPhotoURL;\n      }),\n      field(\"Water_Traps_Photo_URL__c\", function (state) {\n        var wtPhotoURL = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.erosion_control.water_traps_or_trenches_image\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.erosion_control.water_traps_or_trenches_image\"\n          )(state) !== \"\"\n        ) {\n          wtPhotoURL =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.erosion_control.water_traps_or_trenches_image\"\n            )(state);\n        }\n\n        return wtPhotoURL;\n      }),\n      field(\"Physical_Barriers_Photo_URL__c\", function (state) {\n        var pbPhotoURL = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.erosion_control.physical_barriers_image\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.erosion_control.physical_barriers_image\"\n          )(state) !== \"\"\n        ) {\n          pbPhotoURL =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.erosion_control.physical_barriers_image\"\n            )(state);\n        }\n\n        return pbPhotoURL;\n      }),\n      field(\"Terraces_Photo_URL__c\", function (state) {\n        var terracesPhotoURL = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.erosion_control.terraces_image\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.erosion_control.terraces_image\"\n          )(state) !== \"\"\n        ) {\n          terracesPhotoURL =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.erosion_control.terraces_image\"\n            )(state);\n        }\n\n        return terracesPhotoURL;\n      }),\n      field(\"Contour_Planting_Photo_URL__c\", function (state) {\n        var cpPhotoURL = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.erosion_control.contour_planting_image\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.erosion_control.contour_planting_image\"\n          )(state) !== \"\"\n        ) {\n          cpPhotoURL =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.erosion_control.contour_planting_image\"\n            )(state);\n        }\n\n        return cpPhotoURL;\n      }),\n      field(\"Cover_Crop_Photo_URL__c\", function (state) {\n        var ccPhotoURL = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.erosion_control.bean_or_arachis_cover_crop_image\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.erosion_control.bean_or_arachis_cover_crop_image\"\n          )(state) !== \"\"\n        ) {\n          ccPhotoURL =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.erosion_control.bean_or_arachis_cover_crop_image\"\n            )(state);\n        }\n\n        return ccPhotoURL;\n      })\n    )\n  )\n);\n\n// 8.1 Erosion Control\nbeta.each(\n  function (state) {\n    //incoming erosion data\n    var best_practice_results_data = dataValue(\n      \"form.best_practice_questions.erosion_control.methods_of_erosion_control\"\n    )(state);\n\n    if (best_practice_results_data !== undefined) {\n      return best_practice_results_data.split(\" \").map(function (resultId) {\n        return {\n          result_data: resultId,\n          best_result_submission:\n            \"FVBPN-\" + dataValue(\"id\")(state) + \"_erosion_\" + resultId,\n          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n        };\n      });\n    }\n  },\n  upsert(\n    \"FV_Best_Practice_Results__c\",\n    \"Best_Practice_Result_Submission_ID__c\",\n    fields(\n      field(\n        \"Best_Practice_Result_Submission_ID__c\",\n        dataValue(\"best_result_submission\")\n      ), //best result submission ID\n      relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n      field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n      field(\"Best_Practice_Result_Type__c\", \"Erosion Control\"), //this is the actual result type\n      field(\"Best_Practice_Result_Description__c\", function (state) {\n        var returnResults = \"\";\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"1\"\n        ) {\n          returnResults = \"Stabilizing grasses\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"2\"\n        ) {\n          returnResults = \"Mulch\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"3\"\n        ) {\n          returnResults = \"Water traps or trenches\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"4\"\n        ) {\n          returnResults = \"Physical barriers. (e.g. rocks)\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"5\"\n        ) {\n          returnResults = \"Terraces\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"6\"\n        ) {\n          returnResults = \"Contour planting\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"7\"\n        ) {\n          returnResults = \"Bean or Arachis cover crop between the rows\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"0\"\n        ) {\n          returnResults = \"No erosion control method seen\";\n        }\n\n        return returnResults;\n      })\n    )\n  )\n);\n\n// 4.2 loop through chemical/fertilizier applied and insert into database :: Nutrition BP\nbeta.each(\n  function (state) {\n    //incoming chemical/fertilizer used data\n    var best_practice_results_data = dataValue(\n      \"form.best_practice_questions.nutrition.type_chemical_applied_on_coffee_last_12_months\"\n    )(state);\n\n    if (best_practice_results_data !== undefined) {\n      return best_practice_results_data.split(\" \").map(function (resultId) {\n        return {\n          result_data: resultId,\n          best_result_submission:\n            \"FVBPN-\" + dataValue(\"id\")(state) + \"_fertilizer_\" + resultId,\n          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n        };\n      });\n    }\n  },\n  upsert(\n    \"FV_Best_Practice_Results__c\",\n    \"Best_Practice_Result_Submission_ID__c\",\n    fields(\n      field(\n        \"Best_Practice_Result_Submission_ID__c\",\n        dataValue(\"best_result_submission\")\n      ), //best result submission ID\n      relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n      field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n      field(\n        \"Best_Practice_Result_Type__c\",\n        \"Chemicals and Fertilizers Applied\"\n      ), //this is the actual result type\n      field(\"Best_Practice_Result_Description__c\", function (state) {\n        var returnResults = \"\";\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"1\"\n        ) {\n          returnResults = \"Compost\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"2\"\n        ) {\n          returnResults = \"Manure\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"3\"\n        ) {\n          returnResults = \"NPK 22:6:12\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"4\"\n        ) {\n          returnResults = \"Lime\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"5\"\n        ) {\n          returnResults = \"DAP\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"6\"\n        ) {\n          returnResults = \"Urea\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"0\"\n        ) {\n          returnResults = \"Did NOT apply any fertilizer in past 12 months\";\n        }\n\n        return returnResults;\n      })\n    )\n  )\n);\n\n// 6. IPDM: loop through methods of controlling coffee berry borer :: Integrated Pest and Disease Management BP\nbeta.each(\n  function (state) {\n    //incoming coffee berry borer data\n    var best_practice_results_data = dataValue(\n      \"form.best_practice_questions.pest_disease_management.methods_of_controlling_coffee_berry_borer\"\n    )(state);\n\n    if (best_practice_results_data !== undefined) {\n      return best_practice_results_data.split(\" \").map(function (resultId) {\n        return {\n          result_data: resultId,\n          best_result_submission:\n            \"FVBPN-\" + dataValue(\"id\")(state) + \"_cbb_\" + resultId,\n          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n        };\n      });\n    }\n  },\n  upsert(\n    \"FV_Best_Practice_Results__c\",\n    \"Best_Practice_Result_Submission_ID__c\",\n    fields(\n      field(\n        \"Best_Practice_Result_Submission_ID__c\",\n        dataValue(\"best_result_submission\")\n      ), //best result submission ID\n      relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n      field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n      field(\n        \"Best_Practice_Result_Type__c\",\n        \"Management of Coffee Berry Borer (CBB)\"\n      ), //this is the actual result type\n      field(\"Best_Practice_Result_Description__c\", function (state) {\n        var returnResults = \"\";\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"1\"\n        ) {\n          returnResults =\n            \"Encourage natural predators, parasites and beneficial insects by reducing pesticide sprays.\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"2\"\n        ) {\n          returnResults =\n            \"Remove all old berries at the end of harvest, known as crop hygiene\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"3\"\n        ) {\n          returnResults =\n            \"Harvest ripe cherries regularly - to reduce pest and disease levels\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"4\"\n        ) {\n          returnResults =\n            \"Hang Berry Borer traps to trap and kill Berry Borer beetles\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"5\"\n        ) {\n          returnResults =\n            \"Collect fallen berries at the end of the season - crop hygiene\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"6\"\n        ) {\n          returnResults = \"Feed the trees well to keep them healthy\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"7\"\n        ) {\n          returnResults =\n            \"Use good agricultural practices such as weeding or mulching to reduce stress and keep trees healthy\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"8\"\n        ) {\n          returnResults = \"Prune to keep the canopy open\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"9\"\n        ) {\n          returnResults =\n            \"Rejuvenate regularly to keep main stems less than 8 years old\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"10\"\n        ) {\n          returnResults =\n            \"Smooth the bark at the base of the tree to reduce egg laying sites for While Stem Borer\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"11\"\n        ) {\n          returnResults = \"Use a wite to kill White Stem Borer larvae\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"12\"\n        ) {\n          returnResults = \"Spray homemade herbal or botanical pesticides\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"13\"\n        ) {\n          returnResults = \"Spray fungicides eg. copper  to manage rust\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"15\"\n        ) {\n          returnResults = \"Spray normal  insecticides\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"0\"\n        ) {\n          returnResults = \"Does not know any methods\";\n        }\n\n        return returnResults;\n      })\n    )\n  )\n);\n\n// 3. Pruning: loop through pruning methods :: Pruning BP\nbeta.each(\n  function (state) {\n    //incoming pruning data\n    var best_practice_results_data =\n      dataValue(\n        \"form.best_practice_questions.pruning.pruning_method_on_majority_trees\"\n      )(state) || \"\";\n\n    if (best_practice_results_data !== undefined) {\n      return best_practice_results_data.split(\" \").map(function (resultId) {\n        return {\n          result_data: resultId,\n          best_result_submission:\n            \"FVBPN-\" + dataValue(\"id\")(state) + \"_pruning_\" + resultId,\n          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n          // field_age: dataValue(\"form.field_age\")(state),\n        };\n      });\n    }\n  },\n  upsert(\n    \"FV_Best_Practice_Results__c\",\n    \"Best_Practice_Result_Submission_ID__c\",\n    fields(\n      field(\n        \"Best_Practice_Result_Submission_ID__c\",\n        dataValue(\"best_result_submission\")\n      ), //best result submission ID\n      relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n      field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n      field(\"Best_Practice_Result_Type__c\", \"Pruning\"), //this is the actual result type\n      field(\"Best_Practice_Result_Description__c\", function (state) {\n        var returnResults = \"\";\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"1\"\n        ) {\n          returnResults = \"Centers opened\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"2\"\n        ) {\n          returnResults = \"Unwanted suckers removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"3\"\n        ) {\n          returnResults = \"Dead branches removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"4\"\n        ) {\n          returnResults = \"Branches touching the ground removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"5\"\n        ) {\n          returnResults = \"Broken / unproductive stems and/or branches removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"6\"\n        ) {\n          returnResults =\n            \"Many primaries removed on the lower half of the tree.\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"0\"\n        ) {\n          returnResults = \"No pruning methods used\";\n        }\n\n        return returnResults;\n      })\n    )\n  )\n);\n\n// 1. Compost\nbeta.each(\n  function (state) {\n    //incoming compost data\n    var best_practice_results_data =\n      dataValue(\n        \"form.compost.do_you_have_compost_manure\"\n      )(state) || \"\";\n      \n     if (best_practice_results_data !== undefined) {\n      return best_practice_results_data.split(\" \").map(function (resultId) {\n        return {\n          result_data: resultId,\n          best_result_submission:\n            \"FVBPN-\" + dataValue(\"id\")(state) + \"_compost_\" + resultId,\n          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n          // field_age: dataValue(\"form.field_age\")(state),\n        };\n      });\n    }\n  },\n  upsert(\n    \"FV_Best_Practice_Results__c\",\n    \"Best_Practice_Result_Submission_ID__c\",\n    fields(\n      field(\n        \"Best_Practice_Result_Submission_ID__c\",\n        dataValue(\"best_result_submission\")\n      ), //best result submission ID\n      relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n      field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n      field(\"Best_Practice_Result_Type__c\", \"Compost\"), //this is the actual result type\n      field(\"Best_Practice_Result_Description__c\", function (state) {\n        var returnResults = \"\";\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"0\"\n        ) {\n          returnResults = \"NO compost or manure\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"1\"\n        ) {\n          returnResults = \"YES a compost heap\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"2\"\n        ) {\n          returnResults = \"YES a  compost pit\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"3\"\n        ) {\n          returnResults = \"YES a manure heap\";\n        }\n        return returnResults;\n      })\n    )\n  )\n);\n\n",
          "adaptor": "@openfn/language-salesforce@4.6.5",
          "project_credential_id": "55f298ba-f7d3-442c-9c27-ff1825d583f6"
        }
      },
      "edges": {
        "webhook->Production---Farm-Visit---BU---CommCare----Salesforce": {
          "enabled": true,
          "id": "c7821af7-0833-4506-81f9-d2dec2a19097",
          "target_job_id": "d84c8654-9cf3-4aa9-8a7a-f9fd328290d5",
          "source_trigger_id": "a576cbac-b986-4125-8637-00a5f1ab99f9",
          "condition_type": "js_expression",
          "condition_label": "Production - Farm Visit - BU - CommCare -- Salesforce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Farm Visit Full - BU\""
        }
      }
    },
    "Production---Farm-Visit---ZW---CommCare----Salesforce": {
      "id": "595dfbac-9f2d-454f-86fb-1519ae1ec754",
      "name": "Production - Farm Visit - ZW - CommCare -- Salesforce",
      "inserted_at": "2025-02-12T06:52:51.669696Z",
      "lock_version": 4,
      "triggers": {
        "webhook": {
          "enabled": true,
          "id": "44aaefbb-e405-42c3-8125-0631b7956bfe",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Farm-Visit---ZW---CommCare----Salesforce": {
          "id": "259b5992-f922-426a-ade2-9c78252432d9",
          "name": "Production - Farm Visit - ZW - CommCare -- Salesforce",
          "body": "//FARM VISIT JOB FOR ALL ZIMBABWE PROJECTS\n//Production - Farm Visit :: ZM 2022 | CommCare --> Salesforce | Farm Visit Full\n//ZM ZM C2018\n\n  //insert the farm visit record for FT Level\n  each(\n      \"$.data\",\n      upsertIf(state.data.form['@name'] == \"Farm Visit Full\",\n        \"Farm_Visit__c\", \"FV_Submission_ID__c\",\n          fields(\n              field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n              field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n              field(\"Farm_Visit_Type__c\", dataValue(\"form.survey_type\")),\n              field(\"Training_Group__c\", dataValue(\"form.case.@case_id\")),\n              field(\"Farm_Visited__c\", dataValue(\"form.farm_being_visted\")),\n              field(\"Primary_Farmer_PIMA_ID__c\", dataValue(\"form.farm_being_visted\")),\n              field(\"Secondary_Farmer__c\", function(state){\n                  var secondaryFarmer = '';\n                  if(dataValue(\"form.secondary_farmer_available\")(state) == 'yes' && dataValue(\"form.secondary_farmer\")(state) !== ''){\n                    secondaryFarmer = dataValue(\"form.secondary_farmer\");\n                  }\n                  return secondaryFarmer;\n              }),\n              field(\"Secondary_Farmer_PIMA_ID__c\", function(state){\n                  var secondaryFarmer = '';\n                  if(dataValue(\"form.secondary_farmer_available\")(state) == 'yes' && dataValue(\"form.secondary_farmer\")(state) !== ''){\n                    secondaryFarmer = dataValue(\"form.secondary_farmer\");\n                  }\n                  return secondaryFarmer;\n              }),\n              field(\"Visit_Has_Training__c\", dataValue(\"form.is_this_a_farm_training_visit\")),\n            //  field(\"Training_Session__c\", dataValue(\"form.training_session\")),\n              field(\"Other_Participants_Present__c\", dataValue(\"form.any_other_participants_present\")),\n              field(\"Total_Farmers_Visited__c\", dataValue(\"form.attendance_count\")),\n              field(\"Date_Visited__c\", dataValue(\"form.date_of_visit\")),\n              field(\"visit_comments__c\", dataValue(\"form.farm_visit_comments\")),\n              field(\"Farmer_Trainer__c\", dataValue(\"form.trainer\")),\n              field(\"No_of_curedas__c\", dataValue(\"form.opening_questions.number_of_curedas\")),\n              field(\"No_of_separate_coffee_fields__c\", dataValue(\"form.opening_questions.number_of_separate_coffee_fields\")),\n              field(\"Field_Age__c\", dataValue(\"form.field_age\")),\n              field(\"Field_Size__c\", function(state){\n                  var fieldSize = '';\n                  if(dataValue(\"form.field_size\")(state) !== undefined && dataValue(\"form.field_size\")(state) !== ''){\n                    fieldSize = dataValue(\"form.field_size\");\n                  }\n                  else if(dataValue(\"form.field_size1\")(state) !== undefined && dataValue(\"form.field_size1\")(state) !== ''){\n                    fieldSize = dataValue(\"form.field_size1\");\n                  }\n                  \n                  return fieldSize;\n                  \n              }),\n              field(\"Farm_Visit_Photo_Url__c\", function(state) {\n                  var farmVisitPhotoUrl = '';\n                  if (dataValue(\"form.farm_visit_photo\")(state) !== undefined && dataValue(\"form.farm_visit_photo\")(state) !== '') {\n                      farmVisitPhotoUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + dataValue(\"form.farm_visit_photo\")(state);\n                  }\n                  return farmVisitPhotoUrl;\n              }),\n              field(\"Signature__c\", function(state) {\n                  var recorderSignatureUrl = '';\n                  if (dataValue(\"form.signature_of_farmer_trainer\")(state) !== undefined && dataValue(\"form.signature_of_farmer_trainer\")(state) !== '') {\n                      recorderSignatureUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + dataValue(\"form.signature_of_farmer_trainer\")(state);\n                  }\n                  return recorderSignatureUrl;\n              }),\n              field('Location_GPS__Latitude__s', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[0];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n                  return '';\n              }),\n              field('Location_GPS__Longitude__s', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[1];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n                  return '';\n              }),\n              field('Altitude__c', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[2];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n              return '';\n              })\n          )\n      )\n  );\n  \n    //insert the farm visit record for AA Level\n  each(\n      \"$.data\",\n      upsertIf(state.data.form['@name'] == 'Farm Visit - AA',\n      \"Farm_Visit__c\", \"FV_Submission_ID__c\",\n          fields(\n              field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n              field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n              field(\"Farm_Visit_Type__c\", dataValue(\"form.survey_type\")),\n              field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n              field(\"Farm_Visited__c\", function(state){\n                const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n                if(visitedFarmers){\n                  return visitedFarmers.split(\" \")[0];\n                }\n              }),\n              field(\"Primary_Farmer_PIMA_ID__c\", function(state){\n                const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n                if(visitedFarmers){\n                  return visitedFarmers.split(\" \")[0];\n                }\n              }),\n              \n              field(\"Secondary_Farmer__c\", function(state){\n                const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n                var result = '';\n                if(visitedFarmers.length > 1){\n                  result = visitedFarmers.split(\" \")[1];\n                }\n                return result;\n              }),\n              \n              field(\"Secondary_Farmer_PIMA_ID__c\", function(state){\n                const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n                var result = '';\n                if(visitedFarmers.length > 1){\n                  result = visitedFarmers.split(\" \")[1];\n                }\n                return result;\n              }),\n              field(\"Visit_Has_Training__c\", dataValue(\"form.is_this_a_farm_training_visit\")),\n            //  field(\"Training_Session__c\", dataValue(\"form.training_session\")),\n              field(\"Other_Participants_Present__c\", dataValue(\"form.any_other_participants_present\")),\n              field(\"Total_Farmers_Visited__c\", dataValue(\"form.attendance_count\")),\n              field(\"Date_Visited__c\", dataValue(\"form.date_of_visit\")),\n              field(\"visit_comments__c\", dataValue(\"form.farm_visit_comments\")),\n              field(\"Farmer_Trainer__c\", dataValue(\"form.trainer\")),\n              field(\"No_of_curedas__c\", dataValue(\"form.opening_questions.number_of_curedas\")),\n              field(\"No_of_separate_coffee_fields__c\", dataValue(\"form.opening_questions.number_of_separate_coffee_fields\")),\n              field(\"Field_Age__c\", dataValue(\"form.field_age\")),\n              field(\"Field_Size__c\", function(state){\n                  var fieldSize = '';\n                  if(dataValue(\"form.field_size\")(state) !== undefined && dataValue(\"form.field_size\")(state) !== ''){\n                    fieldSize = dataValue(\"form.field_size\");\n                  }\n                  else if(dataValue(\"form.field_size1\")(state) !== undefined && dataValue(\"form.field_size1\")(state) !== ''){\n                    fieldSize = dataValue(\"form.field_size1\");\n                  }\n                  \n                  return fieldSize;\n                  \n              }),\n              field(\"Farm_Visit_Photo_Url__c\", function(state) {\n                  var farmVisitPhotoUrl = '';\n                  if (dataValue(\"form.farm_visit_photo\")(state) !== undefined && dataValue(\"form.farm_visit_photo\")(state) !== '') {\n                      farmVisitPhotoUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + dataValue(\"form.farm_visit_photo\")(state);\n                  }\n                  return farmVisitPhotoUrl;\n              }),\n              field(\"Signature__c\", function(state) {\n                  var recorderSignatureUrl = '';\n                  if (dataValue(\"form.signature_of_farmer_trainer\")(state) !== undefined && dataValue(\"form.signature_of_farmer_trainer\")(state) !== '') {\n                      recorderSignatureUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + dataValue(\"form.signature_of_farmer_trainer\")(state);\n                  }\n                  return recorderSignatureUrl;\n              }),\n              field('Location_GPS__Latitude__s', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[0];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n                  return '';\n              }),\n              field('Location_GPS__Longitude__s', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[1];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n                  return '';\n              }),\n              field('Altitude__c', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[2];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n              return '';\n              }),\n              field('FV_AA_Farmer_1_Attended_Any_Training__c', function(state){\n                var result = '';\n                if(dataValue('form.farmer_1_questions.attended_training')(state) == 1){\n                  result = 'Yes';\n                }\n                else if(dataValue('form.farmer_1_questions.attended_training')(state) == 0){\n                  result = 'No';\n                }\n                return result;\n              }),\n              field('FV_AA_Farmer_2_Attended_Any_Training__c', function(state){\n                var result = '';\n                if(dataValue('form.farmer_2_questions.attended_training')(state) == 1){\n                  result = 'Yes';\n                }\n                else if(dataValue('form.farmer_2_questions.attended_training')(state) == 0){\n                  result = 'No';\n                }\n                return result;\n              }),\n              field('FV_AA_Farmer_1_Trainings_Attended__c', dataValue('form.farmer_1_questions.number_of_trainings')),\n              field('FV_AA_Farmer_2_Trainings_Attended__c', dataValue('form.farmer_2_questions.number_of_trainings')),\n              field('FV_AA_Visit_Done_By_AA__c', 'Yes'),\n              field('Training_Session__c', dataValue('form.training_session'))\n          )\n      )\n  );\n  \n  // Update Household Record \n  each(\"$.data\", \n    upsertIf(state.data.form['@name'] == 'Farm Visit - AA', \n      \"Household__c\", \"Id\",\n      fields(\n        field(\"Id\", state.data.form.case[\"@case_id\"]),\n        field(\"FV_AA_Visited__c\", dataValue(\"form.case.update.FV_AA_Visited\")(state)),\n        relationship(\n          \"Latest_Farm_Visit_Record__r\",\n          \"FV_Submission_ID__c\",\n          \"FV-\" + dataValue(\"id\")(state)\n          )\n        )\n      )\n  );\n\n    //Best Practices :: Main Stem && Weeding &&  Shade Control && Record Keeping && Compost && Erosion Control && Nutrition\n  each(\n      \"$.data\",\n      upsert(\"FV_Best_Practices__c\", \"FV_Submission_ID__c\",\n          fields(\n              field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n              field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n              relationship(\"Farm_Visit__r\", \"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n              //main stems\n                field(\"number_of_main_stems_on_majority_trees__c\", dataValue(\"form.main_stems.number_of_main_stems_on_majority_trees\")),\n          \n          /*    field(\"number_of_main_stems_on_majority_trees__c\", function(state){\n                \n                var numberOfMainStems = dataValue(\"form.main_stems.number_of_main_stems_on_majority_trees\")(state);\n                var returnNumberOfMainStems = 0;\n                \n                if (numberOfMainStems !== undefined && numberOfMainStems !== '') {\n                    returnNumberOfMainStems = numberOfMainStems;\n                }\n                \n                return returnNumberOfMainStems;\n                \n              }),\n              \n          */    \n              field(\"photo_of_trees_and_average_main_stems__c\", function(state){\n                \n                var mainStemsPhotoURL = \"\";\n                if(dataValue(\"form.main_stems.trees_and_main_stems_photo\")(state) !== undefined && dataValue(\"form.main_stems.trees_and_main_stems_photo\")(state) !== '') {\n                  mainStemsPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.main_stems.trees_and_main_stems_photo\")(state);  \n                 }\n                 return mainStemsPhotoURL;\n                 \n              }),\n\n              //nutrition\n              field(\"Color_of_coffee_tree_leaves__c\", function(state){\n                \n                var colorOfCoffeeLeaves = dataValue(\"form.nutrition.are_the_leave_green_or_yellow_pale_green\")(state);\n                var returnColorOfCoffeeLeaves = \"\";\n                \n                if(colorOfCoffeeLeaves !== undefined && colorOfCoffeeLeaves !== '' && colorOfCoffeeLeaves == 0){\n                  \n                  returnColorOfCoffeeLeaves = \"5% or more (5 or more in 100) of the leaves are yellow, pale green or brown.\";\n                  \n                }\n\n                if(colorOfCoffeeLeaves !== undefined && colorOfCoffeeLeaves !== '' && colorOfCoffeeLeaves == 1){\n                  \n                  returnColorOfCoffeeLeaves = \"Nearly all leaves are dark green and less than 5% (less than 5 in 100) are yellow, pale green, or brown.\";\n                  \n                }\n\n                return returnColorOfCoffeeLeaves;\n\n              }),\n\n              //weeding\n              field(\"how_many_weeds_under_canopy_and_how_big__c\", function(state){\n                \n                var weedsUnderCanopy = dataValue(\"form.weeding.how_many_weeds_under_canopy_and_how_big_are_they\")(state);\n                var returnWeedsUnderCanopy = \"\";\n        \n                if(weedsUnderCanopy == 1){\n        \n                  returnWeedsUnderCanopy = \"Few small weeds (less than 30cm) under the tree canopy\";\n        \n                }\n        \n                if(weedsUnderCanopy == 2){\n        \n                  returnWeedsUnderCanopy = \"Many small weeds under the tree canopy (ground is covered with weeds)\";\n        \n                }\n        \n                if(weedsUnderCanopy == 3){\n        \n                  returnWeedsUnderCanopy = \"Many large weeds under the tree canopy (ground is covered with weeds)\";\n        \n                }\n\n                  return returnWeedsUnderCanopy;\n\n              }),\n\n              //Health of New Planting (Yves might need to add a new Object for this)\n              field(\"health_of_new_planting_choice__c\", function(state){\n  \n                  var healthNewPlanting = dataValue(\"form.health_of_new_planting.health_of_new_planting_choice\")(state);\n                  var returnhealthNewPlanting = \"\";\n  \n                  if(healthNewPlanting == 1){\n  \n                      returnhealthNewPlanting = \"The majority of trees are green and healthy and have grown well\";\n  \n                  }\n  \n                  if(healthNewPlanting == 2){\n  \n                      returnhealthNewPlanting = \"The majority of trees look stressed and growth is slow\";\n  \n                  }\n  \n                  if(healthNewPlanting == 3){\n  \n                      returnhealthNewPlanting = \"The majority of trees have dried up or died\";\n  \n                  }\n\n              return returnhealthNewPlanting;\n\n          }),\n\n          field(\"photo_of_trees_and_average_main_stems__c\", function(state){\n                \n              var healthPhotoURL = \"\";\n              if(dataValue(\"form.main_stems.health_of_trees_photo\")(state) !== undefined && dataValue(\"form.main_stems.health_of_trees_photo\")(state) !== '') {\n                  healthPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.main_stems.trees_and_main_stems_photo\")(state);  \n               }\n               return healthPhotoURL;\n               \n            }),\n\n             field(\"Have_herbicides_been_used_on_the_field__c\", dataValue(\"form.weeding.used_herbicides\")),\n              // field(\"Herbicide_products_used_on_farm__c\", function(state){\n                \n              //   var herbicideUsed = dataValue(\"form.weeding.which_product_have_you_used\")(state);\n              //   var returnHerbicideUsed = \"EMPTY\";\n                \n              //   if(herbicideUsed !== undefined && herbicideUsed == 1){\n                  \n              //     returnHerbicideUsed = \"Glyphosate (Eg Round Up)\";\n                  \n              //   }\n                \n              //   if(herbicideUsed !== undefined && herbicideUsed == 2){\n                  \n              //     returnHerbicideUsed = \"Paraquat (Eg. Gramoxone)\";\n                  \n              //   }\n\n              //   if(herbicideUsed !== undefined && herbicideUsed == 3){\n                  \n              //     returnHerbicideUsed = dataValue(\"form.weeding.ask_which_other_product_have_you_use\")(state);\n                  \n              //   }                  \n\n              //   return returnHerbicideUsed;\n                \n              // }),\n              \n              field(\"photo_of_weeds_under_the_canopy__c\", function(state){\n                \n                var weedsPhotoUrl = dataValue(\"form.weeding.weeds_under_the_canopy_photo\")(state);\n                var returnWeedsPhotoUrl = \"\";\n                \n                if (weedsPhotoUrl !== undefined && weedsPhotoUrl !== '') {\n                    returnWeedsPhotoUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + weedsPhotoUrl;\n                }\n                \n                return returnWeedsPhotoUrl;\n                \n              }),\n\n              //shade management\n              field(\"level_of_shade_present_on_the_farm__c\", function(state){\n                \n                var levelOfShadeOnPlot = dataValue(\"form.shade_control.level_of_shade_present_on_the_farm\")(state);\n                var returnLevelOfShadeOnPlot = \"\";\n                \n                if(levelOfShadeOnPlot == 0){\n                  \n                  returnLevelOfShadeOnPlot = \"NO shade, less than 5%\";\n                  \n                }\n                \n                if(levelOfShadeOnPlot == 1){\n                  \n                  returnLevelOfShadeOnPlot = \"Light shade, 5 to 20%\";\n                  \n                }\n                \n                if(levelOfShadeOnPlot == 2){\n                  \n                  returnLevelOfShadeOnPlot = \"Medium shade, 20 to 40%\";\n                  \n                }\n                \n                if(levelOfShadeOnPlot == 3){\n                  \n                  returnLevelOfShadeOnPlot = \"Heavy shade, over 40%\";\n                  \n                }\n                \n                return returnLevelOfShadeOnPlot;\n\n              }),\n              \n              // field(\"have_new_shade_been_planted_last_3_years__c\", function(state){\n                \n              //   var newShadePlanted = dataValue(\"form.shade_control.new_shade_trees_in_the_last_3_years\")(state);\n              //   var returnNewShadePlanted = \"\";\n                \n              //   if(newShadePlanted == 0){\n                  \n              //     returnNewShadePlanted = \"No\";\n                  \n              //   }\n\n              //   if(newShadePlanted == 1){\n                  \n              //     returnNewShadePlanted = \"Yes\";\n                  \n              //   }\n\n              //   return returnNewShadePlanted;\n\n              // }),\n              \n              field(\"photo_of_level_of_shade_on_the_plot__c\", function(state) {\n                \n                var shadePhotoUrl = '';\n                if(dataValue(\"form.shade_control.photo_of_level_of_shade_on_the_plot\")(state) !== undefined && dataValue(\"form.shade_control.photo_of_level_of_shade_on_the_plot\")(state) !== '') {\n                  shadePhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.photo\")(state);\n                  \n                }\n                \n                return shadePhotoUrl;\n                \n              }),\n              \n              // Yves needs to Add Object\n              field(\"planted_intercrop_bananas__c\", function(state){\n                \n                  var bananaShadePlanted = dataValue(\"form.shade_control.planted_intercrop_bananas\")(state);\n                  var returnbananaShadePlanted = \"\";\n                  \n                  if(bananaShadePlanted == \"no\"){\n                    \n                      returnbananaShadePlanted = \"No\";\n                    \n                  }\n\n                  if(bananaShadePlanted == \"yes\"){\n                    \n                      returnbananaShadePlanted = \"Yes\";\n                    \n                  }\n\n                  return returnbananaShadePlanted;\n\n                }),\n                \n                //Yves needs to add object\n                field(\"photograph_intercrop_bananas__c\", function(state) {\n                  \n                  var bananashadePhotoUrl = '';\n                  if(dataValue(\"form.shade_control.photograph_intercrop_bananas\")(state) !== undefined && dataValue(\"form.shade_control.photograph_intercrop_bananas\")(state) !== '') {\n                      bananashadePhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.photo\")(state);\n                    \n                  }\n                  \n                  return bananashadePhotoUrl;\n                  \n                }),\n\n\n              //compost manure\n              field(\"do_you_have_compost_manure__c\", function(state){\n                \n                var haveCompostManure = dataValue(\"form.compost.do_you_have_compost_manure\")(state);\n                var returnHaveCompostManure = \"\";\n                \n                if(haveCompostManure !== undefined && haveCompostManure !== '' && haveCompostManure == 0){\n                  \n                  returnHaveCompostManure = \"No\";\n                  \n                }\n                \n                if(haveCompostManure !== undefined && haveCompostManure !== '' && haveCompostManure == 1){\n                  \n                  returnHaveCompostManure = \"Yes\";\n                  \n                }\n                \n                return returnHaveCompostManure;\n\n              }),\n\n              field(\"photo_of_the_compost_manure__c\", function(state) {\n                \n                var compostPhotoUrl = '';\n                if(dataValue(\"form.compost.photo_of_the_compost_manure\")(state) !== undefined && dataValue(\"form.compost.photo_of_the_compost_manure\")(state) !== '') {\n                  compostPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.compost.photo_of_the_compost_manure\")(state);\n                  \n                }\n                \n                return compostPhotoUrl;\n                \n              }),\n\n              //erosion control\n          /*    field(\"take_a_photo_of_erosion_control__c\", function(state) {\n                \n                var erosionPhotoUrl = '';\n                if(dataValue(\"form.erosion_control.photo_of_erosion_control_method\")(state) !== undefined && dataValue(\"form.erosion_control.photo_of_erosion_control_method\")(state) !== '') {\n                  erosionPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.photo_of_erosion_control_method\")(state);\n                  \n                }\n                \n                return erosionPhotoUrl;\n                \n              }),\n          */\n              field(\"Stabilizing_Grasses_Photo_URL__c\", function(state){                    \n\n                  var sgPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.stabilizing_grasses_image\")(state) !== undefined && dataValue(\"form.erosion_control.stabilizing_grasses_image\")(state) !== '') {\n                      sgPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.stabilizing_grasses_image\")(state); \n                  } \n\n                  return sgPhotoURL;                \n              }),\n              field(\"Mulch_Photo_URL__c\", function(state){                    \n\n                  var mulchPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.mulch_image\")(state) !== undefined && dataValue(\"form.erosion_control.mulch_image\")(state) !== '') {\n                      mulchPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.mulch_image\")(state); \n                  } \n\n                  return mulchPhotoURL;                \n              }),\n              field(\"Water_Traps_Photo_URL__c\", function(state){                    \n\n                  var wtPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.water_traps_or_trenches_image\")(state) !== undefined && dataValue(\"form.erosion_control.water_traps_or_trenches_image\")(state) !== '') {\n                      wtPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.water_traps_or_trenches_image\")(state); \n                  } \n\n                  return wtPhotoURL;                \n              }),\n              field(\"Physical_Barriers_Photo_URL__c\", function(state){                    \n\n                  var pbPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.physical_barriers_image\")(state) !== undefined && dataValue(\"form.erosion_control.physical_barriers_image\")(state) !== '') {\n                      pbPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.physical_barriers_image\")(state); \n                  } \n\n                  return pbPhotoURL;                \n              }),\n              field(\"Terraces_Photo_URL__c\", function(state){                    \n\n                  var terracesPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.terraces_image\")(state) !== undefined && dataValue(\"form.erosion_control.terraces_image\")(state) !== '') {\n                      terracesPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.terraces_image\")(state); \n                  } \n\n                  return terracesPhotoURL;                \n              }),\n              field(\"Contour_Planting_Photo_URL__c\", function(state){                    \n\n                  var cpPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.contour_planting_image\")(state) !== undefined && dataValue(\"form.erosion_control.contour_planting_image\")(state) !== '') {\n                      cpPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.contour_planting_image\")(state); \n                  } \n\n                  return cpPhotoURL;                \n              }),\n              field(\"Cover_Crop_Photo_URL__c\", function(state){                    \n\n                  var ccPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.bean_or_arachis_cover_crop_image\")(state) !== undefined && dataValue(\"form.erosion_control.bean_or_arachis_cover_crop_image\")(state) !== '') {\n                      ccPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.bean_or_arachis_cover_crop_image\")(state); \n                  } \n\n                  return ccPhotoURL;                \n              }),\n\n              //record keeping\n              field(\"do_you_have_a_record_book__c\", function(state){\n                \n                var haveRecordBook = dataValue(\"form.record_keeping.do_you_have_a_record_book\")(state);\n                var returnHaveRecordBook = \"\";\n                \n                if(haveRecordBook == 0){\n                  \n                  returnHaveRecordBook = \"No\";\n                  \n                }\n                \n                if(haveRecordBook == 1){\n                  \n                  returnHaveRecordBook = \"Yes\";\n                  \n                }\n                \n                return returnHaveRecordBook;\n\n              }),\n\n              field(\"are_there_records_on_the_record_book__c\", function(state){\n                \n                var recordsOnRecordBook = dataValue(\"form.record_keeping.are_there_records_on_the_record_book\")(state);\n                var returnRecordsOnRecordBook = \"\";\n                \n                if(recordsOnRecordBook !== undefined && recordsOnRecordBook !== '' && recordsOnRecordBook == 0){\n                  \n                  returnRecordsOnRecordBook = \"No\";\n                  \n                }\n                \n                if(recordsOnRecordBook !== undefined && recordsOnRecordBook !== '' && recordsOnRecordBook == 1){\n                  \n                  returnRecordsOnRecordBook = \"Yes\";\n                  \n                }\n                \n                return returnRecordsOnRecordBook;\n                \n              }),\n\n              field(\"take_a_photo_of_the_record_book__c\", function(state){\n                \n                var recordBookPhotoUrl = '';\n                if(dataValue(\"form.record_keeping.take_a_photo_of_the_record_book\")(state) !== undefined && dataValue(\"form.record_keeping.take_a_photo_of_the_record_book\")(state) !== '') {\n                  recordBookPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.record_keeping.take_a_photo_of_the_record_book\")(state) !== undefined && dataValue(\"form.record_keeping.take_a_photo_of_the_record_book\")(state);\n               \n                }\n                \n                return recordBookPhotoUrl;\n                \n              })\n          )\n      )\n  );\n\n//if (state.data.app_id == \"e16e09252eb942a788bd6600e6ceeb28\") {\n\n    //loop through participants and insert in database\n/*    beta.each(\n\n        function(state) {\n            if (state.data.form.present_participants) {\n                return state.data.form.present_participants.split(\" \").map(\n                    function(pId) {\n                        return {\n                            participant: pId,\n                            session: dataValue(\"form.training_session\")(state),\n                            att_submission: dataValue(\"form.training_session\")(state) + pId,\n                            fv_submission: \"FV-\" + dataValue(\"id\")(state),\n                            sessionPhoto: dataValue(\"form.photo\")(state)\n                        };\n                    }\n                );\n            }\n        },\n        upsert(\"FV_Attendance__c\", \"Submission_ID__c\",\n            fields(\n                field(\"Submission_ID__c\", dataValue(\"att_submission\")), //attendance submission_id\n                field(\"FV_Submission_ID__c\", dataValue(\"fv_submission\")), //farm visit submission_id\n                field(\"Status__c\", \"Present\"),\n                relationship(\"Training_Session__r\", \"CommCare_Case_Id__c\", dataValue(\"session\")),\n                relationship(\"Participant__r\", \"CommCare_Case_Id__c\", dataValue(\"participant\"))\n            )\n        )\n\n    );\n*/\n\t//Farm Visit Best Practice Results\n    //loop through methods of erosion control and insert into database :: Erosion Control BP\n    beta.each(\n\n      function(state) {\n\n          //incoming erosion data\n          var best_practice_results_data = dataValue(\"form.erosion_control.methods_of_erosion_control\")(state);\n\n          if (best_practice_results_data !== undefined) {\n\n              return best_practice_results_data.split(\" \").map(\n                \n                  function(resultId) {\n                      return {\n                          result_data: resultId,\n                          best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_erosion_\" + resultId,\n                          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n                      };\n                  }\n                  \n              );\n\n          }\n      },\n      upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n          fields(\n              field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n              field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n              relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n              field(\"Best_Practice_Result_Type__c\", \"Erosion Control\"),//this is the actual result type\n              field(\"Best_Practice_Result_Description__c\", function(state){\n                \n                  var returnResults = \"\";\n                \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                      returnResults = \"Stabilizing grasses\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                      returnResults = \"Mulch\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                      returnResults = \"Water traps or trenches\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n                      returnResults = \"Physical barriers. (e.g. rocks)\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n                      returnResults = \"Terraces\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"6\"){\n\n                      returnResults = \"Contour planting\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"7\"){\n\n                      returnResults = \"Bean or Arachis cover crop between the rows\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n                      returnResults = \"No erosion control method seen\";\n\n                  }\n                  \n                  return returnResults;\n                \n              })                \n          )\n      )\n  );\n\n\n  //loop through chemical/fertilizier applied and insert into database :: Nutrition BP\n  beta.each(\n\n      function(state) {\n\n          //incoming chemical/fertilizer used data\n          var best_practice_results_data = dataValue(\"form.nutrition.type_chemical_applied_on_coffee_last_12_months\")(state);\n\n          if (best_practice_results_data !== undefined) {\n\n              return best_practice_results_data.split(\" \").map(\n                \n                  function(resultId) {\n                      return {\n                          result_data: resultId,\n                          best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_fertilizer_\" + resultId,\n                          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n                      };\n                  }\n                  \n              );\n\n          }\n      },\n      upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n          fields(\n              field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n              field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n              relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n              field(\"Best_Practice_Result_Type__c\", \"Chemicals and Fertilizers Applied\"), //this is the actual result type\n              field(\"Best_Practice_Result_Description__c\", function(state){\n                \n                  var returnResults = \"\";\n                \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                      returnResults = \"Compost\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                      returnResults = \"Manure\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                      returnResults = \"Lime\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n                      returnResults = \"Compound S\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n                      returnResults = \"Compound J\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"6\"){\n\n                      returnResults = \"Single Super Phosphate (SSP)\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"7\"){\n\n                      returnResults = \"Zinc/Boron Foliar Feed (Tracel)\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"8\"){\n\n                      returnResults = \"Ammonium Nitrate\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n                      returnResults = \"Did NOT apply any fertilizer in past 12 months\";\n\n                  }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"9\"){\n\n                  //     returnResults = \"Agricultural lime - Calcium Carbonate\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"10\"){\n\n                  //     returnResults = \"Foliar Zinc or Boron\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"11\"){\n\n                  //     returnResults = \"General Foliar Feed (Nurish, Ferquido Ferqan)\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"12\"){\n\n                  //     returnResults = \"Nutrical (cal dolomita)\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"13\"){\n\n                  //     returnResults = \"15-5-10+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"14\"){\n\n                  //     returnResults = \"20-5-10+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"15\"){\n\n                  //     returnResults = \"15-15-15+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"16\"){\n\n                  //     returnResults = \"10-5-20+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"17\"){\n\n                  //     returnResults = \"20-5-20+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"18\"){\n\n                  //     returnResults = \"12-5-15+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"19\"){\n\n                  //     returnResults = \"14-7-19+3MGO+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"20\"){\n\n                  //     returnResults = \"Caldo bordeles\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"21\"){\n\n                  //     returnResults = \"Foliar - lixiviado de bioinsumo (lombricomposta o equivalente)\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"22\"){\n\n                  //     returnResults = \"Urea\";\n\n                  // }\n\n                  return returnResults;\n                \n              })\n          )\n      )\n\n  );\n\n\n  //loop through methods of controlling coffee berry borer :: Integrated Pest and Disease Management BP\n  beta.each(\n\n      function(state) {\n\n          //incoming coffee berry borer data\n          var best_practice_results_data = dataValue(\"form.pest_disease_management.methods_of_controlling_coffee_berry_borer\")(state);\n\n          if (best_practice_results_data !== undefined) {\n\n              return best_practice_results_data.split(\" \").map(\n                \n                  function(resultId) {\n                      return {\n                          result_data: resultId,\n                          best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_cbb_\" + resultId,\n                          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n                      };\n                  }\n                  \n              );\n\n          }\n      },\n      upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n          fields(\n              field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n              field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n              relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n              field(\"Best_Practice_Result_Type__c\", \"Management of Coffee Berry Borer (CBB)\"), //this is the actual result type\n              field(\"Best_Practice_Result_Description__c\", function(state){\n                \n                  var returnResults = \"\";\n                \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                      returnResults = \"Reduce pesticide use and/or encourage natural predators and parasites - beneficial insects.\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                      returnResults = \"Strip all berries at the end of harvest, known as crop hygiene\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                      returnResults = \"Harvest ripe cherries regularly - to reduce pest and disease levels\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n                      returnResults = \"Use berry borer traps\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n                      returnResults = \"Collect fallen berries at the end of the season - crop hygiene\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"6\"){\n\n                      returnResults = \"Feed the tree well to keep it healthy\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"7\"){\n\n                      returnResults = \"Use good agricultural practices such as weeding or mulching to reduce stress and keep trees healthy\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"8\"){\n\n                      returnResults = \"Prune to keep the canopy open\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"9\"){\n\n                      returnResults = \"Renovate (new planting) or rejuvenate regularly to keep main stems less than 8 years old\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"10\"){\n\n                      returnResults = \"Plant and grow disease resistant varieties\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"11\"){\n\n                      returnResults = \"Smooth the bark to reduce egg laying sites for While Coffee Borer\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"12\"){\n\n                      returnResults = \"Spray regular pesticides\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"13\"){\n\n                      returnResults = \"Spray homemade herbal or botanical pesticides\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n                      returnResults = \"Does not know any methods\";\n\n                  }\n\n                  return returnResults;\n                \n              })\n          )\n      )\n\n  );\n\n\n  //loop through methods of controlling leaf rust :: Integrated Pest and Disease Management\n  // beta.each(\n\n  //     function(state) {\n\n  //         //incoming coffee leaf rust data\n  //         var best_practice_results_data = dataValue(\"form.pest_disease_management.methods_of_controlling_coffee_leaf_rust\")(state);\n\n  //         if (best_practice_results_data !== undefined) {\n\n  //             return best_practice_results_data.split(\" \").map(\n                \n  //                 function(resultId) {\n  //                     return {\n  //                         result_data: resultId,\n  //                         best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_clr_\" + resultId,\n  //                         farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n  //                     };\n  //                 }\n                  \n  //             );\n\n  //         }\n  //     },\n  //     upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n  //         fields(\n  //             field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n  //             field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n  //             field(\"Best_Practice_Result_Type__c\", \"Management of Coffee Leaf Rust (CLR)\"), //this is the actual result type\n  //             field(\"Best_Practice_Result_Description__c\", function(state){\n                \n  //                 var returnResults = \"\";\n                \n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n  //                     returnResults = \"Feed the tree well to keep it healthy\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n  //                     returnResults = \"Use good agricultural practices such as weeding or mulching to reduce stress and keep trees healthy\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n  //                     returnResults = \"Prune or keep canopy open\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n  //                     returnResults = \"Spray fungicides\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n  //                     returnResults = \"Grow resistant varieties\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n  //                     returnResults = \"Does not know any methods\";\n\n  //                 }\n\n  //                 return returnResults;\n                \n  //             })\n  //         )\n  //     )\n\n  // );\n  \n\n  //loop through pruning methods :: Pruning BP  \n    beta.each(\n\n      function(state) {\n\n          //incoming pruning data\n          var best_practice_results_data = dataValue(\"form.pruning.pruning_method_on_majority_trees\")(state) || \"\";\n\n          if (best_practice_results_data !== undefined) {\n\n              return best_practice_results_data.split(\" \").map(\n                \n                  function(resultId) {\n                      return {\n                          result_data: resultId,\n                          best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_pruning_\" + resultId,\n                          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n                          field_age: dataValue(\"form.field_age\")(state)\n                      };\n                  }\n                  \n              );\n\n          }\n      },\n      upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n          fields(\n              field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n              field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n              relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n              field(\"Best_Practice_Result_Type__c\", \"Pruning\"), //this is the actual result type\n              field(\"Best_Practice_Result_Description__c\", function(state){\n                \n                  var returnResults = \"\";\n                  var field_age = dataValue(\"field_age\")(state);\n                  console.log(\"The string field age is: \");\n                  console.log(field_age);\n                  const numeric_field_age = parseInt(field_age);\n                  console.log(\"The numeric field age is: \");\n                  console.log(numeric_field_age);\n                \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                      returnResults = \"Centers opened\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                      returnResults = \"Unwanted suckers removed\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                      returnResults = \"Dead branches removed\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n                      returnResults = \"Branches touching the ground removed\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n                      returnResults = \"Broken / unproductive stems and/or branches removed\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n                      returnResults = \"No pruning methods used\";\n\n                  }\n                  else if(numeric_field_age < 3) {\n                      returnResults = 'N/A';\n                  }\n\n                  return returnResults;\n                \n              })\n          )\n      )\n\n  );\n\n  beta.each(\n\n    function(state) {\n\n        //incoming pruning data\n        var best_practice_results_data = dataValue(\"form.weeding.which_product_have_you_used\")(state) || \"\";\n        var otherProduct = dataValue(\"form.weeding.ask_which_other_product_have_you_used\")(state);\n        console.log(\"debug\", otherProduct);\n        if (best_practice_results_data !== undefined) {\n\n            return best_practice_results_data.split(\" \").map(\n              \n                function(resultId) {\n                    return {\n                        result_data: resultId,\n                        best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_weeding_\" + resultId,\n                        farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n                        other_submission: otherProduct\n                    };\n                }\n                \n            );\n\n        }\n    },\n    upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n        fields(\n            field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n            field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n            relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n            field(\"Best_Practice_Result_Type__c\", \"Weeding\"), //this is the actual result type\n            field(\"Best_Practice_Result_Description__c\", function(state){\n              \n                var returnResults = \"\";\n              \n                if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                    returnResults = \"Glyphosate (Eg Round Up)\";\n\n                }\n\n                if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                    returnResults = \"Paraquat (Eg. Gramoxone)\";\n\n                }\n\n                if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                    returnResults = dataValue(\"other_submission\");\n                    console.log(\"debug\", dataValue(\"other_submission\"));\n                }\n                return returnResults;\n              \n            })\n        )\n    )\n\n);\n  \n    // Upsert Farm Data -- Households that haven't completed FIS\n// Upsert Farm Data -- Households that haven't completed FIS\nbeta.each(\n  substate=>{\n    const itemsFromRepeatGroup = [];\n    var createdObjects = [];\n    \n    var form = dataValue('form')(substate);\n\n    // Check if the property exists and return early if not\n    if (!form.hasOwnProperty(\"field_inventory_survey\")) {\n      console.log(\"No FIS to upsert\");\n      return itemsFromRepeatGroup; // Return an empty array to prevent further execution\n    }\n    \n    var fis_list = dataValue('form.households_completed_fis')(substate);\n    const hh_tns_id = dataValue('form.household_tns_id')(substate);\n\n    // Proceed with the logic if the property exists\n    if(fis_list.includes(hh_tns_id) === false){\n      var fisTag = fis_list;\n      console.log(\"This is the list of visited Households: \" + fisTag);\n      const householdId = hh_tns_id;\n      console.log(\"This is the household ID: \" + householdId);\n      const numberOfPlots = dataValue('form.field_inventory_survey.number_of_plots')(substate);\n      console.log(\"This is the number of plots: \" + numberOfPlots);\n      \n      if(numberOfPlots > 1){\n        dataValue('form.field_inventory_survey.general_plot_information')(substate).forEach((plot)=>{\n          itemsFromRepeatGroup.push(plot);\n        });\n      }\n      else{\n        itemsFromRepeatGroup.push(dataValue('form.field_inventory_survey.general_plot_information')(substate));\n      }\n      \n      console.log(itemsFromRepeatGroup);\n      return itemsFromRepeatGroup;\n    }\n  }, \n  upsertIf(\n    dataValue(\"current_index\") !== undefined,\n    \"Farm__c\", \"TNS_Id__c\",\n    fields(\n      field(\"TNS_Id__c\", function(substate){\n        const current_index = dataValue(\"current_index\")(substate);\n        var result = \"F-0\" + current_index + \"-\" + dataValue('form.household_tns_id')(state);\n        return result;\n      }),\n      field(\"Name\",  function(substate){\n        const current_index = dataValue(\"current_index\")(substate);\n        var result = \"0\" + current_index;\n        return result;\n      }),\n      field(\"Farm_Size_Coffee_Trees__c\", dataValue(\"total_coffee\")),\n      field(\"Farm_Size_Land_Measurements__c\", dataValue(\"farm_size_ha\")),\n      field(\"Main_Coffee_Field__c\", function(state){\n        var result = false;\n        if(dataValue(\"current_index\")(state) === \"1\"){\n          result = true;\n        }\n        return result;\n      }),\n      field(\"Planted_on_visit_date__c\", function(substate){\n        var result = false;\n        if(dataValue(\"important_notes_planting_dates.planting_period_note_same_date_as_visit\")(substate) === \"yes\"){\n          result = true;\n        }\n        return result;\n      }),\n      field(\"Planted_out_of_season__c\", function(substate){\n        var result = false;\n        if(dataValue(\"important_notes_planting_dates.planting_period_note_out_of_season\")(substate) === \"yes\"){\n          result = true;\n        }\n        return result;\n      }),\n      field(\"Planted_out_of_season_comments__c\", dataValue(\"important_notes_planting_dates.planting_period_comment_out_of_season\")),\n      field(\"Planting_Month_and_Year__c\", dataValue(\"date_planted\")),\n      field('Farm_GPS_Coordinates__Latitude__s', (substate) => {\n          const coords = dataValue(\"final_gps\")(substate);\n          if (coords) {\n            return coords.split(\" \")[0];\n          }\n          return '';\n      }),\n      field('Farm_GPS_Coordinates__Longitude__s', (substate) => {\n          const coords = dataValue(\"final_gps\")(substate);\n          if (coords) {\n            return coords.split(\" \")[1];\n          }\n          return '';\n      }),\n      field('Altitude__c', (substate) => {\n        const coords = dataValue(\"final_gps\")(substate);\n        if (coords) {\n          return coords.split(\" \")[2];\n        }\n        return '';\n      }),\n      field(\"Farm_Image_URL__c\", function(substate) {\n          var plotPhotoUrl = '';\n          if (dataValue(\"plot_photo\")(substate) !== undefined && dataValue(\"plot_photo\")(substate) !== '') {\n              plotPhotoUrl = \"https://www.commcarehq.org/a/\" + dataValue('domain')(state) + \"/api/form/attachment/\" + dataValue('metadata.instanceID')(state) + \"/\" + dataValue(\"plot_photo\")(substate);\n          }\n          return plotPhotoUrl;\n      }),\n      relationship(\"Household__r\", \"Household_ID__c\",function(substate){\n        var result = dataValue('form.household_tns_id')(state);\n        return result;\n      }),\n      relationship(\"Latest_Farm_Visit_Record__r\", \"FV_Submission_ID__c\", function(substate){\n        var result = \"FV-\" + dataValue('id')(state);\n        return result;\n      })\n    )\n  )\n);\n\n  \n  //Upsert FIS Variety data -- FT Level Farm Visit\n  \n  beta.each(\n  function(substate){\n    var createdObjects = [];\n    \n    var form = dataValue('form')(substate);\n    \n    // Check if the property exists and return early if not\n    if (!form.hasOwnProperty(\"field_inventory_survey\")) {\n      console.log(\"No FIS to upsert\");\n      return createdObjects; // Return an empty array to prevent further execution\n    }\n    \n    var fis_list = dataValue('form.households_completed_fis')(substate);\n    const hh_tns_id = dataValue('form.household_tns_id')(substate);\n\n    // Proceed with the logic if the property exists\n    if (fis_list.includes(hh_tns_id) === false) {\n      var fisTag = fis_list;\n      console.log(\"This is the list of visited Households: \" + fisTag);\n      const householdId = hh_tns_id;\n      console.log(\"This is the household ID: \" + householdId);\n      const numberOfPlots = dataValue('form.field_inventory_survey.number_of_plots')(substate);\n      console.log(\"This is the number of plots: \" + numberOfPlots);\n      \n      if (fisTag.includes(householdId) === false) {\n        if (numberOfPlots > 1) {\n          dataValue('form.field_inventory_survey.general_plot_information')(substate).forEach((item) => {\n            var varietiesList = item.varieties.split(\" \");\n            varietiesList.forEach((variety) => {\n              var varietyQuantity = item[`variety_${variety}`];\n              var createdObject = {\n                id: variety,\n                quantity: varietyQuantity,\n                plot: item.current_index,\n                other_variety: item.other_variety\n              };\n              createdObjects.push(createdObject);\n            });\n          });\n        } else {\n          const item = dataValue('form.field_inventory_survey.general_plot_information')(substate);\n          var varietiesList = item.varieties.split(\" \");\n          varietiesList.forEach((variety) => {\n            var varietyQuantity = item[`variety_${variety}`];\n            var createdObject = {\n              id: variety,\n              quantity: varietyQuantity,\n              plot: item.current_index,\n              other_variety: item.other_variety\n            };\n            createdObjects.push(createdObject);\n          });\n        }\n      }\n      console.log(\"Created Objects:\");\n      console.log(createdObjects);\n      return createdObjects;\n    }\n  },\n  upsertIf(dataValue(\"quantity\")!==undefined,\n  \"Coffee_Variety__c\", \"Name\",\n    fields(\n      field(\"Name\", function(substate){\n        console.log(\"Variety Number:\");\n        console.log(dataValue(\"id\")(substate));\n        console.log(dataValue(\"id\"));\n        const variety = dataValue(\"id\")(substate);\n        const plot = dataValue(\"plot\")(substate);\n        return \"CV-0\" + variety + \"-F-0\" + plot + \"-\" + dataValue('form.household_tns_id')(state);\n      }),\n      field(\"Variety_Type_Name__c\", function(substate){\n        var result = \"\";\n        if(dataValue(\"id\")(substate) == \"1\"){\n          result = \"Costa Rica 95\";\n        }\n        else if(dataValue(\"id\")(substate) == \"2\"){\n          result = \"SL28 or 34\";\n        }\n        else if(dataValue(\"id\")(substate) == \"3\"){\n          result = \"K7\";\n        }\n        else if(dataValue(\"id\")(substate) == \"4\"){\n          result = \"Catimor 129\";\n        }\n        else if(dataValue(\"id\")(substate) == \"5\"){\n          result = \"Catuai\";\n        }\n        else if(dataValue(\"id\")(substate) == \"6\"){\n          result = \"Yellow Catuai\";\n        }\n        else if(dataValue(\"id\")(substate) == \"7\"){\n          result = \"F6\";\n        }\n        else if(dataValue(\"id\")(substate) == \"8\"){\n          result = \"Caturra\";\n        }\n        else if(dataValue(\"id\")(substate) == \"9\"){\n          result = dataValue(\"other_variety\")(substate);\n        }\n        return result;\n      }),\n      field(\"Variety_Number_of_Trees__c\", dataValue(\"quantity\")),\n      relationship(\"Farm__r\", \"TNS_Id__c\", function(substate){\n        var result = \"F-0\" + dataValue(\"plot\")(substate) + \"-\" + dataValue('form.household_tns_id')(state);\n        return result;\n      })\n    )\n  )\n);\n\n  \n  // Upsert Latest Visit with FIS\n    beta.each(substate=>{\n      \n      var createdObject = [];\n      \n      var form = dataValue('form')(substate);\n    \n      // Check if the property exists and return early if not\n      if (!form.hasOwnProperty(\"field_inventory_survey\")) {\n        console.log(\"No FIS to upsert\");\n        return createdObject; // Return an empty array to prevent further execution\n      }\n      \n      var fis_list = dataValue('form.households_completed_fis')(substate);\n      const hh_tns_id = dataValue('form.household_tns_id')(substate);\n        \n      if(fis_list.includes(hh_tns_id) === false){\n        createdObject.push(substate);\n        return createdObject;\n      }\n    }, \n    upsert(\n      \"Household__c\", \"Household_ID__c\",\n      fields(\n        field(\"Household_ID__c\", dataValue('form.household_tns_id')(state)),\n        field(\"FIS_Completed__c\", true),\n        relationship(\n          \"Lastest_Visit_with_FIS__r\",\n          \"FV_Submission_ID__c\",\n          substate=>{\n            var result = \"FV-\" + dataValue(\"id\")(state);\n            return result;\n          }\n          )\n        )\n      )\n  );\n\n\n  //upsert training session\n/*    each(\n      \"$.data\",\n      upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n          fields(\n              field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n              field(\"Updated_from_CommCare__c\", true)\n          )\n      )\n  );\n*/\n\n//}\n",
          "adaptor": "@openfn/language-salesforce@4.6.5",
          "project_credential_id": "55f298ba-f7d3-442c-9c27-ff1825d583f6"
        }
      },
      "edges": {
        "webhook->Production---Farm-Visit---ZW---CommCare----Salesforce": {
          "enabled": true,
          "id": "e30ef3a2-4c20-4cf5-8daf-53607dc77936",
          "target_job_id": "259b5992-f922-426a-ade2-9c78252432d9",
          "source_trigger_id": "44aaefbb-e405-42c3-8125-0631b7956bfe",
          "condition_type": "js_expression",
          "condition_label": "Production - Farm Visit ZM 2022 CommCare  Salesforce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Farm Visit Full - ZM\""
        }
      }
    },
    "Production---Farm-Visit---KE---CommCare----Salesforce": {
      "id": "56b08ba0-2741-47d2-9761-3fdc95eb337b",
      "name": "Production - Farm Visit - KE - CommCare -- Salesforce",
      "inserted_at": "2025-02-12T06:56:31.870350Z",
      "lock_version": 5,
      "triggers": {
        "webhook": {
          "enabled": true,
          "id": "4ee52f51-0d76-444a-b711-c9701e48acce",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Farm-Visit---KE---CommCare----Salesforce": {
          "id": "c0cdd02b-7380-4888-97a6-73d345345348",
          "name": "Production - Farm Visit - KE - CommCare -- Salesforce",
          "body": "//FARM VISIT JOB FOR ALL KENYA PROJECTS\n//Production - Farm Visit :: KE 2023 | CommCare --> Salesforce | Farm Visit Full\n\n\n    //insert the farm visit record FT-Level\n    each(\n        \"$.data\",\n        upsertIf(state.data.form['@name'] == \"Farm Visit Full\",\n        \"Farm_Visit__c\", \"FV_Submission_ID__c\",\n            fields(\n                field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n                field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n                field(\"Farm_Visit_Type__c\", dataValue(\"form.survey_type\")),\n                field(\"Training_Group__c\", dataValue(\"form.case.@case_id\")),\n                field(\"Primary_Farmer_PIMA_ID__c\", dataValue(\"form.farm_being_visted\")),\n                field(\"Date_Visited__c\", dataValue(\"form.date_of_visit\")),\n                field(\"visit_comments__c\", dataValue(\"form.farm_visit_comments\")),\n                field(\"Farmer_Trainer__c\", dataValue(\"form.trainer\")),\n                field(\"Field_Size__c\", dataValue(\"form.field_size\")),\n                field(\"Farm_Visit_Photo_Url__c\", function(state) {\n                    var farmVisitPhotoUrl = '';\n                    if (dataValue(\"form.farm_visit_photo\")(state) !== undefined && dataValue(\"form.farm_visit_photo\")(state) !== '') {\n                        farmVisitPhotoUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + dataValue(\"form.farm_visit_photo\")(state);\n                    }\n                    return farmVisitPhotoUrl;\n                }),\n                field(\"Signature__c\", function(state) {\n                    var recorderSignatureUrl = '';\n                    if (dataValue(\"form.signature_of_farmer_trainer\")(state) !== undefined && dataValue(\"form.signature_of_farmer_trainer\")(state) !== '') {\n                        recorderSignatureUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + dataValue(\"form.signature_of_farmer_trainer\")(state);\n                    }\n                    return recorderSignatureUrl;\n                }),\n                field('Location_GPS__Latitude__s', (state) => {\n                    // define this once, it's constant...\n                    const coords = state.data.form.gps_coordinates;\n                    // write your contional\n                    if (coords) {\n                      return coords.split(\" \")[0];\n                    }\n                    // the 'else' is unnecessary, return '' if there are no coords\n                    return '';\n                }),\n                field('Location_GPS__Longitude__s', (state) => {\n                    // define this once, it's constant...\n                    const coords = state.data.form.gps_coordinates;\n                    // write your contional\n                    if (coords) {\n                      return coords.split(\" \")[1];\n                    }\n                    // the 'else' is unnecessary, return '' if there are no coords\n                    return '';\n                }),\n                field('Altitude__c', (state) => {\n                    // define this once, it's constant...\n                    const coords = state.data.form.gps_coordinates;\n                    // write your contional\n                    if (coords) {\n                      return coords.split(\" \")[2];\n                    }\n                    // the 'else' is unnecessary, return '' if there are no coords\n                return '';\n                }),\n                relationship(\"Farm_Visited__r\", \"CommCare_Case_Id__c\", dataValue(\"form.farm_being_visted\")),\n                // relationship(\"Secondary_Farmer__r\", \"CommCare_Case_Id__c\", function(state){\n                //     var secondaryFarmer = '';\n                //     if(dataValue(\"form.secondary_farmer_available\")(state) == 'yes' && dataValue(\"form.secondary_farmer\")(state) !== ''){\n                //       secondaryFarmer = dataValue(\"form.secondary_farmer\");\n                //     }\n                //     return secondaryFarmer;\n                // })\n            )\n        )\n    );\n    \n    each(\n      \"$.data\",\n      upsertIf(state.data.form['@name'] == 'Farm Visit - AA',\n      \"Farm_Visit__c\", \"FV_Submission_ID__c\",\n          fields(\n              field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n              field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n              field(\"Farm_Visit_Type__c\", dataValue(\"form.survey_type\")),\n              field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n              relationship(\"Farm_Visited__r\", \"CommCare_Case_Id__c\", function(state){\n                const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n                if(visitedFarmers){\n                  return visitedFarmers.split(\" \")[0];\n                }\n              }),\n              field(\"Primary_Farmer_PIMA_ID__c\", function(state){\n                const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n                if(visitedFarmers){\n                  return visitedFarmers.split(\" \")[0];\n                }\n              }),\n              \n              // relationship(\"Secondary_Farmer__r\", \"CommCare_Case_Id__c\", function(state){\n              //   const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n              //   var result = null;\n              //   if(visitedFarmers.length > 1){\n              //     result = visitedFarmers.split(\" \")[1];\n              //   }\n              //   return result;\n              // }),\n              \n              // field(\"Secondary_Farmer_PIMA_ID__c\", function(state){\n              //   const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n              //   var result = null;\n              //   if(visitedFarmers.length > 1){\n              //     result = visitedFarmers.split(\" \")[1];\n              //   }\n              //   return result;\n              // }),\n              field(\"Visit_Has_Training__c\", dataValue(\"form.is_this_a_farm_training_visit\")),\n            //  field(\"Training_Session__c\", dataValue(\"form.training_session\")),\n              // field(\"Other_Participants_Present__c\", dataValue(\"form.any_other_participants_present\")),\n              field(\"Total_Farmers_Visited__c\", dataValue(\"form.attendance_count\")),\n              field(\"Date_Visited__c\", dataValue(\"form.date_of_visit\")),\n              field(\"visit_comments__c\", dataValue(\"form.farm_visit_comments\")),\n              field(\"Farmer_Trainer__c\", dataValue(\"form.trainer\")),\n              field(\"No_of_separate_coffee_fields__c\", dataValue(\"form.opening_questions.number_of_separate_coffee_fields\")),\n              field(\"Field_Age__c\", dataValue(\"form.field_age\")),\n              field(\"Field_Size__c\", function(state){\n                  var fieldSize = '';\n                  if(dataValue(\"form.field_size\")(state) !== undefined && dataValue(\"form.field_size\")(state) !== ''){\n                    fieldSize = dataValue(\"form.field_size\");\n                  }\n                  else if(dataValue(\"form.field_size1\")(state) !== undefined && dataValue(\"form.field_size1\")(state) !== ''){\n                    fieldSize = dataValue(\"form.field_size1\");\n                  }\n                  \n                  return fieldSize;\n                  \n              }),\n              field(\"Farm_Visit_Photo_Url__c\", function(state) {\n                  var farmVisitPhotoUrl = '';\n                  if (dataValue(\"form.farm_visit_photo\")(state) !== undefined && dataValue(\"form.farm_visit_photo\")(state) !== '') {\n                      farmVisitPhotoUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + dataValue(\"form.farm_visit_photo\")(state);\n                  }\n                  return farmVisitPhotoUrl;\n              }),\n              field(\"Signature__c\", function(state) {\n                  var recorderSignatureUrl = '';\n                  if (dataValue(\"form.signature_of_farmer_trainer\")(state) !== undefined && dataValue(\"form.signature_of_farmer_trainer\")(state) !== '') {\n                      recorderSignatureUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + dataValue(\"form.signature_of_farmer_trainer\")(state);\n                  }\n                  return recorderSignatureUrl;\n              }),\n              field('Location_GPS__Latitude__s', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[0];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n                  return '';\n              }),\n              field('Location_GPS__Longitude__s', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[1];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n                  return '';\n              }),\n              field('Altitude__c', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[2];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n              return '';\n              }),\n              field('FV_AA_Farmer_1_Attended_Any_Training__c', function(state){\n                var result = '';\n                if(dataValue('form.farmer_1_questions.attended_training')(state) == 1){\n                  result = 'Yes';\n                }\n                else if(dataValue('form.farmer_1_questions.attended_training')(state) == 0){\n                  result = 'No';\n                }\n                return result;\n              }),\n              field('FV_AA_Farmer_2_Attended_Any_Training__c', function(state){\n                var result = '';\n                if(dataValue('form.farmer_2_questions.attended_training')(state) == 1){\n                  result = 'Yes';\n                }\n                else if(dataValue('form.farmer_2_questions.attended_training')(state) == 0){\n                  result = 'No';\n                }\n                return result;\n              }),\n              field('FV_AA_Farmer_1_Trainings_Attended__c', dataValue('form.farmer_1_questions.number_of_trainings')),\n              field('FV_AA_Farmer_2_Trainings_Attended__c', dataValue('form.farmer_2_questions.number_of_trainings')),\n              field('FV_AA_Visit_Done_By_AA__c', 'Yes'),\n              field('Training_Session__c', dataValue('form.training_session'))\n          )\n      )\n  );\n  \n      // Update Household Record - FV AA\n  each(\"$.data\", \n    upsertIf(state.data.form['@name'] == 'Farm Visit - AA', \n      \"Household__c\", \"Id\",\n      fields(\n        field(\"Id\", state.data.form.case[\"@case_id\"]),\n        field(\"FV_AA_Visited__c\", dataValue(\"form.case.update.FV_AA_Visited\")(state)),\n        relationship(\n          \"Latest_Farm_Visit_Record__r\",\n          \"FV_Submission_ID__c\",\n          \"FV-\" + dataValue(\"id\")(state)\n          )\n        )\n      )\n  );\n    \n    // update FV with secondary Farmer\n    each(\n      \"$.data\",\n      upsertIf(\n        state.data.form.secondary_farmer !== \"\" && state.data.form.secondary_farmer_available == 'yes',\n        \"Farm_Visit__c\",\n        \"FV_Submission_ID__c\",\n        fields(\n          field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n          relationship(\"Secondary_Farmer__r\", \"CommCare_Case_Id__c\", dataValue(\"form.secondary_farmer\")),\n          field(\"Secondary_Farmer_PIMA_ID__c\", dataValue(\"form.secondary_farmer\"))\n          )\n        )\n      );\n\n          //Best Practices :: Main Stem && Weeding &&  Shade Control && Record Keeping && Compost && Erosion Control && Nutrition && Safe Use of Pesticides\n    each(\n        \"$.data\",\n        upsert(\"FV_Best_Practices__c\", \"FV_Submission_ID__c\",\n            fields(\n                field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n                field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n                relationship(\"Farm_Visit__r\", \"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n  \n                //main stems\n                field(\"number_of_main_stems_on_majority_trees__c\", dataValue(\"form.best_practice_questions.main_stems.number_of_main_stems_on_majority_trees\")),\n            \n                field(\"photo_of_trees_and_average_main_stems__c\", function(state){\n                  \n                  var mainStemsPhotoURL = \"\";\n                  if(dataValue(\"form.best_practice_questions.main_stems.trees_and_main_stems_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.main_stems.trees_and_main_stems_photo\")(state) !== '') {\n                    mainStemsPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.main_stems.trees_and_main_stems_photo\")(state);  \n                   }\n                   return mainStemsPhotoURL;\n                   \n                }),\n  \n                //nutrition\n                field(\"Color_of_coffee_tree_leaves__c\", function(state){\n                  \n                  var colorOfCoffeeLeaves = dataValue(\"form.best_practice_questions.nutrition.are_the_leave_green_or_yellow_pale_green\")(state);\n                  var returnColorOfCoffeeLeaves = \"\";\n                  \n                  if(colorOfCoffeeLeaves !== undefined && colorOfCoffeeLeaves !== '' && colorOfCoffeeLeaves == 0){\n                    \n                    returnColorOfCoffeeLeaves = \"5% or more (5 or more in 100) of the leaves are yellow, pale green or brown.\";\n                    \n                  }\n  \n                  if(colorOfCoffeeLeaves !== undefined && colorOfCoffeeLeaves !== '' && colorOfCoffeeLeaves == 1){\n                    \n                    returnColorOfCoffeeLeaves = \"Nearly all leaves are dark green and less than 5% (less than 5 in 100) are yellow, pale green, or brown.\";\n                    \n                  }\n  \n                  return returnColorOfCoffeeLeaves;\n  \n                }),\n  \n                //weeding\n                field(\"how_many_weeds_under_canopy_and_how_big__c\", function(state){\n                  \n                  var weedsUnderCanopy = dataValue(\"form.best_practice_questions.weeding.how_many_weeds_under_canopy_and_how_big_are_they\")(state);\n                  var returnWeedsUnderCanopy = \"\";\n          \n                  if(weedsUnderCanopy == 1){\n          \n                    returnWeedsUnderCanopy = \"Few small weeds (less than 30cm) under the tree canopy\";\n          \n                  }\n          \n                  if(weedsUnderCanopy == 2){\n          \n                    returnWeedsUnderCanopy = \"Many small weeds under the tree canopy (ground is covered with weeds)\";\n          \n                  }\n          \n                  if(weedsUnderCanopy == 3){\n          \n                    returnWeedsUnderCanopy = \"Many large weeds under the tree canopy (ground is covered with weeds)\";\n          \n                  }\n  \n                    return returnWeedsUnderCanopy;\n  \n                }),\n  \n               field(\"Have_herbicides_been_used_on_the_field__c\", dataValue(\"form.best_practice_questions.weeding.used_herbicides\")),\n                field(\"photo_of_weeds_under_the_canopy__c\", function(state){\n                  \n                  var weedsPhotoUrl = dataValue(\"form.best_practice_questions.weeding.weeds_under_the_canopy_photo\")(state);\n                  var returnWeedsPhotoUrl = \"\";\n                  \n                  if (weedsPhotoUrl !== undefined && weedsPhotoUrl !== '') {\n                      returnWeedsPhotoUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + weedsPhotoUrl;\n                  }\n                  \n                  return returnWeedsPhotoUrl;\n                  \n                }),\n\n                // Safe use of pesticides\n\n                field(\"used_pesticide__c\", function(state){\n                    var usedPesticide = dataValue(\"form.best_practice_questions.safe_use_of_pesticides.used_pesticides\")(state);\n                    var returnUsedPesticide = \"\";\n                    if (usedPesticide == 1){\n                        returnUsedPesticide = \"Yes\";\n                    }\n                    else if (usedPesticide == 0) {\n                        returnUsedPesticide = \"No\";\n                    }\n                    return returnUsedPesticide;\n                }),\n\n                field(\"pesticide_number_of_times__c\", dataValue(\"form.best_practice_questions.safe_use_of_pesticides.pesticide_number_of_times\")),\n                field(\"pesticide_spray_type__c\", function(state){\n                    const sprayType = dataValue(\"form.best_practice_questions.safe_use_of_pesticides.pesticide_spray_type\")(state);\n                    var returnSprayType = \"\";\n\n                    if(sprayType === \"1\"){\n                        returnSprayType = \"Routine spray\";\n                    }\n                    else if(sprayType === \"2\"){\n                        returnSprayType = \"After scouting and seeing a pest\";\n                    }\n                    return returnSprayType;\n                }),\n  \n                //shade management\n                field(\"level_of_shade_present_on_the_farm__c\", function(state){\n                  \n                  var levelOfShadeOnPlot = dataValue(\"form.best_practice_questions.shade_control.level_of_shade_present_on_the_farm\")(state);\n                  var returnLevelOfShadeOnPlot = \"\";\n                  \n                  if(levelOfShadeOnPlot == 0){\n                    \n                    returnLevelOfShadeOnPlot = \"NO shade, less than 5%\";\n                    \n                  }\n                  \n                  if(levelOfShadeOnPlot == 1){\n                    \n                    returnLevelOfShadeOnPlot = \"Light shade, 5 to 20%\";\n                    \n                  }\n                  \n                  if(levelOfShadeOnPlot == 2){\n                    \n                    returnLevelOfShadeOnPlot = \"Medium shade, 20 to 40%\";\n                    \n                  }\n                  \n                  if(levelOfShadeOnPlot == 3){\n                    \n                    returnLevelOfShadeOnPlot = \"Heavy shade, over 40%\";\n                    \n                  }\n                  \n                  return returnLevelOfShadeOnPlot;\n  \n                }),\n                \n                field(\"photo_of_level_of_shade_on_the_plot__c\", function(state) {\n                  \n                  var shadePhotoUrl = '';\n                  if(dataValue(\"form.best_practice_questions.shade_control.photo_of_level_of_shade_on_the_plot\")(state) !== undefined && dataValue(\"form.best_practice_questions.shade_control.photo_of_level_of_shade_on_the_plot\")(state) !== '') {\n                    shadePhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.shade_control.photo_of_level_of_shade_on_the_plot\")(state);\n                    \n                  }\n                  \n                  return shadePhotoUrl;\n                  \n                }),  \n  \n                //compost manure\n                field(\"do_you_have_compost_manure__c\", function(state){\n                  \n                  var haveCompostManure = dataValue(\"form.best_practice_questions.compost.do_you_have_compost_manure\")(state);\n                  var returnHaveCompostManure = \"\";\n                  \n                  if(haveCompostManure !== undefined && haveCompostManure !== '' && haveCompostManure == 0){\n                    \n                    returnHaveCompostManure = \"No\";\n                    \n                  }\n                  \n                  if(haveCompostManure !== undefined && haveCompostManure !== '' && haveCompostManure == 1){\n                    \n                    returnHaveCompostManure = \"Yes\";\n                    \n                  }\n                  \n                  return returnHaveCompostManure;\n  \n                }),\n  \n                field(\"photo_of_the_compost_manure__c\", function(state) {\n                  \n                  var compostPhotoUrl = '';\n                  if(dataValue(\"form.best_practice_questions.compost.photo_of_the_compost_manure\")(state) !== undefined && dataValue(\"form.best_practice_questions.compost.photo_of_the_compost_manure\")(state) !== '') {\n                    compostPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.compost.photo_of_the_compost_manure\")(state);\n                    \n                  }\n                  \n                  return compostPhotoUrl;\n                  \n                }),\n  \n                //erosion control\n                field(\"Stabilizing_Grasses_Photo_URL__c\", function(state){                    \n  \n                    var sgPhotoURL = \"\";\n                    if(dataValue(\"form.best_practice_questions.erosion_control.stabilizing_grasses_image\")(state) !== undefined && dataValue(\"form.best_practice_questions.erosion_control.stabilizing_grasses_image\")(state) !== '') {\n                        sgPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.erosion_control.stabilizing_grasses_image\")(state); \n                    } \n  \n                    return sgPhotoURL;                \n                }),\n                field(\"Mulch_Photo_URL__c\", function(state){                    \n  \n                    var mulchPhotoURL = \"\";\n                    if(dataValue(\"form.best_practice_questions.erosion_control.mulch_image\")(state) !== undefined && dataValue(\"form.best_practice_questions.erosion_control.mulch_image\")(state) !== '') {\n                        mulchPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.erosion_control.mulch_image\")(state); \n                    } \n  \n                    return mulchPhotoURL;                \n                }),\n                field(\"Water_Traps_Photo_URL__c\", function(state){                    \n  \n                    var wtPhotoURL = \"\";\n                    if(dataValue(\"form.best_practice_questions.erosion_control.water_traps_or_trenches_image\")(state) !== undefined && dataValue(\"form.best_practice_questions.erosion_control.water_traps_or_trenches_image\")(state) !== '') {\n                        wtPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.erosion_control.water_traps_or_trenches_image\")(state); \n                    } \n  \n                    return wtPhotoURL;                \n                }),\n                field(\"Physical_Barriers_Photo_URL__c\", function(state){                    \n  \n                    var pbPhotoURL = \"\";\n                    if(dataValue(\"form.best_practice_questions.erosion_control.physical_barriers_image\")(state) !== undefined && dataValue(\"form.best_practice_questions.erosion_control.physical_barriers_image\")(state) !== '') {\n                        pbPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.erosion_control.physical_barriers_image\")(state); \n                    } \n  \n                    return pbPhotoURL;                \n                }),\n                field(\"Terraces_Photo_URL__c\", function(state){                    \n  \n                    var terracesPhotoURL = \"\";\n                    if(dataValue(\"form.best_practice_questions.erosion_control.terraces_image\")(state) !== undefined && dataValue(\"form.best_practice_questions.erosion_control.terraces_image\")(state) !== '') {\n                        terracesPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.erosion_control.terraces_image\")(state); \n                    } \n  \n                    return terracesPhotoURL;                \n                }),\n                field(\"Contour_Planting_Photo_URL__c\", function(state){                    \n  \n                    var cpPhotoURL = \"\";\n                    if(dataValue(\"form.best_practice_questions.erosion_control.contour_planting_image\")(state) !== undefined && dataValue(\"form.best_practice_questions.erosion_control.contour_planting_image\")(state) !== '') {\n                        cpPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.erosion_control.contour_planting_image\")(state); \n                    } \n  \n                    return cpPhotoURL;                \n                }),\n                field(\"Cover_Crop_Photo_URL__c\", function(state){                    \n  \n                    var ccPhotoURL = \"\";\n                    if(dataValue(\"form.best_practice_questions.erosion_control.bean_or_arachis_cover_crop_image\")(state) !== undefined && dataValue(\"form.best_practice_questions.erosion_control.bean_or_arachis_cover_crop_image\")(state) !== '') {\n                        ccPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.erosion_control.bean_or_arachis_cover_crop_image\")(state); \n                    } \n  \n                    return ccPhotoURL;                \n                }),\n  \n                //record keeping\n                field(\"do_you_have_a_record_book__c\", function(state){\n                  \n                  var haveRecordBook = dataValue(\"form.best_practice_questions.record_keeping.do_you_have_a_record_book\")(state);\n                  var returnHaveRecordBook = \"\";\n                  \n                  if(haveRecordBook == 0){\n                    \n                    returnHaveRecordBook = \"No\";\n                    \n                  }\n                  \n                  if(haveRecordBook == 1){\n                    \n                    returnHaveRecordBook = \"Yes\";\n                    \n                  }\n                  \n                  return returnHaveRecordBook;\n  \n                }),\n  \n                field(\"are_there_records_on_the_record_book__c\", function(state){\n                  \n                  var recordsOnRecordBook = dataValue(\"form.best_practice_questions.record_keeping.are_there_records_on_the_record_book\")(state);\n                  var returnRecordsOnRecordBook = \"\";\n                  \n                  if(recordsOnRecordBook !== undefined && recordsOnRecordBook !== '' && recordsOnRecordBook == 0){\n                    \n                    returnRecordsOnRecordBook = \"No\";\n                    \n                  }\n                  \n                  if(recordsOnRecordBook !== undefined && recordsOnRecordBook !== '' && recordsOnRecordBook == 1){\n                    \n                    returnRecordsOnRecordBook = \"Yes\";\n                    \n                  }\n                  \n                  return returnRecordsOnRecordBook;\n                  \n                }),\n  \n                field(\"take_a_photo_of_the_record_book__c\", function(state){\n                  \n                  var recordBookPhotoUrl = '';\n                  if(dataValue(\"form.best_practice_questions.record_keeping.take_a_photo_of_the_record_book\")(state) !== undefined && dataValue(\"form.best_practice_questions.record_keeping.take_a_photo_of_the_record_book\")(state) !== '') {\n                    recordBookPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.record_keeping.take_a_photo_of_the_record_book\")(state) !== undefined && dataValue(\"form.best_practice_questions.record_keeping.take_a_photo_of_the_record_book\")(state);\n                 \n                  }\n                  \n                  return recordBookPhotoUrl;\n                  \n                })\n            )\n        )\n    );\n\n\t//Farm Visit Best Practice Results\n    //loop through methods of erosion control and insert into database :: Erosion Control BP\n\n    beta.each(\n\n        function(state) {\n  \n            //incoming erosion data\n            var best_practice_results_data = dataValue(\"form.best_practice_questions.erosion_control.methods_of_erosion_control\")(state);\n  \n            if (best_practice_results_data !== undefined) {\n  \n                return best_practice_results_data.split(\" \").map(\n                  \n                    function(resultId) {\n                        return {\n                            result_data: resultId,\n                            best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_erosion_\" + resultId,\n                            farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n                        };\n                    }\n                    \n                );\n  \n            }\n        },\n        upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n            fields(\n                field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n                field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n                relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n                field(\"Best_Practice_Result_Type__c\", \"Erosion Control\"),//this is the actual result type\n                field(\"Best_Practice_Result_Description__c\", function(state){\n                  \n                    var returnResults = \"\";\n                  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n  \n                        returnResults = \"Stabilizing grasses\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n  \n                        returnResults = \"Mulch\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n  \n                        returnResults = \"Water traps or trenches\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n  \n                        returnResults = \"Physical barriers. (e.g. rocks)\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n  \n                        returnResults = \"Terraces\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"6\"){\n  \n                        returnResults = \"Contour planting\";\n  \n                    }\n                    \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"7\"){\n  \n                        returnResults = \"Bean or Arachis cover crop between the rows\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n  \n                        returnResults = \"No erosion control method seen\";\n  \n                    }\n                    \n                    return returnResults;\n                  \n                })                \n            )\n        )\n    );\n  \n  \n    //loop through chemical/fertilizier applied and insert into database :: Nutrition BP\n    beta.each(\n  \n        function(state) {\n  \n            //incoming chemical/fertilizer used data\n            var best_practice_results_data = dataValue(\"form.best_practice_questions.nutrition.type_chemical_applied_on_coffee_last_12_months\")(state);\n  \n            if (best_practice_results_data !== undefined) {\n  \n                return best_practice_results_data.split(\" \").map(\n                  \n                    function(resultId) {\n                        return {\n                            result_data: resultId,\n                            best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_fertilizer_\" + resultId,\n                            farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n                        };\n                    }\n                    \n                );\n  \n            }\n        },\n        upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n            fields(\n                field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n                field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n                relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n                field(\"Best_Practice_Result_Type__c\", \"Chemicals and Fertilizers Applied\"), //this is the actual result type\n                field(\"Best_Practice_Result_Description__c\", function(state){\n                  \n                    var returnResults = \"\";\n                  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n  \n                        returnResults = \"Compost\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n  \n                        returnResults = \"Manure\";\n  \n                    }\n                    \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n  \n                        returnResults = \"NPK 22:6:12\";\n  \n                    }\n                    \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n  \n                        returnResults = \"NPK 17:17:17\";\n  \n                    }\n                    \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n  \n                        returnResults = \"Other NPK\";\n  \n                    }\n                    \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"6\"){\n  \n                        returnResults = \"Zinc/Boron Foliar feed\";\n  \n                    }\n                    \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"7\"){\n  \n                        returnResults = \"General Foliar feed\";\n  \n                    }\n                    \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"8\"){\n  \n                        returnResults = \"LIME\";\n  \n                    }\n\n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"9\"){\n  \n                        returnResults = \"CAN\";\n  \n                    }\n                    \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"10\"){\n  \n                        returnResults = \"Urea\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n  \n                        returnResults = \"Did NOT apply any fertilizer in past 12 months\";\n  \n                    }\n  \n                    return returnResults;\n                  \n                })\n            )\n        )\n  \n    );\n  \n  \n    //loop through methods of controlling coffee berry borer :: Integrated Pest and Disease Management BP\n    beta.each(\n  \n        function(state) {\n  \n            //incoming coffee berry borer data\n            var best_practice_results_data = dataValue(\"form.best_practice_questions.pest_disease_management.methods_of_controlling_coffee_berry_borer\")(state);\n  \n            if (best_practice_results_data !== undefined) {\n  \n                return best_practice_results_data.split(\" \").map(\n                  \n                    function(resultId) {\n                        return {\n                            result_data: resultId,\n                            best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_cbb_\" + resultId,\n                            farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n                        };\n                    }\n                    \n                );\n  \n            }\n        },\n        upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n            fields(\n                field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n                field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n                relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n                field(\"Best_Practice_Result_Type__c\", \"Management of Coffee Berry Borer (CBB)\"), //this is the actual result type\n                field(\"Best_Practice_Result_Description__c\", function(state){\n                  \n                    var returnResults = \"\";\n                  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n  \n                        returnResults = \"Reduce pesticide use and/or encourage natural predators and parasites - beneficial insects.\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n  \n                        returnResults = \"Strip all berries at the end of harvest, known as crop hygiene\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n  \n                        returnResults = \"Harvest ripe cherries regularly - to reduce pest and disease levels\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n  \n                        returnResults = \"Use berry borer traps\";\n  \n                    }\n                    \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n  \n                        returnResults = \"Collect fallen berries at the end of the season - crop hygiene\";\n  \n                    }\n                    \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"6\"){\n  \n                        returnResults = \"Feed the tree well to keep it healthy\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"7\"){\n  \n                        returnResults = \"Use good agricultural practices such as weeding or mulching to reduce stress and keep trees healthy\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"8\"){\n  \n                        returnResults = \"Prune to keep the canopy open\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"9\"){\n  \n                        returnResults = \"Renovate (new planting or grafting) or rejuvenate regularly to keep main stems less than 8 years old\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"10\"){\n  \n                        returnResults = \"Plant and grow disease resistant varieties e.g. Ruiru 11 and Batian\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"11\"){\n  \n                        returnResults = \"Smooth the bark to reduce egg laying sites for While Coffee Borer\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"12\"){\n  \n                        returnResults = \"Spray regular pesticides\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"13\"){\n  \n                        returnResults = \"Spray homemade herbal or botanical pesticides\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n  \n                        returnResults = \"Does not know any methods\";\n  \n                    }\n  \n                    return returnResults;\n                  \n                })\n            )\n        )\n  \n    );\n    \n  \n    //loop through pruning methods :: Pruning BP  \n      beta.each(\n  \n        function(state) {\n  \n            //incoming pruning data\n            var best_practice_results_data = dataValue(\"form.best_practice_questions.pruning.pruning_method_on_majority_trees\")(state) || \"\";\n  \n            if (best_practice_results_data !== undefined) {\n  \n                return best_practice_results_data.split(\" \").map(\n                  \n                    function(resultId) {\n                        return {\n                            result_data: resultId,\n                            best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_pruning_\" + resultId,\n                            farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n                            field_age: dataValue(\"form.field_age\")(state)\n                        };\n                    }\n                    \n                );\n  \n            }\n        },\n        upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n            fields(\n                field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n                field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n                relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n                field(\"Best_Practice_Result_Type__c\", \"Pruning\"), //this is the actual result type\n                field(\"Best_Practice_Result_Description__c\", function(state){\n                  \n                    var returnResults = \"\";\n                  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n  \n                        returnResults = \"Centers opened\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n  \n                        returnResults = \"Unwanted suckers removed\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n  \n                        returnResults = \"Dead branches removed\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n  \n                        returnResults = \"Branches touching the ground removed\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n  \n                        returnResults = \"Broken / unproductive stems and/or branches removed\";\n  \n                    }\n  \n                    if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n  \n                        returnResults = \"No pruning methods used\";\n  \n                    }\n\n                    return returnResults;\n                  \n                })\n            )\n        )\n  \n    );\n  \n    beta.each(\n  \n      function(state) {\n  \n          //incoming weeding data\n          var best_practice_results_data = dataValue(\"form.best_practice_questions.weeding.which_product_have_you_used\")(state) || \"\";\n          if (best_practice_results_data !== undefined) {\n  \n              return best_practice_results_data.split(\" \").map(\n                  function(resultId) {\n                      return {\n                          result_data: resultId,\n                          best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_weeding_\" + resultId,\n                          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n                      };\n                  }  \n              );\n          }\n      },\n      upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n          fields(\n              field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n              field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n              relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n              field(\"Best_Practice_Result_Type__c\", \"Weeding\"), //this is the actual result type\n              field(\"Best_Practice_Result_Description__c\", function(state){\n                \n                  var returnResults = \"\";\n                \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n  \n                      returnResults = \"Glyphosate (Eg Round Up)\";\n  \n                  }\n  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n  \n                      returnResults = \"Paraquat (Eg. Gramoxone)\";\n  \n                  }\n                  return returnResults;\n                \n              })\n          )\n      )\n  \n  );\n\n  // Other Herbicide Handler\n  beta.each(\n  \n    function(state) {\n\n        //incoming weeding data\n        var otherProduct = dataValue(\"form.best_practice_questions.weeding.ask_which_other_product_have_you_used\")(state) || \"\";\n        if (otherProduct !== undefined) {\n\n            return otherProduct.split(\",\").map(\n                function(resultId) {\n                    return {\n                        result_data: resultId.trim(),\n                        best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_weeding_\" + resultId.trim(),\n                        farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n                    };\n                }  \n            );\n        }\n    },\n    upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n        fields(\n            field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n            field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n            relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n            field(\"Best_Practice_Result_Type__c\", \"Weeding\"), //this is the actual result type\n            field(\"Best_Practice_Result_Description__c\", dataValue(\"result_data\"))\n        )\n    )\n);\n    \n    \n    //upsert training session\n  /*    each(\n        \"$.data\",\n        upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n            fields(\n                field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n                field(\"Updated_from_CommCare__c\", true)\n            )\n        )\n    );\n  */\n  \n  //}\n  \n  \n",
          "adaptor": "@openfn/language-salesforce@4.6.4",
          "project_credential_id": "55f298ba-f7d3-442c-9c27-ff1825d583f6"
        }
      },
      "edges": {
        "webhook->Production---Farm-Visit---KE---CommCare----Salesforce": {
          "enabled": true,
          "id": "816ce956-4f22-4d47-ab33-4b4ee891ca82",
          "target_job_id": "c0cdd02b-7380-4888-97a6-73d345345348",
          "source_trigger_id": "4ee52f51-0d76-444a-b711-c9701e48acce",
          "condition_type": "js_expression",
          "condition_label": "Production - Farm Visit KE | CommCare Salesforce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Farm Visit Full - KE\""
        }
      }
    },
    "Coffee-PR-2022---Field-Day-Farmer-Registration---CommCare----Salesforce": {
      "id": "717e94ad-6e3e-42ae-9ec6-bd49927d4d66",
      "name": "Coffee PR 2022 - Field Day Farmer Registration - CommCare -- Salesforce",
      "inserted_at": "2025-02-17T09:26:52.555965Z",
      "lock_version": 5,
      "triggers": {
        "webhook": {
          "enabled": true,
          "id": "cece6acb-949e-48a7-ac2b-fb7040cf3957",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee-PR-2022---Field-Day-Farmer-Registration---CommCare----Salesforce": {
          "id": "a8204463-9f45-4dc3-9a88-3333ca68d925",
          "name": "Coffee PR 2022 - Field Day Farmer Registration - CommCare -- Salesforce",
          "body": "// if (\n//   state.data.app_id == \"99561e1da5c84a9e93d242af342dcaf5\" // Puerto Rico 2022C\n// ) {\n  //insert household object\n  each(\n    \"$.data\",\n\n    // Insert Household for New Farmer New Household OR New Farmer Existing Household but for Primary Member OR Existing Farmer Change in FFG but for Primary Member\n    upsertIf(\n      state.data.form.survey_detail == \"New Farmer New Household\",\n      \"Household__c\",\n      \"Household_ID__c\",\n      fields(\n        field(\"Household_ID__c\", dataValue(\"form.Household_Id\")(state)),\n        field(\"Name\", dataValue(\"form.Household_Number\")(state)),\n        field(\"Training_Group__c\", dataValue(\"form.Training_Group_Id\")(state)),\n        field(\"Farm_Size__c\", dataValue(\"form.Farm_Size\")(state)),\n        field(\n          \"Farm_Size_Before__c\",\n          dataValue(\"form.participant_data.farm_size_3_years_and_older\")(state)\n        ),\n        field(\n          \"Farm_Size_After__c\",\n          dataValue(\"form.participant_data.farm_size_under_3_years\")(state)\n        )\n      )\n    )\n  ),\n    //insert || update :: participant object :: new household created || existing household updated\n    each(\n      \"$.data\",\n      upsertIf(\n        state.data.form.survey_detail == \"New Farmer New Household\" ||\n          state.data.form.survey_detail == \"New Farmer Existing Household\",\n        \"Participant__c\",\n        \"CommCare_Case_Id__c\",\n        fields(\n          field(\n            \"CommCare_Case_Id__c\",\n            state.data.form.subcase_0.case[\"@case_id\"]\n          ),\n          field(\"TNS_Id__c\", dataValue(\"form.Farmer_Id\")),\n          field(\"Age__c\", dataValue(\"form.Age\")),\n          field(\"Name\", dataValue(\"form.First_Name\")),\n          field(\"Middle_Name__c\", dataValue(\"form.Middle_Name\")),\n          field(\"Last_Name__c\", dataValue(\"form.Last_Name\")),\n          field(\"Gender__c\", dataValue(\"form.Gender\")),\n          field(\"Status__c\", dataValue(\"form.Status\")),\n          field(\"Farm_Size__c\", dataValue(\"form.Farm_Size\")),\n          field(\"Sent_to_OpenFn_Status__c\", \"Complete\"),\n          field(\"Phone_Number__c\", dataValue(\"form.Phone_Number\")),\n          field(\n            \"Primary_Household_Member__c\",\n            dataValue(\"form.Primary_Household_Member\")\n          ),\n          field(\"Registration_Date__c\", dataValue(\"form.registration_date\")),\n          field(\"Create_In_CommCare__c\", false),\n          relationship(\n            \"Household__r\",\n            \"Household_ID__c\",\n            dataValue(\"form.Household_Id\")\n          ),\n          relationship(\n            \"Training_Group__r\",\n            \"CommCare_Case_Id__c\",\n            dataValue(\"form.Training_Group_Id\")\n          )\n        )\n      )\n    ),\n    // Update Training Session\n\n    each(\n      \"$.data\",\n      upsert(\n        \"Training_Session__c\",\n        \"CommCare_Case_Id__c\",\n        fields(\n          field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n          field(\"Trainer__c\", dataValue(\"form.trainer\")),\n          field(\"Updated_from_CommCare__c\", true),\n          field(\"Date__c\", dataValue(\"form.registration_date\"))\n        )\n      )\n    ),\n    // Update Attendance\n\n    each(\n      \"$.data\",\n      upsert(\n        \"Attendance__c\",\n        \"Submission_ID__c\",\n        fields(\n          field(\n            \"Submission_ID__c\",\n            dataValue(\"form.training_session\")(state) +\n              state.data.form.subcase_0.case[\"@case_id\"]\n          ),\n          field(\"Status__c\", \"Present\"),\n          relationship(\n            \"Training_Session__r\",\n            \"CommCare_Case_Id__c\",\n            dataValue(\"form.training_session\")\n          ),\n          relationship(\n            \"Participant__r\",\n            \"CommCare_Case_Id__c\",\n            state.data.form.subcase_0.case[\"@case_id\"]\n          )\n        )\n      )\n    ),\n    //update :: participant object :: participant details updated\n    each(\n      \"$.data\",\n      upsertIf(\n        state.data.form.survey_detail == \"Participant Update\",\n        \"Participant__c\",\n        \"CommCare_Case_Id__c\",\n        fields(\n          field(\"CommCare_Case_Id__c\", state.data.form.case[\"@case_id\"]),\n          field(\"Farm_Size__c\", dataValue(\"form.Number_of_Trees\")),\n          field(\"Phone_Number__c\", dataValue(\"form.Phone_Number\")),\n          field(\"Updated_Date__c\", dataValue(\"form.date\"))\n        )\n      )\n    );\n// }\n",
          "adaptor": "@openfn/language-salesforce@4.6.5",
          "project_credential_id": "55f298ba-f7d3-442c-9c27-ff1825d583f6"
        }
      },
      "edges": {
        "webhook->Coffee-PR-2022---Field-Day-Farmer-Registration---CommCare----Salesforce": {
          "enabled": true,
          "id": "acdbddd5-3707-4186-8907-ec3338a0790f",
          "target_job_id": "a8204463-9f45-4dc3-9a88-3333ca68d925",
          "source_trigger_id": "cece6acb-949e-48a7-ac2b-fb7040cf3957",
          "condition_type": "js_expression",
          "condition_label": "Coffee PR 2022 Field Day Farmer Registration CommCare Salesforce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Participant Registration\" && state.data[\"app_id\"] == \"99561e1da5c84a9e93d242af342dcaf5\""
        }
      }
    },
    "Coffee-PR-2022---Field-Day-Attendance-Full---CommCare----Salesforce": {
      "id": "b3fda63c-9527-44e9-a474-b820613dbdbb",
      "name": "Coffee PR 2022 - Field Day Attendance Full - CommCare -- Salesforce",
      "inserted_at": "2025-02-28T08:24:03.440751Z",
      "lock_version": 5,
      "triggers": {
        "webhook": {
          "enabled": true,
          "id": "84feecdf-4da2-4030-88e7-32972a997b10",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee-PR-2022---Field-Day-Attendance-Full---CommCare----Salesforce": {
          "id": "1938dd5d-cfd1-44ae-b1ed-2ff78e982600",
          "name": "Coffee PR 2022 - Field Day Attendance Full - CommCare -- Salesforce",
          "body": "\nbeta.each(\n    fn((substate) => {\n        // Initialize an empty array to store items with training sessions\n        const itemsWithTrainingSession = [];\n\n        // Iterate over each item in the data\n        substate.data.form.barrios_repeat_group.item.forEach((item) => {\n            // Check if the item has a training session\n            if (item.hasOwnProperty(\"training_session\")) {\n                // If it does, push it to the itemsWithTrainingSession array\n                itemsWithTrainingSession.push(item);\n            }\n        });\n\n        return itemsWithTrainingSession;\n    }),\n    upsert(\n        \"Training_Session__c\",\n        \"CommCare_Case_Id__c\",\n        fields(\n            field(\"CommCare_Case_Id__c\", dataValue(\"training_session\")),\n            field(\"Trainer__c\", state.data.form.trainer),\n            field(\"Session_Photo_URL__c\", function (substate) {\n                var photoUrl = \"\";\n                // console.log(\"Here is the main state:\");\n                // console.log(state);\n\n                // console.log(\"Here's the Sub-state: \");\n                // console.log(substate);\n                if (\n                    state.data.form.photo !== undefined &&\n                    state.data.form.photo !== \"\"\n                ) {\n                    photoUrl =\n                        \"https://www.commcarehq.org/a/\" +\n                        state.data.domain +\n                        \"/api/form/attachment/\" +\n                        state.data.form.meta.instanceID +\n                        \"/\" +\n                        state.data.form.photo;\n                }\n                return photoUrl;\n            }),\n            field(\"Date__c\", state.data.form.date),\n            field(\"Location_GPS__Latitude__s\", function (substate) {\n                const coords = state.data.form.gps_coordinates;\n                if (coords) {\n                    return coords.split(\" \")[0];\n                }\n                return \"\";\n            }),\n            field(\"Location_GPS__Longitude__s\", function (substate) {\n                const coords = state.data.form.gps_coordinates;\n                if (coords) {\n                    return coords.split(\" \")[1];\n                }\n                return \"\";\n            }),\n            field(\"Altitude__c\", function (substate) {\n                const coords = state.data.form.gps_coordinates;\n                if (coords) {\n                    return coords.split(\" \")[2];\n                }\n                return \"\";\n            }),\n            field(\"Updated_from_CommCare__c\", true)\n        )\n    )\n);\n\nbeta.each(\n    fn((substate) => {\n        // Initialize an empty array to store items with training sessions\n        var attendanceList = [];\n        // const session = \"\";\n\n        // Iterate over each item in the data\n        substate.data.form.barrios_repeat_group.item.forEach((item) => {\n            // Check if the item has a training session\n                if (item.hasOwnProperty(\"training_session\")) {\n                var participantsList = item.present_participants_repeat.split(\" \");\n                var trainingSession = item.training_session;\n                var createdObjects = []; // Array to store the created objects\n                participantsList.forEach((participant) => {\n                    // Create the participantAttendanceData object\n                    var createdObject = {\n                        id: participant,\n                        sessionId: trainingSession,\n                        submissionId: trainingSession + participant\n                    };\n                    // Push the created object into the array\n                    createdObjects.push(createdObject);\n                    // Create the participantAttendanceData record\n                    create('participantAttendanceData', createdObject);\n                });\n                // Concatenate the created objects with participantsList\n                attendanceList = attendanceList.concat(createdObjects);\n            }\n        });\n\n        return attendanceList;\n    }),\n    upsert(\n        \"Attendance__c\",\n        \"Submission_ID__c\",\n        fields(\n            field(\"Submission_ID__c\", dataValue(\"submissionId\")),\n            field(\"Status__c\", \"Present\"),\n            relationship(\n                \"Training_Session__r\",\n                \"CommCare_Case_Id__c\",\n                dataValue(\"sessionId\")\n            ),\n            relationship(\n                \"Participant__r\",\n                \"CommCare_Case_Id__c\",\n                dataValue(\"id\")\n            )\n        )\n    )\n);\n",
          "adaptor": "@openfn/language-salesforce@4.8.6",
          "project_credential_id": "55f298ba-f7d3-442c-9c27-ff1825d583f6"
        }
      },
      "edges": {
        "webhook->Coffee-PR-2022---Field-Day-Attendance-Full---CommCare----Salesforce": {
          "enabled": true,
          "id": "6f455700-c1e7-4a32-bcd1-8819301d67e6",
          "target_job_id": "1938dd5d-cfd1-44ae-b1ed-2ff78e982600",
          "source_trigger_id": "84feecdf-4da2-4030-88e7-32972a997b10",
          "condition_type": "js_expression",
          "condition_label": "Coffee PR 2022C Field Day Attendance Full CommCare Salesforce",
          "condition_expression": "state.data.form[\"@name\"] == \"Field Day Attendance Full\""
        }
      }
    },
    "Production---Coffee-CREW-C2024---Demo-Plot-Observations---CommCare----SalesForce": {
      "id": "b4d9ffb4-8da2-4744-a06e-3556be46c4f3",
      "name": "Production - Coffee CREW C2024 - Demo Plot Observations - CommCare -- SalesForce",
      "inserted_at": "2025-03-04T12:48:57.735896Z",
      "lock_version": 7,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "7bc40b38-5f5d-45cf-846c-090235a132d3",
          "type": "webhook"
        }
      },
      "jobs": {
        "DPO---Coffee-CREW-C2024---CommCare----SalesForce": {
          "id": "ef2c9dfb-dc59-42b6-8a6d-9c83a9c1b4a0",
          "name": "DPO - Coffee CREW C2024 - CommCare -- SalesForce",
          "body": "//Demo Plot Observations\n//Production - Coffee CREW C2024 | Demo Plot Observations | CommCare --> SalesForce\n\n\neach(\n\"$.data\",\n  upsert(\"Observation__c\", \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"id\")),\n      field(\"Observer__c\", dataValue(\"form.observer\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n      field(\"RecordTypeId\", dataValue(\"form.record_type\")),\n      field(\"Date__c\", dataValue(\"form.date\")),\n      field(\"Comments_1__c\", dataValue(\"form.visit_comments\")),\n      field(\"Demo_Plot_Photo__c\", function(state) {\n        var dempPlotPhotoUrl = '';\n        if(dataValue(\"form.Demo_Plot_Photo\")(state) !== undefined && dataValue(\"form.Demo_Plot_Photo\")(state) !== '') {\n          dempPlotPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Demo_Plot_Photo\")(state);  \n        }\n        return dempPlotPhotoUrl;\n      }),\n      \n      field(\"Observer_Signature__c\", function(state) {\n        var observerSignatureUrl = '';\n        if(dataValue(\"form.agronomy_advisor_signature\")(state) !== undefined && dataValue(\"form.agronomy_advisor_signature\")(state) !== '') {\n          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.agronomy_advisor_signature\")(state);  \n        }\n        return observerSignatureUrl;\n      }),\n      \n      field(\"Observation_Location__Latitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[0]; \n        }\n      }),\n      field(\"Observation_Location__Longitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[1]; \n        }\n      }),\n      field(\"Altitude__c\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[2]; \n        }\n      })\n    )\n  )\n),\n\n//HERE WE CAPTURE ALL THE DPO OBSERVATION RESULTS\n// Creates results for Stumped Trees\n\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__stumped_trees\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__stumped_trees\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.stumped.stumped_trees\"))\n  ))),\n\n// Create results for Sucker Selection\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__sucker_selection_taken_place\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__sucker_selection_taken_place\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.sucker_selection.Sucker_Selection_Taken_Place\")),\n    field(\"Result_number__c\", dataValue(\"form.best_practice_questions.sucker_selection.number_of_suckers\"))\n    \n  ))),\n\n\n\n// Create results for Compost Heap\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__compost_heap\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__compost_heap\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.compost_heap.present_compost_heap\")),\n    field(\"Compost_Photo__c\", function(state) {\n        var compostPhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state) !== '') {\n          compostPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state);  \n        }\n        return compostPhotoUrl;\n      })\n      \n    \n  ))),\n\n\n// Create results for Weed Management\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__weed_management\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__weed_management\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\")),\n    field(\"Result_Text__c\", dataValue(\"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\")),\n    field(\"Result_Text_Two__c\", function(state){\n      var weedsSize = '';\n      if(dataValue(\"form.best_practice_questions.weed_management.how_big_are_the_weeds\")(state) !== undefined){\n        weedsSize = dataValue(\"form.best_practice_questions.weed_management.how_big_are_the_weeds\")(state);\n      }\n      return weedsSize;\n    }),\n    field(\"Weed_Management_Photo__c\", function(state) {\n        var weedsPhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state) !== '') {\n          weedsPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state);  \n        }\n        return weedsPhotoUrl;\n      })\n  ))),\n\n\n// Create results for Shade Management\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__shade_management\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__shade_management\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.shade_management.level_of_shade_present\")),\n    field(\"Shade_Management_Photo__c\", function(state) {\n        var shadePhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state) !== '') {\n          shadePhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state);  \n        }\n        return shadePhotoUrl;\n      })\n  ))),\n\n\n// Create results for Mulch\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__mulch\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__mulch\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.mulch.mulch_under_the_canopy\")),\n    field(\"Result_Text__c\", dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\"))\n  ))),\n\n\n// Create results for Vetiver Planted\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__vetiver_planted\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__vetiver_planted\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\"))\n  )));\n\n/*\n// Create results for Shade_Trees_Planted {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__shade_trees_planted\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__shade_trees_planted\"),\n    field(\"Result__c\", dataValue(\"form.Shade_Trees_Planted\"))\n  ))),\n\n\n// Create results for Compost_Heap {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__compost_heap\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__compost_heap\"),\n    field(\"Result__c\", dataValue(\"form.Compost_Heap\")),\n    field(\"Photo_URL__c\", function(state) {\n        var compostHeapPhotoUrl = '';\n        if(dataValue(\"form.Photo_of_Compost_Heap\")(state) !== undefined && dataValue(\"form.Photo_of_Compost_Heap\")(state) !== '') {\n          compostHeapPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo_of_Compost_Heap\")(state);  \n        }\n        return compostHeapPhotoUrl;\n      })\n  ))),\n\n\n// Create results for Vertiver_Grass_on_Demo_Plot {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__vertiver_grass_on_demo_plot\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__vertiver_grass_on_demo_plot\"),\n    field(\"Result__c\", dataValue(\"form.Vertiver_Grass_on_Demo_Plot\"))\n  )));\n\n// Version control\n*/\n",
          "adaptor": "@openfn/language-salesforce@4.6.5",
          "project_credential_id": "55f298ba-f7d3-442c-9c27-ff1825d583f6"
        }
      },
      "edges": {
        "webhook->DPO---Coffee-CREW-C2024---CommCare----SalesForce": {
          "enabled": true,
          "id": "924a1c44-aa8d-45f1-b2fa-b008c9f03bb9",
          "target_job_id": "ef2c9dfb-dc59-42b6-8a6d-9c83a9c1b4a0",
          "source_trigger_id": "7bc40b38-5f5d-45cf-846c-090235a132d3",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee CREW C2024 Demo Plot Observations CommCare SalesForce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Demo Plot Observation\" && state.data[\"app_id\"] == \"f079b0daae1d4d34a89e331dc5a72fbd\""
        }
      }
    },
    "Production---Coffee-HWG-C2023---CommCare----SalesForce---Demo-Plot-Observations": {
      "id": "e5e9134d-1713-4086-b0ae-9e3a5f47a9d7",
      "name": "Production - Coffee HWG C2023 - CommCare -- SalesForce - Demo Plot Observations",
      "inserted_at": "2025-03-04T12:49:30.863393Z",
      "lock_version": 6,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "ac3960d5-557d-420f-9965-f8f5539ed621",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-HWG-C2023---CommCare----SalesForce---Demo-Plot-Observations": {
          "id": "f373735a-2a05-4f63-a885-af3b1fa4d6b5",
          "name": "Production - Coffee HWG C2023 - CommCare -- SalesForce - Demo Plot Observations",
          "body": "//Demo Plot Observations\n//Production - Coffee JCP HWG C2023 | Demo Plot Observations | CommCare --> SalesForce\n\n\neach(\n\"$.data\",\n  upsert(\"Observation__c\", \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"id\")),\n      field(\"Observer__c\", dataValue(\"form.observer\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n      field(\"RecordTypeId\", dataValue(\"form.record_type\")),\n      field(\"Date__c\", dataValue(\"form.date\")),\n      field(\"Comments_1__c\", dataValue(\"form.visit_comments\")),\n      field(\"Demo_Plot_Photo__c\", function(state) {\n        var dempPlotPhotoUrl = '';\n        if(dataValue(\"form.Demo_Plot_Photo\")(state) !== undefined && dataValue(\"form.Demo_Plot_Photo\")(state) !== '') {\n          dempPlotPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Demo_Plot_Photo\")(state);  \n        }\n        return dempPlotPhotoUrl;\n      }),\n      \n      field(\"Observer_Signature__c\", function(state) {\n        var observerSignatureUrl = '';\n        if(dataValue(\"form.agronomy_advisor_signature\")(state) !== undefined && dataValue(\"form.agronomy_advisor_signature\")(state) !== '') {\n          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.agronomy_advisor_signature\")(state);  \n        }\n        return observerSignatureUrl;\n      }),\n      \n      field(\"Observation_Location__Latitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[0]; \n        }\n      }),\n      field(\"Observation_Location__Longitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[1]; \n        }\n      }),\n      field(\"Altitude__c\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[2]; \n        }\n      })\n    )\n  )\n),\n\n//HERE WE CAPTURE ALL THE DPO OBSERVATION RESULTS\n// Creates results for Stumped Trees\n\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__stumped_trees\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__stumped_trees\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.stumped.stumped_trees\"))\n  ))),\n\n// Create results for Sucker Selection\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__sucker_selection_taken_place\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__sucker_selection_taken_place\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.sucker_selection.Sucker_Selection_Taken_Place\")),\n    field(\"Result_number__c\", dataValue(\"form.best_practice_questions.sucker_selection.number_of_suckers\"))\n    \n  ))),\n\n\n\n// Create results for Compost Heap\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__compost_heap\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__compost_heap\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.compost_heap.present_compost_heap\")),\n    field(\"Compost_Photo__c\", function(state) {\n        var compostPhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state) !== '') {\n          compostPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state);  \n        }\n        return compostPhotoUrl;\n      })\n      \n    \n  ))),\n\n\n// Create results for Weed Management\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__weed_management\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__weed_management\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\")),\n    field(\"Result_Text__c\", dataValue(\"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\")),\n    field(\"Result_Text_Two__c\", dataValue(\"form.best_practice_questions.weed_management.how_big_are_the_weeds\")),\n    field(\"Weed_Management_Photo__c\", function(state) {\n        var weedsPhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state) !== '') {\n          weedsPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state);  \n        }\n        return weedsPhotoUrl;\n      })\n  ))),\n\n\n// Create results for Shade Management\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__shade_management\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__shade_management\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.shade_management.level_of_shade_present\")),\n    field(\"Shade_Management_Photo__c\", function(state) {\n        var shadePhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state) !== '') {\n          shadePhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state);  \n        }\n        return shadePhotoUrl;\n      })\n  ))),\n\n\n// Create results for Mulch\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__mulch\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__mulch\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.mulch.mulch_under_the_canopy\")),\n    field(\"Result_Text__c\", dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\"))\n  ))),\n\n\n// Create results for Vetiver Planted\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__vetiver_planted\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__vetiver_planted\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\"))\n  )));\n\n/*\n// Create results for Shade_Trees_Planted {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__shade_trees_planted\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__shade_trees_planted\"),\n    field(\"Result__c\", dataValue(\"form.Shade_Trees_Planted\"))\n  ))),\n\n\n// Create results for Compost_Heap {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__compost_heap\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__compost_heap\"),\n    field(\"Result__c\", dataValue(\"form.Compost_Heap\")),\n    field(\"Photo_URL__c\", function(state) {\n        var compostHeapPhotoUrl = '';\n        if(dataValue(\"form.Photo_of_Compost_Heap\")(state) !== undefined && dataValue(\"form.Photo_of_Compost_Heap\")(state) !== '') {\n          compostHeapPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo_of_Compost_Heap\")(state);  \n        }\n        return compostHeapPhotoUrl;\n      })\n  ))),\n\n\n// Create results for Vertiver_Grass_on_Demo_Plot {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__vertiver_grass_on_demo_plot\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__vertiver_grass_on_demo_plot\"),\n    field(\"Result__c\", dataValue(\"form.Vertiver_Grass_on_Demo_Plot\"))\n  )));\n\n// Version control\n*/\n",
          "adaptor": "@openfn/language-salesforce@4.6.5",
          "project_credential_id": "55f298ba-f7d3-442c-9c27-ff1825d583f6"
        }
      },
      "edges": {
        "webhook->Production---Coffee-HWG-C2023---CommCare----SalesForce---Demo-Plot-Observations": {
          "enabled": true,
          "id": "7604584c-80b8-4ff7-9fc7-5a3b630d753e",
          "target_job_id": "f373735a-2a05-4f63-a885-af3b1fa4d6b5",
          "source_trigger_id": "ac3960d5-557d-420f-9965-f8f5539ed621",
          "condition_type": "js_expression",
          "condition_label": "Coffee HWG C2023 Demo Plot Observations CommCare -SalesForce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Demo Plot Observation\" && state.data[\"app_id\"] == \"d63cdcf6b9d849548413ca356871cd3a\""
        }
      }
    },
    "Production---Coffee-Regrow-YG-Ag-C2024---Demo-Plot-Observations---CommCare----SalesForce": {
      "id": "4f07509b-0223-47b6-9dd8-a0d5191d9d43",
      "name": "Production - Coffee Regrow YG Ag C2024 - Demo Plot Observations - CommCare -- SalesForce",
      "inserted_at": "2025-03-04T12:49:57.590195Z",
      "lock_version": 6,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "4831955d-cfc2-444f-b0e0-858a6de74a0b",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-Regrow-YG-Ag-C2024---Demo-Plot-Observations---CommCare----SalesForce": {
          "id": "641dda14-5a95-40dc-81ed-20a73e18ae0e",
          "name": "Production - Coffee Regrow YG Ag C2024 - Demo Plot Observations - CommCare -- SalesForce",
          "body": "//Demo Plot Observations\n//Production - Coffee Regrow Yirga Agronomy C2022 | Demo Plot Observations | CommCare --> SalesForce\n\n\neach(\n\"$.data\",\n  upsert(\"Observation__c\", \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"id\")),\n      field(\"Observer__c\", dataValue(\"form.observer\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n      field(\"RecordTypeId\", dataValue(\"form.record_type\")),\n      field(\"Date__c\", dataValue(\"form.date\")),\n      field(\"Comments_1__c\", dataValue(\"form.visit_comments\")),\n      field(\"Demo_Plot_Photo__c\", function(state) {\n        var dempPlotPhotoUrl = '';\n        if(dataValue(\"form.Demo_Plot_Photo\")(state) !== undefined && dataValue(\"form.Demo_Plot_Photo\")(state) !== '') {\n          dempPlotPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Demo_Plot_Photo\")(state);  \n        }\n        return dempPlotPhotoUrl;\n      }),\n      \n      field(\"Observer_Signature__c\", function(state) {\n        var observerSignatureUrl = '';\n        if(dataValue(\"form.agronomy_advisor_signature\")(state) !== undefined && dataValue(\"form.agronomy_advisor_signature\")(state) !== '') {\n          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.agronomy_advisor_signature\")(state);  \n        }\n        return observerSignatureUrl;\n      }),\n      \n      field(\"Observation_Location__Latitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[0]; \n        }\n      }),\n      field(\"Observation_Location__Longitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[1]; \n        }\n      }),\n      field(\"Altitude__c\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[2]; \n        }\n      })\n    )\n  )\n),\n\n//HERE WE CAPTURE ALL THE DPO OBSERVATION RESULTS\n// Creates results for Stumped Trees\n\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__stumped_trees\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__stumped_trees\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.stumped.stumped_trees\"))\n  ))),\n\n// Create results for Sucker Selection\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__sucker_selection_taken_place\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__sucker_selection_taken_place\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.sucker_selection.Sucker_Selection_Taken_Place\")),\n    field(\"Result_number__c\", dataValue(\"form.best_practice_questions.sucker_selection.number_of_suckers\"))\n    \n  ))),\n\n\n\n// Create results for Compost Heap\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__compost_heap\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__compost_heap\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.compost_heap.present_compost_heap\")),\n    field(\"Compost_Photo__c\", function(state) {\n        var compostPhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state) !== '') {\n          compostPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state);  \n        }\n        return compostPhotoUrl;\n      })\n      \n    \n  ))),\n\n\n// Create results for Weed Management\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__weed_management\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__weed_management\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\")),\n    field(\"Result_Text__c\", dataValue(\"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\")),\n    field(\"Result_Text_Two__c\", dataValue(\"form.best_practice_questions.weed_management.how_big_are_the_weeds\")),\n    field(\"Weed_Management_Photo__c\", function(state) {\n        var weedsPhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state) !== '') {\n          weedsPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state);  \n        }\n        return weedsPhotoUrl;\n      })\n  ))),\n\n\n// Create results for Shade Management\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__shade_management\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__shade_management\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.shade_management.level_of_shade_present\")),\n    field(\"Shade_Management_Photo__c\", function(state) {\n        var shadePhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state) !== '') {\n          shadePhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state);  \n        }\n        return shadePhotoUrl;\n      })\n  ))),\n\n\n// Create results for Mulch\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__mulch\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__mulch\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.mulch.mulch_under_the_canopy\")),\n    field(\"Result_Text__c\", dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\"))\n  ))),\n\n\n// Create results for Vetiver Planted\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_global__vetiver_planted\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__vetiver_planted\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\"))\n  )));\n\n/*\n// Create results for Shade_Trees_Planted {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__shade_trees_planted\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__shade_trees_planted\"),\n    field(\"Result__c\", dataValue(\"form.Shade_Trees_Planted\"))\n  ))),\n\n\n// Create results for Compost_Heap {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__compost_heap\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__compost_heap\"),\n    field(\"Result__c\", dataValue(\"form.Compost_Heap\")),\n    field(\"Photo_URL__c\", function(state) {\n        var compostHeapPhotoUrl = '';\n        if(dataValue(\"form.Photo_of_Compost_Heap\")(state) !== undefined && dataValue(\"form.Photo_of_Compost_Heap\")(state) !== '') {\n          compostHeapPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo_of_Compost_Heap\")(state);  \n        }\n        return compostHeapPhotoUrl;\n      })\n  ))),\n\n\n// Create results for Vertiver_Grass_on_Demo_Plot {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__vertiver_grass_on_demo_plot\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__vertiver_grass_on_demo_plot\"),\n    field(\"Result__c\", dataValue(\"form.Vertiver_Grass_on_Demo_Plot\"))\n  )));\n\n// Version control\n*/\n",
          "adaptor": "@openfn/language-salesforce@4.6.5",
          "project_credential_id": "55f298ba-f7d3-442c-9c27-ff1825d583f6"
        }
      },
      "edges": {
        "webhook->Production---Coffee-Regrow-YG-Ag-C2024---Demo-Plot-Observations---CommCare----SalesForce": {
          "enabled": true,
          "id": "12cc9935-f773-4a24-bf9b-cb9098fcfe86",
          "target_job_id": "641dda14-5a95-40dc-81ed-20a73e18ae0e",
          "source_trigger_id": "4831955d-cfc2-444f-b0e0-858a6de74a0b",
          "condition_type": "js_expression",
          "condition_label": "Coffee Regrow Yirga C2024 Demo Plot Observations CommCare SalesForce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Demo Plot Observation\" && state.data[\"app_id\"] == \"dd10fc19040d40f0be48a447e1d2727c\""
        }
      }
    },
    "Production---Coffee-KE-Nespresso-2024AC---CommCare----SalesForce---Demo-Plot-Observations": {
      "id": "2174f57b-9b4a-4427-b4d0-3d0d2da8bdcc",
      "name": "Production - Coffee KE Nespresso 2024AC - CommCare -- SalesForce - Demo Plot Observations",
      "inserted_at": "2025-03-04T12:50:13.825460Z",
      "lock_version": 6,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "bc37eac4-f321-4d84-86e1-4bbf92746f8f",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-KE-Nespresso-2024AC---CommCare----SalesForce---Demo-Plot-Observations": {
          "id": "36868a0e-f38f-44f9-8f92-0da79d11b404",
          "name": "Production - Coffee KE Nespresso 2024AC - CommCare -- SalesForce - Demo Plot Observations",
          "body": "//Demo Plot Observations\n//Production - Coffee KE Nespresso 2024AC | Demo Plot Observations | CommCare --> SalesForce\n\neach(\n  \"$.data\",\n  upsert(\n    \"Observation__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"id\")),\n      field(\"Observer__c\", dataValue(\"form.observer\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n      field(\"RecordTypeId\", dataValue(\"form.record_type\")),\n      field(\"Date__c\", dataValue(\"form.date\")),\n      field(\"Comments_1__c\", dataValue(\"form.visit_comments\")),\n      field(\"Demo_Plot_Photo__c\", function (state) {\n        var demoPlotPhotoUrl = \"\";\n        if (\n          dataValue(\"form.Demo_Plot_Photo\")(state) !== undefined &&\n          dataValue(\"form.Demo_Plot_Photo\")(state) !== \"\"\n        ) {\n          demoPlotPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.Demo_Plot_Photo\")(state);\n        }\n        return demoPlotPhotoUrl;\n      }),\n\n      field(\"Observer_Signature__c\", function (state) {\n        var observerSignatureUrl = \"\";\n        if (\n          dataValue(\"form.agronomy_advisor_signature\")(state) !== undefined &&\n          dataValue(\"form.agronomy_advisor_signature\")(state) !== \"\"\n        ) {\n          observerSignatureUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.agronomy_advisor_signature\")(state);\n        }\n        return observerSignatureUrl;\n      }),\n\n      field(\"Observation_Location__Latitude__s\", function (state) {\n        if (dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(\n            \" \"\n          );\n          return coordinates[0];\n        }\n      }),\n      field(\"Observation_Location__Longitude__s\", function (state) {\n        if (dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(\n            \" \"\n          );\n          return coordinates[1];\n        }\n      }),\n      field(\"Altitude__c\", function (state) {\n        if (dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(\n            \" \"\n          );\n          return coordinates[2];\n        }\n      })\n    )\n  )\n);\n\n// Pruning data handler\nbeta.each(\n  function (state) {\n    //incoming pruning data\n    var pruning_data = dataValue(\n      \"form.best_practice_questions.pruning.pruning_methods\"\n    )(state);\n\n    if (pruning_data !== undefined) {\n      return pruning_data.split(\" \").map(function (resultId) {\n        return {\n          result_data: resultId,\n          dpo_submission: dataValue(\"id\")(state) + \"coffee_global__pruning\" + resultId,\n        };\n      });\n    }\n  },\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"dpo_submission\")),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__pruning\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnResults = \"\";\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"1\"\n        ) {\n          returnResults = \"Centers opened\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"2\"\n        ) {\n          returnResults = \"Unwanted suckers removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"3\"\n        ) {\n          returnResults = \"Dead branches removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"4\"\n        ) {\n          returnResults = \"Branches touching the ground removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"5\"\n        ) {\n          returnResults = \"Broken/unproductive stems and/or branches removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"0\"\n        ) {\n          returnResults = \"No pruning methods used\";\n        }\n\n        return returnResults;\n      })\n    )\n  )\n);\n\n// //HERE WE CAPTURE ALL THE DPO OBSERVATION RESULTS\n\n// // Create results for Pruning\n// beta.each(\n//   //\"$.data\",\n//   function (state) {\n//     var pruningData = dataValue(\n//       \"form.best_practice_questions.pruning.pruning_methods\"\n//     )(state);\n//     if (pruningData !== undefined) {\n//       return pruningData.split(\" \").map(function (resultId) {\n//         return {\n//         result_data: resultId,\n//         };\n//         console.log(resultId);\n//       });\n//     }\n//   },\n//   upsert(\n//     \"Observation_Result__c\",\n//     \"Submission_ID__c\",\n//     fields(\n//       field(\"Submission_ID__c\", function (state) {\n//         return dataValue(\"id\")(state) + \"coffee_global__pruning\";\n//       }),\n//       field(\"Observation__c\", function (state) {\n//         return state.references[state.references.length - 1].id;\n//       }),\n//       field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n//       relationship(\n//         \"Observation_Criterion__r\",\n//         \"Unique_Name__c\",\n//         \"coffee_global__pruning\"\n//       ),\n//       field(\"Result__c\", function (state) {\n//         var returnPruning = \"\";\n\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"1\"\n//         ) {\n//           returnPruning = \"Centers opened\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"2\"\n//         ) {\n//           returnPruning = \"Unwanted suckers removed\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"3\"\n//         ) {\n//           returnPruning = \"Dead branches removed\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"4\"\n//         ) {\n//           returnPruning = \"Branches touching the ground removed\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"5\"\n//         ) {\n//           returnPruning = \"Broken/unproductive stems and/or branches removed\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"0\"\n//         ) {\n//           returnPruning = \"No pruning methods used\";\n//         }\n//         return returnPruning;\n//       })\n//     )\n//   )\n// ),\n\n// Create results for Compost Heap\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__compost_heap\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__compost_heap\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnCompost = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) == \"1\" &&\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) !== undefined\n        ) {\n          returnCompost = \"Yes, compost or manure heap seen\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) == \"0\" &&\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) !== undefined\n        ) {\n          returnCompost = \"No compost or manure heap seen\";\n        }\n        return returnCompost;\n      }),\n      field(\"Compost_Photo__c\", function (state) {\n        var compostPhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.compost_heap.compost_heap_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.compost_heap.compost_heap_photo\"\n          )(state) !== \"\"\n        ) {\n          compostPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.compost_heap.compost_heap_photo\"\n            )(state);\n        }\n        return compostPhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Weed Management\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__weed_management\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__weed_management\"\n      ),\n\n      //Q1\n      field(\"Result__c\", function (state) {\n        var returnWeeds = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) == \"1\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) !== undefined\n        ) {\n          returnWeeds = \"Yes, field dug\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) == \"0\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) !== undefined\n        ) {\n          returnWeeds = \"No sign of digging\";\n        }\n        return returnWeeds;\n      }),\n\n      //Q2\n      field(\"Result_Text__c\", function (state) {\n        var returnWeeds2 = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) == \"0\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) !== undefined\n        ) {\n          returnWeeds2 = \"No weeds under the tree canopy\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) == \"1\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) !== undefined\n        ) {\n          returnWeeds2 = \"Few weeds under the tree canopy\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) == \"2\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) !== undefined\n        ) {\n          returnWeeds2 = \"Many weeds under the tree canopy\";\n        }\n\n        return returnWeeds2;\n      }),\n\n      //Q3\n      field(\"Result_Text_Two__c\", function (state) {\n        var returnWeeds3 = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) == \"1\"\n        ) {\n          returnWeeds3 =\n            \"Weeds are less than 30cm tall or 30cm spread for grasses\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) == \"2\"\n        ) {\n          returnWeeds3 =\n            \"Weeds are more than 30cm tall or 30cm spread for grasses\";\n        }\n        return returnWeeds3;\n      }),\n\n      field(\"Weed_Management_Photo__c\", function (state) {\n        var weedsPhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.weed_management_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.weed_management_photo\"\n          )(state) !== \"\"\n        ) {\n          weedsPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.weed_management.weed_management_photo\"\n            )(state);\n        }\n        return weedsPhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Shade Management\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__shade_management\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__shade_management\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnShade = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"0\"\n        ) {\n          returnShade = \"NO shade, less than 5%\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"1\"\n        ) {\n          returnShade = \"Light shade, 5 to 20%\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"2\"\n        ) {\n          returnShade = \"Medium shade, 20 to 40%\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"3\"\n        ) {\n          returnShade = \"Heavy shade, over 40%\";\n        }\n        return returnShade;\n      }),\n      field(\"Shade_Management_Photo__c\", function (state) {\n        var shadePhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.shade_management_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.shade_management_photo\"\n          )(state) !== \"\"\n        ) {\n          shadePhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.shade_management.shade_management_photo\"\n            )(state);\n        }\n        return shadePhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Mulch\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__mulch\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__mulch\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnMulch = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) == \"1\"\n        ) {\n          returnMulch = \"Yes, Some mulch seen\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) == \"0\"\n        ) {\n          returnMulch = \"No mulch seen\";\n        }\n        return returnMulch;\n      }),\n      field(\"Result_Text__c\", function (state) {\n        var returnMulch2 = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) == \"1\"\n        ) {\n          returnMulch2 = \"Soil can be seen clearly, less than 2cm of mulch\";\n        } else if (\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) == \"2\"\n        ) {\n          returnMulch2 = \"Soil can not be seen, more than 2cm of mulch\";\n        }\n        return returnMulch2;\n      })\n    )\n  )\n);\n\n// Create results for Vetiver Planted\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__vetiver_planted\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__vetiver_planted\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnVetiver = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\")(\n            state\n          ) == \"1\"\n        ) {\n          returnVetiver = \"Yes. Row of vetiver planted\";\n        } else if (\n          dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\")(\n            state\n          ) == \"0\"\n        ) {\n          returnVetiver = \"No. Vetiver not planted\";\n        }\n        return returnVetiver;\n      })\n    )\n  )\n);\n\n// Create results for Rejuvenation\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__rejuvenation\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__rejuvenation\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnRejuventation = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.rejuvenation.rejuvenation_plot\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.rejuvenation.rejuvenation_plot\"\n          )(state) == 1\n        ) {\n          returnRejuventation = \"Yes. There is a rejuvenated plot\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.rejuvenation.rejuvenation_plot\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.rejuvenation.rejuvenation_plot\"\n          )(state) == 0\n        ) {\n          returnRejuventation = \"No rejuvenated plot\";\n        }\n        return returnRejuventation;\n      }),\n      field(\"Result_Text__c\", function (state) {\n        var returnRejuventation2 = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n            state\n          ) == 1\n        ) {\n          returnRejuventation2 = \"Yes. Sucker selection is complete\";\n        } else if (\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n            state\n          ) == 0\n        ) {\n          returnRejuventation2 = \"No. Sucker selection has not been done\";\n        }\n        return returnRejuventation2;\n      }),\n\n      field(\"Rejuvenation_Photo__c\", function (state) {\n        var RejuvenationPhotoUrl = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_photo\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_photo\")(\n            state\n          ) !== \"\"\n        ) {\n          RejuvenationPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.rejuvenation.suckers_photo\"\n            )(state);\n        }\n        return RejuvenationPhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Sucker Selection\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function(state) {\n        return dataValue(\"id\")(state) + \"coffee_global__sucker_selection_taken_place\";\n      }),\n      field(\"Observation__c\",function(state){\n        return state.references[state.references.length-1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__sucker_selection_taken_place\"),\n      field(\"Result__c\", function (state) {\n          var sucker_selection = \"\";\n          if (\n            dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n              state\n            ) !== undefined &&\n            dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n              state\n            ) == 1\n          ) {\n            sucker_selection = \"Yes. Sucker selection is complete\";\n          } else if (\n            dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n              state\n            ) !== undefined &&\n            dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n              state\n            ) == 0\n          ) {\n            sucker_selection = \"No. Sucker selection has not been done\";\n          }\n          return sucker_selection;\n        }\n      ),\n      field(\"Result_number__c\",\"2\")\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-salesforce@4.6.5",
          "project_credential_id": "55f298ba-f7d3-442c-9c27-ff1825d583f6"
        }
      },
      "edges": {
        "webhook->Production---Coffee-KE-Nespresso-2024AC---CommCare----SalesForce---Demo-Plot-Observations": {
          "enabled": true,
          "id": "dc76a733-58be-43c3-8478-7dd106dbae1f",
          "target_job_id": "36868a0e-f38f-44f9-8f92-0da79d11b404",
          "source_trigger_id": "bc37eac4-f321-4d84-86e1-4bbf92746f8f",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE 2024AC CommCare SalesForce Demo Plot Observations",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Demo Plot Observation\" && state.data[\"app_id\"] == \"30cee26f064e403388e334ae7b0c403b\""
        }
      }
    },
    "Production---Coffee-KE-Nespresso-C2023---Demo-Plot-Observations---CommCare----SalesForce": {
      "id": "59dba392-bda5-4763-a611-7ee76c925ee4",
      "name": "Production - Coffee KE Nespresso C2023 - Demo Plot Observations - CommCare -- SalesForce",
      "inserted_at": "2025-03-04T12:50:26.276895Z",
      "lock_version": 6,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "447dff8d-8788-49a9-8c50-feb46dd02426",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-KE-Nespresso-C2023---Demo-Plot-Observations---CommCare----SalesForce": {
          "id": "d90ad195-681c-4834-a1df-6dfaa3d06278",
          "name": "Production - Coffee KE Nespresso C2023 - Demo Plot Observations - CommCare -- SalesForce",
          "body": "//Demo Plot Observations\n//Production - Coffee KE Nespresso 2023C | Demo Plot Observations | CommCare --> SalesForce\n\neach(\n  \"$.data\",\n  upsert(\n    \"Observation__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"id\")),\n      field(\"Observer__c\", dataValue(\"form.observer\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n      field(\"RecordTypeId\", dataValue(\"form.record_type\")),\n      field(\"Date__c\", dataValue(\"form.date\")),\n      field(\"Comments_1__c\", dataValue(\"form.visit_comments\")),\n      field(\"Demo_Plot_Photo__c\", function (state) {\n        var demoPlotPhotoUrl = \"\";\n        if (\n          dataValue(\"form.Demo_Plot_Photo\")(state) !== undefined &&\n          dataValue(\"form.Demo_Plot_Photo\")(state) !== \"\"\n        ) {\n          demoPlotPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.Demo_Plot_Photo\")(state);\n        }\n        return demoPlotPhotoUrl;\n      }),\n\n      field(\"Observer_Signature__c\", function (state) {\n        var observerSignatureUrl = \"\";\n        if (\n          dataValue(\"form.agronomy_advisor_signature\")(state) !== undefined &&\n          dataValue(\"form.agronomy_advisor_signature\")(state) !== \"\"\n        ) {\n          observerSignatureUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.agronomy_advisor_signature\")(state);\n        }\n        return observerSignatureUrl;\n      }),\n\n      field(\"Observation_Location__Latitude__s\", function (state) {\n        if (dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(\n            \" \"\n          );\n          return coordinates[0];\n        }\n      }),\n      field(\"Observation_Location__Longitude__s\", function (state) {\n        if (dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(\n            \" \"\n          );\n          return coordinates[1];\n        }\n      }),\n      field(\"Altitude__c\", function (state) {\n        if (dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(\n            \" \"\n          );\n          return coordinates[2];\n        }\n      })\n    )\n  )\n);\n\n// Pruning data handler\nbeta.each(\n  function (state) {\n    //incoming pruning data\n    var pruning_data = dataValue(\n      \"form.best_practice_questions.pruning.pruning_methods\"\n    )(state);\n\n    if (pruning_data !== undefined) {\n      return pruning_data.split(\" \").map(function (resultId) {\n        return {\n          result_data: resultId,\n          dpo_submission: dataValue(\"id\")(state) + \"coffee_global__pruning\" + resultId,\n        };\n      });\n    }\n  },\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"dpo_submission\")),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__pruning\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnResults = \"\";\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"1\"\n        ) {\n          returnResults = \"Centers opened\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"2\"\n        ) {\n          returnResults = \"Unwanted suckers removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"3\"\n        ) {\n          returnResults = \"Dead branches removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"4\"\n        ) {\n          returnResults = \"Branches touching the ground removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"5\"\n        ) {\n          returnResults = \"Broken/unproductive stems and/or branches removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"0\"\n        ) {\n          returnResults = \"No pruning methods used\";\n        }\n\n        return returnResults;\n      })\n    )\n  )\n);\n\n// //HERE WE CAPTURE ALL THE DPO OBSERVATION RESULTS\n\n// // Create results for Pruning\n// beta.each(\n//   //\"$.data\",\n//   function (state) {\n//     var pruningData = dataValue(\n//       \"form.best_practice_questions.pruning.pruning_methods\"\n//     )(state);\n//     if (pruningData !== undefined) {\n//       return pruningData.split(\" \").map(function (resultId) {\n//         return {\n//         result_data: resultId,\n//         };\n//         console.log(resultId);\n//       });\n//     }\n//   },\n//   upsert(\n//     \"Observation_Result__c\",\n//     \"Submission_ID__c\",\n//     fields(\n//       field(\"Submission_ID__c\", function (state) {\n//         return dataValue(\"id\")(state) + \"coffee_global__pruning\";\n//       }),\n//       field(\"Observation__c\", function (state) {\n//         return state.references[state.references.length - 1].id;\n//       }),\n//       field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n//       relationship(\n//         \"Observation_Criterion__r\",\n//         \"Unique_Name__c\",\n//         \"coffee_global__pruning\"\n//       ),\n//       field(\"Result__c\", function (state) {\n//         var returnPruning = \"\";\n\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"1\"\n//         ) {\n//           returnPruning = \"Centers opened\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"2\"\n//         ) {\n//           returnPruning = \"Unwanted suckers removed\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"3\"\n//         ) {\n//           returnPruning = \"Dead branches removed\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"4\"\n//         ) {\n//           returnPruning = \"Branches touching the ground removed\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"5\"\n//         ) {\n//           returnPruning = \"Broken/unproductive stems and/or branches removed\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"0\"\n//         ) {\n//           returnPruning = \"No pruning methods used\";\n//         }\n//         return returnPruning;\n//       })\n//     )\n//   )\n// ),\n\n// Create results for Compost Heap\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__compost_heap\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__compost_heap\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnCompost = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) == \"1\" &&\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) !== undefined\n        ) {\n          returnCompost = \"Yes, compost or manure heap seen\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) == \"0\" &&\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) !== undefined\n        ) {\n          returnCompost = \"No compost or manure heap seen\";\n        }\n        return returnCompost;\n      }),\n      field(\"Compost_Photo__c\", function (state) {\n        var compostPhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.compost_heap.compost_heap_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.compost_heap.compost_heap_photo\"\n          )(state) !== \"\"\n        ) {\n          compostPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.compost_heap.compost_heap_photo\"\n            )(state);\n        }\n        return compostPhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Weed Management\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__weed_management\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__weed_management\"\n      ),\n\n      //Q1\n      field(\"Result__c\", function (state) {\n        var returnWeeds = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) == \"1\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) !== undefined\n        ) {\n          returnWeeds = \"Yes, field dug\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) == \"0\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) !== undefined\n        ) {\n          returnWeeds = \"No sign of digging\";\n        }\n        return returnWeeds;\n      }),\n\n      //Q2\n      field(\"Result_Text__c\", function (state) {\n        var returnWeeds2 = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) == \"0\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) !== undefined\n        ) {\n          returnWeeds2 = \"No weeds under the tree canopy\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) == \"1\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) !== undefined\n        ) {\n          returnWeeds2 = \"Few weeds under the tree canopy\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) == \"2\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) !== undefined\n        ) {\n          returnWeeds2 = \"Many weeds under the tree canopy\";\n        }\n\n        return returnWeeds2;\n      }),\n\n      //Q3\n      field(\"Result_Text_Two__c\", function (state) {\n        var returnWeeds3 = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) == \"1\"\n        ) {\n          returnWeeds3 =\n            \"Weeds are less than 30cm tall or 30cm spread for grasses\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) == \"2\"\n        ) {\n          returnWeeds3 =\n            \"Weeds are more than 30cm tall or 30cm spread for grasses\";\n        }\n        return returnWeeds3;\n      }),\n\n      field(\"Weed_Management_Photo__c\", function (state) {\n        var weedsPhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.weed_management_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.weed_management_photo\"\n          )(state) !== \"\"\n        ) {\n          weedsPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.weed_management.weed_management_photo\"\n            )(state);\n        }\n        return weedsPhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Shade Management\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__shade_management\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__shade_management\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnShade = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"0\"\n        ) {\n          returnShade = \"NO shade, less than 5%\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"1\"\n        ) {\n          returnShade = \"Light shade, 5 to 20%\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"2\"\n        ) {\n          returnShade = \"Medium shade, 20 to 40%\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"3\"\n        ) {\n          returnShade = \"Heavy shade, over 40%\";\n        }\n        return returnShade;\n      }),\n      field(\"Shade_Management_Photo__c\", function (state) {\n        var shadePhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.shade_management_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.shade_management_photo\"\n          )(state) !== \"\"\n        ) {\n          shadePhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.shade_management.shade_management_photo\"\n            )(state);\n        }\n        return shadePhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Mulch\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__mulch\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__mulch\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnMulch = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) == \"1\"\n        ) {\n          returnMulch = \"Yes, Some mulch seen\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) == \"0\"\n        ) {\n          returnMulch = \"No mulch seen\";\n        }\n        return returnMulch;\n      }),\n      field(\"Result_Text__c\", function (state) {\n        var returnMulch2 = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) == \"1\"\n        ) {\n          returnMulch2 = \"Soil can be seen clearly, less than 2cm of mulch\";\n        } else if (\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) == \"2\"\n        ) {\n          returnMulch2 = \"Soil can not be seen, more than 2cm of mulch\";\n        }\n        return returnMulch2;\n      })\n    )\n  )\n);\n\n// Create results for Vetiver Planted\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__vetiver_planted\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__vetiver_planted\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnVetiver = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\")(\n            state\n          ) == \"1\"\n        ) {\n          returnVetiver = \"Yes. Row of vetiver planted\";\n        } else if (\n          dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\")(\n            state\n          ) == \"0\"\n        ) {\n          returnVetiver = \"No. Vetiver not planted\";\n        }\n        return returnVetiver;\n      })\n    )\n  )\n);\n\n// Create results for Rejuvenation\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__rejuvenation\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__rejuvenation\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnRejuventation = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.rejuvenation.rejuvenation_plot\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.rejuvenation.rejuvenation_plot\"\n          )(state) == 1\n        ) {\n          returnRejuventation = \"Yes. There is a rejuvenated plot\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.rejuvenation.rejuvenation_plot\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.rejuvenation.rejuvenation_plot\"\n          )(state) == 0\n        ) {\n          returnRejuventation = \"No rejuvenated plot\";\n        }\n        return returnRejuventation;\n      }),\n      field(\"Result_Text__c\", function (state) {\n        var returnRejuventation2 = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n            state\n          ) == 1\n        ) {\n          returnRejuventation2 = \"Yes. Sucker selection is complete\";\n        } else if (\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n            state\n          ) == 0\n        ) {\n          returnRejuventation2 = \"No. Sucker selection has not been done\";\n        }\n        return returnRejuventation2;\n      }),\n\n      field(\"Rejuvenation_Photo__c\", function (state) {\n        var RejuvenationPhotoUrl = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_photo\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_photo\")(\n            state\n          ) !== \"\"\n        ) {\n          RejuvenationPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.rejuvenation.suckers_photo\"\n            )(state);\n        }\n        return RejuvenationPhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Sucker Selection\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function(state) {\n        return dataValue(\"id\")(state) + \"coffee_global__sucker_selection_taken_place\";\n      }),\n      field(\"Observation__c\",function(state){\n        return state.references[state.references.length-1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_global__sucker_selection_taken_place\"),\n      field(\"Result__c\", function (state) {\n          var sucker_selection = \"\";\n          if (\n            dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n              state\n            ) !== undefined &&\n            dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n              state\n            ) == 1\n          ) {\n            sucker_selection = \"Yes. Sucker selection is complete\";\n          } else if (\n            dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n              state\n            ) !== undefined &&\n            dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n              state\n            ) == 0\n          ) {\n            sucker_selection = \"No. Sucker selection has not been done\";\n          }\n          return sucker_selection;\n        }\n      ),\n      field(\"Result_number__c\",\"2\")\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-salesforce@4.6.5",
          "project_credential_id": "55f298ba-f7d3-442c-9c27-ff1825d583f6"
        }
      },
      "edges": {
        "webhook->Production---Coffee-KE-Nespresso-C2023---Demo-Plot-Observations---CommCare----SalesForce": {
          "enabled": true,
          "id": "9230be51-2706-4779-8a22-9e7cc9698e0f",
          "target_job_id": "d90ad195-681c-4834-a1df-6dfaa3d06278",
          "source_trigger_id": "447dff8d-8788-49a9-8c50-feb46dd02426",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE Nespresso C2023 Demo Plot Observations CommCare SalesForce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Demo Plot Observation\" && state.data[\"app_id\"] == \"ae6ad2d1fb104da5be0dbb1d431db8b4\""
        }
      }
    },
    "Production---Coffee-ZW-Nespresso-C2021---Demo-Plot-Observations---CommCare----SalesForce": {
      "id": "c62a0f7d-49cd-493b-bfe5-fdf5aaa885e2",
      "name": "Production - Coffee ZW Nespresso C2021 - Demo Plot Observations - CommCare -- SalesForce",
      "inserted_at": "2025-03-04T12:50:38.128954Z",
      "lock_version": 6,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "a5ad99ff-af41-4b72-aedf-6ff480a87a9d",
          "type": "webhook"
        }
      },
      "jobs": {
        "DPO---ZIM-Nespresso-C2021---CommCare---SalesForce": {
          "id": "a00c7a81-e09a-45dc-bf8a-caa028e9c815",
          "name": "DPO - ZIM Nespresso C2021 - CommCare - SalesForce",
          "body": "//Demo Plot Observations\n//Production - Coffee ZW NN 2021C | Demo Plot Observations | CommCare --> SalesForce\n\neach(\n  \"$.data\",\n  upsert(\n    \"Observation__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"id\")),\n      field(\"Observer__c\", dataValue(\"form.observer\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n      field(\"RecordTypeId\", dataValue(\"form.record_type\")),\n      field(\"Date__c\", dataValue(\"form.date\")),\n      field(\"Comments_1__c\", dataValue(\"form.visit_comments\")),\n      field(\"Demo_Plot_Photo__c\", function (state) {\n        var demoPlotPhotoUrl = \"\";\n        if (\n          dataValue(\"form.Demo_Plot_Photo\")(state) !== undefined &&\n          dataValue(\"form.Demo_Plot_Photo\")(state) !== \"\"\n        ) {\n          demoPlotPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.Demo_Plot_Photo\")(state);\n        }\n        return demoPlotPhotoUrl;\n      }),\n\n      field(\"Observer_Signature__c\", function (state) {\n        var observerSignatureUrl = \"\";\n        if (\n          dataValue(\"form.agronomy_advisor_signature\")(state) !== undefined &&\n          dataValue(\"form.agronomy_advisor_signature\")(state) !== \"\"\n        ) {\n          observerSignatureUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.agronomy_advisor_signature\")(state);\n        }\n        return observerSignatureUrl;\n      }),\n\n      field(\"Observation_Location__Latitude__s\", function (state) {\n        if (dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(\n            \" \"\n          );\n          return coordinates[0];\n        }\n      }),\n      field(\"Observation_Location__Longitude__s\", function (state) {\n        if (dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(\n            \" \"\n          );\n          return coordinates[1];\n        }\n      }),\n      field(\"Altitude__c\", function (state) {\n        if (dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(\n            \" \"\n          );\n          return coordinates[2];\n        }\n      })\n    )\n  )\n);\n\n// Cover Crop Data Handler\nbeta.each(\n  function (state) {\n    //incoming Covercrop\n    var covercropping_data = dataValue(\n      \"form.best_practice_questions.covercropping.covercrop_present\"\n    )(state);\n\n    if (covercropping_data !== undefined) {\n      return covercropping_data.split(\" \").map(function (resultId) {\n        return {\n          result_data: resultId,\n          dpo_submission: dataValue(\"id\")(state) + \"coffee_global__covercrop_planted\" + resultId,\n        };\n      });\n    }\n  },\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"dpo_submission\")),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__covercrop_planted\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnResults = \"\";\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"1\"\n        ) {\n          returnResults = \"Arachis\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"2\"\n        ) {\n          returnResults = \"Beans\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"3\"\n        ) {\n          returnResults = \"Mulch\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"0\"\n        ) {\n          returnResults = \"No Covercropping Practice\";\n        }\n\n        return returnResults;\n      })\n    )\n  )\n);\n\n// Create results for Compost Heap\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__compost_heap\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__compost_heap\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnCompost = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) == \"1\" &&\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) !== undefined\n        ) {\n          returnCompost = \"Yes, compost or manure heap seen\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) == \"0\" &&\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) !== undefined\n        ) {\n          returnCompost = \"No compost or manure heap seen\";\n        }\n        return returnCompost;\n      }),\n      field(\"Compost_Photo__c\", function (state) {\n        var compostPhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.compost_heap.compost_heap_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.compost_heap.compost_heap_photo\"\n          )(state) !== \"\"\n        ) {\n          compostPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.compost_heap.compost_heap_photo\"\n            )(state);\n        }\n        return compostPhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Weed Management\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__weed_management\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__weed_management\"\n      ),\n\n      //Q1\n      field(\"Result__c\", function (state) {\n        var returnWeeds = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) == \"1\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) !== undefined\n        ) {\n          returnWeeds = \"Yes, field dug\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) == \"0\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) !== undefined\n        ) {\n          returnWeeds = \"No sign of digging\";\n        }\n        return returnWeeds;\n      }),\n\n      //Q2\n      field(\"Result_Text__c\", function (state) {\n        var returnWeeds2 = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) == \"0\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) !== undefined\n        ) {\n          returnWeeds2 = \"No weeds under the tree canopy\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) == \"1\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) !== undefined\n        ) {\n          returnWeeds2 = \"Few weeds under the tree canopy\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) == \"2\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) !== undefined\n        ) {\n          returnWeeds2 = \"Many weeds under the tree canopy\";\n        }\n\n        return returnWeeds2;\n      }),\n\n      //Q3\n      field(\"Result_Text_Two__c\", function (state) {\n        var returnWeeds3 = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) == \"1\"\n        ) {\n          returnWeeds3 =\n            \"Weeds are less than 30cm tall or 30cm spread for grasses\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) == \"2\"\n        ) {\n          returnWeeds3 =\n            \"Weeds are more than 30cm tall or 30cm spread for grasses\";\n        }\n        return returnWeeds3;\n      }),\n\n      field(\"Weed_Management_Photo__c\", function (state) {\n        var weedsPhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.weed_management_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.weed_management_photo\"\n          )(state) !== \"\"\n        ) {\n          weedsPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.weed_management.weed_management_photo\"\n            )(state);\n        }\n        return weedsPhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Shade Management\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__shade_management\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__shade_management\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnShade = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"0\"\n        ) {\n          returnShade = \"NO shade, less than 5%\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"1\"\n        ) {\n          returnShade = \"Light shade, 5 to 20%\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"2\"\n        ) {\n          returnShade = \"Medium shade, 20 to 40%\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"3\"\n        ) {\n          returnShade = \"Heavy shade, over 40%\";\n        }\n        return returnShade;\n      }),\n      field(\"Shade_Management_Photo__c\", function (state) {\n        var shadePhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.shade_management_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.shade_management_photo\"\n          )(state) !== \"\"\n        ) {\n          shadePhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.shade_management.shade_management_photo\"\n            )(state);\n        }\n        return shadePhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Mulch\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__mulch\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__mulch\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnMulch = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) == \"1\"\n        ) {\n          returnMulch = \"Yes, Some mulch seen\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) == \"0\"\n        ) {\n          returnMulch = \"No mulch seen\";\n        }\n        return returnMulch;\n      }),\n      field(\"Result_Text__c\", function (state) {\n        var returnMulch2 = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) == \"1\"\n        ) {\n          returnMulch2 = \"Soil can be seen clearly, less than 2cm of mulch\";\n        } else if (\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) == \"2\"\n        ) {\n          returnMulch2 = \"Soil can not be seen, more than 2cm of mulch\";\n        }\n        return returnMulch2;\n      })\n    )\n  )\n);\n\n// Create results for Vetiver Planted\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_global__vetiver_planted\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_global__vetiver_planted\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnVetiver = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\")(\n            state\n          ) == \"1\"\n        ) {\n          returnVetiver = \"Yes. Row of vetiver planted\";\n        } else if (\n          dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\")(\n            state\n          ) == \"0\"\n        ) {\n          returnVetiver = \"No. Vetiver not planted\";\n        }\n        return returnVetiver;\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-salesforce@4.6.5",
          "project_credential_id": "55f298ba-f7d3-442c-9c27-ff1825d583f6"
        }
      },
      "edges": {
        "webhook->DPO---ZIM-Nespresso-C2021---CommCare---SalesForce": {
          "enabled": true,
          "id": "49f15b3f-544b-4b93-92b9-187071966e86",
          "target_job_id": "a00c7a81-e09a-45dc-bf8a-caa028e9c815",
          "source_trigger_id": "a5ad99ff-af41-4b72-aedf-6ff480a87a9d",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW Nespresso C2021 Demo Plot Observations CommCare SalesForce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Demo Plot Observation\" && state.data[\"app_id\"] == \"2b0b8dc3eff145889eaa3d085bfaadaf\""
        }
      }
    },
    "Production---Attendance-Full---CommCare-----Salesforce---Training-Attendance": {
      "id": "1d30b791-21a5-4487-ac59-c4693f97a163",
      "name": "Production - Attendance Full - CommCare --- Salesforce - Training Attendance",
      "inserted_at": "2025-03-14T10:10:01.632693Z",
      "lock_version": 4,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "b4da8bdb-01fd-4524-a8f7-f1965e816b24",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Attendance-Full---CommCare-----Salesforce---Training-Attendance": {
          "id": "9aba791f-a2bb-4c1f-94d8-4e9d839590d5",
          "name": "Production - Attendance Full - CommCare --- Salesforce - Training Attendance",
          "body": "//Coffee - ZW C2021 | Training Attendance | CommCare --> SalesForce\n\n//ATTENDANCE REGISTRATION JOB {COMMCARE TO SALESFORCE}\neach(\n    \"$.data\",\n    upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n      fields(\n        field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n        field(\"Trainer__c\", dataValue(\"form.trainer\")),\n        field(\"Number_in_Attendance__c\", dataValue(\"form.attendance_count\")),\n        field(\"Session_Photo_URL__c\", function(state) {\n            var photoUrl = '';\n            if(dataValue(\"form.photo\")(state) !== undefined && dataValue(\"form.photo\")(state) !== '') {\n              photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.photo\")(state);  \n            }\n            return photoUrl;\n        }),\n        field(\"Date__c\", dataValue(\"form.date\")),\n        field('Location_GPS__Latitude__s', (state) => {\n          // define this once, it's constant...\n          const coords = state.data.form.gps_coordinates;\n          // write your contional\n          if (coords) {\n            return coords.split(\" \")[0];\n          }\n          // the 'else' is unnecessary, return '' if there are no coords\n          return '';\n        }),\n        field('Location_GPS__Longitude__s', (state) => {\n          // define this once, it's constant...\n          const coords = state.data.form.gps_coordinates;\n          // write your contional\n          if (coords) {\n            return coords.split(\" \")[1];\n          }\n          // the 'else' is unnecessary, return '' if there are no coords\n          return '';\n        }),\n        field('Altitude__c', (state) => {\n          // define this once, it's constant...\n          const coords = state.data.form.gps_coordinates;\n          // write your contional\n          if (coords) {\n            return coords.split(\" \")[2];\n          }\n          // the 'else' is unnecessary, return '' if there are no coords\n          return '';\n        })\n        )\n      )\n    );\n  \n  beta.each(\n    function(state) {\n      if (state.data.form.present_participants) {\n        return state.data.form.present_participants.split(\" \").map(\n          function(pId) {\n            return {\n              participant: pId,\n              session: dataValue(\"form.training_session\")(state),\n              submission: dataValue(\"form.training_session\")(state)+pId,\n              sessionPhoto: dataValue(\"form.photo\")(state)\n            };\n          }\n        );\n      }\n    },\n    upsert(\"Attendance__c\", \"Submission_ID__c\",\n      fields(\n        field(\"Submission_ID__c\", dataValue(\"submission\")),\n        field(\"Status__c\", \"Present\"),\n        relationship(\"Training_Session__r\", \"CommCare_Case_Id__c\", dataValue(\"session\")),\n        relationship(\"Participant__r\", \"CommCare_Case_Id__c\", dataValue(\"participant\"))\n      )\n    )\n  );\n  each(\n    \"$.data\",\n    upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n      fields(\n        field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n        field(\"Updated_from_CommCare__c\", true)\n      )\n    )\n  );\n  \n  //Version Control\n",
          "adaptor": "@openfn/language-salesforce@5.0.4",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Attendance-Full---CommCare-----Salesforce---Training-Attendance": {
          "enabled": true,
          "id": "698c4ade-81ba-484e-bc3a-a6a31ec0ee3d",
          "target_job_id": "9aba791f-a2bb-4c1f-94d8-4e9d839590d5",
          "source_trigger_id": "b4da8bdb-01fd-4524-a8f7-f1965e816b24",
          "condition_type": "js_expression",
          "condition_label": "Production - Attendance Full - CommCare --> Salesforce - Training Attendance",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Attendance Full\""
        }
      }
    },
    "Production---Attendance-Light---CommCare-----Salesforce---Training-Attendance": {
      "id": "a62f418a-3b90-499d-b02b-63dbe94d4d97",
      "name": "Production - Attendance Light - CommCare --- Salesforce - Training Attendance",
      "inserted_at": "2025-03-14T10:10:11.435875Z",
      "lock_version": 4,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "fa2d28b0-b2d2-4dd9-9918-89790a7ab03b",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Attendance-Light---CommCare-----Salesforce---Training-Attendance": {
          "id": "8eadde28-eaa8-4401-89c9-fb7a8da13699",
          "name": "Production - Attendance Light - CommCare --- Salesforce - Training Attendance",
          "body": "//ATTENDANCE LIGHT JOB FOR ALL PROJECT USING ATTENDANCE LIGHT SURVEY\n\n\neach(\n\t  \"$.data\",\n\t  upsertIf(state.data.form.session === undefined || state.data.form.session === \"first_session\", \"Training_Session__c\", \"CommCare_Case_Id__c\",\n\t\tfields(\n\t\t  field(\"CommCare_Case_Id__c\", dataValue(\"form.selected_training_module\")),\n\t    field(\"Updated_from_CommCare__c\", true),\n\t    field(\"Trainer__c\", dataValue(\"form.trainer\")),\n\t    field(\"Date__c\", dataValue(\"form.Current_session_participants.date\")),\n\t\t  field(\"Male_Attendance__c\", dataValue(\"form.Current_session_participants.male_attendance\")),\n\t\t  field(\"Female_Attendance__c\", dataValue(\"form.Current_session_participants.female_attendance\")),\n\t\t  field(\"Number_in_Attendance__c\", dataValue(\"form.Current_session_participants.total_attendance\")),\n\t\t\t\t \n\t\t  field(\"Session_Photo_URL__c\", function(state) {\n\t\t  var photoUrl = '';\n\t\t  if(dataValue(\"form.photo\")(state) !== undefined && dataValue(\"form.photo\")(state) !== '') {\n            photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.photo\")(state);  \n          }\n          return photoUrl;\n\t\t  }),\n\t\t\t\t        \n        field('Location_GPS__Latitude__s', (state) => {\n          // define this once, it's constant...\n          const coords = state.data.form.gps_coordinates;\n          // write your contional\n         if (coords) {\n            return coords.split(\" \")[0];\n        }\n          // the 'else' is unnecessary, return '' if there are no coords\n          return '';\n        }), \n        field('Location_GPS__Longitude__s', (state) => {\n          // define this once, it's constant...\n          const coords = state.data.form.gps_coordinates;\n          // write your contional\n        if (coords) {\n          return coords.split(\" \")[1];\n        }\n          // the 'else' is unnecessary, return '' if there are no coords\n        return '';\n        }),\n        field('Altitude__c', (state) => {\n          // define this once, it's constant...\n          const coords = state.data.form.gps_coordinates;\n          // write your contional\n        if (coords) {\n          return coords.split(\" \")[2];\n        }\n          // the 'else' is unnecessary, return '' if there are no coords\n        return '';\n        })\t\t\t\t\n\t\t))),\n\t\t\neach(\n\t \"$.data\",\n\t  upsertIf(state.data.form.session === \"second_session\", \"Training_Session__c\", \"CommCare_Case_Id__c\",\n\t\tfields(\n\t\t  field(\"CommCare_Case_Id__c\", dataValue(\"form.selected_training_module\")),\n\t    field(\"Updated_from_CommCare__c\", true),\n\t    field(\"Trainer__c\", dataValue(\"form.trainer\")),\n\t    field(\"Date_2__c\", dataValue(\"form.Current_session_participants.date\")),\n\t\t  field(\"Second_Male_Attendance__c\", dataValue(\"form.Current_session_participants.male_attendance\")),\n\t\t  field(\"Second_Female_Attendance__c\", dataValue(\"form.Current_session_participants.female_attendance\")),\n\t\t  field(\"Second_Number_in_Attendance__c\", dataValue(\"form.Current_session_participants.total_attendance\")),\n\t\t\t\t \n\t\t  field(\"Session_Photo_URL_2__c\", function(state) {\n\t\t  var photoUrl = '';\n\t\t  if(dataValue(\"form.photo\")(state) !== undefined && dataValue(\"form.photo\")(state) !== '') {\n            photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.photo\")(state);  \n          }\n          return photoUrl;\n\t\t  }),\n\t\t\t\t        \n        field('Second_Location_GPS__Latitude__s', (state) => {\n          // define this once, it's constant...\n          const coords = state.data.form.gps_coordinates;\n          // write your contional\n         if (coords) {\n            return coords.split(\" \")[0];\n        }\n          // the 'else' is unnecessary, return '' if there are no coords\n          return '';\n        }), \n        field('Second_Location_GPS__Longitude__s', (state) => {\n          // define this once, it's constant...\n          const coords = state.data.form.gps_coordinates;\n          // write your contional\n        if (coords) {\n          return coords.split(\" \")[1];\n        }\n          // the 'else' is unnecessary, return '' if there are no coords\n        return '';\n        }),\n        field('Second_Altitude__c', (state) => {\n          // define this once, it's constant...\n          const coords = state.data.form.gps_coordinates;\n          // write your contional\n        if (coords) {\n          return coords.split(\" \")[2];\n        }\n          // the 'else' is unnecessary, return '' if there are no coords\n        return '';\n        })\t\t\n\t    )\n\t  )\n);\n\t    \n",
          "adaptor": "@openfn/language-salesforce@5.0.4",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Attendance-Light---CommCare-----Salesforce---Training-Attendance": {
          "enabled": true,
          "id": "719c0700-af97-4612-b9a3-e0e3588b734a",
          "target_job_id": "8eadde28-eaa8-4401-89c9-fb7a8da13699",
          "source_trigger_id": "fa2d28b0-b2d2-4dd9-9918-89790a7ab03b",
          "condition_type": "js_expression",
          "condition_label": "Production - Attendance Light - CommCare --> Salesforce - Training Attendance",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Attendance Light\""
        }
      }
    },
    "Production---Participant-Registration-and-Update---CommCare----SalesForce": {
      "id": "e55c0abb-4115-4222-80d9-6fae4775463e",
      "name": "Production - Participant Registration and Update - CommCare -- SalesForce",
      "inserted_at": "2025-03-14T10:10:29.432417Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "3d608383-97d9-48e1-9445-ac47f63b261a",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Participant-Registration-and-Update---CommCare----SalesForce": {
          "id": "120f4a95-bf7a-4bec-a36f-eff0830ddcca",
          "name": "Production - Participant Registration and Update - CommCare -- SalesForce",
          "body": "// JOB PURPOSE :: This is a consolidated job used for farmer registeration and update\n// DATA FLOW :: Commcare --> TO --> Salesforce\n// TARGET APPS :: Puerto_Rico_Ag_C1 | Uganda_Ag_C1 | Uganda_Ag_C2 | Uganda C2020| Zimbabwe_Ag_C1 | Zimbabwe_Ag_C2 | Kenya_Ag_C1\n// JOB NAME :: Production | Participant Registration and Update | CommCare --> SalesForce\n// JOB TRIGGER :: {\"form\":{\"survey_type\":\"Participant\"}}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n\n    //insert :: training group object :: new training group - household relationship created\n    each(\n        \"$.data\",\n        upsertIf(\n            dataValue('form.survey_detail')(state) === \"New Farmer New Household\" ||\n            dataValue('form.survey_detail')(state) === \"Existing Farmer Change in FFG\",\n            \"Training_Group__c\",\n            \"CommCare_Case_Id__c\",\n            fields(\n                field(\"Household_Counter__c\", dataValue(\"form.Update_Household_Counter\")),\n                field(\"CommCare_Case_Id__c\", dataValue(\"form.Training_Group_Id\"))\n            )\n        )\n    ),\n    // //insert household object\n    each(\n        \"$.data\",\n\n        // Insert Household for New Farmer New Household OR New Farmer Existing Household but for Primary Member OR Existing Farmer Change in FFG but for Primary Member\n        upsertIf(\n            dataValue('form.survey_detail')(state) === \"New Farmer New Household\" ||\n            (dataValue('form.survey_detail')(state) === \"New Farmer Existing Household\" &&\n                state.data.form.Primary_Household_Member === \"Yes\") ||\n            dataValue('form.survey_detail')(state) === \"Existing Farmer Change in FFG\",\n            \"Household__c\",\n            \"Household_ID__c\",\n            fields(\n                field(\"Household_ID__c\", dataValue(\"form.Household_Id\")(state)),\n                field(\"Name\", dataValue(\"form.Household_Number\")),\n                field(\"Training_Group__c\", dataValue(\"form.Training_Group_Id\")),\n                field(\"Farm_Size__c\", function (state) {\n                    var result = \"\";\n                    if (\n                        dataValue('form.survey_detail')(state) !== \"Existing Farmer Change in FFG\"\n                    ) {\n                        result = dataValue(\"form.Number_of_Trees\")(state);\n                        if(result === \"\"){\n                          result = null;\n                        }\n                    } else if (\n                        dataValue('form.survey_detail')(state) === \"Existing Farmer Change in FFG\" &&\n                        state.data.form.existing_farmer_change_in_ffg\n                            .former_farmer_primary_secondary_yn === \"Yes\"\n                    ) {\n                        result = dataValue(\n                            \"form.existing_farmer_change_in_ffg.former_farmer_coffeetrees\"\n                        )(state);\n                        if(result === \"\"){\n                          result = null;\n                        }\n                    } else if (\n                        dataValue('form.survey_detail')(state) === \"Existing Farmer Change in FFG\" &&\n                        state.data.form.existing_farmer_change_in_ffg\n                            .former_farmer_primary_secondary_yn === \"No\"\n                    ) {\n                        result = null;\n                    }\n                    return result;\n                }),\n                field(\"Number_of_Coffee_Plots__c\", function (state) {\n                    var result = \"\";\n                    if (\n                        dataValue('form.survey_detail')(state) !== \"Existing Farmer Change in FFG\"\n                    ) {\n                        result = dataValue(\"form.Number_of_Plots\")(state);\n                        if(result === \"\"){\n                          result = null;\n                        }\n                    } else if (\n                        dataValue('form.survey_detail')(state) === \"Existing Farmer Change in FFG\" &&\n                        state.data.form.existing_farmer_change_in_ffg.former_farmer_primary_secondary_yn === \"Yes\" &&\n                        dataValue('form.coffee_project_country')(state) === 'Burundi'\n                    ) {\n                        result = dataValue(\n                            \"form.existing_farmer_change_in_ffg.former_farmer_coffeeplots\"\n                        )(state);\n                        if(result === \"\"){\n                          result = null;\n                        }\n                    } else if (\n                        dataValue('form.survey_detail')(state) === \"Existing Farmer Change in FFG\" &&\n                        state.data.form.existing_farmer_change_in_ffg\n                            .former_farmer_primary_secondary_yn === \"No\"\n                    ) {\n                        result = null;\n                    }\n                    return result;\n                })\n            )\n        )\n    ),\n    // Insert Household for New Farmer Existing Household but for Secondary Member OR Existing Farmer Change in FFG but for Secondary Member\n    each(\n        \"$.data\",\n        upsertIf(\n            (dataValue('form.survey_detail')(state) === \"New Farmer Existing Household\" &&\n                state.data.form.Primary_Household_Member === \"No\") ||\n            (dataValue('form.survey_detail')(state) === \"Existing Farmer Change in FFG\" &&\n                state.data.form.existing_farmer_change_in_ffg\n                    .former_farmer_primary_secondary_yn === \"No\"),\n            \"Household__c\",\n            \"Household_ID__c\",\n            fields(\n                field(\"Household_ID__c\", dataValue(\"form.Household_Id\")(state)),\n                field(\"Name\", dataValue(\"form.Household_Number\")),\n                field(\"Training_Group__c\", dataValue(\"form.Training_Group_Id\"))\n            )\n        )\n    ),\n    \n    \n    // //insert || update :: participant object :: new household created || existing household updated\n   each(\n        \"$.data\",\n        upsertIf((dataValue('form.survey_detail')(state) === \"New Farmer New Household\" || \n            dataValue('form.survey_detail')(state) === \"New Farmer Existing Household\"),\n            \"Participant__c\",\n            \"CommCare_Case_Id__c\",\n            fields(\n                field(\"CommCare_Case_Id__c\", state => {\n                  var result = '';\n                  if(1==1){\n                    result = state.data.form['subcase_0'].case['@case_id'];\n                  }\n                  return result;\n                }),\n                field(\"TNS_Id__c\", dataValue(\"form.Farmer_Id\")),\n                field(\"Age__c\", dataValue(\"form.Age\")),\n                field(\"Name\", dataValue(\"form.First_Name\")),\n                field(\"Middle_Name__c\", dataValue(\"form.Middle_Name\")),\n                field(\"Last_Name__c\", dataValue(\"form.Last_Name\")),\n                field(\"Gender__c\", dataValue(\"form.Gender\")),\n                field(\"Status__c\", dataValue(\"form.Status\")),\n                field(\"Farm_Size__c\", state=>{\n                  var result = dataValue(\"form.Number_of_Trees\")(state);\n                  if(result === \"\"){\n                      result = null;\n                    }\n                  return result;\n                }),\n                field(\"Number_of_Coffee_Plots__c\", state=>{\n                  var result = dataValue(\"form.Number_of_Plots\")(state);\n                  if(result === \"\"){\n                      result = null;\n                    }\n                  return result;\n                }),\n                field(\"Sent_to_OpenFn_Status__c\", \"Complete\"),\n                field(\"Phone_Number__c\", dataValue(\"form.Phone_Number\")),\n                field(\"Primary_Household_Member__c\", dataValue(\"form.Primary_Household_Member\")),\n                field(\"Registration_Date__c\", dataValue(\"form.registration_date\")),\n                field(\"Create_In_CommCare__c\", false),\n                relationship(\"Household__r\", \"Household_ID__c\", dataValue(\"form.Household_Id\")),\n                relationship(\"Training_Group__r\", \"CommCare_Case_Id__c\", dataValue(\"form.Training_Group_Id\"))\n            )\n        )\n    ),\n    // Deactivating replaced farmer\n\n    each(\n        \"$.data\",\n        upsertIf(\n            dataValue('form.survey_detail')(state) === \"New Farmer Existing Household\" &&\n            (dataValue(\"form.existing_household.both_filled.replaced_member_full\")(\n                state\n            ) === \"1\" ||\n                dataValue(\n                    \"form.existing_household.primary_spot_filled.primary_replace_adding\"\n                )(state) === \"2\" ||\n                dataValue(\"form.existing_household.both_filled.replaced_member_full\")(\n                    state\n                ) === \"2\"),\n            \"Participant__c\",\n            \"CommCare_Case_Id__c\",\n            fields(\n                field(\"CommCare_Case_Id__c\", function (state) {\n                    var result = \"\";\n                    if (\n                        dataValue(\n                            \"form.existing_household.both_filled.replaced_member_full\"\n                        )(state) === \"1\" ||\n                        dataValue(\n                            \"form.existing_household.primary_spot_filled.primary_replace_adding\"\n                        )(state) === \"2\"\n                    ) {\n                        result = dataValue(\n                            \"form.existing_household.existing_primary_farmer_id\"\n                        )(state);\n                    } else if (\n                        dataValue(\n                            \"form.existing_household.both_filled.replaced_member_full\"\n                        )(state) === \"2\"\n                    ) {\n                        result = dataValue(\n                            \"form.existing_household.existing_secondary_farmer_id\"\n                        )(state);\n                    }\n                    return result;\n                }),\n                field(\"Updated_Date__c\", dataValue(\"form.registration_date\")),\n                field(\"Status__c\", \"Inactive\"),\n                field(\"Create_In_CommCare__c\", true),\n                relationship(\n                    \"Household__r\",\n                    \"Household_ID__c\",\n                    dataValue(\"form.Household_Id\")\n                ),\n                relationship(\n                    \"Training_Group__r\",\n                    \"CommCare_Case_Id__c\",\n                    dataValue(\"form.Training_Group_Id\")\n                )\n            )\n        )\n    ),\n    // update farmer for existing farmer change in FFG\n\n    each(\n        \"$.data\",\n        upsertIf(\n            dataValue('form.survey_detail')(state) === \"Existing Farmer Change in FFG\",\n            \"Participant__c\",\n            \"CommCare_Case_Id__c\",\n            fields(\n                field(\n                    \"CommCare_Case_Id__c\",\n                    dataValue(\"form.existing_farmer_change_in_ffg.old_farmer_id\")\n                ),\n                field(\"Updated_Date__c\", dataValue(\"form.registration_date\")),\n                field(\n                    \"Former_Training_Group__c\",\n                    dataValue(\"form.existing_farmer_change_in_ffg.old_farmer_ffg\")\n                ),\n                field(\"Create_In_CommCare__c\", true),\n                field(\"TNS_Id__c\", dataValue(\"form.Farmer_Id\")),\n                relationship(\n                    \"Household__r\",\n                    \"Household_ID__c\",\n                    dataValue(\"form.Household_Id\")\n                ),\n                relationship(\n                    \"Training_Group__r\",\n                    \"CommCare_Case_Id__c\",\n                    dataValue(\"form.Training_Group_Id\")\n                )\n            )\n        )\n    ),\n    // Update Training Session\n\n    each(\n        \"$.data\",\n        upsertIf(\n            dataValue('form.survey_detail')(state) === \"New Farmer New Household\" ||\n            dataValue('form.survey_detail')(state) === \"New Farmer Existing Household\" ||\n            dataValue('form.survey_detail')(state) === \"Existing Farmer Change in FFG\",\n            \"Training_Session__c\",\n            \"CommCare_Case_Id__c\",\n            fields(\n                field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n                field(\"Trainer__c\", dataValue(\"form.trainer\")),\n                field(\"Updated_from_CommCare__c\", true),\n                field(\"Date__c\", dataValue(\"form.registration_date\"))\n            )\n        )\n    ),\n    // Update Attendance\n\n    each(\n        \"$.data\",\n        upsertIf(\n            dataValue('form.survey_detail')(state) === \"New Farmer New Household\" ||\n            dataValue('form.survey_detail')(state) === \"New Farmer Existing Household\" ||\n            dataValue('form.survey_detail')(state) === \"Existing Farmer Change in FFG\",\n            \"Attendance__c\",\n            \"Submission_ID__c\",\n            fields(\n                field(\"Submission_ID__c\", function (state) {\n                    var result = \"\";\n                    if (\n                        dataValue('form.survey_detail')(state) !== \"Existing Farmer Change in FFG\"\n                    ) {\n                        result = state.data.form.subcase_0.case['@case_id'];\n                    } else if (\n                        dataValue('form.survey_detail')(state) === \"Existing Farmer Change in FFG\"\n                    ) {\n                        result = dataValue(\n                            \"form.existing_farmer_change_in_ffg.old_farmer_id\"\n                        )(state);\n                    }\n                    return dataValue(\"form.training_session\")(state) + result;\n                }),\n                field(\"Status__c\", \"Present\"),\n                relationship(\n                    \"Training_Session__r\",\n                    \"CommCare_Case_Id__c\",\n                    dataValue(\"form.training_session\")\n                ),\n                relationship(\"Participant__r\", \"CommCare_Case_Id__c\", function (state) {\n                    var result = \"\";\n                    if (\n                        dataValue('form.survey_detail')(state) !== \"Existing Farmer Change in FFG\"\n                    ) {\n                        result = state.data.form.subcase_0.case['@case_id'];\n                    } else if (\n                        dataValue('form.survey_detail')(state) === \"Existing Farmer Change in FFG\"\n                    ) {\n                        result = dataValue(\n                            \"form.existing_farmer_change_in_ffg.old_farmer_id\"\n                        )(state);\n                    }\n                    return result;\n                })\n            )\n        )\n    ),\n    \n    //update :: participant object :: participant details updated\n    each(\n        \"$.data\",\n        upsertIf(\n            dataValue('form.survey_detail')(state) == \"Participant Update\",\n            \"Participant__c\",\n            \"CommCare_Case_Id__c\",\n            fields(\n                field(\"CommCare_Case_Id__c\", dataValue(\"form.case['@case_id']\")),\n                field(\"Farm_Size__c\", state=>{\n                  var result = dataValue(\"form.Number_of_Trees\")(state);\n                  if(result === \"\"){\n                      result = null;\n                    }\n                  return result;\n                }),\n                field(\"Phone_Number__c\", dataValue(\"form.Phone_Number\")),\n                field(\"Number_of_Coffee_Plots__c\", state=>{\n                  var result = dataValue(\"form.Number_of_Plots\")(state);\n                  if(result === \"\"){\n                      result = null;\n                    }\n                  return result;\n                }),\n                field(\"Updated_Date__c\", dataValue(\"form.date\")),\n            )\n        )\n    ),\n\n    // // Update participant Other ID for KE\n    each(\n        \"$.data\",\n        upsertIf(\n            (dataValue('app_id')(state) === \"30cee26f064e403388e334ae7b0c403b\" ||\n             dataValue('app_id')(state) === \"073280bab3b743769796dfc04a926d4a\" || \n             dataValue('app_id')(state) === \"812728b8b35644dabb51561420938ee0\"\n            )&&\n            dataValue('form.survey_detail')(state) != \"Existing Farmer Change in FFG\",\n            \"Participant__c\",\n            \"CommCare_Case_Id__c\",\n            fields(\n                field(\"CommCare_Case_Id__c\", state=>{\n                    var result = '';\n                    if (dataValue('form.survey_detail')(state) === 'Participant Update') {\n                        result = dataValue(\"form.case['@case_id']\")(state);\n                        console.log(\"This is the result 1: \" + result);\n                    }\n                    else if (dataValue('form.survey_detail')(state) === 'New Farmer New Household' || dataValue('form.survey_detail')(state) === 'New Farmer Existing Household') {\n                        result = state.data.form.subcase_0.case['@case_id'];\n                        console.log(\"This is the result 2: \" + result);\n                    }\n                    return result;\n                }),\n                field(\n                    \"Other_ID_Number__c\",\n                    dataValue(\"form.Cooperative_Membership_Number\")\n                )\n            )\n        )\n    ),\n\n    // // Update Participant Other ID for BDI\n    each(\n        \"$.data\",\n        upsertIf(\n            (dataValue('app_id')(state) === \"6022048efa7a44629cf2d5448561e9f1\" ||\n            dataValue('app_id')(state) === \"8cb70ae22b874a6d8ccd8006a525ac8e\" ) &&\n            dataValue('form.survey_detail')(state) != \"Existing Farmer Change in FFG\",\n            \"Participant__c\",\n            \"CommCare_Case_Id__c\",\n            fields(\n                field(\"CommCare_Case_Id__c\", state => {\n                    var result = '';\n                    if (dataValue('form.survey_detail')(state) === 'Participant Update') {\n                        result = state.data.form.case['@case_id'];\n                    }\n                    else if (dataValue('form.survey_detail')(state) === 'New Farmer New Household' || dataValue('form.survey_detail')(state) === 'New Farmer Existing Household') {\n                        result = state.data.form.subcase_0.case['@case_id'];\n                    }\n                    return result;\n                }),\n                field(\n                    \"Other_ID_Number__c\",\n                    dataValue(\"form.National_ID_Number\")\n                )\n            )\n        )\n    ),\n    // // Update Participant Other ID for Zimbabwe\n    each(\n        \"$.data\",\n        upsertIf(\n            dataValue('app_id')(state) === \"8e8e5df7294548e6a4b55ca1a3a05f61\" &&\n            dataValue('form.survey_detail')(state) != \"Existing Farmer Change in FFG\",\n            \"Participant__c\",\n            \"CommCare_Case_Id__c\",\n            fields(\n                field(\"CommCare_Case_Id__c\", state => {\n                    var result = '';\n                    if (dataValue('form.survey_detail')(state) === 'Participant Update') {\n                        result = state.data.form.case['@case_id'];\n                    }\n                    else if (dataValue('form.survey_detail')(state) === 'New Farmer New Household' || dataValue('form.survey_detail')(state) === 'New Farmer Existing Household') {\n                        result = state.data.form.subcase_0.case['@case_id'];\n                    }\n                    return result;\n                }),\n                field(\n                    \"Other_ID_Number__c\",\n                    dataValue(\"form.Grower_Number\")\n                )\n            )\n        )\n    );\n",
          "adaptor": "@openfn/language-salesforce@5.0.4",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Participant-Registration-and-Update---CommCare----SalesForce": {
          "enabled": true,
          "id": "0e896b30-2b95-4e88-9499-e463ba5dddb7",
          "target_job_id": "120f4a95-bf7a-4bec-a36f-eff0830ddcca",
          "source_trigger_id": "3d608383-97d9-48e1-9445-ac47f63b261a",
          "condition_type": "js_expression",
          "condition_label": "Production Participant Registration and Update CommCare SalesForce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Participant\""
        }
      }
    },
    "x-[archived]-Production---Participants---ET-HWG-JCP-C2022---SalesForce----CommCare": {
      "id": "351c6e0a-16e6-45c9-86a4-1ce1cadf040a",
      "name": "x [archived] Production - Participants - ET HWG JCP C2022 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.236069Z",
      "lock_version": 5,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "0a4e2f8f-dc8a-4fe7-9627-47cbd6f126fa",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Participants---ET-HWG-JCP-C2022---SalesForce----CommCare": {
          "id": "fbcfd3c7-e329-49f1-aaa4-d25e839f0b95",
          "name": "Production - Participants - ET HWG JCP C2022 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending Participants for Coffee - ET HWG JCP C2022\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET HWG JCP C2022\n// JOB NAME :: Production | Participants - ET HWG JCP C2022 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_hwg_jcp_c2022\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n\neach(\n  \"$.data.participants[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3E266629-AFD8-4A1C-8825-1DCDDF24E5A8\",\n          \"uiVersion\": \"1\",\n          \"version\": \"325\",\n          \"name\": \"New Participant\",\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name;\n      }),\n      field(\"First_Name\", dataValue(\"participantName\")),\n      field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n      field(\"Last_Name\", dataValue(\"participantLastName\")),\n      field(\"Age\", dataValue(\"participantAge\")),\n      field(\"Gender\", dataValue(\"participantGender\")),\n      field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n      field(\"Farmer_Id\", dataValue(\"tnsId\")),\n      field(\"Farmer_Number\", function(state){\n        var tnsId = dataValue(\"tnsId\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        return farmerNumber;\n      }),\n      field(\"Cooperative_Membership_Number\", dataValue(\"participantOtherIDNumber\")),\n      field(\"Household_Id\", dataValue(\"householdId\")),\n      field(\"Household_Number\", dataValue(\"householdName\")),\n      field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n      field(\"Status\", dataValue(\"status\")),\n      field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Name_Household_Concat\", function(state){\n        var name = '';\n        var tnsId = dataValue(\"tnsId\")(state);\n        var hhNumber = dataValue(\"householdName\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        \n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name+' '+hhNumber+'-'+farmerNumber;\n      }),\n      \n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_hwg_jcp_c2022_participant\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:First_Name\": dataValue(\"participantName\")(state),\n            \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n            \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n            \"n0:Age\": dataValue(\"participantAge\")(state),\n            \"n0:Gender\": dataValue(\"participantGender\")(state),\n            \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n            \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Farmer_Number\": function(){\n              var tnsId = dataValue(\"tnsId\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              return farmerNumber;\n            },\n            \"n0:Cooperative_Membership_Number\": dataValue(\"participantOtherIDNumber\")(state),\n            \"n0:Household_Id\": dataValue(\"householdId\")(state),\n            \"n0:Household_Number\": dataValue(\"householdName\")(state),\n            \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n            \"n0:Status\": dataValue(\"status\")(state),\n            \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n            \"n0:Name_Household_Concat\": function(){\n              var name = '';\n              var tnsId = dataValue(\"tnsId\")(state);\n              var hhNumber = dataValue(\"householdName\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              \n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name+' '+hhNumber+'-'+farmerNumber;\n            },\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_et_hwg_jcp_c2022_training_group\"\n              },\n              \"#\": dataValue(\"trainingGroupId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n1:deviceID\": \"867066029216796\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-commcare@3.2.9",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Participants---ET-HWG-JCP-C2022---SalesForce----CommCare": {
          "enabled": true,
          "id": "ba3d952b-78fe-4eda-b321-b90688d261d1",
          "target_job_id": "fbcfd3c7-e329-49f1-aaa4-d25e839f0b95",
          "source_trigger_id": "0a4e2f8f-dc8a-4fe7-9627-47cbd6f126fa",
          "condition_type": "js_expression",
          "condition_label": "Production Participants HWG JCP C2022 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_hwg_jcp_c2022\""
        }
      }
    },
    "x-[archived]-FV-and-FIS-to-ZW": {
      "id": "46aac40b-f94b-465d-8bb3-f60503075e97",
      "name": "x [archived] FV and FIS to ZW",
      "inserted_at": "2025-03-20T03:44:07.243207Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "d9a8f89b-efe5-4521-af20-9066f919ac82",
          "type": "webhook"
        }
      },
      "jobs": {
        "FV-and-FIS-to-ZW": {
          "id": "af983498-ac53-4443-900e-a3fe16ba90d8",
          "name": "FV and FIS to ZW",
          "body": "//FARM VISIT JOB FOR ALL ZIMBABWE PROJECTS\n//Production - Farm Visit :: ZM 2022 | CommCare --> Salesforce | Farm Visit Full\n//ZM ZM C2018\n\n\t//Farm Visit Best Practice Results\n    //loop through methods of erosion control and insert into database :: Erosion Control BP\n    beta.each(\n\n      function(state) {\n\n          //incoming erosion data\n          var best_practice_results_data = dataValue(\"form.erosion_control.methods_of_erosion_control\")(state);\n\n          if (best_practice_results_data !== undefined) {\n\n              return best_practice_results_data.split(\" \").map(\n                \n                  function(resultId) {\n                      return {\n                          result_data: resultId,\n                          best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_erosion_\" + resultId,\n                          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n                      };\n                  }\n                  \n              );\n\n          }\n      },\n      upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n          fields(\n              field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n              field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n              field(\"Best_Practice_Result_Type__c\", \"Erosion Control\"),//this is the actual result type\n              field(\"Best_Practice_Result_Description__c\", function(state){\n                \n                  var returnResults = \"\";\n                \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                      returnResults = \"Stabilizing grasses\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                      returnResults = \"Mulch\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                      returnResults = \"Water traps or trenches\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n                      returnResults = \"Physical barriers. (e.g. rocks)\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n                      returnResults = \"Terraces\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"6\"){\n\n                      returnResults = \"Contour planting\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"7\"){\n\n                      returnResults = \"Bean or Arachis cover crop between the rows\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n                      returnResults = \"No erosion control method seen\";\n\n                  }\n                  \n                  return returnResults;\n                \n              })                \n          )\n      )\n  );\n\n\n  //loop through chemical/fertilizier applied and insert into database :: Nutrition BP\n  beta.each(\n\n      function(state) {\n\n          //incoming chemical/fertilizer used data\n          var best_practice_results_data = dataValue(\"form.nutrition.type_chemical_applied_on_coffee_last_12_months\")(state);\n\n          if (best_practice_results_data !== undefined) {\n\n              return best_practice_results_data.split(\" \").map(\n                \n                  function(resultId) {\n                      return {\n                          result_data: resultId,\n                          best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_fertilizer_\" + resultId,\n                          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n                      };\n                  }\n                  \n              );\n\n          }\n      },\n      upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n          fields(\n              field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n              field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n              field(\"Best_Practice_Result_Type__c\", \"Chemicals and Fertilizers Applied\"), //this is the actual result type\n              field(\"Best_Practice_Result_Description__c\", function(state){\n                \n                  var returnResults = \"\";\n                \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                      returnResults = \"Compost\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                      returnResults = \"Manure\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                      returnResults = \"Lime\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n                      returnResults = \"Compound S\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n                      returnResults = \"Compound J\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"6\"){\n\n                      returnResults = \"Single Super Phosphate (SSP)\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"7\"){\n\n                      returnResults = \"Zinc/Boron Foliar Feed (Tracel)\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"8\"){\n\n                      returnResults = \"Ammonium Nitrate\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n                      returnResults = \"Did NOT apply any fertilizer in past 12 months\";\n\n                  }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"9\"){\n\n                  //     returnResults = \"Agricultural lime - Calcium Carbonate\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"10\"){\n\n                  //     returnResults = \"Foliar Zinc or Boron\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"11\"){\n\n                  //     returnResults = \"General Foliar Feed (Nurish, Ferquido Ferqan)\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"12\"){\n\n                  //     returnResults = \"Nutrical (cal dolomita)\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"13\"){\n\n                  //     returnResults = \"15-5-10+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"14\"){\n\n                  //     returnResults = \"20-5-10+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"15\"){\n\n                  //     returnResults = \"15-15-15+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"16\"){\n\n                  //     returnResults = \"10-5-20+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"17\"){\n\n                  //     returnResults = \"20-5-20+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"18\"){\n\n                  //     returnResults = \"12-5-15+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"19\"){\n\n                  //     returnResults = \"14-7-19+3MGO+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"20\"){\n\n                  //     returnResults = \"Caldo bordeles\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"21\"){\n\n                  //     returnResults = \"Foliar - lixiviado de bioinsumo (lombricomposta o equivalente)\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"22\"){\n\n                  //     returnResults = \"Urea\";\n\n                  // }\n\n                  return returnResults;\n                \n              })\n          )\n      )\n\n  );\n\n\n  //loop through methods of controlling coffee berry borer :: Integrated Pest and Disease Management BP\n  beta.each(\n\n      function(state) {\n\n          //incoming coffee berry borer data\n          var best_practice_results_data = dataValue(\"form.pest_disease_management.methods_of_controlling_coffee_berry_borer\")(state);\n\n          if (best_practice_results_data !== undefined) {\n\n              return best_practice_results_data.split(\" \").map(\n                \n                  function(resultId) {\n                      return {\n                          result_data: resultId,\n                          best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_cbb_\" + resultId,\n                          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n                      };\n                  }\n                  \n              );\n\n          }\n      },\n      upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n          fields(\n              field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n              field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n              field(\"Best_Practice_Result_Type__c\", \"Management of Coffee Berry Borer (CBB)\"), //this is the actual result type\n              field(\"Best_Practice_Result_Description__c\", function(state){\n                \n                  var returnResults = \"\";\n                \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                      returnResults = \"Reduce pesticide use and/or encourage natural predators and parasites - beneficial insects.\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                      returnResults = \"Strip all berries at the end of harvest, known as crop hygiene\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                      returnResults = \"Harvest ripe cherries regularly - to reduce pest and disease levels\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n                      returnResults = \"Use berry borer traps\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n                      returnResults = \"Collect fallen berries at the end of the season - crop hygiene\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"6\"){\n\n                      returnResults = \"Feed the tree well to keep it healthy\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"7\"){\n\n                      returnResults = \"Use good agricultural practices such as weeding or mulching to reduce stress and keep trees healthy\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"8\"){\n\n                      returnResults = \"Prune to keep the canopy open\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"9\"){\n\n                      returnResults = \"Renovate (new planting) or rejuvenate regularly to keep main stems less than 8 years old\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"10\"){\n\n                      returnResults = \"Plant and grow disease resistant varieties\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"11\"){\n\n                      returnResults = \"Smooth the bark to reduce egg laying sites for While Coffee Borer\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"12\"){\n\n                      returnResults = \"Spray regular pesticides\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"13\"){\n\n                      returnResults = \"Spray homemade herbal or botanical pesticides\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n                      returnResults = \"Does not know any methods\";\n\n                  }\n\n                  return returnResults;\n                \n              })\n          )\n      )\n\n  );\n\n\n  //loop through methods of controlling leaf rust :: Integrated Pest and Disease Management\n  // beta.each(\n\n  //     function(state) {\n\n  //         //incoming coffee leaf rust data\n  //         var best_practice_results_data = dataValue(\"form.pest_disease_management.methods_of_controlling_coffee_leaf_rust\")(state);\n\n  //         if (best_practice_results_data !== undefined) {\n\n  //             return best_practice_results_data.split(\" \").map(\n                \n  //                 function(resultId) {\n  //                     return {\n  //                         result_data: resultId,\n  //                         best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_clr_\" + resultId,\n  //                         farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n  //                     };\n  //                 }\n                  \n  //             );\n\n  //         }\n  //     },\n  //     upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n  //         fields(\n  //             field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n  //             field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n  //             field(\"Best_Practice_Result_Type__c\", \"Management of Coffee Leaf Rust (CLR)\"), //this is the actual result type\n  //             field(\"Best_Practice_Result_Description__c\", function(state){\n                \n  //                 var returnResults = \"\";\n                \n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n  //                     returnResults = \"Feed the tree well to keep it healthy\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n  //                     returnResults = \"Use good agricultural practices such as weeding or mulching to reduce stress and keep trees healthy\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n  //                     returnResults = \"Prune or keep canopy open\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n  //                     returnResults = \"Spray fungicides\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n  //                     returnResults = \"Grow resistant varieties\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n  //                     returnResults = \"Does not know any methods\";\n\n  //                 }\n\n  //                 return returnResults;\n                \n  //             })\n  //         )\n  //     )\n\n  // );\n  \n\n  //loop through pruning methods :: Pruning BP  \n    beta.each(\n\n      function(state) {\n\n          //incoming pruning data\n          var best_practice_results_data = dataValue(\"form.pruning.pruning_method_on_majority_trees\")(state) || \"\";\n\n          if (best_practice_results_data !== undefined) {\n\n              return best_practice_results_data.split(\" \").map(\n                \n                  function(resultId) {\n                      return {\n                          result_data: resultId,\n                          best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_pruning_\" + resultId,\n                          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n                          field_age: dataValue(\"form.field_age\")(state)\n                      };\n                  }\n                  \n              );\n\n          }\n      },\n      upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n          fields(\n              field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n              field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n              field(\"Best_Practice_Result_Type__c\", \"Pruning\"), //this is the actual result type\n              field(\"Best_Practice_Result_Description__c\", function(state){\n                \n                  var returnResults = \"\";\n                  var field_age = dataValue(\"field_age\")(state);\n                  console.log(\"The string field age is: \");\n                  console.log(field_age);\n                  const numeric_field_age = parseInt(field_age);\n                  console.log(\"The numeric field age is: \");\n                  console.log(numeric_field_age);\n                \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                      returnResults = \"Centers opened\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                      returnResults = \"Unwanted suckers removed\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                      returnResults = \"Dead branches removed\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n                      returnResults = \"Branches touching the ground removed\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n                      returnResults = \"Broken / unproductive stems and/or branches removed\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n                      returnResults = \"No pruning methods used\";\n\n                  }\n                  else if(numeric_field_age < 3) {\n                      returnResults = 'N/A'\n                  }\n\n                  return returnResults;\n                \n              })\n          )\n      )\n\n  );\n\n  beta.each(\n\n    function(state) {\n\n        //incoming pruning data\n        var best_practice_results_data = dataValue(\"form.weeding.which_product_have_you_used\")(state) || \"\";\n        var otherProduct = dataValue(\"form.weeding.ask_which_other_product_have_you_used\")(state);\n        console.log(\"debug\", otherProduct);\n        if (best_practice_results_data !== undefined) {\n\n            return best_practice_results_data.split(\" \").map(\n              \n                function(resultId) {\n                    return {\n                        result_data: resultId,\n                        best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_weeding_\" + resultId,\n                        farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n                        other_submission: otherProduct\n                    };\n                }\n                \n            );\n\n        }\n    },\n    upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n        fields(\n            field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n            field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n            field(\"Best_Practice_Result_Type__c\", \"Weeding\"), //this is the actual result type\n            field(\"Best_Practice_Result_Description__c\", function(state){\n              \n                var returnResults = \"\";\n              \n                if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                    returnResults = \"Glyphosate (Eg Round Up)\";\n\n                }\n\n                if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                    returnResults = \"Paraquat (Eg. Gramoxone)\";\n\n                }\n\n                if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                    returnResults = dataValue(\"other_submission\");\n                    console.log(\"debug\", dataValue(\"other_submission\"));\n                }\n                return returnResults;\n              \n            })\n        )\n    )\n\n);\n  \n \n  //Best Practices :: Main Stem && Weeding &&  Shade Control && Record Keeping && Compost && Erosion Control && Nutrition\n  each(\n      \"$.data\",\n      upsert(\"FV_Best_Practices__c\", \"FV_Submission_ID__c\",\n          fields(\n              field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n              field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n\n              //main stems\n                field(\"number_of_main_stems_on_majority_trees__c\", dataValue(\"form.main_stems.number_of_main_stems_on_majority_trees\")),\n              field(\"photo_of_trees_and_average_main_stems__c\", function(state){\n                \n                var mainStemsPhotoURL = \"\";\n                if(dataValue(\"form.main_stems.trees_and_main_stems_photo\")(state) !== undefined && dataValue(\"form.main_stems.trees_and_main_stems_photo\")(state) !== '') {\n                  mainStemsPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.main_stems.trees_and_main_stems_photo\")(state);  \n                 }\n                 return mainStemsPhotoURL;\n                 \n              }),\n\n              //nutrition\n              field(\"Color_of_coffee_tree_leaves__c\", function(state){\n                \n                var colorOfCoffeeLeaves = dataValue(\"form.nutrition.are_the_leave_green_or_yellow_pale_green\")(state);\n                var returnColorOfCoffeeLeaves = \"\";\n                \n                if(colorOfCoffeeLeaves !== undefined && colorOfCoffeeLeaves !== '' && colorOfCoffeeLeaves == 0){\n                  \n                  returnColorOfCoffeeLeaves = \"5% or more (5 or more in 100) of the leaves are yellow, pale green or brown.\";\n                  \n                }\n\n                if(colorOfCoffeeLeaves !== undefined && colorOfCoffeeLeaves !== '' && colorOfCoffeeLeaves == 1){\n                  \n                  returnColorOfCoffeeLeaves = \"Nearly all leaves are dark green and less than 5% (less than 5 in 100) are yellow, pale green, or brown.\";\n                  \n                }\n\n                return returnColorOfCoffeeLeaves;\n\n              }),\n\n              //weeding\n              field(\"how_many_weeds_under_canopy_and_how_big__c\", function(state){\n                \n                var weedsUnderCanopy = dataValue(\"form.weeding.how_many_weeds_under_canopy_and_how_big_are_they\")(state);\n                var returnWeedsUnderCanopy = \"\";\n        \n                if(weedsUnderCanopy == 1){\n        \n                  returnWeedsUnderCanopy = \"Few small weeds (less than 30cm) under the tree canopy\";\n        \n                }\n        \n                if(weedsUnderCanopy == 2){\n        \n                  returnWeedsUnderCanopy = \"Many small weeds under the tree canopy (ground is covered with weeds)\";\n        \n                }\n        \n                if(weedsUnderCanopy == 3){\n        \n                  returnWeedsUnderCanopy = \"Many large weeds under the tree canopy (ground is covered with weeds)\";\n        \n                }\n\n                  return returnWeedsUnderCanopy;\n\n              }),\n\n              //Health of New Planting (Yves might need to add a new Object for this)\n              field(\"health_of_new_planting_choice__c\", function(state){\n  \n                  var healthNewPlanting = dataValue(\"form.health_of_new_planting.health_of_new_planting_choice\")(state);\n                  var returnhealthNewPlanting = \"\";\n  \n                  if(healthNewPlanting == 1){\n  \n                      returnhealthNewPlanting = \"The majority of trees are green and healthy and have grown well\";\n  \n                  }\n  \n                  if(healthNewPlanting == 2){\n  \n                      returnhealthNewPlanting = \"The majority of trees look stressed and growth is slow\";\n  \n                  }\n  \n                  if(healthNewPlanting == 3){\n  \n                      returnhealthNewPlanting = \"The majority of trees have dried up or died\";\n  \n                  }\n\n              return returnhealthNewPlanting;\n\n          }),\n\n          field(\"photo_of_trees_and_average_main_stems__c\", function(state){\n                \n              var healthPhotoURL = \"\";\n              if(dataValue(\"form.main_stems.health_of_trees_photo\")(state) !== undefined && dataValue(\"form.main_stems.health_of_trees_photo\")(state) !== '') {\n                  healthPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.main_stems.trees_and_main_stems_photo\")(state);  \n               }\n               return healthPhotoURL;\n               \n            }),\n\n             field(\"Have_herbicides_been_used_on_the_field__c\", dataValue(\"form.weeding.used_herbicides\")),\n              // field(\"Herbicide_products_used_on_farm__c\", function(state){\n                \n              //   var herbicideUsed = dataValue(\"form.weeding.which_product_have_you_used\")(state);\n              //   var returnHerbicideUsed = \"EMPTY\";\n                \n              //   if(herbicideUsed !== undefined && herbicideUsed == 1){\n                  \n              //     returnHerbicideUsed = \"Glyphosate (Eg Round Up)\";\n                  \n              //   }\n                \n              //   if(herbicideUsed !== undefined && herbicideUsed == 2){\n                  \n              //     returnHerbicideUsed = \"Paraquat (Eg. Gramoxone)\";\n                  \n              //   }\n\n              //   if(herbicideUsed !== undefined && herbicideUsed == 3){\n                  \n              //     returnHerbicideUsed = dataValue(\"form.weeding.ask_which_other_product_have_you_use\")(state);\n                  \n              //   }                  \n\n              //   return returnHerbicideUsed;\n                \n              // }),\n              \n              field(\"photo_of_weeds_under_the_canopy__c\", function(state){\n                \n                var weedsPhotoUrl = dataValue(\"form.weeding.weeds_under_the_canopy_photo\")(state);\n                var returnWeedsPhotoUrl = \"\";\n                \n                if (weedsPhotoUrl !== undefined && weedsPhotoUrl !== '') {\n                    returnWeedsPhotoUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + weedsPhotoUrl;\n                }\n                \n                return returnWeedsPhotoUrl;\n                \n              }),\n\n              //shade management\n              field(\"level_of_shade_present_on_the_farm__c\", function(state){\n                \n                var levelOfShadeOnPlot = dataValue(\"form.shade_control.level_of_shade_present_on_the_farm\")(state);\n                var returnLevelOfShadeOnPlot = \"\";\n                \n                if(levelOfShadeOnPlot == 0){\n                  \n                  returnLevelOfShadeOnPlot = \"NO shade, less than 5%\";\n                  \n                }\n                \n                if(levelOfShadeOnPlot == 1){\n                  \n                  returnLevelOfShadeOnPlot = \"Light shade, 5 to 20%\";\n                  \n                }\n                \n                if(levelOfShadeOnPlot == 2){\n                  \n                  returnLevelOfShadeOnPlot = \"Medium shade, 20 to 40%\";\n                  \n                }\n                \n                if(levelOfShadeOnPlot == 3){\n                  \n                  returnLevelOfShadeOnPlot = \"Heavy shade, over 40%\";\n                  \n                }\n                \n                return returnLevelOfShadeOnPlot;\n\n              }),\n              \n              // field(\"have_new_shade_been_planted_last_3_years__c\", function(state){\n                \n              //   var newShadePlanted = dataValue(\"form.shade_control.new_shade_trees_in_the_last_3_years\")(state);\n              //   var returnNewShadePlanted = \"\";\n                \n              //   if(newShadePlanted == 0){\n                  \n              //     returnNewShadePlanted = \"No\";\n                  \n              //   }\n\n              //   if(newShadePlanted == 1){\n                  \n              //     returnNewShadePlanted = \"Yes\";\n                  \n              //   }\n\n              //   return returnNewShadePlanted;\n\n              // }),\n              \n              field(\"photo_of_level_of_shade_on_the_plot__c\", function(state) {\n                \n                var shadePhotoUrl = '';\n                if(dataValue(\"form.shade_control.photo_of_level_of_shade_on_the_plot\")(state) !== undefined && dataValue(\"form.shade_control.photo_of_level_of_shade_on_the_plot\")(state) !== '') {\n                  shadePhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.photo\")(state);\n                  \n                }\n                \n                return shadePhotoUrl;\n                \n              }),\n              \n              // Yves needs to Add Object\n              field(\"planted_intercrop_bananas__c\", function(state){\n                \n                  var bananaShadePlanted = dataValue(\"form.shade_control.planted_intercrop_bananas\")(state);\n                  var returnbananaShadePlanted = \"\";\n                  \n                  if(bananaShadePlanted == \"no\"){\n                    \n                      returnbananaShadePlanted = \"No\";\n                    \n                  }\n\n                  if(bananaShadePlanted == \"yes\"){\n                    \n                      returnbananaShadePlanted = \"Yes\";\n                    \n                  }\n\n                  return returnbananaShadePlanted;\n\n                }),\n                \n                //Yves needs to add object\n                field(\"photograph_intercrop_bananas__c\", function(state) {\n                  \n                  var bananashadePhotoUrl = '';\n                  if(dataValue(\"form.shade_control.photograph_intercrop_bananas\")(state) !== undefined && dataValue(\"form.shade_control.photograph_intercrop_bananas\")(state) !== '') {\n                      bananashadePhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.photo\")(state);\n                    \n                  }\n                  \n                  return bananashadePhotoUrl;\n                  \n                }),\n\n\n              //compost manure\n              field(\"do_you_have_compost_manure__c\", function(state){\n                \n                var haveCompostManure = dataValue(\"form.compost.do_you_have_compost_manure\")(state);\n                var returnHaveCompostManure = \"\";\n                \n                if(haveCompostManure !== undefined && haveCompostManure !== '' && haveCompostManure == 0){\n                  \n                  returnHaveCompostManure = \"No\";\n                  \n                }\n                \n                if(haveCompostManure !== undefined && haveCompostManure !== '' && haveCompostManure == 1){\n                  \n                  returnHaveCompostManure = \"Yes\";\n                  \n                }\n                \n                return returnHaveCompostManure;\n\n              }),\n\n              field(\"photo_of_the_compost_manure__c\", function(state) {\n                \n                var compostPhotoUrl = '';\n                if(dataValue(\"form.compost.photo_of_the_compost_manure\")(state) !== undefined && dataValue(\"form.compost.photo_of_the_compost_manure\")(state) !== '') {\n                  compostPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.compost.photo_of_the_compost_manure\")(state);\n                  \n                }\n                \n                return compostPhotoUrl;\n                \n              }),\n\n              //erosion control\n          /*    field(\"take_a_photo_of_erosion_control__c\", function(state) {\n                \n                var erosionPhotoUrl = '';\n                if(dataValue(\"form.erosion_control.photo_of_erosion_control_method\")(state) !== undefined && dataValue(\"form.erosion_control.photo_of_erosion_control_method\")(state) !== '') {\n                  erosionPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.photo_of_erosion_control_method\")(state);\n                  \n                }\n                \n                return erosionPhotoUrl;\n                \n              }),\n          */\n              field(\"Stabilizing_Grasses_Photo_URL__c\", function(state){                    \n\n                  var sgPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.stabilizing_grasses_image\")(state) !== undefined && dataValue(\"form.erosion_control.stabilizing_grasses_image\")(state) !== '') {\n                      sgPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.stabilizing_grasses_image\")(state); \n                  } \n\n                  return sgPhotoURL;                \n              }),\n              field(\"Mulch_Photo_URL__c\", function(state){                    \n\n                  var mulchPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.mulch_image\")(state) !== undefined && dataValue(\"form.erosion_control.mulch_image\")(state) !== '') {\n                      mulchPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.mulch_image\")(state); \n                  } \n\n                  return mulchPhotoURL;                \n              }),\n              field(\"Water_Traps_Photo_URL__c\", function(state){                    \n\n                  var wtPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.water_traps_or_trenches_image\")(state) !== undefined && dataValue(\"form.erosion_control.water_traps_or_trenches_image\")(state) !== '') {\n                      wtPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.water_traps_or_trenches_image\")(state); \n                  } \n\n                  return wtPhotoURL;                \n              }),\n              field(\"Physical_Barriers_Photo_URL__c\", function(state){                    \n\n                  var pbPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.physical_barriers_image\")(state) !== undefined && dataValue(\"form.erosion_control.physical_barriers_image\")(state) !== '') {\n                      pbPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.physical_barriers_image\")(state); \n                  } \n\n                  return pbPhotoURL;                \n              }),\n              field(\"Terraces_Photo_URL__c\", function(state){                    \n\n                  var terracesPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.terraces_image\")(state) !== undefined && dataValue(\"form.erosion_control.terraces_image\")(state) !== '') {\n                      terracesPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.terraces_image\")(state); \n                  } \n\n                  return terracesPhotoURL;                \n              }),\n              field(\"Contour_Planting_Photo_URL__c\", function(state){                    \n\n                  var cpPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.contour_planting_image\")(state) !== undefined && dataValue(\"form.erosion_control.contour_planting_image\")(state) !== '') {\n                      cpPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.contour_planting_image\")(state); \n                  } \n\n                  return cpPhotoURL;                \n              }),\n              field(\"Cover_Crop_Photo_URL__c\", function(state){                    \n\n                  var ccPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.bean_or_arachis_cover_crop_image\")(state) !== undefined && dataValue(\"form.erosion_control.bean_or_arachis_cover_crop_image\")(state) !== '') {\n                      ccPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.bean_or_arachis_cover_crop_image\")(state); \n                  } \n\n                  return ccPhotoURL;                \n              }),\n\n              //record keeping\n              field(\"do_you_have_a_record_book__c\", function(state){\n                \n                var haveRecordBook = dataValue(\"form.record_keeping.do_you_have_a_record_book\")(state);\n                var returnHaveRecordBook = \"\";\n                \n                if(haveRecordBook == 0){\n                  \n                  returnHaveRecordBook = \"No\";\n                  \n                }\n                \n                if(haveRecordBook == 1){\n                  \n                  returnHaveRecordBook = \"Yes\";\n                  \n                }\n                \n                return returnHaveRecordBook;\n\n              }),\n\n              field(\"are_there_records_on_the_record_book__c\", function(state){\n                \n                var recordsOnRecordBook = dataValue(\"form.record_keeping.are_there_records_on_the_record_book\")(state);\n                var returnRecordsOnRecordBook = \"\";\n                \n                if(recordsOnRecordBook !== undefined && recordsOnRecordBook !== '' && recordsOnRecordBook == 0){\n                  \n                  returnRecordsOnRecordBook = \"No\";\n                  \n                }\n                \n                if(recordsOnRecordBook !== undefined && recordsOnRecordBook !== '' && recordsOnRecordBook == 1){\n                  \n                  returnRecordsOnRecordBook = \"Yes\";\n                  \n                }\n                \n                return returnRecordsOnRecordBook;\n                \n              }),\n\n              field(\"take_a_photo_of_the_record_book__c\", function(state){\n                \n                var recordBookPhotoUrl = '';\n                if(dataValue(\"form.record_keeping.take_a_photo_of_the_record_book\")(state) !== undefined && dataValue(\"form.record_keeping.take_a_photo_of_the_record_book\")(state) !== '') {\n                  recordBookPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.record_keeping.take_a_photo_of_the_record_book\")(state) !== undefined && dataValue(\"form.record_keeping.take_a_photo_of_the_record_book\")(state);\n               \n                }\n                \n                return recordBookPhotoUrl;\n                \n              })\n          )\n      )\n  );\n\n\n  //insert the farm visit record\n  each(\n      \"$.data\",\n      upsert(\"Farm_Visit__c\", \"FV_Submission_ID__c\",\n          fields(\n              field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n              field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n              field(\"Farm_Visit_Type__c\", dataValue(\"form.survey_type\")),\n              field(\"Training_Group__c\", dataValue(\"form.case.@case_id\")),\n              field(\"Farm_Visited__c\", dataValue(\"form.farm_being_visted\")),\n              field(\"Primary_Farmer_PIMA_ID__c\", dataValue(\"form.farm_being_visted\")),\n              field(\"Secondary_Farmer__c\", function(state){\n                  var secondaryFarmer = '';\n                  if(dataValue(\"form.secondary_farmer_available\")(state) == 'yes' && dataValue(\"form.secondary_farmer\")(state) !== ''){\n                    secondaryFarmer = dataValue(\"form.secondary_farmer\");\n                  }\n                  return secondaryFarmer;\n              }),\n              field(\"Secondary_Farmer_PIMA_ID__c\", function(state){\n                  var secondaryFarmer = '';\n                  if(dataValue(\"form.secondary_farmer_available\")(state) == 'yes' && dataValue(\"form.secondary_farmer\")(state) !== ''){\n                    secondaryFarmer = dataValue(\"form.secondary_farmer\");\n                  }\n                  return secondaryFarmer;\n              }),\n              field(\"Visit_Has_Training__c\", dataValue(\"form.is_this_a_farm_training_visit\")),\n            //  field(\"Training_Session__c\", dataValue(\"form.training_session\")),\n              field(\"Other_Participants_Present__c\", dataValue(\"form.any_other_participants_present\")),\n              field(\"Total_Farmers_Visited__c\", dataValue(\"form.attendance_count\")),\n              field(\"Date_Visited__c\", dataValue(\"form.date_of_visit\")),\n              field(\"visit_comments__c\", dataValue(\"form.farm_visit_comments\")),\n              field(\"Farmer_Trainer__c\", dataValue(\"form.trainer\")),\n              field(\"No_of_curedas__c\", dataValue(\"form.opening_questions.number_of_curedas\")),\n              field(\"No_of_separate_coffee_fields__c\", dataValue(\"form.opening_questions.number_of_separate_coffee_fields\")),\n              field(\"Field_Age__c\", dataValue(\"form.field_age\")),\n              field(\"Field_Size__c\", function(state){\n                  var fieldSize = '';\n                  if(dataValue(\"form.field_size\")(state) !== undefined && dataValue(\"form.field_size\")(state) !== ''){\n                    fieldSize = dataValue(\"form.field_size\");\n                  }\n                  else if(dataValue(\"form.field_size1\")(state) !== undefined && dataValue(\"form.field_size1\")(state) !== ''){\n                    fieldSize = dataValue(\"form.field_size1\");\n                  }\n                  \n                  return fieldSize;\n                  \n              }),\n              field(\"Farm_Visit_Photo_Url__c\", function(state) {\n                  var farmVisitPhotoUrl = '';\n                  if (dataValue(\"form.farm_visit_photo\")(state) !== undefined && dataValue(\"form.farm_visit_photo\")(state) !== '') {\n                      farmVisitPhotoUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + dataValue(\"form.farm_visit_photo\")(state);\n                  }\n                  return farmVisitPhotoUrl;\n              }),\n              field(\"Signature__c\", function(state) {\n                  var recorderSignatureUrl = '';\n                  if (dataValue(\"form.signature_of_farmer_trainer\")(state) !== undefined && dataValue(\"form.signature_of_farmer_trainer\")(state) !== '') {\n                      recorderSignatureUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + dataValue(\"form.signature_of_farmer_trainer\")(state);\n                  }\n                  return recorderSignatureUrl;\n              }),\n              field('Location_GPS__Latitude__s', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[0];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n                  return '';\n              }),\n              field('Location_GPS__Longitude__s', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[1];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n                  return '';\n              }),\n              field('Altitude__c', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[2];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n              return '';\n              })\n          )\n      )\n  );\n  \n  // Upsert Farm Data\n  beta.each(\n    function(substate){\n      const itemsFromRepeatGroup = [];\n      \n      substate.data.form.field_inventory_survey.general_plot_information.forEach((plot)=>{\n        itemsFromRepeatGroup.push(plot);\n      });\n      \n      return itemsFromRepeatGroup;\n    }, upsert(\n      \"Farm__c\", \"TNS_Id__c\",\n      fields(\n        field(\"TNS_Id__c\", function(substate){\n          const current_index = dataValue(\"current_index\")(substate);\n          var result = \"F-0\" + current_index + \"-\" + state.data.form.household_tns_id;\n          return result;\n        }),\n        field(\"Name\",  function(substate){\n          const current_index = dataValue(\"current_index\")(substate);\n          var result = \"0\" + current_index;\n          return result;\n        }),\n        field(\"Farm_Size_Coffee_Trees__c\", dataValue(\"total_coffee\")),\n        field(\"Farm_Size_Land_Measurements__c\", dataValue(\"farm_size_ha\")),\n        field(\"Main_Coffee_Field__c\", function(state){\n          var result = false;\n          if(dataValue(\"current_index\")(state) === \"1\"){\n            result = true;\n          }\n          return result;\n        }),\n        field(\"Planting_Month_and_Year__c\", dataValue(\"date_planted\")),\n        field('Farm_GPS_Coordinates__Latitude__s', (substate) => {\n            const coords = dataValue(\"final_gps\")(substate);\n            if (coords) {\n              return coords.split(\" \")[0];\n            }\n            return '';\n        }),\n        field('Farm_GPS_Coordinates__Longitude__s', (substate) => {\n            const coords = dataValue(\"final_gps\")(substate);\n            if (coords) {\n              return coords.split(\" \")[1];\n            }\n            return '';\n        }),\n        field('Altitude__c', (substate) => {\n           const coords = dataValue(\"final_gps\")(substate);\n            if (coords) {\n              return coords.split(\" \")[2];\n            }\n        return '';\n        }),\n        field(\"Farm_Image_URL__c\", function(substate) {\n            var plotPhotoUrl = '';\n            if (dataValue(\"plot_photo\")(substate) !== undefined && dataValue(\"plot_photo\")(substate) !== '') {\n                plotPhotoUrl = \"https://www.commcarehq.org/a/\" + state.data.domain + \"/api/form/attachment/\" + state.data.form.meta.instanceID + \"/\" + dataValue(\"plot_photo\")(substate);\n            }\n            return plotPhotoUrl;\n        }),\n        relationship(\"Household__r\", \"Household_ID__c\", state.data.form.household_tns_id),\n        relationship(\"Latest_Farm_Visit_Record__r\", \"FV_Submission_ID__c\", \"FV-\" + state.data.id)\n          )\n        )\n      );\n  \n  //Upsert Variety data\n  \n  beta.each(\n    function(substate){\n      var createdObjects = [];\n      substate.data.form.field_inventory_survey.general_plot_information.forEach((item)=>{\n        // var varietiesList = item.varieties.split(\" \").map(variety=>{\n        //   var varietyQuantity = item[`variety_${variety}`];\n        //   console.log(\"Variety Quantity: \" + varietyQuantity);\n        //   return {\n        //     id: variety,\n        //     quantity: varietyQuantity,\n        //     plot: item.current_index,\n        //     other_variety: item.other_variety\n        //   };\n        // });\n        var varietiesList = item.varieties.split(\" \");\n        varietiesList.forEach((variety)=>{\n          var varietyQuantity = item[`variety_${variety}`];\n          var createdObject = {\n              id: variety,\n              quantity: varietyQuantity,\n              plot: item.current_index,\n              other_variety: item.other_variety\n          };\n          createdObjects.push(createdObject);\n        });\n      });\n      console.log(\"Created Objects:\");\n      console.log(createdObjects);\n      return createdObjects;\n    },\n    upsert(\"Coffee_Variety__c\", \"Name\",\n      fields(\n        field(\"Name\", function(substate){\n          console.log(\"Variety Number:\");\n          console.log(dataValue(\"id\")(substate));\n          console.log(dataValue(\"id\"));\n          const variety = dataValue(\"id\")(substate);\n          const plot = dataValue(\"plot\")(substate);\n          return \"CV-0\" + variety + \"-F-0\" + plot + \"-\" + state.data.form.household_tns_id;\n        }),\n        field(\"Variety_Type_Name__c\", function(substate){\n          var result = \"\";\n          if(dataValue(\"id\")(substate) == \"1\"){\n            result = \"Costa Rica 95\";\n          }\n          else if(dataValue(\"id\")(substate) == \"2\"){\n            result = \"SL28 or 34\";\n          }\n          else if(dataValue(\"id\")(substate) == \"3\"){\n            result = \"K7\";\n          }\n          else if(dataValue(\"id\")(substate) == \"4\"){\n            result = \"Catimor 129\";\n          }\n          else if(dataValue(\"id\")(substate) == \"5\"){\n            result = \"Catuai\";\n          }\n          else if(dataValue(\"id\")(substate) == \"6\"){\n            result = \"Yellow Catuai\";\n          }\n          else if(dataValue(\"id\")(substate) == \"7\"){\n            result = \"F6\";\n          }\n          else if(dataValue(\"id\")(substate) == \"8\"){\n            result = \"Caturra\";\n          }\n          else if(dataValue(\"id\")(substate) == \"9\"){\n            result = dataValue(\"other_variety\")(substate);\n          }\n          return result;\n        }),\n        field(\"Variety_Number_of_Trees__c\", dataValue(\"quantity\")),\n        relationship(\"Farm__r\", \"TNS_Id__c\", function(substate){\n          var result = \"F-0\" + dataValue(\"plot\")(substate) + \"-\" + state.data.form.household_tns_id;\n          return result;\n        })\n        )\n    )\n  );\n\n  //upsert training session\n/*    each(\n      \"$.data\",\n      upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n          fields(\n              field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n              field(\"Updated_from_CommCare__c\", true)\n          )\n      )\n  );\n*/\n\n//}\n\n\n// FIS Data\n",
          "adaptor": "@openfn/language-salesforce@v4.6.0",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->FV-and-FIS-to-ZW": {
          "enabled": true,
          "id": "ed7b11ff-2323-4276-b401-71697b760fed",
          "target_job_id": "af983498-ac53-4443-900e-a3fe16ba90d8",
          "source_trigger_id": "d9a8f89b-efe5-4521-af20-9066f919ac82",
          "condition_type": "js_expression",
          "condition_label": "FV and FIS to ZW",
          "condition_expression": "state.data.form[\"survey_type_2\"] == \"FV + FIS - ZW\""
        }
      }
    },
    "x-[archived]-Coffee-DRC---GCA-TNS-2022---Training-Sessions---Salesforce----CommCare": {
      "id": "deca69fc-d0f0-4e97-b525-708f55f041cf",
      "name": "x [archived] Coffee DRC - GCA TNS 2022 - Training Sessions - Salesforce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.260407Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "6c682bb5-9130-46e4-8e40-696fc20601d4",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee-DRC---GCA-TNS-2022---Training-Sessions---Salesforce----CommCare": {
          "id": "08581acd-363f-44e8-9194-b9a0db5c6251",
          "name": "Coffee DRC - GCA TNS 2022 - Training Sessions - Salesforce -- CommCare",
          "body": "//Coffee DRC - GCA TNS 2022 | Training Sessions | Salesforce --> CommCare\n//coffee_drc_gca_tns_2022\n//{\"jobType\":\"Training Session\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_drc_gca_tns_2022\"}\n\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_drc_gca_tns_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_drc_gca_tns_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee-DRC---GCA-TNS-2022---Training-Sessions---Salesforce----CommCare": {
          "enabled": true,
          "id": "87e1e186-6ea9-4d0a-b0a4-a26c2e0c936b",
          "target_job_id": "08581acd-363f-44e8-9194-b9a0db5c6251",
          "source_trigger_id": "6c682bb5-9130-46e4-8e40-696fc20601d4",
          "condition_type": "js_expression",
          "condition_label": "Coffee DRC GCA TNS 2022 Training Sessions Salesforce CommCare",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_drc_gca_tns_2022\""
        }
      }
    },
    "Production---Coffee-DRC-GCA-Kalehe-C2023---SalesForce----CommCare---Training-Groups": {
      "id": "27f70dca-7068-4e2c-b6b0-3c86d0073c3d",
      "name": "Production - Coffee DRC GCA Kalehe C2023 - SalesForce -- CommCare - Training Groups",
      "inserted_at": "2025-03-20T03:44:07.265918Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "5f8c5958-fb2d-479a-b13e-0bd948ef57c7",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-DRC-GCA-Kalehe-C2023---SalesForce----CommCare---Training-Groups": {
          "id": "b88ab500-a02c-4b79-b2c5-bbcaa3d71a65",
          "name": "Production - Coffee DRC GCA Kalehe C2023 - SalesForce -- CommCare - Training Groups",
          "body": "// Training Group = CUG.\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/B9AE4CBF-B571-4038-9C90-3D5D47DFDB90\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_drc_gca_kalehe_c2023_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_drc_gca_kalehe_c2023_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-DRC-GCA-Kalehe-C2023---SalesForce----CommCare---Training-Groups": {
          "enabled": true,
          "id": "ce375c91-69c7-4c90-b646-11f93216954a",
          "target_job_id": "b88ab500-a02c-4b79-b2c5-bbcaa3d71a65",
          "source_trigger_id": "5f8c5958-fb2d-479a-b13e-0bd948ef57c7",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee DRC GCA Kalehe C2023 SalesForce CommCare Training Groups",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_drc_gca_kalehe_c2023\""
        }
      }
    },
    "x-[archived]-Production---Farm-Visit---AI---CommCare----Salesforce---Farm-Visit-Full---AI": {
      "id": "f6c7171e-a556-4c1d-8369-21fb04113509",
      "name": "x [archived] Production - Farm Visit - AI - CommCare -- Salesforce - Farm Visit Full - AI",
      "inserted_at": "2025-03-20T03:44:07.272117Z",
      "lock_version": 5,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "5114b682-19d9-422b-afe8-958674c977ca",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Farm-Visit---AI---CommCare----Salesforce---Farm-Visit-Full---AI": {
          "id": "1eca4686-5f22-44fd-8785-4bd6678c2155",
          "name": "Production - Farm Visit - AI - CommCare -- Salesforce - Farm Visit Full - AI",
          "body": "//FARM VISIT JOB FOR ALL ZIMBABWE PROJECTS\n//Production - Farm Visit :: ZM 2022 | CommCare --> Salesforce | Farm Visit Full\n//ZM ZM C2018\n//if (state.data.app_id == \"e16e09252eb942a788bd6600e6ceeb28\") {\n\n    //loop through participants and insert in database\n/*    beta.each(\n\n        function(state) {\n            if (state.data.form.present_participants) {\n                return state.data.form.present_participants.split(\" \").map(\n                    function(pId) {\n                        return {\n                            participant: pId,\n                            session: dataValue(\"form.training_session\")(state),\n                            att_submission: dataValue(\"form.training_session\")(state) + pId,\n                            fv_submission: \"FV-\" + dataValue(\"id\")(state),\n                            sessionPhoto: dataValue(\"form.photo\")(state)\n                        };\n                    }\n                );\n            }\n        },\n        upsert(\"FV_Attendance__c\", \"Submission_ID__c\",\n            fields(\n                field(\"Submission_ID__c\", dataValue(\"att_submission\")), //attendance submission_id\n                field(\"FV_Submission_ID__c\", dataValue(\"fv_submission\")), //farm visit submission_id\n                field(\"Status__c\", \"Present\"),\n                relationship(\"Training_Session__r\", \"CommCare_Case_Id__c\", dataValue(\"session\")),\n                relationship(\"Participant__r\", \"CommCare_Case_Id__c\", dataValue(\"participant\"))\n            )\n        )\n\n    );\n*/\n\t//Farm Visit Best Practice Results\n    //loop through methods of erosion control and insert into database :: Erosion Control BP\n    beta.each(\n\n      function(state) {\n\n          //incoming erosion data\n          var best_practice_results_data = dataValue(\"form.erosion_control.methods_of_erosion_control\")(state);\n\n          if (best_practice_results_data !== undefined) {\n\n              return best_practice_results_data.split(\" \").map(\n                \n                  function(resultId) {\n                      return {\n                          result_data: resultId,\n                          best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_erosion_\" + resultId,\n                          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n                      };\n                  }\n                  \n              );\n\n          }\n      },\n      upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n          fields(\n              field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n              field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n              field(\"Best_Practice_Result_Type__c\", \"Erosion Control\"),//this is the actual result type\n              field(\"Best_Practice_Result_Description__c\", function(state){\n                \n                  var returnResults = \"\";\n                \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                      returnResults = \"Stabilizing grasses\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                      returnResults = \"Mulch\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                      returnResults = \"Water traps or trenches\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n                      returnResults = \"Physical barriers. (e.g. rocks)\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n                      returnResults = \"Terraces\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"6\"){\n\n                      returnResults = \"Contour planting\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"7\"){\n\n                      returnResults = \"Bean or Arachis cover crop between the rows\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n                      returnResults = \"No erosion control method seen\";\n\n                  }\n                  \n                  return returnResults;\n                \n              })                \n          )\n      )\n  );\n\n\n  //loop through chemical/fertilizier applied and insert into database :: Nutrition BP\n  beta.each(\n\n      function(state) {\n\n          //incoming chemical/fertilizer used data\n          var best_practice_results_data = dataValue(\"form.nutrition.type_chemical_applied_on_coffee_last_12_months\")(state);\n\n          if (best_practice_results_data !== undefined) {\n\n              return best_practice_results_data.split(\" \").map(\n                \n                  function(resultId) {\n                      return {\n                          result_data: resultId,\n                          best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_fertilizer_\" + resultId,\n                          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n                      };\n                  }\n                  \n              );\n\n          }\n      },\n      upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n          fields(\n              field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n              field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n              field(\"Best_Practice_Result_Type__c\", \"Chemicals and Fertilizers Applied\"), //this is the actual result type\n              field(\"Best_Practice_Result_Description__c\", function(state){\n                \n                  var returnResults = \"\";\n                \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                      returnResults = \"Compost\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                      returnResults = \"Manure\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                      returnResults = \"Lime\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n                      returnResults = \"Compound S\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n                      returnResults = \"Compound J\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"6\"){\n\n                      returnResults = \"Single Super Phosphate (SSP)\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"7\"){\n\n                      returnResults = \"Zinc/Boron Foliar Feed (Tracel)\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"8\"){\n\n                      returnResults = \"Ammonium Nitrate\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n                      returnResults = \"Did NOT apply any fertilizer in past 12 months\";\n\n                  }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"9\"){\n\n                  //     returnResults = \"Agricultural lime - Calcium Carbonate\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"10\"){\n\n                  //     returnResults = \"Foliar Zinc or Boron\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"11\"){\n\n                  //     returnResults = \"General Foliar Feed (Nurish, Ferquido Ferqan)\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"12\"){\n\n                  //     returnResults = \"Nutrical (cal dolomita)\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"13\"){\n\n                  //     returnResults = \"15-5-10+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"14\"){\n\n                  //     returnResults = \"20-5-10+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"15\"){\n\n                  //     returnResults = \"15-15-15+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"16\"){\n\n                  //     returnResults = \"10-5-20+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"17\"){\n\n                  //     returnResults = \"20-5-20+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"18\"){\n\n                  //     returnResults = \"12-5-15+3Mg+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"19\"){\n\n                  //     returnResults = \"14-7-19+3MGO+1EM\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"20\"){\n\n                  //     returnResults = \"Caldo bordeles\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"21\"){\n\n                  //     returnResults = \"Foliar - lixiviado de bioinsumo (lombricomposta o equivalente)\";\n\n                  // }\n                  \n                  // if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"22\"){\n\n                  //     returnResults = \"Urea\";\n\n                  // }\n\n                  return returnResults;\n                \n              })\n          )\n      )\n\n  );\n\n\n  //loop through methods of controlling coffee berry borer :: Integrated Pest and Disease Management BP\n  beta.each(\n\n      function(state) {\n\n          //incoming coffee berry borer data\n          var best_practice_results_data = dataValue(\"form.pest_disease_management.methods_of_controlling_coffee_berry_borer\")(state);\n\n          if (best_practice_results_data !== undefined) {\n\n              return best_practice_results_data.split(\" \").map(\n                \n                  function(resultId) {\n                      return {\n                          result_data: resultId,\n                          best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_cbb_\" + resultId,\n                          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n                      };\n                  }\n                  \n              );\n\n          }\n      },\n      upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n          fields(\n              field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n              field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n              field(\"Best_Practice_Result_Type__c\", \"Management of Coffee Berry Borer (CBB)\"), //this is the actual result type\n              field(\"Best_Practice_Result_Description__c\", function(state){\n                \n                  var returnResults = \"\";\n                \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                      returnResults = \"Reduce pesticide use and/or encourage natural predators and parasites - beneficial insects.\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                      returnResults = \"Strip all berries at the end of harvest, known as crop hygiene\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                      returnResults = \"Harvest ripe cherries regularly - to reduce pest and disease levels\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n                      returnResults = \"Use berry borer traps\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n                      returnResults = \"Collect fallen berries at the end of the season - crop hygiene\";\n\n                  }\n                  \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"6\"){\n\n                      returnResults = \"Feed the tree well to keep it healthy\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"7\"){\n\n                      returnResults = \"Use good agricultural practices such as weeding or mulching to reduce stress and keep trees healthy\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"8\"){\n\n                      returnResults = \"Prune to keep the canopy open\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"9\"){\n\n                      returnResults = \"Renovate (new planting) or rejuvenate regularly to keep main stems less than 8 years old\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"10\"){\n\n                      returnResults = \"Plant and grow disease resistant varieties\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"11\"){\n\n                      returnResults = \"Smooth the bark to reduce egg laying sites for While Coffee Borer\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"12\"){\n\n                      returnResults = \"Spray regular pesticides\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"13\"){\n\n                      returnResults = \"Spray homemade herbal or botanical pesticides\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n                      returnResults = \"Does not know any methods\";\n\n                  }\n\n                  return returnResults;\n                \n              })\n          )\n      )\n\n  );\n\n\n  //loop through methods of controlling leaf rust :: Integrated Pest and Disease Management\n  // beta.each(\n\n  //     function(state) {\n\n  //         //incoming coffee leaf rust data\n  //         var best_practice_results_data = dataValue(\"form.pest_disease_management.methods_of_controlling_coffee_leaf_rust\")(state);\n\n  //         if (best_practice_results_data !== undefined) {\n\n  //             return best_practice_results_data.split(\" \").map(\n                \n  //                 function(resultId) {\n  //                     return {\n  //                         result_data: resultId,\n  //                         best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_clr_\" + resultId,\n  //                         farm_visit_submission: \"FV-\" + dataValue(\"id\")(state)\n  //                     };\n  //                 }\n                  \n  //             );\n\n  //         }\n  //     },\n  //     upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n  //         fields(\n  //             field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n  //             field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n  //             field(\"Best_Practice_Result_Type__c\", \"Management of Coffee Leaf Rust (CLR)\"), //this is the actual result type\n  //             field(\"Best_Practice_Result_Description__c\", function(state){\n                \n  //                 var returnResults = \"\";\n                \n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n  //                     returnResults = \"Feed the tree well to keep it healthy\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n  //                     returnResults = \"Use good agricultural practices such as weeding or mulching to reduce stress and keep trees healthy\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n  //                     returnResults = \"Prune or keep canopy open\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n  //                     returnResults = \"Spray fungicides\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n  //                     returnResults = \"Grow resistant varieties\";\n\n  //                 }\n\n  //                 if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n  //                     returnResults = \"Does not know any methods\";\n\n  //                 }\n\n  //                 return returnResults;\n                \n  //             })\n  //         )\n  //     )\n\n  // );\n  \n\n  //loop through pruning methods :: Pruning BP  \n    beta.each(\n\n      function(state) {\n\n          //incoming pruning data\n          var best_practice_results_data = dataValue(\"form.pruning.pruning_method_on_majority_trees\")(state) || \"\";\n\n          if (best_practice_results_data !== undefined) {\n\n              return best_practice_results_data.split(\" \").map(\n                \n                  function(resultId) {\n                      return {\n                          result_data: resultId,\n                          best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_pruning_\" + resultId,\n                          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n                          field_age: dataValue(\"form.field_age\")(state)\n                      };\n                  }\n                  \n              );\n\n          }\n      },\n      upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n          fields(\n              field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n              field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n              field(\"Best_Practice_Result_Type__c\", \"Pruning\"), //this is the actual result type\n              field(\"Best_Practice_Result_Description__c\", function(state){\n                \n                  var returnResults = \"\";\n                  var field_age = dataValue(\"field_age\")(state);\n                  console.log(\"The string field age is: \");\n                  console.log(field_age);\n                  const numeric_field_age = parseInt(field_age);\n                  console.log(\"The numeric field age is: \");\n                  console.log(numeric_field_age);\n                \n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                      returnResults = \"Centers opened\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                      returnResults = \"Unwanted suckers removed\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                      returnResults = \"Dead branches removed\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"4\"){\n\n                      returnResults = \"Branches touching the ground removed\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"5\"){\n\n                      returnResults = \"Broken / unproductive stems and/or branches removed\";\n\n                  }\n\n                  if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"0\"){\n\n                      returnResults = \"No pruning methods used\";\n\n                  }\n                  else if(numeric_field_age < 3) {\n                      returnResults = 'N/A'\n                  }\n\n                  return returnResults;\n                \n              })\n          )\n      )\n\n  );\n\n  beta.each(\n\n    function(state) {\n\n        //incoming pruning data\n        var best_practice_results_data = dataValue(\"form.weeding.which_product_have_you_used\")(state) || \"\";\n        var otherProduct = dataValue(\"form.weeding.ask_which_other_product_have_you_used\")(state);\n        console.log(\"debug\", otherProduct);\n        if (best_practice_results_data !== undefined) {\n\n            return best_practice_results_data.split(\" \").map(\n              \n                function(resultId) {\n                    return {\n                        result_data: resultId,\n                        best_result_submission:  \"FVBPN-\" + dataValue(\"id\")(state) + \"_weeding_\" + resultId,\n                        farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n                        other_submission: otherProduct\n                    };\n                }\n                \n            );\n\n        }\n    },\n    upsert(\"FV_Best_Practice_Results__c\", \"Best_Practice_Result_Submission_ID__c\",\n        fields(\n            field(\"Best_Practice_Result_Submission_ID__c\", dataValue(\"best_result_submission\")), //best result submission ID\n            field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n            field(\"Best_Practice_Result_Type__c\", \"Weeding\"), //this is the actual result type\n            field(\"Best_Practice_Result_Description__c\", function(state){\n              \n                var returnResults = \"\";\n              \n                if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"1\"){\n\n                    returnResults = \"Glyphosate (Eg Round Up)\";\n\n                }\n\n                if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"2\"){\n\n                    returnResults = \"Paraquat (Eg. Gramoxone)\";\n\n                }\n\n                if(dataValue(\"result_data\")(state) !== undefined && dataValue(\"result_data\")(state) == \"3\"){\n\n                    returnResults = dataValue(\"other_submission\");\n                    console.log(\"debug\", dataValue(\"other_submission\"));\n                }\n                return returnResults;\n              \n            })\n        )\n    )\n\n);\n  \n \n  //Best Practices :: Main Stem && Weeding &&  Shade Control && Record Keeping && Compost && Erosion Control && Nutrition\n  each(\n      \"$.data\",\n      upsert(\"FV_Best_Practices__c\", \"FV_Submission_ID__c\",\n          fields(\n              field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n              field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n\n              //main stems\n                field(\"number_of_main_stems_on_majority_trees__c\", dataValue(\"form.main_stems.number_of_main_stems_on_majority_trees\")),\n          \n          /*    field(\"number_of_main_stems_on_majority_trees__c\", function(state){\n                \n                var numberOfMainStems = dataValue(\"form.main_stems.number_of_main_stems_on_majority_trees\")(state);\n                var returnNumberOfMainStems = 0;\n                \n                if (numberOfMainStems !== undefined && numberOfMainStems !== '') {\n                    returnNumberOfMainStems = numberOfMainStems;\n                }\n                \n                return returnNumberOfMainStems;\n                \n              }),\n              \n          */    \n              field(\"photo_of_trees_and_average_main_stems__c\", function(state){\n                \n                var mainStemsPhotoURL = \"\";\n                if(dataValue(\"form.main_stems.trees_and_main_stems_photo\")(state) !== undefined && dataValue(\"form.main_stems.trees_and_main_stems_photo\")(state) !== '') {\n                  mainStemsPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.main_stems.trees_and_main_stems_photo\")(state);  \n                 }\n                 return mainStemsPhotoURL;\n                 \n              }),\n\n              //nutrition\n              field(\"Color_of_coffee_tree_leaves__c\", function(state){\n                \n                var colorOfCoffeeLeaves = dataValue(\"form.nutrition.are_the_leave_green_or_yellow_pale_green\")(state);\n                var returnColorOfCoffeeLeaves = \"\";\n                \n                if(colorOfCoffeeLeaves !== undefined && colorOfCoffeeLeaves !== '' && colorOfCoffeeLeaves == 0){\n                  \n                  returnColorOfCoffeeLeaves = \"5% or more (5 or more in 100) of the leaves are yellow, pale green or brown.\";\n                  \n                }\n\n                if(colorOfCoffeeLeaves !== undefined && colorOfCoffeeLeaves !== '' && colorOfCoffeeLeaves == 1){\n                  \n                  returnColorOfCoffeeLeaves = \"Nearly all leaves are dark green and less than 5% (less than 5 in 100) are yellow, pale green, or brown.\";\n                  \n                }\n\n                return returnColorOfCoffeeLeaves;\n\n              }),\n\n              //weeding\n              field(\"how_many_weeds_under_canopy_and_how_big__c\", function(state){\n                \n                var weedsUnderCanopy = dataValue(\"form.weeding.how_many_weeds_under_canopy_and_how_big_are_they\")(state);\n                var returnWeedsUnderCanopy = \"\";\n        \n                if(weedsUnderCanopy == 1){\n        \n                  returnWeedsUnderCanopy = \"Few small weeds (less than 30cm) under the tree canopy\";\n        \n                }\n        \n                if(weedsUnderCanopy == 2){\n        \n                  returnWeedsUnderCanopy = \"Many small weeds under the tree canopy (ground is covered with weeds)\";\n        \n                }\n        \n                if(weedsUnderCanopy == 3){\n        \n                  returnWeedsUnderCanopy = \"Many large weeds under the tree canopy (ground is covered with weeds)\";\n        \n                }\n\n                  return returnWeedsUnderCanopy;\n\n              }),\n\n              //Health of New Planting (Yves might need to add a new Object for this)\n              field(\"health_of_new_planting_choice__c\", function(state){\n  \n                  var healthNewPlanting = dataValue(\"form.health_of_new_planting.health_of_new_planting_choice\")(state);\n                  var returnhealthNewPlanting = \"\";\n  \n                  if(healthNewPlanting == 1){\n  \n                      returnhealthNewPlanting = \"The majority of trees are green and healthy and have grown well\";\n  \n                  }\n  \n                  if(healthNewPlanting == 2){\n  \n                      returnhealthNewPlanting = \"The majority of trees look stressed and growth is slow\";\n  \n                  }\n  \n                  if(healthNewPlanting == 3){\n  \n                      returnhealthNewPlanting = \"The majority of trees have dried up or died\";\n  \n                  }\n\n              return returnhealthNewPlanting;\n\n          }),\n\n          field(\"photo_of_trees_and_average_main_stems__c\", function(state){\n                \n              var healthPhotoURL = \"\";\n              if(dataValue(\"form.main_stems.health_of_trees_photo\")(state) !== undefined && dataValue(\"form.main_stems.health_of_trees_photo\")(state) !== '') {\n                  healthPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.main_stems.trees_and_main_stems_photo\")(state);  \n               }\n               return healthPhotoURL;\n               \n            }),\n\n             field(\"Have_herbicides_been_used_on_the_field__c\", dataValue(\"form.weeding.used_herbicides\")),\n              // field(\"Herbicide_products_used_on_farm__c\", function(state){\n                \n              //   var herbicideUsed = dataValue(\"form.weeding.which_product_have_you_used\")(state);\n              //   var returnHerbicideUsed = \"EMPTY\";\n                \n              //   if(herbicideUsed !== undefined && herbicideUsed == 1){\n                  \n              //     returnHerbicideUsed = \"Glyphosate (Eg Round Up)\";\n                  \n              //   }\n                \n              //   if(herbicideUsed !== undefined && herbicideUsed == 2){\n                  \n              //     returnHerbicideUsed = \"Paraquat (Eg. Gramoxone)\";\n                  \n              //   }\n\n              //   if(herbicideUsed !== undefined && herbicideUsed == 3){\n                  \n              //     returnHerbicideUsed = dataValue(\"form.weeding.ask_which_other_product_have_you_use\")(state);\n                  \n              //   }                  \n\n              //   return returnHerbicideUsed;\n                \n              // }),\n              \n              field(\"photo_of_weeds_under_the_canopy__c\", function(state){\n                \n                var weedsPhotoUrl = dataValue(\"form.weeding.weeds_under_the_canopy_photo\")(state);\n                var returnWeedsPhotoUrl = \"\";\n                \n                if (weedsPhotoUrl !== undefined && weedsPhotoUrl !== '') {\n                    returnWeedsPhotoUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + weedsPhotoUrl;\n                }\n                \n                return returnWeedsPhotoUrl;\n                \n              }),\n\n              //shade management\n              field(\"level_of_shade_present_on_the_farm__c\", function(state){\n                \n                var levelOfShadeOnPlot = dataValue(\"form.shade_control.level_of_shade_present_on_the_farm\")(state);\n                var returnLevelOfShadeOnPlot = \"\";\n                \n                if(levelOfShadeOnPlot == 0){\n                  \n                  returnLevelOfShadeOnPlot = \"NO shade, less than 5%\";\n                  \n                }\n                \n                if(levelOfShadeOnPlot == 1){\n                  \n                  returnLevelOfShadeOnPlot = \"Light shade, 5 to 20%\";\n                  \n                }\n                \n                if(levelOfShadeOnPlot == 2){\n                  \n                  returnLevelOfShadeOnPlot = \"Medium shade, 20 to 40%\";\n                  \n                }\n                \n                if(levelOfShadeOnPlot == 3){\n                  \n                  returnLevelOfShadeOnPlot = \"Heavy shade, over 40%\";\n                  \n                }\n                \n                return returnLevelOfShadeOnPlot;\n\n              }),\n              \n              // field(\"have_new_shade_been_planted_last_3_years__c\", function(state){\n                \n              //   var newShadePlanted = dataValue(\"form.shade_control.new_shade_trees_in_the_last_3_years\")(state);\n              //   var returnNewShadePlanted = \"\";\n                \n              //   if(newShadePlanted == 0){\n                  \n              //     returnNewShadePlanted = \"No\";\n                  \n              //   }\n\n              //   if(newShadePlanted == 1){\n                  \n              //     returnNewShadePlanted = \"Yes\";\n                  \n              //   }\n\n              //   return returnNewShadePlanted;\n\n              // }),\n              \n              field(\"photo_of_level_of_shade_on_the_plot__c\", function(state) {\n                \n                var shadePhotoUrl = '';\n                if(dataValue(\"form.shade_control.photo_of_level_of_shade_on_the_plot\")(state) !== undefined && dataValue(\"form.shade_control.photo_of_level_of_shade_on_the_plot\")(state) !== '') {\n                  shadePhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.photo\")(state);\n                  \n                }\n                \n                return shadePhotoUrl;\n                \n              }),\n              \n              // Yves needs to Add Object\n              field(\"planted_intercrop_bananas__c\", function(state){\n                \n                  var bananaShadePlanted = dataValue(\"form.shade_control.planted_intercrop_bananas\")(state);\n                  var returnbananaShadePlanted = \"\";\n                  \n                  if(bananaShadePlanted == \"no\"){\n                    \n                      returnbananaShadePlanted = \"No\";\n                    \n                  }\n\n                  if(bananaShadePlanted == \"yes\"){\n                    \n                      returnbananaShadePlanted = \"Yes\";\n                    \n                  }\n\n                  return returnbananaShadePlanted;\n\n                }),\n                \n                //Yves needs to add object\n                field(\"photograph_intercrop_bananas__c\", function(state) {\n                  \n                  var bananashadePhotoUrl = '';\n                  if(dataValue(\"form.shade_control.photograph_intercrop_bananas\")(state) !== undefined && dataValue(\"form.shade_control.photograph_intercrop_bananas\")(state) !== '') {\n                      bananashadePhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.photo\")(state);\n                    \n                  }\n                  \n                  return bananashadePhotoUrl;\n                  \n                }),\n\n\n              //compost manure\n              field(\"do_you_have_compost_manure__c\", function(state){\n                \n                var haveCompostManure = dataValue(\"form.compost.do_you_have_compost_manure\")(state);\n                var returnHaveCompostManure = \"\";\n                \n                if(haveCompostManure !== undefined && haveCompostManure !== '' && haveCompostManure == 0){\n                  \n                  returnHaveCompostManure = \"No\";\n                  \n                }\n                \n                if(haveCompostManure !== undefined && haveCompostManure !== '' && haveCompostManure == 1){\n                  \n                  returnHaveCompostManure = \"Yes\";\n                  \n                }\n                \n                return returnHaveCompostManure;\n\n              }),\n\n              field(\"photo_of_the_compost_manure__c\", function(state) {\n                \n                var compostPhotoUrl = '';\n                if(dataValue(\"form.compost.photo_of_the_compost_manure\")(state) !== undefined && dataValue(\"form.compost.photo_of_the_compost_manure\")(state) !== '') {\n                  compostPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.compost.photo_of_the_compost_manure\")(state);\n                  \n                }\n                \n                return compostPhotoUrl;\n                \n              }),\n\n              //erosion control\n          /*    field(\"take_a_photo_of_erosion_control__c\", function(state) {\n                \n                var erosionPhotoUrl = '';\n                if(dataValue(\"form.erosion_control.photo_of_erosion_control_method\")(state) !== undefined && dataValue(\"form.erosion_control.photo_of_erosion_control_method\")(state) !== '') {\n                  erosionPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.photo_of_erosion_control_method\")(state);\n                  \n                }\n                \n                return erosionPhotoUrl;\n                \n              }),\n          */\n              field(\"Stabilizing_Grasses_Photo_URL__c\", function(state){                    \n\n                  var sgPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.stabilizing_grasses_image\")(state) !== undefined && dataValue(\"form.erosion_control.stabilizing_grasses_image\")(state) !== '') {\n                      sgPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.stabilizing_grasses_image\")(state); \n                  } \n\n                  return sgPhotoURL;                \n              }),\n              field(\"Mulch_Photo_URL__c\", function(state){                    \n\n                  var mulchPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.mulch_image\")(state) !== undefined && dataValue(\"form.erosion_control.mulch_image\")(state) !== '') {\n                      mulchPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.mulch_image\")(state); \n                  } \n\n                  return mulchPhotoURL;                \n              }),\n              field(\"Water_Traps_Photo_URL__c\", function(state){                    \n\n                  var wtPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.water_traps_or_trenches_image\")(state) !== undefined && dataValue(\"form.erosion_control.water_traps_or_trenches_image\")(state) !== '') {\n                      wtPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.water_traps_or_trenches_image\")(state); \n                  } \n\n                  return wtPhotoURL;                \n              }),\n              field(\"Physical_Barriers_Photo_URL__c\", function(state){                    \n\n                  var pbPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.physical_barriers_image\")(state) !== undefined && dataValue(\"form.erosion_control.physical_barriers_image\")(state) !== '') {\n                      pbPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.physical_barriers_image\")(state); \n                  } \n\n                  return pbPhotoURL;                \n              }),\n              field(\"Terraces_Photo_URL__c\", function(state){                    \n\n                  var terracesPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.terraces_image\")(state) !== undefined && dataValue(\"form.erosion_control.terraces_image\")(state) !== '') {\n                      terracesPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.terraces_image\")(state); \n                  } \n\n                  return terracesPhotoURL;                \n              }),\n              field(\"Contour_Planting_Photo_URL__c\", function(state){                    \n\n                  var cpPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.contour_planting_image\")(state) !== undefined && dataValue(\"form.erosion_control.contour_planting_image\")(state) !== '') {\n                      cpPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.contour_planting_image\")(state); \n                  } \n\n                  return cpPhotoURL;                \n              }),\n              field(\"Cover_Crop_Photo_URL__c\", function(state){                    \n\n                  var ccPhotoURL = \"\";\n                  if(dataValue(\"form.erosion_control.bean_or_arachis_cover_crop_image\")(state) !== undefined && dataValue(\"form.erosion_control.bean_or_arachis_cover_crop_image\")(state) !== '') {\n                      ccPhotoURL = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.erosion_control.bean_or_arachis_cover_crop_image\")(state); \n                  } \n\n                  return ccPhotoURL;                \n              }),\n\n              //record keeping\n              field(\"do_you_have_a_record_book__c\", function(state){\n                \n                var haveRecordBook = dataValue(\"form.record_keeping.do_you_have_a_record_book\")(state);\n                var returnHaveRecordBook = \"\";\n                \n                if(haveRecordBook == 0){\n                  \n                  returnHaveRecordBook = \"No\";\n                  \n                }\n                \n                if(haveRecordBook == 1){\n                  \n                  returnHaveRecordBook = \"Yes\";\n                  \n                }\n                \n                return returnHaveRecordBook;\n\n              }),\n\n              field(\"are_there_records_on_the_record_book__c\", function(state){\n                \n                var recordsOnRecordBook = dataValue(\"form.record_keeping.are_there_records_on_the_record_book\")(state);\n                var returnRecordsOnRecordBook = \"\";\n                \n                if(recordsOnRecordBook !== undefined && recordsOnRecordBook !== '' && recordsOnRecordBook == 0){\n                  \n                  returnRecordsOnRecordBook = \"No\";\n                  \n                }\n                \n                if(recordsOnRecordBook !== undefined && recordsOnRecordBook !== '' && recordsOnRecordBook == 1){\n                  \n                  returnRecordsOnRecordBook = \"Yes\";\n                  \n                }\n                \n                return returnRecordsOnRecordBook;\n                \n              }),\n\n              field(\"take_a_photo_of_the_record_book__c\", function(state){\n                \n                var recordBookPhotoUrl = '';\n                if(dataValue(\"form.record_keeping.take_a_photo_of_the_record_book\")(state) !== undefined && dataValue(\"form.record_keeping.take_a_photo_of_the_record_book\")(state) !== '') {\n                  recordBookPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.record_keeping.take_a_photo_of_the_record_book\")(state) !== undefined && dataValue(\"form.record_keeping.take_a_photo_of_the_record_book\")(state);\n               \n                }\n                \n                return recordBookPhotoUrl;\n                \n              })\n          )\n      )\n  );\n\n\n  //insert the farm visit record\n  each(\n      \"$.data\",\n      upsert(\"Farm_Visit__c\", \"FV_Submission_ID__c\",\n          fields(\n              field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n              field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n              field(\"Farm_Visit_Type__c\", dataValue(\"form.survey_type\")),\n              field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n              field(\"Farm_Visited__c\", function(state){\n                const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n                if(visitedFarmers){\n                  return visitedFarmers.split(\" \")[0];\n                }\n              }),\n              field(\"Primary_Farmer_PIMA_ID__c\", function(state){\n                const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n                if(visitedFarmers){\n                  return visitedFarmers.split(\" \")[0];\n                }\n              }),\n              \n              field(\"Secondary_Farmer__c\", function(state){\n                const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n                var result = '';\n                if(visitedFarmers.length > 1){\n                  result = visitedFarmers.split(\" \")[1];\n                }\n                return result;\n              }),\n              \n              field(\"Secondary_Farmer_PIMA_ID__c\", function(state){\n                const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n                var result = '';\n                if(visitedFarmers.length > 1){\n                  result = visitedFarmers.split(\" \")[1];\n                }\n                return result;\n              }),\n              \n              // field(\"Primary_Farmer_PIMA_ID__c\", dataValue(\"form.farm_being_visted\")),\n              // field(\"Secondary_Farmer__c\", function(state){\n              //     var secondaryFarmer = '';\n              //     if(dataValue(\"form.secondary_farmer_available\")(state) == 'yes' && dataValue(\"form.secondary_farmer\")(state) !== ''){\n              //       secondaryFarmer = dataValue(\"form.secondary_farmer\");\n              //     }\n              //     return secondaryFarmer;\n              // }),\n              // field(\"Secondary_Farmer_PIMA_ID__c\", function(state){\n              //     var secondaryFarmer = '';\n              //     if(dataValue(\"form.secondary_farmer_available\")(state) == 'yes' && dataValue(\"form.secondary_farmer\")(state) !== ''){\n              //       secondaryFarmer = dataValue(\"form.secondary_farmer\");\n              //     }\n              //     return secondaryFarmer;\n              // }),\n              field(\"Visit_Has_Training__c\", dataValue(\"form.is_this_a_farm_training_visit\")),\n            //  field(\"Training_Session__c\", dataValue(\"form.training_session\")),\n              field(\"Other_Participants_Present__c\", dataValue(\"form.any_other_participants_present\")),\n              field(\"Total_Farmers_Visited__c\", dataValue(\"form.attendance_count\")),\n              field(\"Date_Visited__c\", dataValue(\"form.date_of_visit\")),\n              field(\"visit_comments__c\", dataValue(\"form.farm_visit_comments\")),\n              field(\"Farmer_Trainer__c\", dataValue(\"form.trainer\")),\n              field(\"No_of_curedas__c\", dataValue(\"form.opening_questions.number_of_curedas\")),\n              field(\"No_of_separate_coffee_fields__c\", dataValue(\"form.opening_questions.number_of_separate_coffee_fields\")),\n              field(\"Field_Age__c\", dataValue(\"form.field_age\")),\n              field(\"Field_Size__c\", function(state){\n                  var fieldSize = '';\n                  if(dataValue(\"form.field_size\")(state) !== undefined && dataValue(\"form.field_size\")(state) !== ''){\n                    fieldSize = dataValue(\"form.field_size\");\n                  }\n                  else if(dataValue(\"form.field_size1\")(state) !== undefined && dataValue(\"form.field_size1\")(state) !== ''){\n                    fieldSize = dataValue(\"form.field_size1\");\n                  }\n                  \n                  return fieldSize;\n                  \n              }),\n              field(\"Farm_Visit_Photo_Url__c\", function(state) {\n                  var farmVisitPhotoUrl = '';\n                  if (dataValue(\"form.farm_visit_photo\")(state) !== undefined && dataValue(\"form.farm_visit_photo\")(state) !== '') {\n                      farmVisitPhotoUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + dataValue(\"form.farm_visit_photo\")(state);\n                  }\n                  return farmVisitPhotoUrl;\n              }),\n              field(\"Signature__c\", function(state) {\n                  var recorderSignatureUrl = '';\n                  if (dataValue(\"form.signature_of_farmer_trainer\")(state) !== undefined && dataValue(\"form.signature_of_farmer_trainer\")(state) !== '') {\n                      recorderSignatureUrl = \"https://www.commcarehq.org/a/\" + dataValue(\"domain\")(state) + \"/api/form/attachment/\" + dataValue(\"form.meta.instanceID\")(state) + \"/\" + dataValue(\"form.signature_of_farmer_trainer\")(state);\n                  }\n                  return recorderSignatureUrl;\n              }),\n              field('Location_GPS__Latitude__s', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[0];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n                  return '';\n              }),\n              field('Location_GPS__Longitude__s', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[1];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n                  return '';\n              }),\n              field('Altitude__c', (state) => {\n                  // define this once, it's constant...\n                  const coords = state.data.form.gps_coordinates;\n                  // write your contional\n                  if (coords) {\n                    return coords.split(\" \")[2];\n                  }\n                  // the 'else' is unnecessary, return '' if there are no coords\n              return '';\n              })\n          )\n      )\n  );\n  \n  // Update Household Record \n  each(\"$.data\", \n    upsert(\"Household__c\", \"Id\",\n      fields(\n        field(\"Id\", state.data.form.case[\"@case_id\"]),\n        field(\"FV_AA_Visited__c\", dataValue(\"form.case.update.FV_AA_Visited\")(state)),\n        relationship(\n          \"Latest_Farm_Visit_Record__r\",\n          \"FV_Submission_ID__c\",\n          \"FV-\" + dataValue(\"id\")(state)\n          )\n        )\n      )\n  );\n  \n\n\n  //upsert training session\n/*    each(\n      \"$.data\",\n      upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n          fields(\n              field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n              field(\"Updated_from_CommCare__c\", true)\n          )\n      )\n  );\n*/\n\n//}\n",
          "adaptor": "@openfn/language-salesforce@5.0.4",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Farm-Visit---AI---CommCare----Salesforce---Farm-Visit-Full---AI": {
          "enabled": true,
          "id": "ea3a199c-e829-48d4-a2a2-ab3080b53647",
          "target_job_id": "1eca4686-5f22-44fd-8785-4bd6678c2155",
          "source_trigger_id": "5114b682-19d9-422b-afe8-958674c977ca",
          "condition_type": "js_expression",
          "condition_label": "Production - Farm Visit AI - CommCare Salesforce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Farm Visit Full - AI\" && state.data[\"app_id\"] == \"5096d2fa0ab840ffaaa62e7736cfecdd\""
        }
      }
    },
    "Coffee---BDI-Kahawatu-2024C---SalesForce----CommCare---Project-Roles": {
      "id": "8f1af212-6f4c-4776-9096-d8d5aaea4844",
      "name": "Coffee - BDI Kahawatu 2024C - SalesForce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.282740Z",
      "lock_version": 5,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "eef24aa3-671a-4222-8226-36ed72366225",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---BDI-Kahawatu-2024C---SalesForce----CommCare---Project-Roles": {
          "id": "5d2cb34f-c4bd-4874-aa43-e4cefe5cf56b",
          "name": "Coffee - BDI Kahawatu 2024C - SalesForce -- CommCare - Project Roles",
          "body": "//Project Roles\n//Coffee :: Burundi 2024C | SalesForce --> CommCare | Project Roles\n//{\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_bdi_kahawatu_2024c\"}\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Staff\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/CBD34B15-1442-4548-9B2D-C9937E3CB347\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_bdi_kahawatu_2024c_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"mjuma\",\n          \"n1:userID\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\"\n        };\n      })\n    )\n  )\n);// Your job goes here.\n\n// Github test comment\n\n// Another comment\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---BDI-Kahawatu-2024C---SalesForce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "dd0155c4-ff39-4364-a6bc-dd2159d6fec2",
          "target_job_id": "5d2cb34f-c4bd-4874-aa43-e4cefe5cf56b",
          "source_trigger_id": "eef24aa3-671a-4222-8226-36ed72366225",
          "condition_type": "js_expression",
          "condition_label": "Coffee BDI Kahawatu 2024C SalesForce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_bdi_kahawatu_2024c\""
        }
      }
    },
    "Production---Training-Sessions---ET-GAC-CREW-C2025---SalesForce----CommCare": {
      "id": "087ce2c6-8366-4012-8bb9-b2a040c603c4",
      "name": "Production - Training Sessions - ET GAC CREW C2025 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.288586Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "21707193-c9e4-4673-81f1-61feb14286a1",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Training-Sessions---ET-GAC-CREW-C2025---SalesForce----CommCare": {
          "id": "c2a3e3e7-8d8e-4eca-8060-55eee0fb71b1",
          "name": "Production - Training Sessions - ET GAC CREW C2025 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending training groups for Coffee - ET HWG JCP CREW C2024\n// DATA FLOW :: SalesForce --> TO --> CommCare\n// TARGET APPS :: // JOB PURPOSE :: Coffee - ET HWG JCP CREW C2024\n// JOB NAME :: Production | Training Sessions - ET HWG JCP CREW C2024 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Session\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_hwg_jcp_crew_c2024\"}\n\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_et_hwg_jcp_crew_c2025_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_et_hwg_jcp_crew_c2025_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Training-Sessions---ET-GAC-CREW-C2025---SalesForce----CommCare": {
          "enabled": true,
          "id": "670f4252-614f-49c1-aa38-f2178dcd4786",
          "target_job_id": "c2a3e3e7-8d8e-4eca-8060-55eee0fb71b1",
          "source_trigger_id": "21707193-c9e4-4673-81f1-61feb14286a1",
          "condition_type": "js_expression",
          "condition_label": "Production Training Sessions ET GAC CREW C2025 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_hwg_jcp_crew_c2025\""
        }
      }
    },
    "Production---Coffee-BDI-TNS-2024C---SalesForce----CommCare---Training-Groups": {
      "id": "c14b430c-84f0-47b4-8c84-513bf03cf870",
      "name": "Production - Coffee BDI TNS 2024C - SalesForce -- CommCare - Training Groups",
      "inserted_at": "2025-03-20T03:44:07.489050Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "33f78b86-fcdf-4609-9bc6-2c6a260cf708",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-BDI-TNS-2024C---SalesForce----CommCare---Training-Groups": {
          "id": "9e34e5d8-ca0c-4a32-8918-20df78e1fe7b",
          "name": "Production - Coffee BDI TNS 2024C - SalesForce -- CommCare - Training Groups",
          "body": "// Your job goes here.\n\n// Job for Coffee Burundi USDA 2024C TNS\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/B9AE4CBF-B571-4038-9C90-3D5D47DFDB90\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_bdi_tns_2024c_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_bdi_tns_2024c_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-BDI-TNS-2024C---SalesForce----CommCare---Training-Groups": {
          "enabled": true,
          "id": "3aa7f681-cd35-4a61-aca4-bd9baad26a7e",
          "target_job_id": "9e34e5d8-ca0c-4a32-8918-20df78e1fe7b",
          "source_trigger_id": "33f78b86-fcdf-4609-9bc6-2c6a260cf708",
          "condition_type": "js_expression",
          "condition_label": "Coffee BDI TNS 2024C SalesForce CommCare Training Groups",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_bdi_tns_2024c\""
        }
      }
    },
    "Production---Coffee-DRC---CommCare----SalesForce---Training-Observations": {
      "id": "d8812b7d-d308-4d00-b282-5dcee62b38f0",
      "name": "Production - Coffee DRC - CommCare -- SalesForce - Training Observations",
      "inserted_at": "2025-03-20T03:44:07.493532Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "46c9532f-a75a-47e8-b349-fda79e4a5a50",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-DRC---CommCare----SalesForce---Training-Observations": {
          "id": "663a6c48-02d3-46dc-af3f-152b65615ddf",
          "name": "Production - Coffee DRC - CommCare -- SalesForce - Training Observations",
          "body": "//Training Observations\n//Production - Coffee DRC | CommCare --> SalesForce | Training Observations\n\neach(\n  \"$.data\",\n  upsert(\"Observation__c\", \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"id\")),\n      field(\"Observer__c\", dataValue(\"form.Observer\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer_salesforce_id\")),\n      field(\"Training_Group__c\", dataValue(\"form.Which_Group_Is_Farmer_Trainer_Teaching\")),\n      field(\"Training_Session__c\", dataValue(\"form.selected_session\")),\n      field(\"RecordTypeId\", dataValue(\"form.Record_Type\")),\n      field(\"Date__c\", dataValue(\"form.Date\")),\n      field(\"Observation_Type__c\", dataValue(\"form.type_of_training_observation\")),\n      \n      field(\"Male_Participants__c\", function(state){\n        return parseInt(dataValue(\"form.Current_session_participants.Male_Participants_In_Attendance\")(state));\n      }),\n      field(\"Female_Participants__c\", function(state){\n        return parseInt(dataValue(\"form.Current_session_participants.Female_Participants_In_Attendance\")(state));\n      }),\n      field(\"Number_of_Participants__c\", function(state){\n        return parseInt(dataValue(\"form.Current_session_participants.Total_Participants_In_Attendance\")(state));\n      }),\n      \n      field(\"Shared_Action_Plan__c\", dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan\")),\n      field(\"Shared_Action_Plan_Comments__c\", function(state){\n        if(dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state) !== undefined) {\n          return dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state);\n        } else {\n          return '';\n        }\n      }),\n      field(\"Did_Well__c\", dataValue(\"form.Current_Session_Review.Did_Well\")),\n      field(\"To_Improve__c\", dataValue(\"form.Current_Session_Review.To_Improve\")),\n      \n      field(\"Photo_of_Facilitator_URL__c\", function(state) {\n        var photoUrl = '';\n        if(dataValue(\"form.Photo\")(state) !== undefined && dataValue(\"form.Photo\")(state) !== '') {\n          photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo\")(state);  \n        }\n        return photoUrl;\n      }),\n      field(\"Farmer_Trainer_Signature__c\", function(state) {\n        var trainerSignatureUrl = '';\n        if(dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== undefined && dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== '') {\n          trainerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state);  \n        }\n        return trainerSignatureUrl;\n      }),\n      field(\"Observer_Signature__c\", function(state) {\n        var observerSignatureUrl = '';\n        if(dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== undefined && dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== '') {\n          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state);  \n        }\n        return observerSignatureUrl;\n      }),\n      \n      field(\"Observation_Location__Latitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[0]; \n        }\n      }),\n      field(\"Observation_Location__Longitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[1]; \n        }\n      }),\n      field(\"Altitude__c\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[2]; \n        }\n      })\n      \n      \n    )\n  )),\n\n//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- PREPARE AND IMPLEMENT AGRONOMY PRACTICE\n  \neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_prepare_and_implement_agronomy_practice-p1\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_prepare_and_implement_agronomy_practice\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n    ))),\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_prepare_and_implement_agronomy_practice-p2\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_prepare_and_implement_agronomy_practice\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n    ))),\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_prepare_and_implement_agronomy_practice-p3\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_prepare_and_implement_agronomy_practice\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n    ))),\n\n//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- TEACHING CLARITY AND EFFECTIVENESS\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_teaching_clarity_and_effectiveness-p1\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_teaching_clarity_and_effectiveness\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Teaching_Clarity_And_Effectiveness\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n    ))),\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_teaching_clarity_and_effectiveness-p2\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_teaching_clarity_and_effectiveness\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Teaching_Clarity_And_Effectiveness\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n    ))),\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_teaching_clarity_and_effectiveness-p3\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_teaching_clarity_and_effectiveness\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Teaching_Clarity_And_Effectiveness\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n    ))),\n\n//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- KNOWLEDGE OF TRAINER ON AGRONOMY\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_knowledge_of_trainer_on_agronomy-p1\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_knowledge_of_trainer_on_agronomy\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n    ))),\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_knowledge_of_trainer_on_agronomy-p2\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_knowledge_of_trainer_on_agronomy\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n    ))),\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_knowledge_of_trainer_on_agronomy-p3\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_knowledge_of_trainer_on_agronomy\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n    ))),\n\n//CREATE OBSERVATION RESULTS FOR EACH TRAINING OBSERVATION CRITERIA\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_shows_professionalism\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_shows_professionalism\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism_Comments\"))\n  ))),\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_is_prepared_and_organized\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_is_prepared_and_organized\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized_Comments\"))\n  ))),\n\neach(\n  \"$.data\",   \n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_engages_participants\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_engages_participants\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants_Comments\"))\n  ))),\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_facilitates_openings_and_closings\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_facilitates_openings_and_closings\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings_Comments\"))\n  ))),\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_leads_activities\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_leads_activities\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities_Comments\"))\n  ))),\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_leads_discussions\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_leads_discussions\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions_Comments\"))\n  ))),\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_follows_lesson_plans\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_follows_lesson_plans\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans_Comments\"))\n  ))),\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc_manages_time\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc_manages_time\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time_Comments\"))\n  )));\n  \n  // Version control\n  \n",
          "adaptor": "@openfn/language-salesforce@v1.3.2",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-DRC---CommCare----SalesForce---Training-Observations": {
          "enabled": true,
          "id": "32425cdf-a2d0-453d-b1ce-2772352597e3",
          "target_job_id": "663a6c48-02d3-46dc-af3f-152b65615ddf",
          "source_trigger_id": "46c9532f-a75a-47e8-b349-fda79e4a5a50",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee DRC CommCare SalesForce Training Observations",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Training Observation\" && state.data[\"app_id\"] == \"eeddc901b4aa4652b7252240152b20d5\""
        }
      }
    },
    "Production---Coffee-ZIM---CommCare----SalesForce---Demo-Plot-Observations": {
      "id": "6640d874-667b-4114-ac03-aa4716aa91c3",
      "name": "Production - Coffee ZIM - CommCare -- SalesForce - Demo Plot Observations",
      "inserted_at": "2025-03-20T03:44:07.498742Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "b8e46154-acc2-4fb5-84d6-b02d4f43b98a",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-ZIM---CommCare----SalesForce---Demo-Plot-Observations": {
          "id": "0b2abff3-681d-4798-b9d3-1d7ade75a4fa",
          "name": "Production - Coffee ZIM - CommCare -- SalesForce - Demo Plot Observations",
          "body": "//Demo-plot observation\n\neach(\n\"$.data\",\n  upsert(\"Observation__c\", \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"id\")),\n      field(\"Observer__c\", dataValue(\"form.observer\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n      field(\"RecordTypeId\", dataValue(\"form.record_type\")),\n      field(\"Date__c\", dataValue(\"form.date\")),\n      field(\"Demo_Plot_Photo__c\", function(state) {\n        var dempPlotPhotoUrl = '';\n        if(dataValue(\"form.Demo_Plot_Photo\")(state) !== undefined && dataValue(\"form.Demo_Plot_Photo\")(state) !== '') {\n          dempPlotPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Demo_Plot_Photo\")(state);  \n        }\n        return dempPlotPhotoUrl;\n      }),\n      \n      field(\"Observer_Signature__c\", function(state) {\n        var observerSignatureUrl = '';\n        if(dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== undefined && dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== '') {\n          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state);  \n        }\n        return observerSignatureUrl;\n      }),\n      \n      field(\"Observation_Location__Latitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[0]; \n        }\n      }),\n      field(\"Observation_Location__Longitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[1]; \n        }\n      }),\n      field(\"Altitude__c\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[2]; \n        }\n      })\n    )\n  )\n),\n\n//HERE WE CAPTURE ALL THE DPO OBSERVATION RESULTS\n\n// Create results for Rejuvinated_Trees {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim__rejuvinated_trees\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim__rejuvinated_trees\"),\n    field(\"Result__c\", dataValue(\"form.Rejuvinated_Trees\"))\n  ))),\n\n// Create results for Sucker_Selection_Taken_Place {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim__sucker_selection_taken_place\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim__sucker_selection_taken_place\"),\n    field(\"Result__c\", dataValue(\"form.Sucker_Selection_Taken_Place\"))\n  ))),\n\n\n// Create results for Maximum_of_Three_Suckers {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim__maximum_of_three_suckers\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim__maximum_of_three_suckers\"),\n    field(\"Result__c\", dataValue(\"form.Maximum_of_Three_Suckers\"))\n  ))),\n\n\n// Create results for Pruned_Demo_Plot {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim__pruned_demo_plot\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim__pruned_demo_plot\"),\n    field(\"Result__c\", dataValue(\"form.Pruned_Demo_Plot\"))\n  ))),\n\n\n// Create results for Trees_Reduced_to_2_or_3_Main_Stems {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim__trees_reduced_to_2_or_3_main_stems\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim__trees_reduced_to_2_or_3_main_stems\"),\n    field(\"Result__c\", dataValue(\"form.Trees_Reduced_to_2_or_3_Main_Stems\"))\n  ))),\n\n\n// Create results for Demo_Plots_Free_of_Weeds {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim__demo_plots_free_of_weeds\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim__demo_plots_free_of_weeds\"),\n    field(\"Result__c\", dataValue(\"form.Demo_Plots_Free_of_Weeds\"))\n  ))),\n\n\n// Create results for Mulched_Under_Coffee_Canopy {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim__mulched_under_coffee_canopy\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim__mulched_under_coffee_canopy\"),\n    field(\"Result__c\", dataValue(\"form.Mulched_Under_Coffee_Canopy\"))\n  ))),\n\n\n// Create results for X20_40_Shade_over_Demo_Plot {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim__X20_40_shade_over_demo_plot\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim__X20_40_shade_over_demo_plot\"),\n    field(\"Result__c\", dataValue(\"form.X20_40_Shade_over_Demo_Plot\"))\n  ))),\n\n\n// Create results for Shade_Trees_Planted {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim__shade_trees_planted\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim__shade_trees_planted\"),\n    field(\"Result__c\", dataValue(\"form.Shade_Trees_Planted\"))\n  ))),\n\n\n// Create results for Compost_Heap {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim__compost_heap\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim__compost_heap\"),\n    field(\"Result__c\", dataValue(\"form.Compost_Heap\")),\n    field(\"Photo_URL__c\", function(state) {\n        var compostHeapPhotoUrl = '';\n        if(dataValue(\"form.Photo_of_Compost_Heap\")(state) !== undefined && dataValue(\"form.Photo_of_Compost_Heap\")(state) !== '') {\n          compostHeapPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo_of_Compost_Heap\")(state);  \n        }\n        return compostHeapPhotoUrl;\n      })\n  ))),\n\n\n// Create results for Vertiver_Grass_on_Demo_Plot {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim__vertiver_grass_on_demo_plot\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim__vertiver_grass_on_demo_plot\"),\n    field(\"Result__c\", dataValue(\"form.Vertiver_Grass_on_Demo_Plot\"))\n  )));\n\n// Version control\n",
          "adaptor": "@openfn/language-salesforce@v1.3.2",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-ZIM---CommCare----SalesForce---Demo-Plot-Observations": {
          "enabled": true,
          "id": "95ebd888-d226-4987-92d0-62363e6a9ff8",
          "target_job_id": "0b2abff3-681d-4798-b9d3-1d7ade75a4fa",
          "source_trigger_id": "b8e46154-acc2-4fb5-84d6-b02d4f43b98a",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee ZIM CommCare SalesForce Demo Plot Observations",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Demo Plot Observation\" && state.data[\"app_id\"] == \"b75286e874c74eb09b8da436709d7f3c\""
        }
      }
    },
    "x-[archived]-Production---Coffee-HWG-C2022---CommCare----SalesForce---Demo-Plot-Observations": {
      "id": "4b259845-2493-439b-8945-ef861d87e30c",
      "name": "x [archived] Production - Coffee HWG C2022 - CommCare -- SalesForce - Demo Plot Observations",
      "inserted_at": "2025-03-20T03:44:07.505960Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "bab438a2-f5ea-4e07-9cc9-a9167ee4faaf",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-HWG-C2022---CommCare----SalesForce---Demo-Plot-Observations": {
          "id": "96a2acf5-a62b-48a0-8972-67ea9c2a8029",
          "name": "Production - Coffee HWG C2022 - CommCare -- SalesForce - Demo Plot Observations",
          "body": "//Demo Plot Observations\n//Production - Coffee HWG C2022 | Demo Plot Observations | CommCare --> SalesForce\n\n\neach(\n\"$.data\",\n  upsert(\"Observation__c\", \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"id\")),\n      field(\"Observer__c\", dataValue(\"form.observer\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n      field(\"RecordTypeId\", dataValue(\"form.record_type\")),\n      field(\"Date__c\", dataValue(\"form.date\")),\n      field(\"Comments_1__c\", dataValue(\"form.visit_comments\")),\n      field(\"Demo_Plot_Photo__c\", function(state) {\n        var dempPlotPhotoUrl = '';\n        if(dataValue(\"form.Demo_Plot_Photo\")(state) !== undefined && dataValue(\"form.Demo_Plot_Photo\")(state) !== '') {\n          dempPlotPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Demo_Plot_Photo\")(state);  \n        }\n        return dempPlotPhotoUrl;\n      }),\n      \n      field(\"Observer_Signature__c\", function(state) {\n        var observerSignatureUrl = '';\n        if(dataValue(\"form.agronomy_advisor_signature\")(state) !== undefined && dataValue(\"form.agronomy_advisor_signature\")(state) !== '') {\n          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.agronomy_advisor_signature\")(state);  \n        }\n        return observerSignatureUrl;\n      }),\n      \n      field(\"Observation_Location__Latitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[0]; \n        }\n      }),\n      field(\"Observation_Location__Longitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[1]; \n        }\n      }),\n      field(\"Altitude__c\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[2]; \n        }\n      })\n    )\n  )\n),\n\n//HERE WE CAPTURE ALL THE DPO OBSERVATION RESULTS\n// Creates results for Stumped Trees\n\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_hwg_2022__stumped_trees\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_hwg_2022__stumped_trees\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.stumped.stumped_trees\"))\n  ))),\n\n// Create results for Sucker Selection\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_hwg_2022__sucker_selection_taken_place\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_hwg_2022__sucker_selection_taken_place\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.sucker_selection.Sucker_Selection_Taken_Place\")),\n    field(\"Result_number__c\", dataValue(\"form.best_practice_questions.sucker_selection.number_of_suckers\"))\n    \n  ))),\n\n\n\n// Create results for Compost Heap\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_hwg_2022__compost_heap\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_hwg_2022__compost_heap\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.compost_heap.present_compost_heap\")),\n    field(\"Compost_Photo__c\", function(state) {\n        var compostPhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state) !== '') {\n          compostPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.compost_heap.compost_heap_photo\")(state);  \n        }\n        return compostPhotoUrl;\n      })\n      \n    \n  ))),\n\n\n// Create results for Weed Management\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_hwg_2022__weed_management\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_hwg_2022__weed_management\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\")),\n    field(\"Result_Text__c\", dataValue(\"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\")),\n    field(\"Result_Text_Two__c\", dataValue(\"form.best_practice_questions.weed_management.how_big_are_the_weeds\")),\n    field(\"Weed_Management_Photo__c\", function(state) {\n        var weedsPhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state) !== '') {\n          weedsPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.weed_management.weed_management_photo\")(state);  \n        }\n        return weedsPhotoUrl;\n      })\n  ))),\n\n\n// Create results for Shade Management\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_hwg_2022__shade_management\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_hwg_2022__shade_management\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.shade_management.level_of_shade_present\")),\n    field(\"Shade_Management_Photo__c\", function(state) {\n        var shadePhotoUrl = '';\n        if(dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state) !== undefined && dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state) !== '') {\n          shadePhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.best_practice_questions.shade_management.shade_management_photo\")(state);  \n        }\n        return shadePhotoUrl;\n      })\n  ))),\n\n\n// Create results for Mulch\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_hwg_2022__mulch\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_hwg_2022__mulch\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.mulch.mulch_under_the_canopy\")),\n    field(\"Result_Text__c\", dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\"))\n  ))),\n\n\n// Create results for Vetiver Planted\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_hwg_2022__vetiver_planted\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_hwg_2022__vetiver_planted\"),\n    field(\"Result__c\", dataValue(\"form.best_practice_questions.vetiver.vetiver_planted\"))\n  )));\n\n/*\n// Create results for Shade_Trees_Planted {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__shade_trees_planted\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__shade_trees_planted\"),\n    field(\"Result__c\", dataValue(\"form.Shade_Trees_Planted\"))\n  ))),\n\n\n// Create results for Compost_Heap {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__compost_heap\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__compost_heap\"),\n    field(\"Result__c\", dataValue(\"form.Compost_Heap\")),\n    field(\"Photo_URL__c\", function(state) {\n        var compostHeapPhotoUrl = '';\n        if(dataValue(\"form.Photo_of_Compost_Heap\")(state) !== undefined && dataValue(\"form.Photo_of_Compost_Heap\")(state) !== '') {\n          compostHeapPhotoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo_of_Compost_Heap\")(state);  \n        }\n        return compostHeapPhotoUrl;\n      })\n  ))),\n\n\n// Create results for Vertiver_Grass_on_Demo_Plot {Yes || No}\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_drc__vertiver_grass_on_demo_plot\";\n    }),\n    field(\"Observation__c\",function(state){\n      return state.references[state.references.length-1].id;\n    }),\n    field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_drc__vertiver_grass_on_demo_plot\"),\n    field(\"Result__c\", dataValue(\"form.Vertiver_Grass_on_Demo_Plot\"))\n  )));\n\n// Version control\n*/\n",
          "adaptor": "@openfn/language-salesforce@v1.3.2",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-HWG-C2022---CommCare----SalesForce---Demo-Plot-Observations": {
          "enabled": true,
          "id": "8d32780c-ab84-453c-b132-1158b4e0e87c",
          "target_job_id": "96a2acf5-a62b-48a0-8972-67ea9c2a8029",
          "source_trigger_id": "bab438a2-f5ea-4e07-9cc9-a9167ee4faaf",
          "condition_type": "js_expression",
          "condition_label": "Coffee HWG C2022 Demo Plot Observations CommCare SalesForce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Demo Plot Observation\" && state.data[\"app_id\"] == \"8f77f25440e5412ba0820a39271374f0\""
        }
      }
    },
    "x-[archived]-CC----SQL---Regenerate-Rwanda": {
      "id": "f1c6f0db-b6eb-4505-bc8d-3015b669ce03",
      "name": "x [archived] CC -- SQL - Regenerate Rwanda",
      "inserted_at": "2025-03-20T03:44:07.511521Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "2a041b49-a6fe-44b3-8b1b-9c1f217bcd6a",
          "type": "webhook"
        }
      },
      "jobs": {
        "CC----SQL---Regenerate-Rwanda": {
          "id": "0f632bc1-8c6f-40e7-b71e-7bec16d8ac9c",
          "name": "CC -- SQL - Regenerate Rwanda",
          "body": "\n\neach(\n  fn((substate) => {\n      \n      var createdObjects = [];\n      \n      if(substate.data.form.survey_type == \"Partner Registration\"){\n        const enumerator = substate.data.form.enumerator;\n        var data_collection_date =\"\";\n        \n        if(substate.data.form.data_collection_date ==\"\"){\n          data_collection_date = '2024-01-01';\n        }\n        else{\n          data_collection_date = substate.data.form.data_collection_date;\n        }\n        const partnership_start_date = state.data.form.partnership_start_date;\n        const partner_name = state.data.form.partner_name;\n        const establishment_date = state.data.form.establishment_date;\n        const registration_number = state.data.form.registration_number;\n        var sector_portfolio_raw = state.data.form.sector_portfolio;\n        sector_portfolio_raw = sector_portfolio_raw.replace(\" \", \", \");\n        const other_portfolio = state.data.form.specify_sector_portfolio;\n        const sector_portfolio = sector_portfolio_raw.replace(\"other\", other_portfolio);\n        \n        var business_type_raw = state.data.form.business_type;\n        business_type_raw = business_type_raw.replace(\" \", \", \");\n        const other_business = state.data.form.specify_business_type;\n        const business_type = business_type_raw.replace(\"other\", other_business);\n        \n        const legal_rep = state.data.form.legal_rep;\n        const legal_rep_sex = state.data.form.legal_rep_sex;\n        const partner_district = state.data.form.partner_district;\n        const partner_sector = state.data.form.partner_sector;\n        const gps_location = state.data.form.gps_location;\n        const email = state.data.form.email;\n        const contact = state.data.form.contact;\n        const provinces_of_operation = state.data.form.provinces_of_operation;\n        const districts_of_operation = state.data.form.districts_of_operation;\n        const partner_id = state.data.form.partner_id;\n        \n        \n         var createdObject = {\n            enumerator : enumerator,\n            data_collection_date: data_collection_date,\n            partnership_start_date: partnership_start_date,\n            partner_name: partner_name,\n            establishment_date: establishment_date,\n            registration_number: registration_number,\n            sector_portfolio: sector_portfolio,\n            business_type: business_type,\n            legal_rep: legal_rep,\n            legal_rep_sex: legal_rep_sex,\n            partner_district: partner_district,\n            partner_sector: partner_sector,\n            gps_location: gps_location,\n            email: email,\n            contact: contact,\n            provinces_of_operation: provinces_of_operation,\n            districts_of_operation: districts_of_operation,\n            partner_id: partner_id\n        };\n        createdObjects.push(createdObject);\n      }\n      \n      console.log(createdObjects);\n\n      return createdObjects;\n  }),\nupsertMany(\n  '1_partner_register', // the DB table\n  [\n    {enumerator: dataValue(\"enumerator\"),\n      data_collection_date: dataValue(\"data_collection_date\"),\n      partnership_start_date: dataValue(\"partnership_start_date\"),\n      partner_name: dataValue(\"partner_name\"),\n      establishment_date: dataValue(\"establishment_date\"),\n      registration_number: dataValue(\"registration_number\"),\n      sector_portfolio: dataValue(\"sector_portfolio\"),\n      business_type: dataValue(\"business_type\"),\n      legal_rep: dataValue(\"legal_rep\"),\n      legal_rep_sex: dataValue(\"legal_rep_sex\"),\n      partner_district: dataValue(\"partner_district\"),\n      partner_sector: dataValue(\"partner_sector\"),\n      gps_location: dataValue(\"gps_location\"),\n      email: dataValue(\"email\"),\n      contact: dataValue(\"contact\"),\n      provinces_of_operation: dataValue(\"provinces_of_operation\"),\n      districts_of_operation: dataValue(\"districts_of_operation\"),\n      partner_id: dataValue(\"partner_id\")\n    }\n  ]\n)\n);\n",
          "adaptor": "@openfn/language-mysql@v1.4.7",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->CC----SQL---Regenerate-Rwanda": {
          "enabled": true,
          "id": "bd641161-0dbf-49bb-a0b4-c712a9398245",
          "target_job_id": "0f632bc1-8c6f-40e7-b71e-7bec16d8ac9c",
          "source_trigger_id": "2a041b49-a6fe-44b3-8b1b-9c1f217bcd6a",
          "condition_type": "js_expression",
          "condition_label": "CC MySQL Regenerate Rwanda",
          "condition_expression": "state.data[\"app_id\"] == \"a5282084af264f5f8f310bd7e57ce3ac\""
        }
      }
    },
    "Coffee---BDI-Kahawatu-2024C---SalesForce----CommCare---Training-Groups": {
      "id": "0af27987-c058-44b0-aa17-2b1d449a06b2",
      "name": "Coffee - BDI Kahawatu 2024C - SalesForce -- CommCare - Training Groups",
      "inserted_at": "2025-03-20T03:44:07.516294Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "3c1c0fc0-e909-4751-a836-e579798e2043",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---BDI-Kahawatu-2024C---SalesForce----CommCare---Training-Groups": {
          "id": "9e4bbc5f-f3b5-4b6c-98c4-1886f510f844",
          "name": "Coffee - BDI Kahawatu 2024C - SalesForce -- CommCare - Training Groups",
          "body": "//Training Groups\n//Coffee :: BDI kahawatu 2024C | SalesForce --> CommCare | Training Groups\n//{\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_bdi_kahawatu_2024c\"}\n\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/E70C61DB-A15E-4466-B187-02B2FCB6A135\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"Status\", dataValue(\"groupStatus\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_bdi_kahawatu_2024c_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:Status\": dataValue(\"groupStatus\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_bdi_kahawatu_2024c_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\"\n        };\n      })\n    )\n  )\n);// Your job goes here.\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---BDI-Kahawatu-2024C---SalesForce----CommCare---Training-Groups": {
          "enabled": true,
          "id": "f5829811-3e0e-4d30-bb69-c1acd41de4a1",
          "target_job_id": "9e4bbc5f-f3b5-4b6c-98c4-1886f510f844",
          "source_trigger_id": "3c1c0fc0-e909-4751-a836-e579798e2043",
          "condition_type": "js_expression",
          "condition_label": "Coffee BDI Kahawatu 2024C SalesForce CommCare Training Groups",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_bdi_kahawatu_2024c\""
        }
      }
    },
    "Coffee---BDI-Kahawatu-2024C---SalesForce----CommCare---Training-Sessions": {
      "id": "1953f258-de06-4d8b-bdea-6b4749bedf00",
      "name": "Coffee - BDI Kahawatu 2024C - SalesForce -- CommCare - Training Sessions",
      "inserted_at": "2025-03-20T03:44:07.520830Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "ea0f5ab2-a61f-4f53-aad0-8c29257d142f",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---BDI-Kahawatu-2024C---SalesForce----CommCare---Training-Sessions": {
          "id": "b0e1c8b1-a9e0-4e3c-9377-942c8f1fbad9",
          "name": "Coffee - BDI Kahawatu 2024C - SalesForce -- CommCare - Training Sessions",
          "body": "// Your job goes here.\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_bdi_kahawatu_2024c_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_bdi_kahawatu_2024c_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---BDI-Kahawatu-2024C---SalesForce----CommCare---Training-Sessions": {
          "enabled": true,
          "id": "6df68831-596b-4d8c-824c-b48a22b02da1",
          "target_job_id": "b0e1c8b1-a9e0-4e3c-9377-942c8f1fbad9",
          "source_trigger_id": "ea0f5ab2-a61f-4f53-aad0-8c29257d142f",
          "condition_type": "js_expression",
          "condition_label": "Coffee BDI Kahawatu 2024C SalesForce CommCare Training Sessions",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_bdi_kahawatu_2024c\""
        }
      }
    },
    "Coffee---ZW-Nespresso--Ag----c2---SalesForce----CommCare---Training-Participants": {
      "id": "200e769e-a294-41c5-a7ff-da988e02aa89",
      "name": "Coffee - ZW Nespresso -Ag- - c2 - SalesForce -- CommCare - Training Participants",
      "inserted_at": "2025-03-20T03:44:07.526141Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "0045a76a-6e30-49ca-85c6-a683977cd868",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---ZW-Nespresso--Ag----c2---SalesForce----CommCare---Training-Participants": {
          "id": "7de840e4-bc0d-495f-b9ff-e35d95ec5d09",
          "name": "Coffee - ZW Nespresso -Ag- - c2 - SalesForce -- CommCare - Training Participants",
          "body": "//Coffee - ZW Nespresso (Ag) - c2 | SalesForce --> CommCare | Training Participants\n\neach(\n  \"$.data.participants[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/1768D5C8-3EE4-4D7B-AE17-FE0AC9A0E60D\",\n          \"uiVersion\": \"1\",\n          \"version\": \"325\",\n          \"name\": \"New Participant\",\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name;\n      }),\n      field(\"First_Name\", dataValue(\"participantName\")),\n      field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n      field(\"Last_Name\", dataValue(\"participantLastName\")),\n      field(\"Age\", dataValue(\"participantAge\")),\n      field(\"Gender\", dataValue(\"participantGender\")),\n      field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n      field(\"Farmer_Id\", dataValue(\"tnsId\")),\n      field(\"Farmer_Number\", function(state){\n        var tnsId = dataValue(\"tnsId\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        return farmerNumber;\n      }),\n      field(\"Cooperative_Membership_Number\", dataValue(\"participantOtherIDNumber\")),\n      field(\"Household_Id\", dataValue(\"householdId\")),\n      field(\"Household_Number\", dataValue(\"householdName\")),\n      field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n      field(\"Status\", dataValue(\"status\")),\n      field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Name_Household_Concat\", function(state){\n        var name = '';\n        var tnsId = dataValue(\"tnsId\")(state);\n        var hhNumber = dataValue(\"householdName\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        \n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name+' '+hhNumber+'-'+farmerNumber;\n      }),\n      \n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_zim_c2_ag_participant\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:First_Name\": dataValue(\"participantName\")(state),\n            \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n            \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n            \"n0:Age\": dataValue(\"participantAge\")(state),\n            \"n0:Gender\": dataValue(\"participantGender\")(state),\n            \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n            \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Farmer_Number\": function(){\n              var tnsId = dataValue(\"tnsId\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              return farmerNumber;\n            },\n            \"n0:Cooperative_Membership_Number\": dataValue(\"participantOtherIDNumber\")(state),\n            \"n0:Household_Id\": dataValue(\"householdId\")(state),\n            \"n0:Household_Number\": dataValue(\"householdName\")(state),\n            \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n            \"n0:Status\": dataValue(\"status\")(state),\n            \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n            \"n0:Name_Household_Concat\": function(){\n              var name = '';\n              var tnsId = dataValue(\"tnsId\")(state);\n              var hhNumber = dataValue(\"householdName\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              \n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name+' '+hhNumber+'-'+farmerNumber;\n            },\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_zim_c2_ag_training_group\"\n              },\n              \"#\": dataValue(\"trainingGroupId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n1:deviceID\": \"867066029216796\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---ZW-Nespresso--Ag----c2---SalesForce----CommCare---Training-Participants": {
          "enabled": true,
          "id": "f9d2d3a2-9c20-4eec-a6e7-3956a8d4edde",
          "target_job_id": "7de840e4-bc0d-495f-b9ff-e35d95ec5d09",
          "source_trigger_id": "0045a76a-6e30-49ca-85c6-a683977cd868",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW Nespresso Ag c2 SalesForce CommCare Training Participants",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zim_c2_ag\""
        }
      }
    },
    "Production---Coffee-KE-2023C---SalesForce----CommCare---Project-Roles": {
      "id": "fecbd3ab-a910-41b9-9241-7ca6280b0eb2",
      "name": "Production - Coffee KE 2023C - SalesForce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.531683Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "ed9f606f-0819-488c-b8d5-7623665ffc19",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-KE-2023C---SalesForce----CommCare---Project-Roles": {
          "id": "e49d542f-7f6a-4b26-9dd7-47e94cf05f24",
          "name": "Production - Coffee KE 2023C - SalesForce -- CommCare - Project Roles",
          "body": "// Project Roles Job = Coffee - Kenya Nespresso 2023C\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_ke_2023c_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);// Your job goes here.\n\n// version control\n",
          "adaptor": "@openfn/language-commcare@v1.5.1",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-KE-2023C---SalesForce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "9d5cc76d-3e04-42d1-a856-e42d31a9d60a",
          "target_job_id": "e49d542f-7f6a-4b26-9dd7-47e94cf05f24",
          "source_trigger_id": "ed9f606f-0819-488c-b8d5-7623665ffc19",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE 2023C SalesForce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2023c\""
        }
      }
    },
    "Production---Coffee-KE-2024AC---Dummy---SalesForce----CommCare---Project-Roles": {
      "id": "648c5f5c-dfab-4e5f-a9f8-f5e367ab5620",
      "name": "Production - Coffee KE 2024AC - Dummy - SalesForce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.535858Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "ce1b2e51-a07f-430c-8d9b-ccac5086b31d",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-KE-2024AC---Dummy---SalesForce----CommCare---Project-Roles": {
          "id": "bfbe23b9-2a7e-4b63-8566-69972da3ec1f",
          "name": "Production - Coffee KE 2024AC - Dummy - SalesForce -- CommCare - Project Roles",
          "body": "// Project Roles Job = Coffee - Kenya Nespresso 2024ac_dummy\neach(\n    \"$.data.projectRoles[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"name\": \"New Project Role\",\n            \"uiVersion\": \"1\",\n            \"version\": \"1\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n          };\n        }),\n        field(\"Name\", function(state){\n          var name = '';\n          if(dataValue(\"staffName\")(state) !== null) {\n            name = dataValue(\"staffName\")(state);\n          }\n          return name;\n        }),\n        field(\"TNS_Id\", dataValue(\"tnsId\")),\n        field(\"City\", dataValue(\"locationName\")),\n        field(\"Role\", dataValue(\"roleForCommCare\")),\n        field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n        field(\"Current_Module\", dataValue(\"currentModule\")),\n        field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n        field(\"Previous_Module\", dataValue(\"previousModule\")),\n        field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n        field(\"Name_id_concat\", function(state){\n          var name = '';\n          if(dataValue(\"staffName\")(state) !== null) {\n            name = dataValue(\"staffName\")(state);\n          }\n          if(dataValue(\"tnsId\")(state) !== null) {\n            name = name+' '+dataValue(\"tnsId\")(state);\n          }\n          return name;\n        }),\n        field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n        field(\"n0:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"commCareCaseId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": function(){\n                var name = '';\n                if(dataValue(\"staffName\")(state) !== null) {\n                  name = dataValue(\"staffName\")(state);\n                }\n                return name;\n              },\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_ke_2024ac_dummy_staff\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n              \"n0:Name_Id_Concat\": function() {\n                var name = '';\n                if(dataValue(\"staffName\")(state) !== null) {\n                  name = dataValue(\"staffName\")(state);\n                }\n                if(dataValue(\"tnsId\")(state) !== null) {\n                  name = name+' '+dataValue(\"tnsId\")(state);\n                }\n                return name;\n              },\n              \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n              \"n0:City\": dataValue(\"locationName\")(state),\n              \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n              \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n              \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n              \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n              \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n              \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n            }\n          };\n        }),\n        field(\"n1:meta\", function(state) {\n          return {\n            \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n            \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n            \"n1:timeStart\": new Date().toISOString(),\n            \"n1:timeEnd\": new Date().toISOString(),\n            \"n1:username\": \"api\",\n            \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );// Your job goes here.\n  \n  // version control\n  \n",
          "adaptor": "@openfn/language-commcare@v1.6.9",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-KE-2024AC---Dummy---SalesForce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "98d08c2a-c74d-4325-bb72-542df0fba779",
          "target_job_id": "bfbe23b9-2a7e-4b63-8566-69972da3ec1f",
          "source_trigger_id": "ce1b2e51-a07f-430c-8d9b-ccac5086b31d",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE 2024AC Dummy SalesForce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2024ac_dummy\""
        }
      }
    },
    "Production---Coffee-KE-2024AC---Dummy---SalesForce----CommCare---Training-Sessions": {
      "id": "6ea1790e-536a-4dc8-abbf-a25070d1f5d4",
      "name": "Production - Coffee KE 2024AC - Dummy - SalesForce -- CommCare - Training Sessions",
      "inserted_at": "2025-03-20T03:44:07.540535Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "a8ffd292-9006-4022-89e4-4c7b29ef539f",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-KE-2024AC---Dummy---SalesForce----CommCare---Training-Sessions": {
          "id": "12f05eae-512f-4589-9336-e4a05136bda2",
          "name": "Production - Coffee KE 2024AC - Dummy - SalesForce -- CommCare - Training Sessions",
          "body": "// Your job goes here.\neach(\n    \"$.data.trainingSessions[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"name\": \"New Training Session\",\n            \"uiVersion\": \"1\",\n            \"version\": \"148\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n          };\n        }),\n        field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n        field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n        field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n        field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n        field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n        field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n        field(\"Current_Previous_Name\", function(state){\n          return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n        }),\n        field(\"Training_Session_Name\", function(state) {\n          return (\n            dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n          );\n        }),\n        field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n        field(\"Case_Id\", dataValue(\"sessionId\")),\n        field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n        field(\"subcase_0\", function(state) {\n          return {\n            \"n0:case\": {\n              \"@\": {\n                \"case_id\": dataValue(\"sessionId\")(state),\n                \"date_modified\": new Date().toISOString(),\n                \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n                \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n              },\n              \"n0:create\": {\n                \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n                \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n                \"n0:case_type\": \"coffee_ke_2024ac_dummy_training_session\"\n              },\n              \"n0:update\": {\n                \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n                \"n0:Date\": new Date().toISOString(),\n                \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n                \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n                \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n                \"n0:Current_Previous_Name\": function(){\n                  return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n                },\n                \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n                \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n                \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n                \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n                \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n              },\n              \"n0:index\":  {\n                \"n0:parent\" : {\n                  \"@\": {\n                    \"case_type\": \"coffee_ke_2024ac_dummy_training_group\"\n                  },\n                  \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n                }\n              }\n            }\n          };\n        }),\n        field(\"n1:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n            }\n          };\n        }),\n        field(\"n2:meta\", function(state) {\n          return {\n            \"@\": {\n              \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n            },\n            \"n2:deviceID\": \"867066029216796\",\n            \"n2:timeStart\": new Date().toISOString(),\n            \"n2:timeEnd\": new Date().toISOString(),\n            \"n2:username\": \"api\",\n            \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );\n",
          "adaptor": "@openfn/language-commcare@v1.6.9",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-KE-2024AC---Dummy---SalesForce----CommCare---Training-Sessions": {
          "enabled": true,
          "id": "5be707e0-40ef-4a46-88e7-98d2503e0d91",
          "target_job_id": "12f05eae-512f-4589-9336-e4a05136bda2",
          "source_trigger_id": "a8ffd292-9006-4022-89e4-4c7b29ef539f",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE 2024AC Dummy SalesForce CommCare Training Sessions",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2024ac_dummy\""
        }
      }
    },
    "Production---Coffee-KE-2024AC---SalesForce----CommCare---Training-Sessions": {
      "id": "6c49f2b3-3272-4580-a603-8c9e60be6bc3",
      "name": "Production - Coffee KE 2024AC - SalesForce -- CommCare - Training Sessions",
      "inserted_at": "2025-03-20T03:44:07.545720Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "48b2b3b9-70c4-463a-ae86-303185814173",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-KE-2024AC---SalesForce----CommCare---Training-Sessions": {
          "id": "f22e8687-33b2-44a9-8c0e-5c992fa76fa6",
          "name": "Production - Coffee KE 2024AC - SalesForce -- CommCare - Training Sessions",
          "body": "// Your job goes here.\neach(\n    \"$.data.trainingSessions[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"name\": \"New Training Session\",\n            \"uiVersion\": \"1\",\n            \"version\": \"148\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n          };\n        }),\n        field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n        field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n        field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n        field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n        field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n        field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n        field(\"Current_Previous_Name\", function(state){\n          return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n        }),\n        field(\"Training_Session_Name\", function(state) {\n          return (\n            dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n          );\n        }),\n        field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n        field(\"Case_Id\", dataValue(\"sessionId\")),\n        field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n        field(\"subcase_0\", function(state) {\n          return {\n            \"n0:case\": {\n              \"@\": {\n                \"case_id\": dataValue(\"sessionId\")(state),\n                \"date_modified\": new Date().toISOString(),\n                \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n                \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n              },\n              \"n0:create\": {\n                \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n                \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n                \"n0:case_type\": \"coffee_ke_2024ac_training_session\"\n              },\n              \"n0:update\": {\n                \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n                \"n0:Date\": new Date().toISOString(),\n                \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n                \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n                \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n                \"n0:Current_Previous_Name\": function(){\n                  return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n                },\n                \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n                \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n                \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n                \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n                \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n              },\n              \"n0:index\":  {\n                \"n0:parent\" : {\n                  \"@\": {\n                    \"case_type\": \"coffee_ke_2024ac_training_group\"\n                  },\n                  \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n                }\n              }\n            }\n          };\n        }),\n        field(\"n1:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n            }\n          };\n        }),\n        field(\"n2:meta\", function(state) {\n          return {\n            \"@\": {\n              \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n            },\n            \"n2:deviceID\": \"867066029216796\",\n            \"n2:timeStart\": new Date().toISOString(),\n            \"n2:timeEnd\": new Date().toISOString(),\n            \"n2:username\": \"api\",\n            \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );\n",
          "adaptor": "@openfn/language-commcare@v1.6.9",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-KE-2024AC---SalesForce----CommCare---Training-Sessions": {
          "enabled": true,
          "id": "9cca801b-c90d-48d1-849e-87450af33fb6",
          "target_job_id": "f22e8687-33b2-44a9-8c0e-5c992fa76fa6",
          "source_trigger_id": "48b2b3b9-70c4-463a-ae86-303185814173",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE 2024AC SalesForce CommCare Training Sessions",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2024ac\""
        }
      }
    },
    "Production---Coffee-ZIM---CommCare----SalesForce---Training-Observations": {
      "id": "f6c2c35f-ff13-4a4d-ad39-69ae3eeb643c",
      "name": "Production - Coffee ZIM - CommCare -- SalesForce - Training Observations",
      "inserted_at": "2025-03-20T03:44:07.550045Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "a951740f-2754-4218-a90a-bd2f78d9b37f",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-ZIM---CommCare----SalesForce---Training-Observations": {
          "id": "d005fc2c-74de-4ec4-9c0e-ca676ac03299",
          "name": "Production - Coffee ZIM - CommCare -- SalesForce - Training Observations",
          "body": "//Training Observation\n\neach(\n  \"$.data\",\n  upsert(\"Observation__c\", \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"id\")),\n      field(\"Observer__c\", dataValue(\"form.Observer\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer_salesforce_id\")),\n      field(\"Training_Group__c\", dataValue(\"form.Which_Group_Is_Farmer_Trainer_Teaching\")),\n      field(\"Training_Session__c\", dataValue(\"form.selected_session\")),\n      field(\"RecordTypeId\", dataValue(\"form.Record_Type\")),\n      field(\"Date__c\", dataValue(\"form.Date\")),\n      \n      field(\"Male_Participants__c\", function(state){\n        return parseInt(dataValue(\"form.Current_session_participants.Male_Participants_In_Attendance\")(state));\n      }),\n      field(\"Female_Participants__c\", function(state){\n        return parseInt(dataValue(\"form.Current_session_participants.Female_Participants_In_Attendance\")(state));\n      }),\n      field(\"Number_of_Participants__c\", function(state){\n        return parseInt(dataValue(\"form.Current_session_participants.Total_Participants_In_Attendance\")(state));\n      }),\n      \n      field(\"Shared_Action_Plan__c\", dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan\")),\n      field(\"Shared_Action_Plan_Comments__c\", function(state){\n        if(dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state) !== undefined) {\n          return dataValue(\"form.Feedback_And_Coaching_With_The_Farmer_Trainer.Share_Action_Plan_Comments\")(state);\n        } else {\n          return '';\n        }\n      }),\n      field(\"Did_Well__c\", dataValue(\"form.Current_Session_Review.Did_Well\")),\n      field(\"To_Improve__c\", dataValue(\"form.Current_Session_Review.To_Improve\")),\n      \n      field(\"Photo_of_Facilitator_URL__c\", function(state) {\n        var photoUrl = '';\n        if(dataValue(\"form.Photo\")(state) !== undefined && dataValue(\"form.Photo\")(state) !== '') {\n          photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Photo\")(state);  \n        }\n        return photoUrl;\n      }),\n      field(\"Farmer_Trainer_Signature__c\", function(state) {\n        var trainerSignatureUrl = '';\n        if(dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== undefined && dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state) !== '') {\n          trainerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Farmer_Trainer_Signature_Section.Farmer_Trainer_Signature\")(state);  \n        }\n        return trainerSignatureUrl;\n      }),\n      field(\"Observer_Signature__c\", function(state) {\n        var observerSignatureUrl = '';\n        if(dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== undefined && dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state) !== '') {\n          observerSignatureUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.Observer_Signature_Section.Observer_Signature\")(state);  \n        }\n        return observerSignatureUrl;\n      }),\n      \n      field(\"Observation_Location__Latitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[0]; \n        }\n      }),\n      field(\"Observation_Location__Longitude__s\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[1]; \n        }\n      }),\n      field(\"Altitude__c\", function(state) {\n        if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n          return coordinates[2]; \n        }\n      })\n      \n      \n    )\n  )),\n\n//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- PREPARE AND IMPLEMENT AGRONOMY PRACTICE\n  \neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\", \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_prepare_and_implement_agronomy_practice-p1\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_prepare_and_implement_agronomy_practice\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n    ))),\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_prepare_and_implement_agronomy_practice-p2\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_prepare_and_implement_agronomy_practice\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n    ))),\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_prepare_and_implement_agronomy_practice-p3\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_prepare_and_implement_agronomy_practice\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Prepare_And_Implement_Agronomy_Practice\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n    ))),\n\n//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- TEACHING CLARITY AND EFFECTIVENESS\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_teaching_clarity_and_effectiveness-p1\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_teaching_clarity_and_effectiveness\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Teaching_Clarity_And_Effectiveness\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n    ))),\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_teaching_clarity_and_effectiveness-p2\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_teaching_clarity_and_effectiveness\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Teaching_Clarity_And_Effectiveness\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n    ))),\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_teaching_clarity_and_effectiveness-p3\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_teaching_clarity_and_effectiveness\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Teaching_Clarity_And_Effectiveness\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n    ))),\n\n//CREATE OBSERVATION RESULTS FOR EACH PARTICIPANT -- KNOWLEDGE OF TRAINER ON AGRONOMY\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_knowledge_of_trainer_on_agronomy-p1\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_knowledge_of_trainer_on_agronomy\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_One_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_One_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_One_Feedback.participant_comments\"))\n    ))),\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_knowledge_of_trainer_on_agronomy-p2\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_knowledge_of_trainer_on_agronomy\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Two_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_Two_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_Two_Feedback.participant_comments\"))\n    ))),\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_knowledge_of_trainer_on_agronomy-p3\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe6AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_knowledge_of_trainer_on_agronomy\"),\n    field(\"Participant_Sex__c\", dataValue(\"form.Participant_Three_Feedback.Participant_Gender\")),\n    field(\"Result__c\", dataValue(\"form.Participant_Three_Feedback.Knowledge_Of_Trainer_On_Agronomy\")),\n    field(\"Comments__c\", dataValue(\"form.Participant_Three_Feedback.participant_comments\"))\n    ))),\n\n//CREATE OBSERVATION RESULTS FOR EACH TRAINING OBSERVATION CRITERIA\n\neach(\n  \"$.data\",\n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_shows_professionalism\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_shows_professionalism\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Shows_Professionalism_Comments\"))\n  ))),\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_is_prepared_and_organized\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_is_prepared_and_organized\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Is_Prepared_and_Organized_Comments\"))\n  ))),\n\neach(\n  \"$.data\",   \n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_engages_participants\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_engages_participants\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Engages_Participants_Comments\"))\n  ))),\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_facilitates_openings_and_closings\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_facilitates_openings_and_closings\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Facilitates_Openings_and_Closings_Comments\"))\n  ))),\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_leads_activities\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_leads_activities\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Activities_Comments\"))\n  ))),\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_leads_discussions\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_leads_discussions\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Leads_Discussions_Comments\"))\n  ))),\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_follows_lesson_plans\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_follows_lesson_plans\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Follows_Lesson_Plans_Comments\"))\n  ))),\n\neach(\n  \"$.data\",  \n  upsert(\"Observation_Result__c\",  \"Submission_ID__c\",\n    fields(\n    field(\"Submission_ID__c\", function(state) {\n      return dataValue(\"id\")(state) + \"coffee_zim_manages_time\";\n    }),\n    relationship(\"Observation__r\", \"Submission_ID__c\", dataValue(\"id\")),/*function(state){\n      return state.references[state.references.length-1].id;\n    }),*/\n    field(\"RecordTypeId\", \"01224000000gQe7AAE\"),\n    relationship(\"Observation_Criterion__r\", \"Unique_Name__c\", \"coffee_zim_manages_time\"),\n    field(\"Result__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time\")),\n    field(\"Comments__c\", dataValue(\"form.Ratings_and_Comments.Manages_Time_Comments\"))\n  )));\n  \n  // Version control\n  \n",
          "adaptor": "@openfn/language-salesforce@v1.3.2",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-ZIM---CommCare----SalesForce---Training-Observations": {
          "enabled": true,
          "id": "9f0ec92f-ccf8-4e30-b8a1-4cf9eee7f39d",
          "target_job_id": "d005fc2c-74de-4ec4-9c0e-ca676ac03299",
          "source_trigger_id": "a951740f-2754-4218-a90a-bd2f78d9b37f",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee ZIM CommCare SalesForce Training Observations",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Training Observation\" && state.data[\"app_id\"] == \"b75286e874c74eb09b8da436709d7f3c\""
        }
      }
    },
    "Production---Participants---ET-CREW-C2025---SalesForce----CommCare": {
      "id": "33ba3053-7cd6-4426-8eff-e240fccc0e83",
      "name": "Production - Participants - ET CREW C2025 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.557622Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "aff6a534-4905-4b14-b625-f6e7f1935d69",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Participants---ET-CREW-C2025---SalesForce----CommCare": {
          "id": "ee755077-3dbf-444f-b776-9a0277284144",
          "name": "Production - Participants - ET CREW C2025 - SalesForce -- CommCare",
          "body": "// Your job goes here.// JOB PURPOSE :: This is a job for sending Participants for Coffee - ET CREW C2024\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: ET CREW C2024\n// JOB NAME :: Production - Participants - ET CREW C2024 - SalesForce -- CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_hwg_jcp__crew_c2024\"}\n// AUTHOR :: Yves Mugenga | ymugenga@tns.org\n\neach(\n  \"$.data.participants[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3E266629-AFD8-4A1C-8825-1DCDDF24E5A8\",\n          \"uiVersion\": \"1\",\n          \"version\": \"325\",\n          \"name\": \"New Participant\",\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name;\n      }),\n      field(\"First_Name\", dataValue(\"participantName\")),\n      field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n      field(\"Last_Name\", dataValue(\"participantLastName\")),\n      field(\"Age\", dataValue(\"participantAge\")),\n      field(\"Gender\", dataValue(\"participantGender\")),\n      field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n      field(\"Farmer_Id\", dataValue(\"tnsId\")),\n      field(\"Farmer_Number\", function(state){\n        var tnsId = dataValue(\"tnsId\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        return farmerNumber;\n      }),\n      field(\"Cooperative_Membership_Number\", dataValue(\"participantOtherIDNumber\")),\n      field(\"Household_Id\", dataValue(\"householdId\")),\n      field(\"Household_Number\", dataValue(\"householdName\")),\n      field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n      field(\"Status\", dataValue(\"status\")),\n      field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Name_Household_Concat\", function(state){\n        var name = '';\n        var tnsId = dataValue(\"tnsId\")(state);\n        var hhNumber = dataValue(\"householdName\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        \n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name+' '+hhNumber+'-'+farmerNumber;\n      }),\n      \n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_hwg_jcp_crew_c2025_participant\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:First_Name\": dataValue(\"participantName\")(state),\n            \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n            \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n            \"n0:Age\": dataValue(\"participantAge\")(state),\n            \"n0:Gender\": dataValue(\"participantGender\")(state),\n            \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n            \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Farmer_Number\": function(){\n              var tnsId = dataValue(\"tnsId\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              return farmerNumber;\n            },\n            \"n0:Cooperative_Membership_Number\": dataValue(\"participantOtherIDNumber\")(state),\n            \"n0:Household_Id\": dataValue(\"householdId\")(state),\n            \"n0:Household_Number\": dataValue(\"householdName\")(state),\n            \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n            \"n0:Status\": dataValue(\"status\")(state),\n            \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n            \"n0:Name_Household_Concat\": function(){\n              var name = '';\n              var tnsId = dataValue(\"tnsId\")(state);\n              var hhNumber = dataValue(\"householdName\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              \n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name+' '+hhNumber+'-'+farmerNumber;\n            },\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_et_hwg_jcp_crew_c2025_training_group\"\n              },\n              \"#\": dataValue(\"trainingGroupId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n1:deviceID\": \"867066029216796\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Participants---ET-CREW-C2025---SalesForce----CommCare": {
          "enabled": true,
          "id": "cdb5d83f-42ef-42f5-860a-13d501fd45c3",
          "target_job_id": "ee755077-3dbf-444f-b776-9a0277284144",
          "source_trigger_id": "aff6a534-4905-4b14-b625-f6e7f1935d69",
          "condition_type": "js_expression",
          "condition_label": "Production - Participants - ET CREW C2025 - SalesForce -- CommCare",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_hwg_jcp_crew_c2025\""
        }
      }
    },
    "Production---Project-Role---ET-GAC-CREW-TFS-C2025---SalesForce----CommCare": {
      "id": "074d2de9-8b21-46d5-8223-68beceff2888",
      "name": "Production - Project Role - ET GAC CREW TFS C2025 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.569906Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "b0213d34-e5fa-4889-83e2-3cab4b566788",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Project-Role---ET-GAC-CREW-TFS-C2025---SalesForce----CommCare": {
          "id": "da3a5f2d-bb62-435a-8144-321d8b3fdd96",
          "name": "Production - Project Role - ET GAC CREW TFS C2025 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending project roles\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET GAC CREW TFS C2025\n// JOB NAME :: Production | Project Role - ET GAC CREW TFS C2025 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_crew_gac_tfs_c2025\"}\n// AUTHOR :: Emmanuel Mwaka | emwaka@tns.org\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/CBD34B15-1442-4548-9B2D-C9937E3CB347\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"FFGs_Observed\", null),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_crew_gac_tfs_c2025_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:FFGs_Observed\": null,\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Project-Role---ET-GAC-CREW-TFS-C2025---SalesForce----CommCare": {
          "enabled": true,
          "id": "42d46696-eaa6-43b7-bfe6-bd719f74a82f",
          "target_job_id": "da3a5f2d-bb62-435a-8144-321d8b3fdd96",
          "source_trigger_id": "b0213d34-e5fa-4889-83e2-3cab4b566788",
          "condition_type": "js_expression",
          "condition_label": "Production Project Role ET GAC CREW TFS C2025 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_crew_gac_tfs_c2025\""
        }
      }
    },
    "Production---Project-Role---ET-Regrow-YG--Ag--C2024---SalesForce----CommCare": {
      "id": "309b054b-d5d5-4a59-ba6b-bcaf9ab72bae",
      "name": "Production - Project Role - ET Regrow YG -Ag- C2024 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.575064Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "acb31abd-2abe-4bc3-b51d-1ef1c8d20b83",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Project-Role---ET-Regrow-YG--Ag--C2024---SalesForce----CommCare": {
          "id": "0ca24071-c89f-4edf-b584-877ee028edcc",
          "name": "Production - Project Role - ET Regrow YG -Ag- C2024 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending project roles for Coffee Herz Cohort 2024\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET Regrow Yirga (Ag) C2024\n// JOB NAME :: Production | Project Role - ET Regrow YG (Ag) C2024 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_regrow_ag_c3\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/CBD34B15-1442-4548-9B2D-C9937E3CB347\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"FFGs_Observed\", null),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_regrow_ag_c3_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:FFGs_Observed\": null,\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Project-Role---ET-Regrow-YG--Ag--C2024---SalesForce----CommCare": {
          "enabled": true,
          "id": "55bb5813-655f-4081-91f1-534111050d42",
          "target_job_id": "0ca24071-c89f-4edf-b584-877ee028edcc",
          "source_trigger_id": "acb31abd-2abe-4bc3-b51d-1ef1c8d20b83",
          "condition_type": "js_expression",
          "condition_label": "Production Project Roles Regrow Yirga C2024 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_regrow_ag_c3\""
        }
      }
    },
    "Production---Project-Role---ET-Regrow-YG--Ag--C2025---SalesForce----CommCare": {
      "id": "6c4aad02-2b00-4711-bcce-defbe98019e7",
      "name": "Production - Project Role - ET Regrow YG -Ag- C2025 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.579760Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "fb72c2f1-7a46-4adc-a6d7-fff91c2f3032",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Project-Role---ET-Regrow-YG--Ag--C2025---SalesForce----CommCare": {
          "id": "7a297ee4-cdb7-4ff1-b06b-21612cbb911c",
          "name": "Production - Project Role - ET Regrow YG -Ag- C2025 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending project roles for Coffee ET Yirga Regrow 2025C\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET Regrow Yirga (Ag) C2025\n// JOB NAME :: Production | Project Role - ET Regrow YG (Ag) C2025 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_regrow_ag_c4\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n// EDITED :: Emmanuel Mwaka | emwaka@tns.org\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/CBD34B15-1442-4548-9B2D-C9937E3CB347\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"FFGs_Observed\", null),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_regrow_ag_c4_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:FFGs_Observed\": null,\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Project-Role---ET-Regrow-YG--Ag--C2025---SalesForce----CommCare": {
          "enabled": true,
          "id": "e71df155-cc4f-4d05-b67c-57dad6bccad0",
          "target_job_id": "7a297ee4-cdb7-4ff1-b06b-21612cbb911c",
          "source_trigger_id": "fb72c2f1-7a46-4adc-a6d7-fff91c2f3032",
          "condition_type": "js_expression",
          "condition_label": "Production Project Roles Regrow Yirga C2025 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_regrow_ag_c4\""
        }
      }
    },
    "Production---Training-Groups---ET-GAC-CREW-TFS-C2025---SalesForce----CommCare": {
      "id": "dcb0f150-462e-4502-bf6a-37ece74a05c3",
      "name": "Production - Training Groups - ET GAC CREW TFS C2025 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.584260Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "8d327af6-97fb-47ac-bf75-20bbcd82f129",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Training-Groups---ET-GAC-CREW-TFS-C2025---SalesForce----CommCare": {
          "id": "e95025c6-9b5b-4e3a-afaa-e0095e96edb6",
          "name": "Production - Training Groups - ET GAC CREW TFS C2025 - SalesForce -- CommCare",
          "body": "// Your job goes here.// JOB PURPOSE :: This is a job for sending training groups for Coffee - ET GAC CREW C2025\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET GAC CREW TFS C2025\n// JOB NAME :: Production | Training Groups - ET CREW GAC TFS C2025 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_crew_gac_tfs_c2025\"}\n// AUTHOR :: Emmanuel Mwaka }| emwaka@tns.org\n\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_crew_gac_tfs_c2025_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_et_crew_gac_tfs_c2025_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Training-Groups---ET-GAC-CREW-TFS-C2025---SalesForce----CommCare": {
          "enabled": true,
          "id": "3a64034f-e414-48a7-ad02-aef3d49fef0f",
          "target_job_id": "e95025c6-9b5b-4e3a-afaa-e0095e96edb6",
          "source_trigger_id": "8d327af6-97fb-47ac-bf75-20bbcd82f129",
          "condition_type": "js_expression",
          "condition_label": "Production Training Groups ET GAC CREW TFS C2025 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_crew_gac_tfs_c2025\""
        }
      }
    },
    "Production---Training-Groups---ET-Regrow-YG--Ag--C2023---SalesForce----CommCare": {
      "id": "a482032f-e5a9-41c6-b2d5-29fea25faa38",
      "name": "Production - Training Groups - ET Regrow YG -Ag- C2023 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.590166Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "3f532b55-449f-47e1-b31c-3cc1ae2e9f61",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Training-Groups---ET-Regrow-YG--Ag--C2023---SalesForce----CommCare": {
          "id": "63fa8eca-5145-4b38-9b29-fc44c36824db",
          "name": "Production - Training Groups - ET Regrow YG -Ag- C2023 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending training groups for Coffee ET - Regrow Yirga Agronomy C2023\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET Regrow Yirga (Ag) C2023\n// JOB NAME :: Production | Training Groups - ET Regrow YG (Ag) C2023 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_regrow_ag_c2\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n// EDITED :: Emmanuel Mwaka | emwaka@tns.org\n\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_regrow_ag_c2_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_et_regrow_ag_c2_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@v1.5.1",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Training-Groups---ET-Regrow-YG--Ag--C2023---SalesForce----CommCare": {
          "enabled": true,
          "id": "f8707317-5a02-459d-bb00-88b899826f64",
          "target_job_id": "63fa8eca-5145-4b38-9b29-fc44c36824db",
          "source_trigger_id": "3f532b55-449f-47e1-b31c-3cc1ae2e9f61",
          "condition_type": "js_expression",
          "condition_label": "Production Training Groups Regrow Yirga C2023 Salesforce CommCare",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_regrow_ag_c2\""
        }
      }
    },
    "Production---Training-Groups---ET-Regrow-YG--Ag--C2025---SalesForce----CommCare": {
      "id": "09eaa6d4-7408-49d2-88b1-721f99e1cf0b",
      "name": "Production - Training Groups - ET Regrow YG -Ag- C2025 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.595574Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "eaf6fd65-bf2a-416a-8a19-b4197fd4181d",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Training-Groups---ET-Regrow-YG--Ag--C2025---SalesForce----CommCare": {
          "id": "44c8d0c3-d9e4-43d4-b93a-83dc430ad1f2",
          "name": "Production - Training Groups - ET Regrow YG -Ag- C2025 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending training groups for Coffee ET - Regrow Yirga Agronomy C2025\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET Regrow Yirga (Ag) C2025\n// JOB NAME :: Production | Training Groups - ET Regrow YG (Ag) C2025 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_regrow_ag_c4\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n// EDITED :: Emmanuel Mwaka | emwaka@tns.org\n\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_regrow_ag_c4_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_et_regrow_ag_c4_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Training-Groups---ET-Regrow-YG--Ag--C2025---SalesForce----CommCare": {
          "enabled": true,
          "id": "c02218ce-a36d-4326-836c-80fda239d4d1",
          "target_job_id": "44c8d0c3-d9e4-43d4-b93a-83dc430ad1f2",
          "source_trigger_id": "eaf6fd65-bf2a-416a-8a19-b4197fd4181d",
          "condition_type": "js_expression",
          "condition_label": "Production Training Groups Regrow Yirga C2025 Salesforce CommCare",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_regrow_ag_c4\""
        }
      }
    },
    "Production---Training-Sessions---ET-GAC-CREW-TFS-C2025---SalesForce----CommCare": {
      "id": "2355c9a6-0d69-45e4-bacb-c1bc8f1065ed",
      "name": "Production - Training Sessions - ET GAC CREW TFS C2025 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.601690Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "24dcb1d7-56b7-4923-85a2-ee6201a79c40",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Training-Sessions---ET-GAC-CREW-TFS-C2025---SalesForce----CommCare": {
          "id": "dc5e6dd2-0020-4e54-bf57-b9989ec7fa90",
          "name": "Production - Training Sessions - ET GAC CREW TFS C2025 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending training groups for Coffee ET - CREW GAC TFS C2025\n// DATA FLOW :: SalesForce --> TO --> CommCare\n// TARGET APPS :: // JOB PURPOSE :: Coffee - ET GAC CREW TFS C2025\n// JOB NAME :: Production | Training Sessions - ET GAC CREW TFS C2025 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Session\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_crew_gac_tfs_c2025\"}\n\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_et_crew_gac_tfs_c2025_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_et_crew_gac_tfs_c2025_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Training-Sessions---ET-GAC-CREW-TFS-C2025---SalesForce----CommCare": {
          "enabled": true,
          "id": "bed1eca0-8618-48a5-87ed-1a9b814f992b",
          "target_job_id": "dc5e6dd2-0020-4e54-bf57-b9989ec7fa90",
          "source_trigger_id": "24dcb1d7-56b7-4923-85a2-ee6201a79c40",
          "condition_type": "js_expression",
          "condition_label": "Production Training Sessions ET GAC CREW TFS C2025 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_crew_gac_tfs_c2025\""
        }
      }
    },
    "Production-Training-Sessions-Regrow-Yirga-C2025-SalesForce-CommCare": {
      "id": "9171b852-88c0-49e5-8a2b-dea0a6c7aa57",
      "name": "Production Training Sessions Regrow Yirga C2025 SalesForce CommCare",
      "inserted_at": "2025-03-20T03:44:07.606567Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "32464f22-403a-402d-b68b-1113151ffaf2",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production-Training-Sessions-Regrow-Yirga-C2025-SalesForce-CommCare": {
          "id": "badd6aa2-0ce9-4e19-a7bd-39c3a8d0ede4",
          "name": "Production Training Sessions Regrow Yirga C2025 SalesForce CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending training groups for Coffee ET - Regrow Yirga Agronomy C2025\n// DATA FLOW :: SalesForce --> TO --> CommCare\n// TARGET APPS :: // JOB PURPOSE :: Coffee - ET Regrow Yirga (Ag) C2025\n// JOB NAME :: Production | Training Sessions - ET Regrow YG (Ag) C2025 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Session\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_regrow_ag_c4\"}\n\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_et_regrow_ag_c4_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_et_regrow_ag_c4_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production-Training-Sessions-Regrow-Yirga-C2025-SalesForce-CommCare": {
          "enabled": true,
          "id": "5ca7f2f7-cd05-43e0-bdb2-77184acbbdef",
          "target_job_id": "badd6aa2-0ce9-4e19-a7bd-39c3a8d0ede4",
          "source_trigger_id": "32464f22-403a-402d-b68b-1113151ffaf2",
          "condition_type": "js_expression",
          "condition_label": "Production Training Sessions Regrow Yirga C2025 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_regrow_ag_c4\""
        }
      }
    },
    "x-[archived]-Production---Coffee-DRC-GCA-Kalehe-2022C---Demo-Plot-Observations---CommCare----SalesForce": {
      "id": "f3669490-a16d-46ff-bf1d-475f0bfad702",
      "name": "x [archived] Production - Coffee DRC GCA Kalehe 2022C - Demo Plot Observations - CommCare -- SalesForce",
      "inserted_at": "2025-03-20T03:44:07.611483Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "cad8a0e3-b041-4977-9829-dc5f35a232de",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-DRC-GCA-Kalehe-2022C---Demo-Plot-Observations---CommCare----SalesForce": {
          "id": "8910d112-310e-4d35-8f14-2e9e2dfa7d05",
          "name": "Production - Coffee DRC GCA Kalehe 2022C - Demo Plot Observations - CommCare -- SalesForce",
          "body": "//Demo Plot Observations\n//Production - Coffee DRC GCA Kalehe 2022C | Demo Plot Observations | CommCare --> SalesForce\n\neach(\n  \"$.data\",\n  upsert(\n    \"Observation__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"id\")),\n      field(\"Observer__c\", dataValue(\"form.observer\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n      field(\"RecordTypeId\", dataValue(\"form.record_type\")),\n      field(\"Date__c\", dataValue(\"form.date\")),\n      field(\"Comments_1__c\", dataValue(\"form.visit_comments\")),\n      field(\"Demo_Plot_Photo__c\", function (state) {\n        var demoPlotPhotoUrl = \"\";\n        if (\n          dataValue(\"form.Demo_Plot_Photo\")(state) !== undefined &&\n          dataValue(\"form.Demo_Plot_Photo\")(state) !== \"\"\n        ) {\n          demoPlotPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.Demo_Plot_Photo\")(state);\n        }\n        return demoPlotPhotoUrl;\n      }),\n\n      field(\"Observer_Signature__c\", function (state) {\n        var observerSignatureUrl = \"\";\n        if (\n          dataValue(\"form.agronomy_advisor_signature\")(state) !== undefined &&\n          dataValue(\"form.agronomy_advisor_signature\")(state) !== \"\"\n        ) {\n          observerSignatureUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.agronomy_advisor_signature\")(state);\n        }\n        return observerSignatureUrl;\n      }),\n\n      field(\"Observation_Location__Latitude__s\", function (state) {\n        if (dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(\n            \" \"\n          );\n          return coordinates[0];\n        }\n      }),\n      field(\"Observation_Location__Longitude__s\", function (state) {\n        if (dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(\n            \" \"\n          );\n          return coordinates[1];\n        }\n      }),\n      field(\"Altitude__c\", function (state) {\n        if (dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n          var coordinates = dataValue(\"form.meta.location.#text\")(state).split(\n            \" \"\n          );\n          return coordinates[2];\n        }\n      })\n    )\n  )\n);\n\n// Pruning data handler\nbeta.each(\n  function (state) {\n    //incoming pruning data\n    var pruning_data = dataValue(\n      \"form.best_practice_questions.pruning.pruning_methods\"\n    )(state);\n\n    if (pruning_data !== undefined) {\n      return pruning_data.split(\" \").map(function (resultId) {\n        return {\n          result_data: resultId,\n          dpo_submission:\n            dataValue(\"id\")(state) +\n            \"coffee_drc_gca_kalehe_2022__pruning\" +\n            resultId,\n        };\n      });\n    }\n  },\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"dpo_submission\")),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_drc_gca_kalehe_2022__pruning\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnResults = \"\";\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"1\"\n        ) {\n          returnResults = \"Centers opened\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"2\"\n        ) {\n          returnResults = \"Unwanted suckers removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"3\"\n        ) {\n          returnResults = \"Dead branches removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"4\"\n        ) {\n          returnResults = \"Branches touching the ground removed\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"0\"\n        ) {\n          returnResults = \"No pruning methods used\";\n        }\n\n        return returnResults;\n      })\n    )\n  )\n);\n\n// //HERE WE CAPTURE ALL THE DPO OBSERVATION RESULTS\n\n// // Create results for Pruning\n// beta.each(\n//   //\"$.data\",\n//   function (state) {\n//     var pruningData = dataValue(\n//       \"form.best_practice_questions.pruning.pruning_methods\"\n//     )(state);\n//     if (pruningData !== undefined) {\n//       return pruningData.split(\" \").map(function (resultId) {\n//         return {\n//         result_data: resultId,\n//         };\n//         console.log(resultId);\n//       });\n//     }\n//   },\n//   upsert(\n//     \"Observation_Result__c\",\n//     \"Submission_ID__c\",\n//     fields(\n//       field(\"Submission_ID__c\", function (state) {\n//         return dataValue(\"id\")(state) + \"coffee_ke_nn_2023__pruning\";\n//       }),\n//       field(\"Observation__c\", function (state) {\n//         return state.references[state.references.length - 1].id;\n//       }),\n//       field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n//       relationship(\n//         \"Observation_Criterion__r\",\n//         \"Unique_Name__c\",\n//         \"coffee_ke_nn_2023__pruning\"\n//       ),\n//       field(\"Result__c\", function (state) {\n//         var returnPruning = \"\";\n\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"1\"\n//         ) {\n//           returnPruning = \"Centers opened\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"2\"\n//         ) {\n//           returnPruning = \"Unwanted suckers removed\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"3\"\n//         ) {\n//           returnPruning = \"Dead branches removed\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"4\"\n//         ) {\n//           returnPruning = \"Branches touching the ground removed\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"5\"\n//         ) {\n//           returnPruning = \"Broken/unproductive stems and/or branches removed\";\n//         }\n//         if (\n//           dataValue(\"result_data\")(state) !== undefined &&\n//           dataValue(\"result_data\")(state) == \"0\"\n//         ) {\n//           returnPruning = \"No pruning methods used\";\n//         }\n//         return returnPruning;\n//       })\n//     )\n//   )\n// ),\n\n// Create results for Compost Heap\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_drc_kalehe_2022__compost_heap\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_drc_kalehe_2022__compost_heap\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnCompost = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) == \"1\" &&\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) !== undefined\n        ) {\n          returnCompost = \"Yes, compost or manure heap seen\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) == \"0\" &&\n          dataValue(\n            \"form.best_practice_questions.compost_heap.present_compost_heap\"\n          )(state) !== undefined\n        ) {\n          returnCompost = \"No compost or manure heap seen\";\n        }\n        return returnCompost;\n      }),\n      field(\"Compost_Photo__c\", function (state) {\n        var compostPhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.compost_heap.compost_heap_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.compost_heap.compost_heap_photo\"\n          )(state) !== \"\"\n        ) {\n          compostPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.compost_heap.compost_heap_photo\"\n            )(state);\n        }\n        return compostPhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Weed Management\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return (\n          dataValue(\"id\")(state) + \"coffee_drc_gca_kalehe_2022__weed_management\"\n        );\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_drc_gca_kalehe_2022__weed_management\"\n      ),\n\n      //Q1\n      field(\"Result__c\", function (state) {\n        var returnWeeds = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) == \"1\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) !== undefined\n        ) {\n          returnWeeds = \"Yes, field dug\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) == \"0\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.has_the_demo_plot_been_dug\"\n          )(state) !== undefined\n        ) {\n          returnWeeds = \"No sign of digging\";\n        }\n        return returnWeeds;\n      }),\n\n      //Q2\n      field(\"Result_Text__c\", function (state) {\n        var returnWeeds2 = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) == \"0\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) !== undefined\n        ) {\n          returnWeeds2 = \"No weeds under the tree canopy\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) == \"1\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) !== undefined\n        ) {\n          returnWeeds2 = \"Few weeds under the tree canopy\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) == \"2\" &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_many_weeds_are_under_the_tree_canopy\"\n          )(state) !== undefined\n        ) {\n          returnWeeds2 = \"Many weeds under the tree canopy\";\n        }\n\n        return returnWeeds2;\n      }),\n\n      //Q3\n      field(\"Result_Text_Two__c\", function (state) {\n        var returnWeeds3 = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) == \"1\"\n        ) {\n          returnWeeds3 =\n            \"Weeds are less than 30cm tall or 30cm spread for grasses\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.how_big_are_the_weeds\"\n          )(state) == \"2\"\n        ) {\n          returnWeeds3 =\n            \"Weeds are more than 30cm tall or 30cm spread for grasses\";\n        }\n        return returnWeeds3;\n      }),\n\n      field(\"Weed_Management_Photo__c\", function (state) {\n        var weedsPhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.weed_management.weed_management_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.weed_management.weed_management_photo\"\n          )(state) !== \"\"\n        ) {\n          weedsPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.weed_management.weed_management_photo\"\n            )(state);\n        }\n        return weedsPhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Shade Management\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return (\n          dataValue(\"id\")(state) +\n          \"coffee_drc_gca_kalehe_2022__shade_management\"\n        );\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_drc_gca_kalehe_2022__shade_management\"\n      ),\n\n      // Question 1\n      field(\"Result__c\", function (state) {\n        var returnShade = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"0\"\n        ) {\n          returnShade = \"NO shade, less than 5%\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"1\"\n        ) {\n          returnShade = \"Light shade, 5 to 20%\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"2\"\n        ) {\n          returnShade = \"Medium shade, 20 to 40%\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.level_of_shade_present\"\n          )(state) == \"3\"\n        ) {\n          returnShade = \"Heavy shade, over 40%\";\n        }\n        return returnShade;\n      }),\n\n      // Question 2\n      field(\"Result_Text__c\", function (state) {\n        var returnShade2 = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.have_2_shade_trees_been_planted\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.have_2_shade_trees_been_planted\"\n          )(state) == \"1\"\n        ) {\n          returnShade2 = \"Yes. 2 shade trees planted\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.have_2_shade_trees_been_planted\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.have_2_shade_trees_been_planted\"\n          )(state) == \"0\"\n        ) {\n          returnShade2 = \"No. Shade trees have not been planted yet\";\n        }\n        return returnShade2;\n      }),\n\n      field(\"Shade_Management_Photo__c\", function (state) {\n        var shadePhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.shade_management.shade_management_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.shade_management.shade_management_photo\"\n          )(state) !== \"\"\n        ) {\n          shadePhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.shade_management.shade_management_photo\"\n            )(state);\n        }\n        return shadePhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Mulch\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return dataValue(\"id\")(state) + \"coffee_drc_gca_kalehe_2022__mulch\";\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_drc_gca_kalehe_2022__mulch\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnMulch = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) == \"1\"\n        ) {\n          returnMulch = \"Yes, Some mulch seen\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.mulch.mulch_under_the_canopy\"\n          )(state) == \"0\"\n        ) {\n          returnMulch = \"No mulch seen\";\n        }\n        return returnMulch;\n      }),\n      field(\"Result_Text__c\", function (state) {\n        var returnMulch2 = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) == \"1\"\n        ) {\n          returnMulch2 = \"Soil can be seen clearly, less than 2cm of mulch\";\n        } else if (\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.mulch.thickness_of_mulch\")(\n            state\n          ) == \"2\"\n        ) {\n          returnMulch2 = \"Soil can not be seen, more than 2cm of mulch\";\n        }\n        return returnMulch2;\n      })\n    )\n  )\n);\n\n// Create results for Kitchen Gardens\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return (\n          dataValue(\"id\")(state) + \"coffee_drc_gca_kalehe_2022__kitchen_garden\"\n        );\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_drc_gca_kalehe_2022__kitchen_garden\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnWoodlots = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.kitchen_gardens.is_there_a_kitchen_garden\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.kitchen_gardens.is_there_a_kitchen_garden\"\n          )(state) == \"1\"\n        ) {\n          returnWoodlots = \"Yes. There is a kitchen garden on the farm\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.kitchen_gardens.is_there_a_kitchen_garden\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.kitchen_gardens.is_there_a_kitchen_garden\"\n          )(state) == \"0\"\n        ) {\n          returnWoodlots = \"No kitchen garden planted\";\n        }\n        return returnWoodlots;\n      }),\n\n      field(\"Kitchen_Garden_Photo__c\", function (state) {\n        var RejuvenationPhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.kitchen_gardens.kitchen_garden_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.kitchen_gardens.kitchen_garden_photo\"\n          )(state) !== \"\"\n        ) {\n          RejuvenationPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.kitchen_gardens.kitchen_garden_photo\"\n            )(state);\n        }\n        return RejuvenationPhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Woodlots\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return (\n          dataValue(\"id\")(state) + \"coffee_drc_gca_kalehe_2022__woodlots\"\n        );\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_drc_gca_kalehe_2022__woodlots\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnWoodlots = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.woodlots.is_there_woodlots\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.woodlots.is_there_woodlots\")(\n            state\n          ) == \"1\"\n        ) {\n          returnWoodlots = \"Yes. There is a woodlot on the farm\";\n        } else if (\n          dataValue(\"form.best_practice_questions.woodlots.is_there_woodlots\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.woodlots.is_there_woodlots\")(\n            state\n          ) == \"0\"\n        ) {\n          returnWoodlots = \"No woodlot planted\";\n        }\n        return returnWoodlots;\n      }),\n\n      field(\"Woodlot_Photo__c\", function (state) {\n        var RejuvenationPhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.woodlots.woodlots_photo\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.woodlots.woodlots_photo\"\n          )(state) !== \"\"\n        ) {\n          RejuvenationPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.woodlots.woodlots_photo\"\n            )(state);\n        }\n        return RejuvenationPhotoUrl;\n      })\n    )\n  )\n);\n\n// Create results for Rejuvenation\neach(\n  \"$.data\",\n  upsert(\n    \"Observation_Result__c\",\n    \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", function (state) {\n        return (\n          dataValue(\"id\")(state) + \"coffee_drc_gca_kalehe_2022__rejuvenation\"\n        );\n      }),\n      field(\"Observation__c\", function (state) {\n        return state.references[state.references.length - 1].id;\n      }),\n      field(\"RecordTypeId\", \"01224000000gQe5AAE\"),\n      relationship(\n        \"Observation_Criterion__r\",\n        \"Unique_Name__c\",\n        \"coffee_drc_gca_kalehe_2022__rejuvenation\"\n      ),\n      field(\"Result__c\", function (state) {\n        var returnRejuventation = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.rejuvenation.rejuvenation_plot\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.rejuvenation.rejuvenation_plot\"\n          )(state) == 1\n        ) {\n          returnRejuventation = \"Yes. There is a rejuvenated plot\";\n        } else if (\n          dataValue(\n            \"form.best_practice_questions.rejuvenation.rejuvenation_plot\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.rejuvenation.rejuvenation_plot\"\n          )(state) == 0\n        ) {\n          returnRejuventation = \"No rejuvenated plot\";\n        }\n        return returnRejuventation;\n      }),\n      field(\"Result_Text__c\", function (state) {\n        var returnRejuventation2 = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n            state\n          ) == 1\n        ) {\n          returnRejuventation2 = \"Yes. Sucker selection is complete\";\n        } else if (\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_three\")(\n            state\n          ) == 0\n        ) {\n          returnRejuventation2 = \"No. Sucker selection has not been done\";\n        }\n        return returnRejuventation2;\n      }),\n\n      field(\"Rejuvenation_Photo__c\", function (state) {\n        var RejuvenationPhotoUrl = \"\";\n        if (\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_photo\")(\n            state\n          ) !== undefined &&\n          dataValue(\"form.best_practice_questions.rejuvenation.suckers_photo\")(\n            state\n          ) !== \"\"\n        ) {\n          RejuvenationPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.rejuvenation.suckers_photo\"\n            )(state);\n        }\n        return RejuvenationPhotoUrl;\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-salesforce@v3.0.7",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-DRC-GCA-Kalehe-2022C---Demo-Plot-Observations---CommCare----SalesForce": {
          "enabled": true,
          "id": "919607f6-c678-4f92-b22d-1763bb2a7a0e",
          "target_job_id": "8910d112-310e-4d35-8f14-2e9e2dfa7d05",
          "source_trigger_id": "cad8a0e3-b041-4977-9829-dc5f35a232de",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee DRC GCA Kalehe 2022C Demo Plot Observations CommCare SalesForce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Demo Plot Observation\" && state.data[\"app_id\"] == \"3c5b97f40ff54b72a3c85e221b6eb5c2\""
        }
      }
    },
    "x-[archived]-Coffee-DRC--GCA-TNS-2022---Project-Roles---Salesforce----CommCare": {
      "id": "eb83cc7b-0a7b-406f-9c08-72c1bbb8f390",
      "name": "x [archived] Coffee DRC- GCA TNS 2022 - Project Roles - Salesforce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.618263Z",
      "lock_version": 4,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "52cda24d-ee65-4291-a368-f7d1ce2457cf",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee-DRC--GCA-TNS-2022---Project-Roles---Salesforce----CommCare": {
          "id": "a4992427-e018-4c9c-b69c-69987150d15e",
          "name": "Coffee DRC- GCA TNS 2022 - Project Roles - Salesforce -- CommCare",
          "body": "//Coffee DRC - GCA TNS 2022 | Project Roles | Salesforce --> CommCare\n//coffee_drc_gca_tns_2022\n//{\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_drc_gca_tns_2022\"}\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_drc_gca_tns_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee-DRC--GCA-TNS-2022---Project-Roles---Salesforce----CommCare": {
          "enabled": true,
          "id": "93b9cc41-f872-49c2-a312-5fe419a16687",
          "target_job_id": "a4992427-e018-4c9c-b69c-69987150d15e",
          "source_trigger_id": "52cda24d-ee65-4291-a368-f7d1ce2457cf",
          "condition_type": "js_expression",
          "condition_label": "Coffee DRC GCA TNS 2022 Project Roles Salesforce  CommCare",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_drc_gca_tns_2022\""
        }
      }
    },
    "Coffee-DRC-GCA-Kabare-C2023---SalesForce----CommCare---Training-Sessions": {
      "id": "b24f0870-435f-4256-9873-2d64065cd94d",
      "name": "Coffee DRC GCA Kabare C2023 - SalesForce -- CommCare - Training Sessions",
      "inserted_at": "2025-03-20T03:44:07.623861Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "80f07573-88a5-42d7-8e63-e25128b7fa56",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee-DRC-GCA-Kabare-C2023---SalesForce----CommCare---Training-Sessions": {
          "id": "e72c3d6e-cbdb-4fcb-a75d-7eb467c2fafd",
          "name": "Coffee DRC GCA Kabare C2023 - SalesForce -- CommCare - Training Sessions",
          "body": "// Your job goes here.\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_drc_gca_kabare_c2023_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_drc_gca_kabare_c2023_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee-DRC-GCA-Kabare-C2023---SalesForce----CommCare---Training-Sessions": {
          "enabled": true,
          "id": "93c77049-cba4-4312-a47a-b0f4cf5849d6",
          "target_job_id": "e72c3d6e-cbdb-4fcb-a75d-7eb467c2fafd",
          "source_trigger_id": "80f07573-88a5-42d7-8e63-e25128b7fa56",
          "condition_type": "js_expression",
          "condition_label": "Coffee DRC GCA Kabare C2023 SalesForce CommCare Training Sessions",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_drc_gca_kabare_c2023\""
        }
      }
    },
    "Coffee-DRC-GCA-Kalehe-C2023---SalesForce----CommCare---Training-Sessions": {
      "id": "834482be-e796-40a2-86a8-5d78fe452177",
      "name": "Coffee DRC GCA Kalehe C2023 - SalesForce -- CommCare - Training Sessions",
      "inserted_at": "2025-03-20T03:44:07.628716Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "dbe06803-ef96-4ee7-9b0f-52cfea126755",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee-DRC-GCA-Kalehe-C2023---SalesForce----CommCare---Training-Sessions": {
          "id": "7073c3c6-9b95-49c2-90c5-c6fc73039730",
          "name": "Coffee DRC GCA Kalehe C2023 - SalesForce -- CommCare - Training Sessions",
          "body": "// Your job goes here.\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_drc_gca_kalehe_c2023_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_drc_gca_kalehe_c2023_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee-DRC-GCA-Kalehe-C2023---SalesForce----CommCare---Training-Sessions": {
          "enabled": true,
          "id": "62076d81-8641-4965-a9e6-36d760dfc5e3",
          "target_job_id": "7073c3c6-9b95-49c2-90c5-c6fc73039730",
          "source_trigger_id": "dbe06803-ef96-4ee7-9b0f-52cfea126755",
          "condition_type": "js_expression",
          "condition_label": "Coffee DRC GCA Kalehe C2023 SalesForce CommCare Training Sessions",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_drc_gca_kalehe_c2023\""
        }
      }
    },
    "Coffee---PR-2022---Salesforce----CommCare---Project-Roles": {
      "id": "3ee9083a-0f50-42c1-840c-4c2790720665",
      "name": "Coffee - PR 2022 - Salesforce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.634613Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "dbdbfe97-cea0-436d-8728-62b2c94371cb",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---PR-2022---Salesforce----CommCare---Project-Roles": {
          "id": "9bdeb5e2-6d16-4abc-8f22-860a63fc90c3",
          "name": "Coffee - PR 2022 - Salesforce -- CommCare - Project Roles",
          "body": "//Project Role Job\n//Coffee:: PR C2020 | SalesForce --> CommCare | Project Roles\n//{\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_puerto_rico_2022\"}\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Staff\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/CBD34B15-1442-4548-9B2D-C9937E3CB347\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_pr_2022_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---PR-2022---Salesforce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "b296b924-aaf2-4cd6-9989-93f536286a1b",
          "target_job_id": "9bdeb5e2-6d16-4abc-8f22-860a63fc90c3",
          "source_trigger_id": "dbdbfe97-cea0-436d-8728-62b2c94371cb",
          "condition_type": "js_expression",
          "condition_label": "Coffee PR 2022 Salesforce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_puerto_rico_2022\""
        }
      }
    },
    "Coffee---PR-2022---SalesForce----CommCare---Training-Groups": {
      "id": "1ed46a3f-3c1d-4aba-83c0-c2de48052c4b",
      "name": "Coffee - PR 2022 - SalesForce -- CommCare - Training Groups",
      "inserted_at": "2025-03-20T03:44:07.639474Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "7bbd9356-1253-485a-a900-2e85113ba5c8",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---PR-2022---SalesForce----CommCare---Training-Groups": {
          "id": "8462ddac-357f-4802-965a-dd825c9b9c6d",
          "name": "Coffee - PR 2022 - SalesForce -- CommCare - Training Groups",
          "body": "//Training Group Job \n//Coffee :: PR 2022 | SalesForce --> CommCare | Training Groups\n//{\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_puerto_rico_2022\"}\n\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/E70C61DB-A15E-4466-B187-02B2FCB6A135\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"Status\", dataValue(\"groupStatus\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Municipality\", dataValue(\"municipality\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_pr_2022_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:Status\": dataValue(\"groupStatus\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_pr_2022_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---PR-2022---SalesForce----CommCare---Training-Groups": {
          "enabled": true,
          "id": "47588bbb-54cd-4d1f-9afa-95ebba7bfe57",
          "target_job_id": "8462ddac-357f-4802-965a-dd825c9b9c6d",
          "source_trigger_id": "7bbd9356-1253-485a-a900-2e85113ba5c8",
          "condition_type": "js_expression",
          "condition_label": "Coffee PR 2022 SalesForce CommCare Training Groups",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_puerto_rico_2022\""
        }
      }
    },
    "Coffee---ZW-IFC-2024C---SalesForce----CommCare---Project-Roles": {
      "id": "d133b48e-294e-4fd9-92d5-202b3e5977ec",
      "name": "Coffee - ZW IFC 2024C - SalesForce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.645109Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "67649d00-4a37-4188-98f5-32aaacde2cf2",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---ZW-IFC-2024C---SalesForce----CommCare---Project-Roles": {
          "id": "7ca69f7f-55ef-49af-b014-7b405a5eaff9",
          "name": "Coffee - ZW IFC 2024C - SalesForce -- CommCare - Project Roles",
          "body": "//Coffee - ZW C4 - C2024 | SalesForce --> CommCare | Project Roles\n//{\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_zw_2024c\"}\n\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"FFGs_Observed\", null),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_zw_2024c_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFGs_Observed\": null\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---ZW-IFC-2024C---SalesForce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "48a14bda-2c80-449c-b51a-a3e62c5531b0",
          "target_job_id": "7ca69f7f-55ef-49af-b014-7b405a5eaff9",
          "source_trigger_id": "67649d00-4a37-4188-98f5-32aaacde2cf2",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW IFC 2024C SalesForce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zw_2024c\""
        }
      }
    },
    "Coffee---ZW-Nespresso--Ag----c2---SalesForce----CommCare---Training-Groups": {
      "id": "1c4b6931-814d-4877-bf69-67bfaff08aa9",
      "name": "Coffee - ZW Nespresso -Ag- - c2 - SalesForce -- CommCare - Training Groups",
      "inserted_at": "2025-03-20T03:44:07.650363Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "7bc897cb-a247-4340-8c50-755a272ba1a3",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---ZW-Nespresso--Ag----c2---SalesForce----CommCare---Training-Groups": {
          "id": "630874a0-2659-4e38-b778-a40f627a264c",
          "name": "Coffee - ZW Nespresso -Ag- - c2 - SalesForce -- CommCare - Training Groups",
          "body": "//Coffee - ZW Nespresso (Ag) - c2 | SalesForce --> CommCare | Training Groups\n//coffee_zim_c2_agronomy\n//{\"uniqueProjectKey\":\"coffee_zim_c2_agronomy\",\"source\":\"SF\",\"jobType\":\"Training Group\"}\n\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/B9AE4CBF-B571-4038-9C90-3D5D47DFDB90\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_zim_c2_ag_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_zim_c2_ag_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---ZW-Nespresso--Ag----c2---SalesForce----CommCare---Training-Groups": {
          "enabled": true,
          "id": "88c27e1f-9a0f-4bd3-bd6b-5a0eb87e45a3",
          "target_job_id": "630874a0-2659-4e38-b778-a40f627a264c",
          "source_trigger_id": "7bc897cb-a247-4340-8c50-755a272ba1a3",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW Nespresso Ag c2 SalesForce CommCare Training Groups",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zim_c2_ag\""
        }
      }
    },
    "DRC-2021-Ag---C1---Salesforce----CommCare---Project-Roles": {
      "id": "7f86d585-095e-4a8c-b173-6608096ffb2e",
      "name": "DRC 2021 Ag - C1 - Salesforce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.655272Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "a701d328-871d-43ec-b41b-90627d903352",
          "type": "webhook"
        }
      },
      "jobs": {
        "DRC-2021-Ag---C1---Salesforce----CommCare---Project-Roles": {
          "id": "f37c6cea-c45b-42ba-9bc4-a1f7ea3577fa",
          "name": "DRC 2021 Ag - C1 - Salesforce -- CommCare - Project Roles",
          "body": "//DRC 2021 Ag :: C1 | Salesforce --> CommCare | Project Roles\n//coffee_drc_2021_agronomy_cohort_1\n//{\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_drc_2021_agronomy_cohort_1\"}\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_drc_2021_ag_c1_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->DRC-2021-Ag---C1---Salesforce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "4e67da90-1735-4a04-bf5f-ff1dc8ee5491",
          "target_job_id": "f37c6cea-c45b-42ba-9bc4-a1f7ea3577fa",
          "source_trigger_id": "a701d328-871d-43ec-b41b-90627d903352",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee DRC SalesForce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ca_svc\""
        }
      }
    },
    "Global---SalesForce----CommCare---Training-Sessions": {
      "id": "c964a78d-22fa-4645-9c24-9cc813123f6c",
      "name": "Global - SalesForce -- CommCare - Training Sessions",
      "inserted_at": "2025-03-20T03:44:07.660694Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "02a44ce6-4c29-4834-ba3f-6dfc3178f907",
          "type": "webhook"
        }
      },
      "jobs": {
        "Global---SalesForce----CommCare---Training-Sessions": {
          "id": "51e207ba-cfcc-4a16-ba4b-2273f9f22b40",
          "name": "Global - SalesForce -- CommCare - Training Sessions",
          "body": "//Coffee - ZW C1 - C2018 | SalesForce --> CommCare | Training Sessions\n//{\"jobType\":\"Training Session\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_zim_c2_ag\"}\n\n\neach(\n    \"$.data.trainingSessions[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"name\": \"New Training Session\",\n            \"uiVersion\": \"1\",\n            \"version\": \"148\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n          };\n        }),\n        field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n        field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n        field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n        field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n        field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n        field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n        field(\"Current_Previous_Name\", function(state){\n          return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n        }),\n        field(\"Training_Session_Name\", function(state) {\n          return (\n            dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n          );\n        }),\n        field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n        field(\"Case_Id\", dataValue(\"sessionId\")),\n        field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n        field(\"subcase_0\", function(state) {\n          return {\n            \"n0:case\": {\n              \"@\": {\n                \"case_id\": dataValue(\"sessionId\")(state),\n                \"date_modified\": new Date().toISOString(),\n                \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n                \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n              },\n              \"n0:create\": {\n                \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n                \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n                \"n0:case_type\": \"the_avengers_initiative_training_session\"\n              },\n              \"n0:update\": {\n                \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n                \"n0:Date\": new Date().toISOString(),\n                \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n                \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n                \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n                \"n0:Current_Previous_Name\": function(){\n                  return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n                },\n                \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n                \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n                \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n                \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n                \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n              },\n              \"n0:index\":  {\n                \"n0:parent\" : {\n                  \"@\": {\n                    \"case_type\": \"avengers_initiative_training_group\"\n                  },\n                  \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n                }\n              }\n            }\n          };\n        }),\n        field(\"n1:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n            }\n          };\n        }),\n        field(\"n2:meta\", function(state) {\n          return {\n            \"@\": {\n              \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n            },\n            \"n2:deviceID\": \"867066029216796\",\n            \"n2:timeStart\": new Date().toISOString(),\n            \"n2:timeEnd\": new Date().toISOString(),\n            \"n2:username\": \"api\",\n            \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Global---SalesForce----CommCare---Training-Sessions": {
          "enabled": true,
          "id": "12dd029e-4db0-414d-bd8b-2b68a559af4d",
          "target_job_id": "51e207ba-cfcc-4a16-ba4b-2273f9f22b40",
          "source_trigger_id": "02a44ce6-4c29-4834-ba3f-6dfc3178f907",
          "condition_type": "js_expression",
          "condition_label": "Global SalesForce CommCare Training Sessions",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"the_avengers_initiative\""
        }
      }
    },
    "Global---Training-Groups---Salesforce----CommCare": {
      "id": "6097ac5a-6053-4283-8075-8e3bb41244ca",
      "name": "Global - Training Groups - Salesforce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.672556Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "fe07c15a-e5a6-46fe-a574-326385c98456",
          "type": "webhook"
        }
      },
      "jobs": {
        "Global---Training-Groups---Salesforce----CommCare": {
          "id": "4e56a9eb-3725-4981-8b2d-eda18e5f66b0",
          "name": "Global - Training Groups - Salesforce -- CommCare",
          "body": "//Coffee DRC - GCA TNS 2022 | Training Groups | Salesforce --> CommCare\n//coffee_drc_gca_tns_2022\n//{\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_drc_gca_tns_2022\"}\n\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/B9AE4CBF-B571-4038-9C90-3D5D47DFDB90\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"avengers_initiative_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"avengers_initiative_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Global---Training-Groups---Salesforce----CommCare": {
          "enabled": true,
          "id": "71e42a5b-4aa2-4459-8dd9-616d34627fed",
          "target_job_id": "4e56a9eb-3725-4981-8b2d-eda18e5f66b0",
          "source_trigger_id": "fe07c15a-e5a6-46fe-a574-326385c98456",
          "condition_type": "js_expression",
          "condition_label": "Global Training Groups Salesforce CommCare",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"the_avengers_initiative\""
        }
      }
    },
    "Production---Coffee-BDI-TNS-2024C---SalesForce----CommCare---Project-Roles": {
      "id": "15d20f6a-9bcf-4bad-9186-34974bda1d60",
      "name": "Production - Coffee BDI TNS 2024C - SalesForce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.678513Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "8d3a2361-d2b3-429b-8747-c4182efa6d15",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-BDI-TNS-2024C---SalesForce----CommCare---Project-Roles": {
          "id": "c3c09860-c16b-4a2c-9977-2b87f8cb0dc7",
          "name": "Production - Coffee BDI TNS 2024C - SalesForce -- CommCare - Project Roles",
          "body": "// Project Roles Job = Coffee Burundi USDA TNS 2024C\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_bdi_tns_2024c_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);// Your job goes here.\n\n// version control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-BDI-TNS-2024C---SalesForce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "92e66114-586c-424f-9bef-c1789af227b4",
          "target_job_id": "c3c09860-c16b-4a2c-9977-2b87f8cb0dc7",
          "source_trigger_id": "8d3a2361-d2b3-429b-8747-c4182efa6d15",
          "condition_type": "js_expression",
          "condition_label": "Coffee BDI TNS 2024C SalesForce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_bdi_tns_2024c\""
        }
      }
    },
    "Production---Coffee-BDI-TNS-2024C---SalesForce----CommCare---Training-Sessions": {
      "id": "d4800295-f0db-4ea2-8d64-27d346b2bf8f",
      "name": "Production - Coffee BDI TNS 2024C - SalesForce -- CommCare - Training Sessions",
      "inserted_at": "2025-03-20T03:44:07.683486Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "2f897fbc-9e8f-4ecc-8aef-680fc5c6c547",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-BDI-TNS-2024C---SalesForce----CommCare---Training-Sessions": {
          "id": "cc347711-a120-48ac-b2b3-7890691854b4",
          "name": "Production - Coffee BDI TNS 2024C - SalesForce -- CommCare - Training Sessions",
          "body": "// Your job goes here.\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_bdi_tns_2024c_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_bdi_tns_2024c_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-BDI-TNS-2024C---SalesForce----CommCare---Training-Sessions": {
          "enabled": true,
          "id": "6db6ecc0-c68f-4bf5-8cc7-db66b30eb37f",
          "target_job_id": "cc347711-a120-48ac-b2b3-7890691854b4",
          "source_trigger_id": "2f897fbc-9e8f-4ecc-8aef-680fc5c6c547",
          "condition_type": "js_expression",
          "condition_label": "Coffee BDI TNS 2024C SalesForce CommCare Training Sessions",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_bdi_tns_2024c\""
        }
      }
    },
    "Production---Coffee-KE-2023C---SalesForce----CommCare---Training-Groups": {
      "id": "4f383a2c-6ede-41e8-a2ac-f2dc09e65ceb",
      "name": "Production - Coffee KE 2023C - SalesForce -- CommCare - Training Groups",
      "inserted_at": "2025-03-20T03:44:07.690628Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "d55f4d1a-5f5a-4f0d-86a5-3a54d4a59055",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-KE-2023C---SalesForce----CommCare---Training-Groups": {
          "id": "c41ebfda-3893-4f06-90c7-c6e9968882df",
          "name": "Production - Coffee KE 2023C - SalesForce -- CommCare - Training Groups",
          "body": "// Your job goes here.\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/B9AE4CBF-B571-4038-9C90-3D5D47DFDB90\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_ke_2023c_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_ke_2023c_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@v1.5.1",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-KE-2023C---SalesForce----CommCare---Training-Groups": {
          "enabled": true,
          "id": "820ac1c0-68a0-4c8e-bb71-6d04c8d7f747",
          "target_job_id": "c41ebfda-3893-4f06-90c7-c6e9968882df",
          "source_trigger_id": "d55f4d1a-5f5a-4f0d-86a5-3a54d4a59055",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE 2023C SalesForce CommCare Training Groups",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2023c\""
        }
      }
    },
    "Production---Coffee-KE-2024AC---Dummy---SalesForce----CommCare---Training-Groups": {
      "id": "c051d577-937c-4894-9a98-dbaec6b22ed9",
      "name": "Production - Coffee KE 2024AC - Dummy - SalesForce -- CommCare - Training Groups",
      "inserted_at": "2025-03-20T03:44:07.695919Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "df7dc819-b1c3-44ca-88f5-5de081b8cbfb",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-KE-2024AC---Dummy---SalesForce----CommCare---Training-Groups": {
          "id": "ada430d7-fa87-4939-9536-fcde50828303",
          "name": "Production - Coffee KE 2024AC - Dummy - SalesForce -- CommCare - Training Groups",
          "body": "// Your job goes here.\neach(\n    \"$.data.trainingGroups[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"name\": \"New Training Group\",\n            \"uiVersion\": \"1\",\n            \"version\": \"1\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/B9AE4CBF-B571-4038-9C90-3D5D47DFDB90\",\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n          };\n        }),\n        field(\"Name\", dataValue(\"trainingGroupName\")),\n        field(\"FFG_Number\", dataValue(\"tnsId\")),\n        field(\"Location\", dataValue(\"locationName\")),\n        field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n        field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n        field(\"Household_Counter\", dataValue(\"householdCounter\")),\n        field(\"Name_Id_Concat\", function(state) {\n          return (\n            //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n            dataValue(\"trainingGroupName\")(state)\n          );\n        }),\n        field(\"Parent_Id\", dataValue(\"staffId\")),\n        field(\"n0:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"trainingGroupId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_ke_2024ac_dummy_training_group\"\n            },\n            \"n0:update\": {\n              \"n0:Location\": dataValue(\"locationName\")(state),\n              \"n0:Market\": dataValue(\"market\")(state),\n              \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n              \"n0:Name_Id_Concat\": function(){\n                //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n                var name = dataValue(\"trainingGroupName\")(state);\n                return name;\n              },\n              \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n              \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n              \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n              \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n            },\n            \"n0:index\": {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_ke_2024ac_dummy_staff\"\n                },\n                \"#\": dataValue(\"staffId\")(state)\n              }\n            }\n          };\n        }),\n        field(\"n1:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"trainingGroupId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n            }\n          };\n        }),\n        field(\"n2:meta\", function(state) {\n          return {\n            \"@\": {\n              \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n            },\n            \"n2:deviceID\": \"PIMA API\",\n            \"n2:timeStart\": new Date().toISOString(),\n            \"n2:timeEnd\": new Date().toISOString(),\n            \"n2:username\": \"api\",\n            \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );\n",
          "adaptor": "@openfn/language-commcare@v1.6.9",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-KE-2024AC---Dummy---SalesForce----CommCare---Training-Groups": {
          "enabled": true,
          "id": "1df080b5-0ff9-4516-a9db-a36e36a86112",
          "target_job_id": "ada430d7-fa87-4939-9536-fcde50828303",
          "source_trigger_id": "df7dc819-b1c3-44ca-88f5-5de081b8cbfb",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE 2024AC Dummy SalesForce CommCare Training Groups",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2024ac_dummy\""
        }
      }
    },
    "Production---Coffee-ZIM---SalesForce----CommCare---Training-Groups": {
      "id": "e0e953ed-08b9-4fe4-9ae6-a04d3d734acc",
      "name": "Production - Coffee ZIM - SalesForce -- CommCare - Training Groups",
      "inserted_at": "2025-03-20T03:44:07.701507Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "e42db201-24e4-41e5-95e3-7c52969b3f1a",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-ZIM---SalesForce----CommCare---Training-Groups": {
          "id": "cf249c47-d5b8-4c6f-bbec-8f65ea70f289",
          "name": "Production - Coffee ZIM - SalesForce -- CommCare - Training Groups",
          "body": "// Training Group = CUG.\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/B9AE4CBF-B571-4038-9C90-3D5D47DFDB90\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            // This is hard-coded remember to set it up well.\n            \"n0:owner_id\": \"ef4ee01d5ea94392b96618dca8ff7d45\",\n            // \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_zim_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_zim_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-ZIM---SalesForce----CommCare---Training-Groups": {
          "enabled": true,
          "id": "ca472fc7-9232-46d0-9dc6-4cb53365a596",
          "target_job_id": "cf249c47-d5b8-4c6f-bbec-8f65ea70f289",
          "source_trigger_id": "e42db201-24e4-41e5-95e3-7c52969b3f1a",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee ZIM SalesForce CommCare Training Groups",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zim\""
        }
      }
    },
    "Production---Participants---ET-HWG-JCP-C2023---SalesForce----CommCare": {
      "id": "369acbbe-ab08-41f3-84ad-7df115318af0",
      "name": "Production - Participants - ET HWG JCP C2023 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.705981Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "c6fbd66a-6cc8-4f93-a008-c4a2914d3f15",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Participants---ET-HWG-JCP-C2023---SalesForce----CommCare": {
          "id": "21d42551-d93b-45fe-9b67-eba0cba2c531",
          "name": "Production - Participants - ET HWG JCP C2023 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending Participants for Coffee - ET HWG JCP C2023\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET HWG JCP C2023\n// JOB NAME :: Production | Participants - ET HWG JCP C2023 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_hwg_jcp_c2023\"}\n// AUTHOR :: Yves Mugenga | ymugenga@tns.org\n\neach(\n  \"$.data.participants[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3E266629-AFD8-4A1C-8825-1DCDDF24E5A8\",\n          \"uiVersion\": \"1\",\n          \"version\": \"325\",\n          \"name\": \"New Participant\",\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name;\n      }),\n      field(\"First_Name\", dataValue(\"participantName\")),\n      field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n      field(\"Last_Name\", dataValue(\"participantLastName\")),\n      field(\"Age\", dataValue(\"participantAge\")),\n      field(\"Gender\", dataValue(\"participantGender\")),\n      field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n      field(\"Farmer_Id\", dataValue(\"tnsId\")),\n      field(\"Farmer_Number\", function(state){\n        var tnsId = dataValue(\"tnsId\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        return farmerNumber;\n      }),\n      field(\"Cooperative_Membership_Number\", dataValue(\"participantOtherIDNumber\")),\n      field(\"Household_Id\", dataValue(\"householdId\")),\n      field(\"Household_Number\", dataValue(\"householdName\")),\n      field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n      field(\"Status\", dataValue(\"status\")),\n      field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Name_Household_Concat\", function(state){\n        var name = '';\n        var tnsId = dataValue(\"tnsId\")(state);\n        var hhNumber = dataValue(\"householdName\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        \n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name+' '+hhNumber+'-'+farmerNumber;\n      }),\n      \n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_hwg_jcp_c2023_participant\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:First_Name\": dataValue(\"participantName\")(state),\n            \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n            \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n            \"n0:Age\": dataValue(\"participantAge\")(state),\n            \"n0:Gender\": dataValue(\"participantGender\")(state),\n            \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n            \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Farmer_Number\": function(){\n              var tnsId = dataValue(\"tnsId\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              return farmerNumber;\n            },\n            \"n0:Cooperative_Membership_Number\": dataValue(\"participantOtherIDNumber\")(state),\n            \"n0:Household_Id\": dataValue(\"householdId\")(state),\n            \"n0:Household_Number\": dataValue(\"householdName\")(state),\n            \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n            \"n0:Status\": dataValue(\"status\")(state),\n            \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n            \"n0:Name_Household_Concat\": function(){\n              var name = '';\n              var tnsId = dataValue(\"tnsId\")(state);\n              var hhNumber = dataValue(\"householdName\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              \n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name+' '+hhNumber+'-'+farmerNumber;\n            },\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_et_hwg_jcp_c2023_training_group\"\n              },\n              \"#\": dataValue(\"trainingGroupId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n1:deviceID\": \"867066029216796\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Participants---ET-HWG-JCP-C2023---SalesForce----CommCare": {
          "enabled": true,
          "id": "0f84f61a-42e5-42ec-a6d8-25f9279cece4",
          "target_job_id": "21d42551-d93b-45fe-9b67-eba0cba2c531",
          "source_trigger_id": "c6fbd66a-6cc8-4f93-a008-c4a2914d3f15",
          "condition_type": "js_expression",
          "condition_label": "Production Participants HWG JCP C2023 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_hwg_jcp_c2023\""
        }
      }
    },
    "Production---Participants---ET-Regrow-TG--Ag--C2023---SalesForce----CommCare": {
      "id": "d7cbe4ff-b15b-4e6d-bc07-bfc8eb79ae22",
      "name": "Production - Participants - ET Regrow TG -Ag- C2023 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.710308Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "57c1250d-a342-4618-ac1c-ca6378108930",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Participants---ET-Regrow-TG--Ag--C2023---SalesForce----CommCare": {
          "id": "566b2a22-59b4-4051-ab10-defedc61f95f",
          "name": "Production - Participants - ET Regrow TG -Ag- C2023 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending Participants for Coffee ET - Regrow Yirga Agronomy C2022\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET Regrow Yirga (Ag) C2022\n// JOB NAME :: Production | Participants - ET Regrow YG (Ag) C2022 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_regrow_ag\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n\neach(\n  \"$.data.participants[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3E266629-AFD8-4A1C-8825-1DCDDF24E5A8\",\n          \"uiVersion\": \"1\",\n          \"version\": \"325\",\n          \"name\": \"New Participant\",\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name;\n      }),\n      field(\"First_Name\", dataValue(\"participantName\")),\n      field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n      field(\"Last_Name\", dataValue(\"participantLastName\")),\n      field(\"Age\", dataValue(\"participantAge\")),\n      field(\"Gender\", dataValue(\"participantGender\")),\n      field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n      field(\"Farmer_Id\", dataValue(\"tnsId\")),\n      field(\"Farmer_Number\", function(state){\n        var tnsId = dataValue(\"tnsId\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        return farmerNumber;\n      }),\n      field(\"Cooperative_Membership_Number\", dataValue(\"participantOtherIDNumber\")),\n      field(\"Household_Id\", dataValue(\"householdId\")),\n      field(\"Household_Number\", dataValue(\"householdName\")),\n      field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n      field(\"Status\", dataValue(\"status\")),\n      field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Name_Household_Concat\", function(state){\n        var name = '';\n        var tnsId = dataValue(\"tnsId\")(state);\n        var hhNumber = dataValue(\"householdName\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        \n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name+' '+hhNumber+'-'+farmerNumber;\n      }),\n      \n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_regrow_ag_c2_participant\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:First_Name\": dataValue(\"participantName\")(state),\n            \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n            \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n            \"n0:Age\": dataValue(\"participantAge\")(state),\n            \"n0:Gender\": dataValue(\"participantGender\")(state),\n            \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n            \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Farmer_Number\": function(){\n              var tnsId = dataValue(\"tnsId\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              return farmerNumber;\n            },\n            \"n0:Cooperative_Membership_Number\": dataValue(\"participantOtherIDNumber\")(state),\n            \"n0:Household_Id\": dataValue(\"householdId\")(state),\n            \"n0:Household_Number\": dataValue(\"householdName\")(state),\n            \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n            \"n0:Status\": dataValue(\"status\")(state),\n            \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n            \"n0:Name_Household_Concat\": function(){\n              var name = '';\n              var tnsId = dataValue(\"tnsId\")(state);\n              var hhNumber = dataValue(\"householdName\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              \n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name+' '+hhNumber+'-'+farmerNumber;\n            },\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_et_regrow_ag_c2_training_group\"\n              },\n              \"#\": dataValue(\"trainingGroupId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n1:deviceID\": \"867066029216796\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Participants---ET-Regrow-TG--Ag--C2023---SalesForce----CommCare": {
          "enabled": true,
          "id": "115d826c-bf8a-4437-8d34-8ebcaba1dcfa",
          "target_job_id": "566b2a22-59b4-4051-ab10-defedc61f95f",
          "source_trigger_id": "57c1250d-a342-4618-ac1c-ca6378108930",
          "condition_type": "js_expression",
          "condition_label": "Production Participants Regrow Yirga C2023 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_regrow_ag_c2\""
        }
      }
    },
    "Production---Training-Sessions---ET-HWG-JCP-CREW-C2024---SalesForce----CommCare": {
      "id": "10598da0-6bbd-430f-8683-7b1e0e444a50",
      "name": "Production - Training Sessions - ET HWG JCP CREW C2024 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.715439Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "461e9ed1-437f-47ae-bf7b-6484f92244bd",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Training-Sessions---ET-HWG-JCP-CREW-C2024---SalesForce----CommCare": {
          "id": "696bcaed-23a8-41b2-8896-15347f293087",
          "name": "Production - Training Sessions - ET HWG JCP CREW C2024 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending training groups for Coffee - ET HWG JCP CREW C2024\n// DATA FLOW :: SalesForce --> TO --> CommCare\n// TARGET APPS :: // JOB PURPOSE :: Coffee - ET HWG JCP CREW C2024\n// JOB NAME :: Production | Training Sessions - ET HWG JCP CREW C2024 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Session\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_hwg_jcp_crew_c2024\"}\n\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_et_hwg_jcp_crew_c2024_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_et_hwg_jcp_crew_c2024_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Training-Sessions---ET-HWG-JCP-CREW-C2024---SalesForce----CommCare": {
          "enabled": true,
          "id": "c291e185-372f-43d7-8ad8-45629f54fab7",
          "target_job_id": "696bcaed-23a8-41b2-8896-15347f293087",
          "source_trigger_id": "461e9ed1-437f-47ae-bf7b-6484f92244bd",
          "condition_type": "js_expression",
          "condition_label": "Production Training Sessions ET HWG JCP CREW C2024 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_hwg_jcp_crew_c2024\""
        }
      }
    },
    "Coffee---ZW-C3---C2021---SalesForce----CommCare---Training-Groups": {
      "id": "c969dcaf-e55a-4e02-8de9-da9f039c865c",
      "name": "Coffee - ZW C3 - C2021 - SalesForce -- CommCare - Training Groups",
      "inserted_at": "2025-03-20T03:44:07.719758Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "c2454caf-2aca-4910-8519-f492914b8544",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---ZW-C3---C2021---SalesForce----CommCare---Training-Groups": {
          "id": "a0d5b1ac-f8d7-4916-85c7-77e91839aa27",
          "name": "Coffee - ZW C3 - C2021 - SalesForce -- CommCare - Training Groups",
          "body": "//Coffee - ZW C3 - C2021 | SalesForce --> CommCare | Training Groups\n//{\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_zw_c21_agronomy\"}\n\n\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/B9AE4CBF-B571-4038-9C90-3D5D47DFDB90\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_zw_c21_ag_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_zw_c21_ag_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---ZW-C3---C2021---SalesForce----CommCare---Training-Groups": {
          "enabled": true,
          "id": "e3dab634-c309-4876-b6cc-d738b6e330ae",
          "target_job_id": "a0d5b1ac-f8d7-4916-85c7-77e91839aa27",
          "source_trigger_id": "c2454caf-2aca-4910-8519-f492914b8544",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW C3 C2021 SalesForce CommCare Training Groups",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zw_c21_ag\""
        }
      }
    },
    "x-[archived]-The--Do-Nothing-Job----HortiMap-Domain---Impact-Team": {
      "id": "73eb9e45-2128-47c4-9ff7-454e03d24590",
      "name": "x [archived] The -Do Nothing Job-  -  HortiMap Domain - Impact Team",
      "inserted_at": "2025-03-20T03:44:07.724353Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "c9201e12-2641-4684-aaa7-51461314ea32",
          "type": "webhook"
        }
      },
      "jobs": {
        "The--Do-Nothing-Job----HortiMap-Domain---Impact-Team": {
          "id": "aaf6df9d-3c6c-449a-b4fb-2608e550c735",
          "name": "The -Do Nothing Job-  - HortiMap Domain - Impact Team",
          "body": "// Your job goes here.\n\nconsole.log(\"done\");\n\neach(\"$.data\", console.log(\"complete\"));\n",
          "adaptor": "@openfn/language-mysql@v1.4.7",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->The--Do-Nothing-Job----HortiMap-Domain---Impact-Team": {
          "enabled": true,
          "id": "abb5d556-572d-42ff-80c6-f9658d562793",
          "target_job_id": "aaf6df9d-3c6c-449a-b4fb-2608e550c735",
          "source_trigger_id": "c9201e12-2641-4684-aaa7-51461314ea32",
          "condition_type": "js_expression",
          "condition_label": "The \"Do Nothing Job\"  | HortiMap Domain | Impact Team",
          "condition_expression": "state.data.domain == \"hortimap-uganda\""
        }
      }
    },
    "x-[arhived]-Global---Project-Roles-SF---CM": {
      "id": "ff3b3c61-baaa-493c-8a6e-c70930d0064c",
      "name": "x [arhived] Global - Project Roles SF - CM",
      "inserted_at": "2025-03-20T03:44:07.728691Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "37bb3a52-fd01-4936-a232-0ec996b2c857",
          "type": "webhook"
        }
      },
      "jobs": {
        "Global---Project-Roles-SF---CM": {
          "id": "0e1c301d-ab58-412a-b0a5-85d86ccbb320",
          "name": "Global - Project Roles SF - CM",
          "body": "// This is a Global Project Role Job. To trigger this Job the isProjectJobsGlobal checkmark on SF\n// must be set to true\n\n// NB: the case is generated by concatinating the uniqueProjectKey to the _staff text to create \n// a staff case type in Commcate\n\n\n// Global | Salesforce --> CommCare | Project Roles\n// {\"jobType\":\"Project Role\",\"source\":\"SF\",\"isProjectJobsGlobal\": true}\n// Extract uniqueProjectKey from the original payload\n\nfn(state => {\n\n  const uniqueProjectKey = state.data.uniqueProjectKey;\n\n  return {\n    ...state,\n    uniqueProjectKey\n  };\n});\n\neach(\n  \"$.data.projectRoles[*]\",\n  //function(state){\n  //console.log(state.data.uniqueProjectKey);\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": function(state){\n              console.log(state.uniqueProjectKey);\n              return state.uniqueProjectKey + \"_staff\";\n            }\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n  //}\n);\n",
          "adaptor": "@openfn/language-commcare@v1.6.9",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Global---Project-Roles-SF---CM": {
          "enabled": true,
          "id": "b75c947e-4912-4614-8a57-4bb26700f8b6",
          "target_job_id": "0e1c301d-ab58-412a-b0a5-85d86ccbb320",
          "source_trigger_id": "37bb3a52-fd01-4936-a232-0ec996b2c857",
          "condition_type": "js_expression",
          "condition_label": "Global Salesforce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"the_avengers_initiative\""
        }
      }
    },
    "Production---Coffee-KE-2024AC---SalesForce----CommCare---Project-Roles": {
      "id": "a548e5d8-e706-4925-aa68-1c366edb448e",
      "name": "Production - Coffee KE 2024AC - SalesForce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.732848Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "b2cb3000-8dfa-411d-8204-cc3bf1a750b4",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-KE-2024AC---SalesForce----CommCare---Project-Roles": {
          "id": "8964443a-53a1-46cc-9b1f-b5b6f26aa17a",
          "name": "Production - Coffee KE 2024AC - SalesForce -- CommCare - Project Roles",
          "body": "// Project Roles Job = Coffee - Kenya Nespresso 2024ac\neach(\n    \"$.data.projectRoles[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"name\": \"New Project Role\",\n            \"uiVersion\": \"1\",\n            \"version\": \"1\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n          };\n        }),\n        field(\"Name\", function(state){\n          var name = '';\n          if(dataValue(\"staffName\")(state) !== null) {\n            name = dataValue(\"staffName\")(state);\n          }\n          return name;\n        }),\n        field(\"TNS_Id\", dataValue(\"tnsId\")),\n        field(\"City\", dataValue(\"locationName\")),\n        field(\"Role\", dataValue(\"roleForCommCare\")),\n        field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n        field(\"Current_Module\", dataValue(\"currentModule\")),\n        field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n        field(\"Previous_Module\", dataValue(\"previousModule\")),\n        field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n        field(\"FFGs_Observed\", null),\n        field(\"Name_id_concat\", function(state){\n          var name = '';\n          if(dataValue(\"staffName\")(state) !== null) {\n            name = dataValue(\"staffName\")(state);\n          }\n          if(dataValue(\"tnsId\")(state) !== null) {\n            name = name+' '+dataValue(\"tnsId\")(state);\n          }\n          return name;\n        }),\n        field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n        field(\"n0:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"commCareCaseId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": function(){\n                var name = '';\n                if(dataValue(\"staffName\")(state) !== null) {\n                  name = dataValue(\"staffName\")(state);\n                }\n                return name;\n              },\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_ke_2024ac_staff\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n              \"n0:Name_Id_Concat\": function() {\n                var name = '';\n                if(dataValue(\"staffName\")(state) !== null) {\n                  name = dataValue(\"staffName\")(state);\n                }\n                if(dataValue(\"tnsId\")(state) !== null) {\n                  name = name+' '+dataValue(\"tnsId\")(state);\n                }\n                return name;\n              },\n              \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n              \"n0:City\": dataValue(\"locationName\")(state),\n              \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n              \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n              \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n              \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n              \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n              \"n0:FFGs_Observed\": null,\n              \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n            }\n          };\n        }),\n        field(\"n1:meta\", function(state) {\n          return {\n            \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n            \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n            \"n1:timeStart\": new Date().toISOString(),\n            \"n1:timeEnd\": new Date().toISOString(),\n            \"n1:username\": \"api\",\n            \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );// Your job goes here.\n  \n  // version control\n  \n",
          "adaptor": "@openfn/language-commcare@v1.6.9",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-KE-2024AC---SalesForce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "560025b7-724d-4874-928e-2913506f2f8d",
          "target_job_id": "8964443a-53a1-46cc-9b1f-b5b6f26aa17a",
          "source_trigger_id": "b2cb3000-8dfa-411d-8204-cc3bf1a750b4",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE 2024AC SalesForce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2024ac\""
        }
      }
    },
    "Production---Coffee-KE-2024BC---SalesForce----CommCare---Project-Roles": {
      "id": "d1050f39-b805-47ad-884c-24fe4762045e",
      "name": "Production - Coffee KE 2024BC - SalesForce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.737329Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "d7fdf901-852d-4ed8-b5d4-dbc824c7a63f",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-KE-2024BC---SalesForce----CommCare---Project-Roles": {
          "id": "326dd11c-ef7a-4743-b9b6-987a381c23de",
          "name": "Production - Coffee KE 2024BC - SalesForce -- CommCare - Project Roles",
          "body": "// Project Roles Job = Coffee - Kenya Nespresso 2024BC\neach(\n    \"$.data.projectRoles[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"name\": \"New Project Role\",\n            \"uiVersion\": \"1\",\n            \"version\": \"1\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n          };\n        }),\n        field(\"Name\", function(state){\n          var name = '';\n          if(dataValue(\"staffName\")(state) !== null) {\n            name = dataValue(\"staffName\")(state);\n          }\n          return name;\n        }),\n        field(\"TNS_Id\", dataValue(\"tnsId\")),\n        field(\"City\", dataValue(\"locationName\")),\n        field(\"Role\", dataValue(\"roleForCommCare\")),\n        field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n        field(\"Current_Module\", dataValue(\"currentModule\")),\n        field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n        field(\"Previous_Module\", dataValue(\"previousModule\")),\n        field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n        field(\"Name_id_concat\", function(state){\n          var name = '';\n          if(dataValue(\"staffName\")(state) !== null) {\n            name = dataValue(\"staffName\")(state);\n          }\n          if(dataValue(\"tnsId\")(state) !== null) {\n            name = name+' '+dataValue(\"tnsId\")(state);\n          }\n          return name;\n        }),\n        field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n        field(\"n0:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"commCareCaseId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": function(){\n                var name = '';\n                if(dataValue(\"staffName\")(state) !== null) {\n                  name = dataValue(\"staffName\")(state);\n                }\n                return name;\n              },\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_ke_2024bc_staff\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n              \"n0:Name_Id_Concat\": function() {\n                var name = '';\n                if(dataValue(\"staffName\")(state) !== null) {\n                  name = dataValue(\"staffName\")(state);\n                }\n                if(dataValue(\"tnsId\")(state) !== null) {\n                  name = name+' '+dataValue(\"tnsId\")(state);\n                }\n                return name;\n              },\n              \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n              \"n0:City\": dataValue(\"locationName\")(state),\n              \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n              \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n              \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n              \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n              \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n              \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n            }\n          };\n        }),\n        field(\"n1:meta\", function(state) {\n          return {\n            \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n            \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n            \"n1:timeStart\": new Date().toISOString(),\n            \"n1:timeEnd\": new Date().toISOString(),\n            \"n1:username\": \"api\",\n            \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );// Your job goes here.\n  \n  // version control\n  \n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-KE-2024BC---SalesForce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "e89d4231-8655-4eb4-bebe-6222d5c9f334",
          "target_job_id": "326dd11c-ef7a-4743-b9b6-987a381c23de",
          "source_trigger_id": "d7fdf901-852d-4ed8-b5d4-dbc824c7a63f",
          "condition_type": "js_expression",
          "condition_label": "Production - Coffee KE 2024BC - SalesForce -- CommCare - Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2024bc\""
        }
      }
    },
    "Production---Coffee-ZIM---CommCare----Salesforce---Participant-Registration-and-Update": {
      "id": "ce5bf979-5bb5-413d-8d9f-3f9bf337189b",
      "name": "Production - Coffee ZIM - CommCare -- Salesforce - Participant Registration and Update",
      "inserted_at": "2025-03-20T03:44:07.742489Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "bb757611-ad95-4f1a-99ab-8dedb5ea1464",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-ZIM---CommCare----Salesforce---Participant-Registration-and-Update": {
          "id": "a604d1a9-3e75-4b6c-a4ea-e7851814bfc8",
          "name": "Production - Coffee ZIM - CommCare -- Salesforce - Participant Registration and Update",
          "body": "//Production - Coffee ZIM | CommCare --> Salesforce | Participant Registration and Update\n//{\"form\":{\"survey_type\":\"Participant\"},\"app_id\":\"b75286e874c74eb09b8da436709d7f3c\"}\n\nbeta.each(\n  \"$.data\",\n  upsertIf(\n    state.data.form.survey_detail == \"New Household\",\n    \"Household__c\", \"Household_ID__c\",\n      fields(\n        field(\"Household_ID__c\", dataValue(\"form.Household_Id\")),\n        field(\"Name\", dataValue(\"form.Household_Number\")),\n        field(\"Training_Group__c\", dataValue(\"form.Training_Group_Id\")),\n        field(\"Farm_Size__c\", dataValue(\"form.Number_of_Trees\"))\n      )\n    )\n  ),\n\n  beta.each(\n    \"$.data\",\n    upsertIf(\n    state.data.form.survey_detail == \"New Household\",\n    \"Training_Group__c\", \"CommCare_Case_Id__c\",\n      fields(\n        field(\"Household_Counter__c\", dataValue(\"form.Update_Household_Counter\")), \n        field(\"CommCare_Case_Id__c\", dataValue(\"form.Training_Group_Id\"))     \n      )\n    )\n  ),\n  \n  beta.each(\n    \"$.data\",\n    upsertIf(\n    state.data.form.survey_detail == \"New Household\",\n    \"Participant__c\", \"CommCare_Case_Id__c\",\n      fields(\n        field(\"CommCare_Case_Id__c\", dataValue(\"form.subcase_0.case.@case_id\")),\n        field(\"TNS_Id__c\", dataValue(\"form.Farmer_Id\")),\n        field(\"Age__c\", dataValue(\"form.Age\")),\n        field(\"Name\", dataValue(\"form.First_Name\")),\n        field(\"Middle_Name__c\", dataValue(\"form.Middle_Name\")),\n        field(\"Last_Name__c\", dataValue(\"form.Last_Name\")),\n        field(\"Gender__c\", dataValue(\"form.Gender\")),\n        field(\"Status__c\", dataValue(\"form.Status\")),\n        field(\"Sent_to_OpenFn_Status__c\", \"Complete\"),\n        field(\"Phone_Number__c\", dataValue(\"form.Phone_Number\")),\n        field(\"Other_ID_Number__c\", dataValue(\"form.Cooperative_Membership_Number\")),\n        field(\"Farm_Size__c\", dataValue(\"form.Number_of_Trees\")),\n        field(\"Primary_Household_Member__c\", dataValue(\"form.Primary_Household_Member\")),\n        relationship(\"Household__r\", \"Household_ID__c\", dataValue(\"form.Household_Id\")),\n        relationship(\"Training_Group__r\", \"CommCare_Case_Id__c\", dataValue(\"form.Training_Group_Id\"))\n      )\n    )\n  ),\n\n//Existing household use this section.\nbeta.each(\n  \"$.data\",\n  upsertIf(\n    state.data.form.survey_detail == \"Existing Household\",\n    \"Household__c\", \"Household_ID__c\",\n      fields(\n        field(\"Household_ID__c\", dataValue(\"form.Household_Id\")),\n        field(\"Farm_Size__c\", dataValue(\"form.Number_of_Trees\"))\n      )\n    )\n  ),\n\n  beta.each(\n    \"$.data\",\n    upsertIf(\n    state.data.form.survey_detail == \"Existing Household\",\n    \"Participant__c\", \"CommCare_Case_Id__c\",\n      fields(\n        field(\"CommCare_Case_Id__c\", dataValue(\"form.subcase_0.case.@case_id\")),\n        field(\"TNS_Id__c\", dataValue(\"form.Farmer_Id\")),\n        field(\"Age__c\", dataValue(\"form.Age\")),\n        field(\"Name\", dataValue(\"form.First_Name\")),\n        field(\"Middle_Name__c\", dataValue(\"form.Middle_Name\")),\n        field(\"Last_Name__c\", dataValue(\"form.Last_Name\")),\n        field(\"Gender__c\", dataValue(\"form.Gender\")),\n        field(\"Status__c\", dataValue(\"form.Status\")),\n        field(\"Sent_to_OpenFn_Status__c\", \"Complete\"),\n        field(\"Phone_Number__c\", dataValue(\"form.Phone_Number\")),\n        field(\"Other_ID_Number__c\", dataValue(\"form.Cooperative_Membership_Number\")),\n        field(\"Farm_Size__c\", dataValue(\"form.Number_of_Trees\")),\n        field(\"Primary_Household_Member__c\", dataValue(\"form.Primary_Household_Member\")),\n        relationship(\"Household__r\", \"Household_ID__c\", dataValue(\"form.Household_Id\")),\n        relationship(\"Training_Group__r\", \"CommCare_Case_Id__c\", dataValue(\"form.Training_Group_Id\"))\n      )\n    )\n  ),\n\n//Update participants use this section.\nbeta.each(\n  \"$.data\",\n  upsertIf(\n    state.data.form.survey_detail == \"Participant Update\",\n    \"Household__c\", \"Household_ID__c\",\n      fields(\n        field(\"Household_ID__c\", dataValue(\"form.Household_Id\")),\n        field(\"Farm_Size__c\", dataValue(\"form.Number_of_Trees\"))\n      )\n    )\n  ),\n\n  beta.each(\n    \"$.data\",\n    upsertIf(\n    state.data.form.survey_detail == \"Participant Update\",\n    \"Participant__c\", \"CommCare_Case_Id__c\",\n      fields(\n        field(\"CommCare_Case_Id__c\", dataValue(\"form.case.@case_id\")),\n        field(\"Age__c\", dataValue(\"form.Age\")),\n        field(\"Name\", dataValue(\"form.First_Name\")),\n        field(\"Middle_Name__c\", dataValue(\"form.Middle_Name\")),\n        field(\"Last_Name__c\", dataValue(\"form.Last_Name\")),\n        field(\"Gender__c\", dataValue(\"form.Gender\")),\n        field(\"Phone_Number__c\", dataValue(\"form.Phone_Number\")),\n        field(\"Farm_Size__c\", dataValue(\"form.Number_of_Trees\")),\n        field(\"Other_ID_Number__c\", dataValue(\"form.Cooperative_Membership_Number\"))\n      )\n    )\n  );\n\n//Version Control\n",
          "adaptor": "@openfn/language-salesforce@v1.3.2",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-ZIM---CommCare----Salesforce---Participant-Registration-and-Update": {
          "enabled": true,
          "id": "c33bbf21-8ae1-46a9-97ce-af451ad83b56",
          "target_job_id": "a604d1a9-3e75-4b6c-a4ea-e7851814bfc8",
          "source_trigger_id": "bb757611-ad95-4f1a-99ab-8dedb5ea1464",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee ZIM CommCare Salesforce Participant Registration and Update",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Participant\" && state.data[\"app_id\"] == \"b75286e874c74eb09b8da436709d7f3c\""
        }
      }
    },
    "x-[archived]-DRC-2021-Ag---C1---Salesforce----CommCare---Training-Groups": {
      "id": "02c680eb-f844-4f56-8f21-c0048e419975",
      "name": "x [archived] DRC 2021 Ag - C1 - Salesforce -- CommCare - Training Groups",
      "inserted_at": "2025-03-20T03:44:07.747675Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "a7d8d4d5-26fb-496c-916b-de39525c7fa0",
          "type": "webhook"
        }
      },
      "jobs": {
        "DRC-2021-Ag---C1---Salesforce----CommCare---Training-Groups": {
          "id": "d3997cfc-e916-4ebf-a44e-69157861c642",
          "name": "DRC 2021 Ag - C1 - Salesforce -- CommCare - Training Groups",
          "body": "//DRC 2021 Ag :: C1 | Salesforce --> CommCare | Training Groups\n//coffee_drc_2021_agronomy_cohort_1\n//{\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_drc_2021_agronomy_cohort_1\"}\n\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/B9AE4CBF-B571-4038-9C90-3D5D47DFDB90\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_drc_2021_ag_c1_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_drc_2021_ag_c1_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->DRC-2021-Ag---C1---Salesforce----CommCare---Training-Groups": {
          "enabled": true,
          "id": "538517e2-bdde-4eb0-8f37-65f337e22c2c",
          "target_job_id": "d3997cfc-e916-4ebf-a44e-69157861c642",
          "source_trigger_id": "a7d8d4d5-26fb-496c-916b-de39525c7fa0",
          "condition_type": "js_expression",
          "condition_label": "Coffee DRC USAID C2021 Salesforce CommCare Training Groups",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_drc_usaid_2021\""
        }
      }
    },
    "Coffee---DRC-GCA-Kabare-C2023---Salesforce----CommCare---Project-Roles": {
      "id": "fec3889b-223d-485b-9048-e9c93e5c99bc",
      "name": "Coffee - DRC GCA Kabare C2023 - Salesforce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.753243Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "ebfef585-2dec-493d-adc6-41610c83deed",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---DRC-GCA-Kabare-C2023---Salesforce----CommCare---Project-Roles": {
          "id": "b47ec7aa-59e5-4885-b633-b22dcff8f647",
          "name": "Coffee - DRC GCA Kabare C2023 - Salesforce -- CommCare - Project Roles",
          "body": "//Coffee - DRC GCA KABARE C2023 | Salesforce --> CommCare | Project Roles\n// coffee_drc_gca_kabare_2023\n//{\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_drc_gca_kabare_2023\"}\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_drc_gca_kabare_c2023_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---DRC-GCA-Kabare-C2023---Salesforce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "f8cf0154-a89f-4297-8859-08e552a7ecb5",
          "target_job_id": "b47ec7aa-59e5-4885-b633-b22dcff8f647",
          "source_trigger_id": "ebfef585-2dec-493d-adc6-41610c83deed",
          "condition_type": "js_expression",
          "condition_label": "Coffee DRC GCA Kabare C2023 Salesforce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_drc_gca_kabare_c2023\""
        }
      }
    },
    "Coffee---DRC-GCA-Kalehe-C2023---Salesforce----CommCare---Project-Roles": {
      "id": "bc67e348-87e1-4bfd-852a-dbef4514eb12",
      "name": "Coffee - DRC GCA Kalehe C2023 - Salesforce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.758356Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "f5de55eb-2f1e-45dc-b2ad-7efb369ce8f4",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---DRC-GCA-Kalehe-C2023---Salesforce----CommCare---Project-Roles": {
          "id": "8468a3bd-0c40-413f-8228-a7eae69efd56",
          "name": "Coffee - DRC GCA Kalehe C2023 - Salesforce -- CommCare - Project Roles",
          "body": "//Coffee - DRC GCA Kalehe C2023 | Salesforce --> CommCare | Project Roles\n// coffee_drc_gca_kalehe_2023\n//{\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_drc_gca_kalehe_2023\"}\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_drc_gca_kalehe_c2023_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---DRC-GCA-Kalehe-C2023---Salesforce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "dfa057d5-cec2-4d69-945d-1b4f249420e9",
          "target_job_id": "8468a3bd-0c40-413f-8228-a7eae69efd56",
          "source_trigger_id": "f5de55eb-2f1e-45dc-b2ad-7efb369ce8f4",
          "condition_type": "js_expression",
          "condition_label": "Coffee DRC GCA Kalehe C2023 Salesforce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_drc_gca_kalehe_c2023\""
        }
      }
    },
    "Coffee---ZW-C3---C2021--SalesForce----CommCare---Training-Participants": {
      "id": "0f357039-513d-41fe-89ad-7f64146d9840",
      "name": "Coffee - ZW C3 - C2021 -SalesForce -- CommCare - Training Participants",
      "inserted_at": "2025-03-20T03:44:07.763912Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "868f9c40-7c47-4ad8-91fd-82c17fe87c96",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---ZW-C3---C2021--SalesForce----CommCare---Training-Participants": {
          "id": "0ee41b10-717e-4c32-b732-3bf1ff4c206d",
          "name": "Coffee - ZW C3 - C2021 -SalesForce -- CommCare - Training Participants",
          "body": "//Production - Coffee ZIM | SalesForce --> CommCare | Training Participants\n\neach(\n  \"$.data.participants[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3F3D264F-4EC7-4C56-AC43-3E4A143E6C1E\",\n          \"uiVersion\": \"1\",\n          \"version\": \"325\",\n          \"name\": \"New Participant\",\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name;\n      }),\n      field(\"First_Name\", dataValue(\"participantName\")),\n      field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n      field(\"Last_Name\", dataValue(\"participantLastName\")),\n      field(\"Age\", dataValue(\"participantAge\")),\n      field(\"Gender\", dataValue(\"participantGender\")),\n      field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n      field(\"Farmer_Id\", dataValue(\"tnsId\")),\n      field(\"Farmer_Number\", function(state){\n        var tnsId = dataValue(\"tnsId\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        return farmerNumber;\n      }),\n      field(\"Cooperative_Membership_Number\", dataValue(\"participantOtherIDNumber\")),\n      field(\"Household_Id\", dataValue(\"householdId\")),\n      field(\"Household_Number\", dataValue(\"householdName\")),\n      field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n      field(\"Status\", dataValue(\"status\")),\n      field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Name_Household_Concat\", function(state){\n        var name = '';\n        var tnsId = dataValue(\"tnsId\")(state);\n        var hhNumber = dataValue(\"householdName\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        \n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name+' '+hhNumber+'-'+farmerNumber;\n      }),\n      \n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_zw_c21_ag_participant\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:First_Name\": dataValue(\"participantName\")(state),\n            \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n            \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n            \"n0:Age\": dataValue(\"participantAge\")(state),\n            \"n0:Gender\": dataValue(\"participantGender\")(state),\n            \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n            \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Farmer_Number\": function(){\n              var tnsId = dataValue(\"tnsId\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              return farmerNumber;\n            },\n            \"n0:Cooperative_Membership_Number\": dataValue(\"participantOtherIDNumber\")(state),\n            \"n0:Household_Id\": dataValue(\"householdId\")(state),\n            \"n0:Household_Number\": dataValue(\"householdName\")(state),\n            \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n            \"n0:Status\": dataValue(\"status\")(state),\n            \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n            \"n0:Name_Household_Concat\": function(){\n              var name = '';\n              var tnsId = dataValue(\"tnsId\")(state);\n              var hhNumber = dataValue(\"householdName\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              \n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name+' '+hhNumber+'-'+farmerNumber;\n            },\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_zw_c21_ag_training_group\"\n              },\n              \"#\": dataValue(\"trainingGroupId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n1:deviceID\": \"867066029216796\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---ZW-C3---C2021--SalesForce----CommCare---Training-Participants": {
          "enabled": true,
          "id": "b2ba6dc9-93d4-4ff5-965c-4ca9c4eaf0c2",
          "target_job_id": "0ee41b10-717e-4c32-b732-3bf1ff4c206d",
          "source_trigger_id": "868f9c40-7c47-4ad8-91fd-82c17fe87c96",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW Ag C2021 SalesForce CommCare Training Participants",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zw_c21_ag\""
        }
      }
    },
    "Coffee---ZW-Nespresso--Ag----c2---CommCare----Salesforce---Participant-Registration-and-Update": {
      "id": "73183fc4-3ba1-45da-b1ce-497e5514a8e8",
      "name": "Coffee - ZW Nespresso -Ag- - c2 - CommCare -- Salesforce - Participant Registration and Update",
      "inserted_at": "2025-03-20T03:44:07.768656Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "b43cec61-ba3a-45e8-adce-8e18707ebaaa",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---ZW-Nespresso--Ag----c2---CommCare----Salesforce---Participant-Registration-and-Update": {
          "id": "a148cf60-1c74-43d6-b0b8-b2ec52068d03",
          "name": "Coffee - ZW Nespresso -Ag- - c2 - CommCare -- Salesforce - Participant Registration and Update",
          "body": "//Coffee - ZW Nespresso (Ag) - c2 | CommCare --> Salesforce | Participant Registration and Update\n//{\"app_id\":\"c14d231df6e142deb9bdd44319287437\",\"form\":{\"survey_type\":\"Participant\"}}\n\n//New Households use this section.\nbeta.each(\n  \"$.data\",\n  upsertIf(\n    state.data.form.survey_detail == \"New Household\",\n    \"Household__c\", \"Household_ID__c\",\n      fields(\n        field(\"Household_ID__c\", dataValue(\"form.Household_Id\")),\n        field(\"Name\", dataValue(\"form.Household_Number\")),\n        field(\"Training_Group__c\", dataValue(\"form.Training_Group_Id\")),\n        field(\"Farm_Size__c\", dataValue(\"form.Number_of_Trees\"))\n      )\n    )\n  ),\n\n  beta.each(\n    \"$.data\",\n    upsertIf(\n    state.data.form.survey_detail == \"New Household\",\n    \"Training_Group__c\", \"CommCare_Case_Id__c\",\n      fields(\n        field(\"Household_Counter__c\", dataValue(\"form.Update_Household_Counter\")), \n        field(\"CommCare_Case_Id__c\", dataValue(\"form.Training_Group_Id\"))     \n      )\n    )\n  ),\n  \n  beta.each(\n    \"$.data\",\n    upsertIf(\n    state.data.form.survey_detail == \"New Household\",\n    \"Participant__c\", \"CommCare_Case_Id__c\",\n      fields(\n        field(\"CommCare_Case_Id__c\", dataValue(\"form.subcase_0.case.@case_id\")),\n        field(\"TNS_Id__c\", dataValue(\"form.Farmer_Id\")),\n        field(\"Age__c\", dataValue(\"form.Age\")),\n        field(\"Name\", dataValue(\"form.First_Name\")),\n        field(\"Middle_Name__c\", dataValue(\"form.Middle_Name\")),\n        field(\"Last_Name__c\", dataValue(\"form.Last_Name\")),\n        field(\"Gender__c\", dataValue(\"form.Gender\")),\n        field(\"Status__c\", dataValue(\"form.Status\")),\n        field(\"Farm_Size__c\", dataValue(\"form.Number_of_Trees\")),\n        field(\"Sent_to_OpenFn_Status__c\", \"Complete\"),\n        field(\"Phone_Number__c\", dataValue(\"form.Phone_Number\")),\n        field(\"Other_ID_Number__c\", dataValue(\"form.Cooperative_Membership_Number\")),\n        field(\"Primary_Household_Member__c\", dataValue(\"form.Primary_Household_Member\")),\n        relationship(\"Household__r\", \"Household_ID__c\", dataValue(\"form.Household_Id\")),\n        relationship(\"Training_Group__r\", \"CommCare_Case_Id__c\", dataValue(\"form.Training_Group_Id\"))\n      )\n    )\n  ),\n\n//Existing household use this section.\nbeta.each(\n  \"$.data\",\n  upsertIf(\n    state.data.form.survey_detail == \"Existing Household\",\n    \"Household__c\", \"Household_ID__c\",\n      fields(\n        field(\"Household_ID__c\", dataValue(\"form.Household_Id\")),\n        field(\"Farm_Size__c\", dataValue(\"form.Number_of_Trees\"))\n      )\n    )\n  ),\n\n  beta.each(\n    \"$.data\",\n    upsertIf(\n    state.data.form.survey_detail == \"Existing Household\",\n    \"Participant__c\", \"CommCare_Case_Id__c\",\n      fields(\n        field(\"CommCare_Case_Id__c\", dataValue(\"form.subcase_0.case.@case_id\")),\n        field(\"TNS_Id__c\", dataValue(\"form.Farmer_Id\")),\n        field(\"Age__c\", dataValue(\"form.Age\")),\n        field(\"Name\", dataValue(\"form.First_Name\")),\n        field(\"Middle_Name__c\", dataValue(\"form.Middle_Name\")),\n        field(\"Last_Name__c\", dataValue(\"form.Last_Name\")),\n        field(\"Gender__c\", dataValue(\"form.Gender\")),\n        field(\"Status__c\", dataValue(\"form.Status\")),\n        field(\"Farm_Size__c\", dataValue(\"form.Number_of_Trees\")),\n        field(\"Sent_to_OpenFn_Status__c\", \"Complete\"),\n        field(\"Phone_Number__c\", dataValue(\"form.Phone_Number\")),\n        field(\"Other_ID_Number__c\", dataValue(\"form.Cooperative_Membership_Number\")),\n        field(\"Primary_Household_Member__c\", dataValue(\"form.Primary_Household_Member\")),\n        relationship(\"Household__r\", \"Household_ID__c\", dataValue(\"form.Household_Id\")),\n        relationship(\"Training_Group__r\", \"CommCare_Case_Id__c\", dataValue(\"form.Training_Group_Id\"))\n      )\n    )\n  ),\n\n//Update participants use this section.\nbeta.each(\n  \"$.data\",\n  upsertIf(\n    state.data.form.survey_detail == \"Participant Update\",\n    \"Household__c\", \"Household_ID__c\",\n      fields(\n        field(\"Household_ID__c\", dataValue(\"form.Household_Id\")),\n        field(\"Farm_Size__c\", dataValue(\"form.Number_of_Trees\"))\n      )\n    )\n  ),\n\n  beta.each(\n    \"$.data\",\n    upsertIf(\n    state.data.form.survey_detail == \"Participant Update\",\n    \"Participant__c\", \"CommCare_Case_Id__c\",\n      fields(\n        field(\"CommCare_Case_Id__c\", dataValue(\"form.case.@case_id\")),\n        field(\"Age__c\", dataValue(\"form.Age\")),\n        field(\"Name\", dataValue(\"form.First_Name\")),\n        field(\"Middle_Name__c\", dataValue(\"form.Middle_Name\")),\n        field(\"Last_Name__c\", dataValue(\"form.Last_Name\")),\n        field(\"Gender__c\", dataValue(\"form.Gender\")),\n        field(\"Farm_Size__c\", dataValue(\"form.Number_of_Trees\")),\n        field(\"Phone_Number__c\", dataValue(\"form.Phone_Number\")),\n        field(\"Other_ID_Number__c\", dataValue(\"form.Cooperative_Membership_Number\"))\n      )\n    )\n  );\n\n//Version Control\n",
          "adaptor": "@openfn/language-salesforce@v1.3.2",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---ZW-Nespresso--Ag----c2---CommCare----Salesforce---Participant-Registration-and-Update": {
          "enabled": true,
          "id": "95342542-52a4-4f69-a795-a33e4b96368c",
          "target_job_id": "a148cf60-1c74-43d6-b0b8-b2ec52068d03",
          "source_trigger_id": "b43cec61-ba3a-45e8-adce-8e18707ebaaa",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW Nespresso Ag c2 CommCare Salesforce Participant Registration and Update",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Participant\" && state.data[\"app_id\"] == \"c14d231df6e142deb9bdd44319287437\""
        }
      }
    },
    "Coffee---ZW-Nespresso--Ag----c2---CommCare----SalesForce--Training-Attendance": {
      "id": "65ce2fb3-1740-4d04-8f30-24fdf8fd20e6",
      "name": "Coffee - ZW Nespresso -Ag- - c2 - CommCare -- SalesForce -Training Attendance",
      "inserted_at": "2025-03-20T03:44:07.774535Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "61f78eb2-b86c-4103-b166-d4285de5f1fe",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---ZW-Nespresso--Ag----c2---CommCare----SalesForce--Training-Attendance": {
          "id": "eb637538-a385-4d66-99b6-258b4b014475",
          "name": "Coffee - ZW Nespresso -Ag- - c2 - CommCare -- SalesForce -Training Attendance",
          "body": "//Coffee - ZW Nespresso (Ag) - c2 | CommCare --> SalesForce | Training Attendance\n//{\"app_id\":\"c14d231df6e142deb9bdd44319287437\",\"form\":{\"survey_type\":\"Training Attendance\"}}\n\n//ATTENDANCE REGISTRATION JOB {COMMCARE TO SALESFORCE}\neach(\n  \"$.data\",\n  upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n    fields(\n      field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Number_in_Attendance__c\", dataValue(\"form.attendance_count\")),\n      field(\"Session_Photo_URL__c\", function(state) {\n          var photoUrl = '';\n          if(dataValue(\"form.photo\")(state) !== undefined && dataValue(\"form.photo\")(state) !== '') {\n            photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.photo\")(state);  \n          }\n          return photoUrl;\n      }),\n      field(\"Date__c\", dataValue(\"form.date\")),\n      field('Location_GPS__Latitude__s', (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[0];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return '';\n      }),\n      field('Location_GPS__Longitude__s', (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[1];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return '';\n      }),\n      field('Altitude__c', (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[2];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return '';\n      })\n      )\n    )\n  );\n\nbeta.each(\n  function(state) {\n    if (state.data.form.present_participants) {\n      return state.data.form.present_participants.split(\" \").map(\n        function(pId) {\n          return {\n            participant: pId,\n            session: dataValue(\"form.training_session\")(state),\n            submission: dataValue(\"form.training_session\")(state)+pId,\n            sessionPhoto: dataValue(\"form.photo\")(state)\n          };\n        }\n      );\n    }\n  },\n  upsert(\"Attendance__c\", \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"submission\")),\n      field(\"Status__c\", \"Present\"),\n      relationship(\"Training_Session__r\", \"CommCare_Case_Id__c\", dataValue(\"session\")),\n      relationship(\"Participant__r\", \"CommCare_Case_Id__c\", dataValue(\"participant\"))\n    )\n  )\n);\neach(\n  \"$.data\",\n  upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n    fields(\n      field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n      field(\"Updated_from_CommCare__c\", true)\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-salesforce@v1.3.2",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---ZW-Nespresso--Ag----c2---CommCare----SalesForce--Training-Attendance": {
          "enabled": true,
          "id": "c4aff4ec-efb5-43b4-ad9e-edb3151cb537",
          "target_job_id": "eb637538-a385-4d66-99b6-258b4b014475",
          "source_trigger_id": "61f78eb2-b86c-4103-b166-d4285de5f1fe",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW Nespresso Ag c2 CommCare SalesForce Training Attendance",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Training Attendance\" && state.data[\"app_id\"] == \"c14d231df6e142deb9bdd44319287437\""
        }
      }
    },
    "Global---Participants---SalesForce----CommCare": {
      "id": "9e4097c1-8f4f-4ebb-9d7a-fb16bf878d2b",
      "name": "Global - Participants - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.779397Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "f56a3d6c-4afa-453d-8767-06b78508c5d7",
          "type": "webhook"
        }
      },
      "jobs": {
        "Global---Participants---SalesForce----CommCare": {
          "id": "d5e21fb4-057c-4b71-b226-a68117a0921b",
          "name": "Global - Participants - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending Participants for Coffee - ET HWG JCP C2023\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET HWG JCP C2023\n// JOB NAME :: Production | Participants - ET HWG JCP C2023 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_hwg_jcp_c2023\"}\n// AUTHOR :: Yves Mugenga | ymugenga@tns.org\n\neach(\n  \"$.data.participants[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3E266629-AFD8-4A1C-8825-1DCDDF24E5A8\",\n          \"uiVersion\": \"1\",\n          \"version\": \"325\",\n          \"name\": \"New Participant\",\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name;\n      }),\n      field(\"First_Name\", dataValue(\"participantName\")),\n      field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n      field(\"Last_Name\", dataValue(\"participantLastName\")),\n      field(\"Age\", dataValue(\"participantAge\")),\n      field(\"Gender\", dataValue(\"participantGender\")),\n      field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n      field(\"Farmer_Id\", dataValue(\"tnsId\")),\n      field(\"Farmer_Number\", function(state){\n        var tnsId = dataValue(\"tnsId\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        return farmerNumber;\n      }),\n      field(\"Cooperative_Membership_Number\", dataValue(\"participantOtherIDNumber\")),\n      field(\"Household_Id\", dataValue(\"householdId\")),\n      field(\"Household_Number\", dataValue(\"householdName\")),\n      field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n      field(\"Status\", dataValue(\"status\")),\n      field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Name_Household_Concat\", function(state){\n        var name = '';\n        var tnsId = dataValue(\"tnsId\")(state);\n        var hhNumber = dataValue(\"householdName\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        \n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name+' '+hhNumber+'-'+farmerNumber;\n      }),\n      \n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"the_avengers_initiative_participant\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:First_Name\": dataValue(\"participantName\")(state),\n            \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n            \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n            \"n0:Age\": dataValue(\"participantAge\")(state),\n            \"n0:Gender\": dataValue(\"participantGender\")(state),\n            \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n            \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Farmer_Number\": function(){\n              var tnsId = dataValue(\"tnsId\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              return farmerNumber;\n            },\n            \"n0:Cooperative_Membership_Number\": dataValue(\"participantOtherIDNumber\")(state),\n            \"n0:Household_Id\": dataValue(\"householdId\")(state),\n            \"n0:Household_Number\": dataValue(\"householdName\")(state),\n            \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n            \"n0:Status\": dataValue(\"status\")(state),\n            \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n            \"n0:Name_Household_Concat\": function(){\n              var name = '';\n              var tnsId = dataValue(\"tnsId\")(state);\n              var hhNumber = dataValue(\"householdName\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              \n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name+' '+hhNumber+'-'+farmerNumber;\n            },\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"the_avengers_initiative_training_group\"\n              },\n              \"#\": dataValue(\"trainingGroupId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n1:deviceID\": \"867066029216796\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Global---Participants---SalesForce----CommCare": {
          "enabled": true,
          "id": "1df79463-c018-416e-bf62-f9cbbbac093d",
          "target_job_id": "d5e21fb4-057c-4b71-b226-a68117a0921b",
          "source_trigger_id": "f56a3d6c-4afa-453d-8767-06b78508c5d7",
          "condition_type": "js_expression",
          "condition_label": "Global Participants SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"the_avengers_initiative\""
        }
      }
    },
    "Production---Coffee-KE-2024BC---SalesForce----CommCare---Training-Groups": {
      "id": "e590f330-77d7-4ab4-aa30-2857f5c41279",
      "name": "Production - Coffee KE 2024BC - SalesForce -- CommCare - Training Groups",
      "inserted_at": "2025-03-20T03:44:07.784135Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "f0261009-edb4-4fce-9aea-20f5c95b4ceb",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-KE-2024BC---SalesForce----CommCare---Training-Groups": {
          "id": "93363329-3a27-46c2-9b17-bfb10ce1ad3a",
          "name": "Production - Coffee KE 2024BC - SalesForce -- CommCare - Training Groups",
          "body": "// Your job goes here.\neach(\n    \"$.data.trainingGroups[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"name\": \"New Training Group\",\n            \"uiVersion\": \"1\",\n            \"version\": \"1\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/B9AE4CBF-B571-4038-9C90-3D5D47DFDB90\",\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n          };\n        }),\n        field(\"Name\", dataValue(\"trainingGroupName\")),\n        field(\"FFG_Number\", dataValue(\"tnsId\")),\n        field(\"Location\", dataValue(\"locationName\")),\n        field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n        field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n        field(\"Household_Counter\", dataValue(\"householdCounter\")),\n        field(\"Name_Id_Concat\", function(state) {\n          return (\n            //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n            dataValue(\"trainingGroupName\")(state)\n          );\n        }),\n        field(\"Parent_Id\", dataValue(\"staffId\")),\n        field(\"n0:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"trainingGroupId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_ke_2024bc_training_group\"\n            },\n            \"n0:update\": {\n              \"n0:Location\": dataValue(\"locationName\")(state),\n              \"n0:Market\": dataValue(\"market\")(state),\n              \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n              \"n0:Name_Id_Concat\": function(){\n                //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n                var name = dataValue(\"trainingGroupName\")(state);\n                return name;\n              },\n              \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n              \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n              \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n              \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n            },\n            \"n0:index\": {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_ke_2024bc_staff\"\n                },\n                \"#\": dataValue(\"staffId\")(state)\n              }\n            }\n          };\n        }),\n        field(\"n1:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"trainingGroupId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n            }\n          };\n        }),\n        field(\"n2:meta\", function(state) {\n          return {\n            \"@\": {\n              \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n            },\n            \"n2:deviceID\": \"PIMA API\",\n            \"n2:timeStart\": new Date().toISOString(),\n            \"n2:timeEnd\": new Date().toISOString(),\n            \"n2:username\": \"api\",\n            \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-KE-2024BC---SalesForce----CommCare---Training-Groups": {
          "enabled": true,
          "id": "d7f14d3d-0f4e-4932-9cac-210650ec5e6d",
          "target_job_id": "93363329-3a27-46c2-9b17-bfb10ce1ad3a",
          "source_trigger_id": "f0261009-edb4-4fce-9aea-20f5c95b4ceb",
          "condition_type": "js_expression",
          "condition_label": "Production - Coffee KE 2024BC - SalesForce -- CommCare - Training Groups",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2024bc\""
        }
      }
    },
    "Production---Coffee-KE-2024BC---SalesForce----CommCare---Training-Sessions": {
      "id": "52a51dac-26ee-4796-b7bb-8ffdba69a6e3",
      "name": "Production - Coffee KE 2024BC - SalesForce -- CommCare - Training Sessions",
      "inserted_at": "2025-03-20T03:44:07.789314Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "a77c54ac-ab5c-4f1f-af60-eb84a4cd3f71",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-KE-2024BC---SalesForce----CommCare---Training-Sessions": {
          "id": "f9f2aeab-6da4-4b34-9120-de0578f291dd",
          "name": "Production - Coffee KE 2024BC - SalesForce -- CommCare - Training Sessions",
          "body": "// Your job goes here.\neach(\n    \"$.data.trainingSessions[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"name\": \"New Training Session\",\n            \"uiVersion\": \"1\",\n            \"version\": \"148\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n          };\n        }),\n        field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n        field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n        field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n        field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n        field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n        field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n        field(\"Current_Previous_Name\", function(state){\n          return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n        }),\n        field(\"Training_Session_Name\", function(state) {\n          return (\n            dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n          );\n        }),\n        field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n        field(\"Case_Id\", dataValue(\"sessionId\")),\n        field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n        field(\"subcase_0\", function(state) {\n          return {\n            \"n0:case\": {\n              \"@\": {\n                \"case_id\": dataValue(\"sessionId\")(state),\n                \"date_modified\": new Date().toISOString(),\n                \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n                \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n              },\n              \"n0:create\": {\n                \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n                \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n                \"n0:case_type\": \"coffee_ke_2024bc_training_session\"\n              },\n              \"n0:update\": {\n                \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n                \"n0:Date\": new Date().toISOString(),\n                \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n                \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n                \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n                \"n0:Current_Previous_Name\": function(){\n                  return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n                },\n                \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n                \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n                \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n                \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n                \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n              },\n              \"n0:index\":  {\n                \"n0:parent\" : {\n                  \"@\": {\n                    \"case_type\": \"coffee_ke_2024bc_training_group\"\n                  },\n                  \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n                }\n              }\n            }\n          };\n        }),\n        field(\"n1:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n            }\n          };\n        }),\n        field(\"n2:meta\", function(state) {\n          return {\n            \"@\": {\n              \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n            },\n            \"n2:deviceID\": \"867066029216796\",\n            \"n2:timeStart\": new Date().toISOString(),\n            \"n2:timeEnd\": new Date().toISOString(),\n            \"n2:username\": \"api\",\n            \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-KE-2024BC---SalesForce----CommCare---Training-Sessions": {
          "enabled": true,
          "id": "21977bd7-064b-4125-ae4a-78f71322fe6e",
          "target_job_id": "f9f2aeab-6da4-4b34-9120-de0578f291dd",
          "source_trigger_id": "a77c54ac-ab5c-4f1f-af60-eb84a4cd3f71",
          "condition_type": "js_expression",
          "condition_label": "Coffee KE 2024BC SalesForce CommCare Training Sessions",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ke_2024bc\""
        }
      }
    },
    "Production---Coffee-ZIM---CommCare----Salesforce---Training-Attendance": {
      "id": "56175fe0-9c2b-43c6-ace7-140eeccaa1d9",
      "name": "Production - Coffee ZIM - CommCare -- Salesforce - Training Attendance",
      "inserted_at": "2025-03-20T03:44:07.794707Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "f3dbad99-e043-4d43-b070-58d687dc2082",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-ZIM---CommCare----Salesforce---Training-Attendance": {
          "id": "00b5959a-b81e-429f-83b4-dc08fabea628",
          "name": "Production - Coffee ZIM - CommCare -- Salesforce - Training Attendance",
          "body": "//Attendance Light\n\neach(\n  \"$.data\",\n  upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n    fields(\n      field(\"CommCare_Case_Id__c\", dataValue(\"form.selected_training_module\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Male_Attendance__c\", dataValue(\"form.Current_session_participants.male_attendance\")),\n      field(\"Female_Attendance__c\", dataValue(\"form.Current_session_participants.female_attendance\")),\n      field(\"Number_in_Attendance__c\", dataValue(\"form.Current_session_participants.total_attendance\")),\n\n      field(\"Date__c\", dataValue(\"form.Current_session_participants.date\")),\n      field(\"Location_GPS__Latitude__s\", function(state) {\n          if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n            var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n            return coordinates[0]; \n          }\n      }),\n      field(\"Location_GPS__Longitude__s\", function(state) {\n          if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n            var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n            return coordinates[1]; \n          }\n      }),\n      field(\"Altitude__c\", function(state) {\n          if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n            var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n            return coordinates[2]; \n          }\n      })\n      \n    )\n  )\n);\n\n// Version control\n",
          "adaptor": "@openfn/language-salesforce@v1.3.2",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-ZIM---CommCare----Salesforce---Training-Attendance": {
          "enabled": true,
          "id": "d83355e8-d01f-4cfb-930a-914f4117d355",
          "target_job_id": "00b5959a-b81e-429f-83b4-dc08fabea628",
          "source_trigger_id": "f3dbad99-e043-4d43-b070-58d687dc2082",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee ZIM CommCare Salesforce Training Attendance",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Attendance Light\" && state.data[\"app_id\"] == \"b75286e874c74eb09b8da436709d7f3c\""
        }
      }
    },
    "Production---Coffee-ZIM---SalesForce----CommCare---Project-Roles": {
      "id": "650d19cc-4783-4163-bd55-6b239362c4dc",
      "name": "Production - Coffee ZIM - SalesForce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.801024Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "02142ee2-1b88-47ec-a2cc-54f18905d922",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-ZIM---SalesForce----CommCare---Project-Roles": {
          "id": "5261ab3c-7f46-4961-a775-8502ba06c77e",
          "name": "Production - Coffee ZIM - SalesForce -- CommCare - Project Roles",
          "body": "//Project Roles\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Staff\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"FFGs_Observed\", null),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_zim_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFGs_Observed\": null\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"mjuma\",\n          \"n1:userID\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\"\n        };\n      })\n    )\n  )\n);// Your job goes here.\n\n// Version control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-ZIM---SalesForce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "06e1719d-ebe6-468b-9b5e-5977780be34c",
          "target_job_id": "5261ab3c-7f46-4961-a775-8502ba06c77e",
          "source_trigger_id": "02142ee2-1b88-47ec-a2cc-54f18905d922",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee ZIM SalesForce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zim\""
        }
      }
    },
    "Production---Training-Groups---ET-HWG-JCP-C2023---SalesForce----CommCare": {
      "id": "d6626e85-ead7-4878-a472-73ebb683c299",
      "name": "Production - Training Groups - ET HWG JCP C2023 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.806412Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "e59e78ff-9de9-4abb-9674-ded0c886bf65",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Training-Groups---ET-HWG-JCP-C2023---SalesForce----CommCare": {
          "id": "5e45680d-4a3b-426a-a887-1af2b581a218",
          "name": "Production - Training Groups - ET HWG JCP C2023 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending training groups for Coffee - ET HWG JCP C2023\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET HWG JCP C2023\n// JOB NAME :: Production | Training Groups - ET HWG JCP C2023 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"C_ET_HWG_BK_2022C\"}\n// AUTHOR :: Yves Mugenga | ymugenga@tns.org\n\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_hwg_jcp_c2023_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_et_hwg_jcp_c2023_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Training-Groups---ET-HWG-JCP-C2023---SalesForce----CommCare": {
          "enabled": true,
          "id": "e22247a9-362c-4918-9b67-d2ac44a92419",
          "target_job_id": "5e45680d-4a3b-426a-a887-1af2b581a218",
          "source_trigger_id": "e59e78ff-9de9-4abb-9674-ded0c886bf65",
          "condition_type": "js_expression",
          "condition_label": "Production Training Groups HWG JCP C2023 Salesforce CommCare",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_hwg_jcp_c2023\""
        }
      }
    },
    "Production---Coffee-DRC---CommCare----Salesforce---Training-Attendance": {
      "id": "1845c90b-9e1c-4ad1-aba3-b763f6789ee1",
      "name": "Production - Coffee DRC - CommCare -- Salesforce - Training Attendance",
      "inserted_at": "2025-03-20T03:44:07.896792Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "cb6007df-10c8-4d89-a111-eaf6f840d58a",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-DRC---CommCare----Salesforce---Training-Attendance": {
          "id": "840e1ffc-0215-4fdd-bf7a-c7629315785d",
          "name": "Production - Coffee DRC - CommCare -- Salesforce - Training Attendance",
          "body": "//Training Attendance\n//Production - Coffee DRC | CommCare --> Salesforce | Training Attendance\n\n\neach(\n  \"$.data\",\n  upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n    fields(\n      field(\"CommCare_Case_Id__c\", dataValue(\"form.selected_training_module\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Male_Attendance__c\", dataValue(\"form.Current_session_participants.male_attendance\")),\n      field(\"Female_Attendance__c\", dataValue(\"form.Current_session_participants.female_attendance\")),\n      field(\"Number_in_Attendance__c\", dataValue(\"form.Current_session_participants.total_attendance\")),\n\n      field(\"Date__c\", dataValue(\"form.Current_session_participants.date\")),\n      field(\"Location_GPS__Latitude__s\", function(state) {\n          if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n            var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n            return coordinates[0]; \n          }\n      }),\n      field(\"Location_GPS__Longitude__s\", function(state) {\n          if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n            var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n            return coordinates[1]; \n          }\n      }),\n      field(\"Altitude__c\", function(state) {\n          if(dataValue(\"form.meta.location.#text\")(state) !== undefined) {\n            var coordinates = dataValue(\"form.meta.location.#text\")(state).split(' ');\n            return coordinates[2]; \n          }\n      })\n      \n    )\n  )\n);\n\n// Version control\n",
          "adaptor": "@openfn/language-salesforce@v1.3.2",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-DRC---CommCare----Salesforce---Training-Attendance": {
          "enabled": true,
          "id": "4b4eba10-c483-4f77-94b3-06b4d64755ed",
          "target_job_id": "840e1ffc-0215-4fdd-bf7a-c7629315785d",
          "source_trigger_id": "cb6007df-10c8-4d89-a111-eaf6f840d58a",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee DRC CommCare Salesforce Training Attendance",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Attendance Light\" && state.data[\"app_id\"] == \"eeddc901b4aa4652b7252240152b20d5\""
        }
      }
    },
    "x-[archived]-OpenFN-to-MySQL-Test": {
      "id": "99907582-6c67-433f-a86b-6d5e7c54fed0",
      "name": "x [archived] OpenFN to MySQL Test",
      "inserted_at": "2025-03-20T03:44:07.901504Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "e20ee86a-7947-4587-922e-4a309bb43bd7",
          "type": "webhook"
        }
      },
      "jobs": {
        "OpenFN-to-MySQL-Test": {
          "id": "df6eb583-edbb-4026-af0c-b95049f1bb1c",
          "name": "OpenFN to MySQL Test",
          "body": "// Your job goes here.\nconsole.log(\"Upserting data\"),\n  execute(\n    upsert('connection_test', \n      fields(\n        field('session_id', dataValue('form.case.@case_id')(state)),\n        field('females_attended', dataValue('form.Current_session_participants.female_attendance')(state)),\n        field('males_attended', dataValue('form.Current_session_participants.male_attendance')(state))\n      )\n    )\n  )(state);\nconsole.log(\"Upserting done!\");\n",
          "adaptor": "@openfn/language-mysql@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->OpenFN-to-MySQL-Test": {
          "enabled": true,
          "id": "25d3aa59-865c-4d79-9fb4-b08cdc687779",
          "target_job_id": "df6eb583-edbb-4026-af0c-b95049f1bb1c",
          "source_trigger_id": "e20ee86a-7947-4587-922e-4a309bb43bd7",
          "condition_type": "js_expression",
          "condition_label": "Attendance Light CommCare Salesforce Training Attendance",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Attendance Light\""
        }
      }
    },
    "x-[archived]-Coffee-DRC---GEF-Kalehe-2022---Training-Sessions---Salesforce----CommCare": {
      "id": "c2f073cb-0bc3-4fa8-ae1c-d836987a973f",
      "name": "x [archived] Coffee DRC - GEF Kalehe 2022 - Training Sessions - Salesforce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.907563Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "28c08abc-850b-4d85-8085-854cd76dafd2",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee-DRC---GEF-Kalehe-2022---Training-Sessions---Salesforce----CommCare": {
          "id": "da76d8bf-dc7c-443a-82a9-dfed634c5675",
          "name": "Coffee DRC - GEF Kalehe 2022 - Training Sessions - Salesforce -- CommCare",
          "body": "//Coffee DRC - GEF Kalehe 2022 | Training Sessions | Salesforce --> CommCare\n//coffee_drc_gef_2022\n//{\"jobType\":\"Training Session\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_drc_gef_2022\"}\n\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_drc_gef_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_drc_gef_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee-DRC---GEF-Kalehe-2022---Training-Sessions---Salesforce----CommCare": {
          "enabled": true,
          "id": "23bbaafb-6459-4635-8cd3-0a601a173748",
          "target_job_id": "da76d8bf-dc7c-443a-82a9-dfed634c5675",
          "source_trigger_id": "28c08abc-850b-4d85-8085-854cd76dafd2",
          "condition_type": "js_expression",
          "condition_label": "Coffee DRC - GEF Kalehe 2022 | Training Sessions | Salesforce --> CommCare",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_drc_gef_2022\""
        }
      }
    },
    "x-[archived]-Coffee-DRC---GEF-Kalehe-2022---Project-Roles---Salesforce----CommCare": {
      "id": "b99e608b-e844-4139-a167-e9654a61b6e3",
      "name": "x [archived] Coffee DRC - GEF Kalehe 2022 - Project Roles - Salesforce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.913623Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "22d97b15-b889-44eb-9de0-7863ce6df7f4",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee-DRC---GEF-Kalehe-2022---Project-Roles---Salesforce----CommCare": {
          "id": "4b858139-ae13-4a20-be35-a06605aeabb1",
          "name": "Coffee DRC - GEF Kalehe 2022 - Project Roles - Salesforce -- CommCare",
          "body": "//Coffee DRC - GEF Kalehe 2022 | Project Roles | Salesforce --> CommCare\n//coffee_drc_gef_2022\n//{\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_drc_gef_2022\"}\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_drc_gef_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee-DRC---GEF-Kalehe-2022---Project-Roles---Salesforce----CommCare": {
          "enabled": true,
          "id": "526af087-8a9f-42a4-a2c5-5820995924e2",
          "target_job_id": "4b858139-ae13-4a20-be35-a06605aeabb1",
          "source_trigger_id": "22d97b15-b889-44eb-9de0-7863ce6df7f4",
          "condition_type": "js_expression",
          "condition_label": "Coffee DRC GEF Kalehe 2022 Project Roles Salesforce CommCare",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_drc_gef_2022\""
        }
      }
    },
    "x-[archived]-CC-OFn-MySQL-Connection": {
      "id": "69b74d53-668e-4c16-b420-6b6bc021c879",
      "name": "x [archived] CC-OFn-MySQL Connection",
      "inserted_at": "2025-03-20T03:44:07.921877Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "1653678a-4867-4cac-b9f5-15ed4029bb2f",
          "type": "webhook"
        }
      },
      "jobs": {
        "CC-OFn-MySQL-Connection": {
          "id": "1e8f1266-ba3f-4f83-adb5-3ea50a1b0ee1",
          "name": "CC-OFn-MySQL Connection",
          "body": "execute(\n  upsert('openfn_test', \n    fields(\n      field('enumerator', dataValue('form.enumerator')(state)),\n      field('partner_name', dataValue('form.partner_name')(state)),\n      field('partnership_area', function(state){\n        var result = \"\";\n        var curr_data = dataValue('form.partnership_area')(state);\n        curr_data = curr_data.replace(\" \", \", \");\n        console.log(curr_data);\n        var oth_data = dataValue('form.specify_partnership_area')(state);\n        console.log(oth_data);\n        if(curr_data.includes(\"other\")){\n          result = curr_data.replace(\"other\", \", \", oth_data);\n        }\n        else {\n          result = curr_data;\n        }\n        console.log(result);\n        return result;\n      }),\n      // field('product_type', dataValue('form.case.@case_id')(state)),\n      // field('business_type', dataValue('form.case.@case_id')(state)),\n      // field('services_type', dataValue('form.case.@case_id')(state))\n    )\n  )\n)(state);\n",
          "adaptor": "@openfn/language-mysql@v1.4.7",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->CC-OFn-MySQL-Connection": {
          "enabled": true,
          "id": "c0b6fb4e-4848-41a9-8bf2-9aae369eee29",
          "target_job_id": "1e8f1266-ba3f-4f83-adb5-3ea50a1b0ee1",
          "source_trigger_id": "1653678a-4867-4cac-b9f5-15ed4029bb2f",
          "condition_type": "js_expression",
          "condition_label": "CC OFn MySQL Connection",
          "condition_expression": "state.data[\"app_id\"] == \"739e3f083b3c1aaab1a6cd10d177b9c2\""
        }
      }
    },
    "Coffee---PR-2022---SalesForce----CommCare---Training-Participants": {
      "id": "556ee21e-17a8-45d5-bf90-b508d55f3065",
      "name": "Coffee - PR 2022 - SalesForce -- CommCare - Training Participants",
      "inserted_at": "2025-03-20T03:44:07.927350Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "c59188bf-26ed-4aef-ad33-08ce372131de",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---PR-2022---SalesForce----CommCare---Training-Participants": {
          "id": "e7e600e0-9ae2-4b66-9521-461a58f04f86",
          "name": "Coffee - PR 2022 - SalesForce -- CommCare - Training Participants",
          "body": "//Participant Job\n//Coffee :: PR 2022 | SalesForce --> CommCare | Training Participants\n//{\"jobType\":\"Participant\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffe_puerto_rico_2022\"}\n\neach(\n  \"$.data.participants[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/1768D5C8-3EE4-4D7B-AE17-FE0AC9A0E60D\",\n          \"uiVersion\": \"1\",\n          \"version\": \"325\",\n          \"name\": \"New Participant\",\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name;\n      }),\n      field(\"First_Name\", dataValue(\"participantName\")),\n      field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n      field(\"Last_Name\", dataValue(\"participantLastName\")),\n      field(\"Age\", dataValue(\"participantAge\")),\n      field(\"Gender\", dataValue(\"participantGender\")),\n      field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n      field(\"Farmer_Id\", dataValue(\"tnsId\")),\n      field(\"Farmer_Number\", function(state){\n        var tnsId = dataValue(\"tnsId\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        return farmerNumber;\n      }),\n      field(\"Cooperative_Membership_Number\", dataValue(\"participantOtherIDNumber\")),\n      field(\"Household_Id\", dataValue(\"householdId\")),\n      field(\"Household_Number\", dataValue(\"householdName\")),\n      field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n      field(\"Status\", dataValue(\"status\")),\n      field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Name_Household_Concat\", function(state){\n        var name = '';\n        var tnsId = dataValue(\"tnsId\")(state);\n        var hhNumber = dataValue(\"householdName\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        \n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name+' '+hhNumber+'-'+farmerNumber;\n      }),\n      \n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_pr_2022_participant\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:First_Name\": dataValue(\"participantName\")(state),\n            \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n            \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n            \"n0:Age\": dataValue(\"participantAge\")(state),\n            \"n0:Gender\": dataValue(\"participantGender\")(state),\n            \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n            \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Farmer_Number\": function(){\n              var tnsId = dataValue(\"tnsId\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              return farmerNumber;\n            },\n            \"n0:Cooperative_Membership_Number\": dataValue(\"participantOtherIDNumber\")(state),\n            \"n0:Household_Id\": dataValue(\"householdId\")(state),\n            \"n0:Household_Number\": dataValue(\"householdName\")(state),\n            \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n            \"n0:Status\": dataValue(\"status\")(state),\n            \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n            \"n0:Name_Household_Concat\": function(){\n              var name = '';\n              var tnsId = dataValue(\"tnsId\")(state);\n              var hhNumber = dataValue(\"householdName\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              \n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name+' '+hhNumber+'-'+farmerNumber;\n            },\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_pr_2022_training_group\"\n              },\n              \"#\": dataValue(\"trainingGroupId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n1:deviceID\": \"867066029216796\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---PR-2022---SalesForce----CommCare---Training-Participants": {
          "enabled": true,
          "id": "6698d3da-f266-43a5-966e-196f88580d24",
          "target_job_id": "e7e600e0-9ae2-4b66-9521-461a58f04f86",
          "source_trigger_id": "c59188bf-26ed-4aef-ad33-08ce372131de",
          "condition_type": "js_expression",
          "condition_label": "Coffee PR 2022 SalesForce CommCare Training Participants",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_puerto_rico_2022\""
        }
      }
    },
    "Coffee---ZW-C3---C2021---SalesForce----CommCare---Project-Roles": {
      "id": "3a069d4d-a9dd-44aa-9e29-71295f67def1",
      "name": "Coffee - ZW C3 - C2021 - SalesForce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.933554Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "8f05ddd5-64cf-4ce3-8e9c-d05c958187d8",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---ZW-C3---C2021---SalesForce----CommCare---Project-Roles": {
          "id": "4f71882b-9bb6-4236-9776-e5aa86dc5ccc",
          "name": "Coffee - ZW C3 - C2021 - SalesForce -- CommCare - Project Roles",
          "body": "//Coffee - ZW C3 - C2021 | SalesForce --> CommCare | Project Roles\n//{\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_zw_c21_agronomy\"}\n\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"FFGs_Observed\", null),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_zw_c21_ag_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFGs_Observed\": null\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---ZW-C3---C2021---SalesForce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "b8b32a57-3813-4f48-8038-869a082cc063",
          "target_job_id": "4f71882b-9bb6-4236-9776-e5aa86dc5ccc",
          "source_trigger_id": "8f05ddd5-64cf-4ce3-8e9c-d05c958187d8",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW C3 C2021 SalesForce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zw_c21_ag\""
        }
      }
    },
    "Coffee---ZW-C3---C2021---SalesForce----CommCare---Training-Sessions": {
      "id": "2f92ae42-63c4-4715-8a4f-2b5c90f5adc2",
      "name": "Coffee - ZW C3 - C2021 - SalesForce -- CommCare - Training Sessions",
      "inserted_at": "2025-03-20T03:44:07.938898Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "69aa6a6c-959d-4711-8db7-5b4137638a60",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---ZW-C3---C2021---SalesForce----CommCare---Training-Sessions": {
          "id": "12b82604-7384-405f-8f37-809e7bb1ed3b",
          "name": "Coffee - ZW C3 - C2021 - SalesForce -- CommCare - Training Sessions",
          "body": "//Coffee - ZW C3 - C2021 | SalesForce --> CommCare | Training Sessions\n//{\"jobType\":\"Training Session\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_zw_c21_agronomy\"}\n\n\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n      field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n      field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n      field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Current_Previous_Name\", function(state){\n        return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n      }),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_zw_c21_ag_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n              \"n0:Current_Previous_Name\": function(){\n                return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n              },\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n              \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n              \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n              \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n              \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_zw_c21_ag_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---ZW-C3---C2021---SalesForce----CommCare---Training-Sessions": {
          "enabled": true,
          "id": "8de16713-ee45-432e-afdf-77bde79468bb",
          "target_job_id": "12b82604-7384-405f-8f37-809e7bb1ed3b",
          "source_trigger_id": "69aa6a6c-959d-4711-8db7-5b4137638a60",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW C3 C2021 SalesForce CommCare Training Sessions",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zw_c21_ag\""
        }
      }
    },
    "Coffee---ZW-IFC-2024C---SalesForce----CommCare---Training-Groups": {
      "id": "850169e9-9225-4dbd-9901-ea9ddda0c86d",
      "name": "Coffee - ZW IFC 2024C - SalesForce -- CommCare - Training Groups",
      "inserted_at": "2025-03-20T03:44:07.944534Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "0cb9c3e5-3522-4028-8d66-8f2ee79a4986",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---ZW-IFC-2024C---SalesForce----CommCare---Training-Groups": {
          "id": "78a73b9b-4635-4b5f-9461-2cc19c8f11a8",
          "name": "Coffee - ZW IFC 2024C - SalesForce -- CommCare - Training Groups",
          "body": "//Training Group Job \n//Coffee - UG Benckiser (Ag) :: C2020 | SalesForce --> CommCare | Training Groups\n//{\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_zw_2024c\"}\n\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/E70C61DB-A15E-4466-B187-02B2FCB6A135\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"Status\", dataValue(\"groupStatus\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_zw_2024c_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:Status\": dataValue(\"groupStatus\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_zw_2024c_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---ZW-IFC-2024C---SalesForce----CommCare---Training-Groups": {
          "enabled": true,
          "id": "b0b5d085-530f-4ccb-afd7-9243df88c78a",
          "target_job_id": "78a73b9b-4635-4b5f-9461-2cc19c8f11a8",
          "source_trigger_id": "0cb9c3e5-3522-4028-8d66-8f2ee79a4986",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW IFC 2024C SalesForce CommCare Training Groups",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zw_2024c\""
        }
      }
    },
    "Coffee---PR-2022---SalesForce----CommCare---Training-Sessions": {
      "id": "f6b0e143-4d12-4415-85c4-6875969c019d",
      "name": "Coffee - PR 2022 - SalesForce -- CommCare - Training Sessions",
      "inserted_at": "2025-03-20T03:44:07.950924Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "043a9061-3dc6-4875-aee2-2a728c94ad14",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---PR-2022---SalesForce----CommCare---Training-Sessions": {
          "id": "1dcdcbcb-f5fd-4c50-b363-70947b82a071",
          "name": "Coffee - PR 2022 - SalesForce -- CommCare - Training Sessions",
          "body": "//Training Sessions\n//Coffee :: PR C2022 | SalesForce --> CommCare | Training Sessions\n//{\"jobType\":\"Training Session\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_puerto_rico_2022\"}\n\neach(\n  \"$.data.trainingSessions[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Session\",\n          \"uiVersion\": \"1\",\n          \"version\": \"148\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n      field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n      field(\"Session_Status\", dataValue(\"sessionStatus\")),\n      field(\"Training_Session_Name\", function(state) {\n        return (\n          dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n        );\n      }),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Case_Id\", dataValue(\"sessionId\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n      field(\"subcase_0\", function(state) {\n        return {\n          \"n0:case\": {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\",\n              \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n            },\n            \"n0:create\": {\n              \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n              \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n              \"n0:case_type\": \"coffee_pr_2022_training_session\"\n            },\n            \"n0:update\": {\n              \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n              \"n0:Date\": new Date().toISOString(),\n              \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n              \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n              \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n              \"n0:Session_Status\": dataValue(\"sessionStatus\")(state),\n              \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state)\n            },\n            \"n0:index\":  {\n              \"n0:parent\" : {\n                \"@\": {\n                  \"case_type\": \"coffee_pr_2022_training_group\"\n                },\n                \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n              }\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"sessionId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"867066029216796\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"mjuma\",\n          \"n2:userID\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---PR-2022---SalesForce----CommCare---Training-Sessions": {
          "enabled": true,
          "id": "bd032c85-39d7-48d4-9524-38fe4a3d9cf2",
          "target_job_id": "1dcdcbcb-f5fd-4c50-b363-70947b82a071",
          "source_trigger_id": "043a9061-3dc6-4875-aee2-2a728c94ad14",
          "condition_type": "js_expression",
          "condition_label": "Coffee PR 2022  SalesForce CommCare Training Sessions",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_puerto_rico_2022\""
        }
      }
    },
    "Coffee---ZW-IFC-2024C---SalesForce----CommCare---Training-Sessions": {
      "id": "4e6359a7-0a34-4a58-b320-90e0c5d7870e",
      "name": "Coffee - ZW IFC 2024C - SalesForce -- CommCare - Training Sessions",
      "inserted_at": "2025-03-20T03:44:07.956325Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "4ec0a12c-f838-4841-9591-5f40c1903e4c",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---ZW-IFC-2024C---SalesForce----CommCare---Training-Sessions": {
          "id": "b1425bcb-b6d2-4f95-b3c0-f12dc8419b7c",
          "name": "Coffee - ZW IFC 2024C - SalesForce -- CommCare - Training Sessions",
          "body": "// Your job goes here.\neach(\n    \"$.data.trainingSessions[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"name\": \"New Training Session\",\n            \"uiVersion\": \"1\",\n            \"version\": \"148\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n          };\n        }),\n        field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n        field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n        field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n        field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n        field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n        field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n        field(\"Current_Previous_Name\", function(state){\n          return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n        }),\n        field(\"Training_Session_Name\", function(state) {\n          return (\n            dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n          );\n        }),\n        field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n        field(\"Case_Id\", dataValue(\"sessionId\")),\n        field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n        field(\"subcase_0\", function(state) {\n          return {\n            \"n0:case\": {\n              \"@\": {\n                \"case_id\": dataValue(\"sessionId\")(state),\n                \"date_modified\": new Date().toISOString(),\n                \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n                \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n              },\n              \"n0:create\": {\n                \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n                \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n                \"n0:case_type\": \"coffee_zw_2024c_training_session\"\n              },\n              \"n0:update\": {\n                \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n                \"n0:Date\": new Date().toISOString(),\n                \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n                \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n                \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n                \"n0:Current_Previous_Name\": function(){\n                  return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n                },\n                \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n                \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n                \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n                \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n                \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n              },\n              \"n0:index\":  {\n                \"n0:parent\" : {\n                  \"@\": {\n                    \"case_type\": \"coffee_zw_2024c_training_group\"\n                  },\n                  \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n                }\n              }\n            }\n          };\n        }),\n        field(\"n1:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n            }\n          };\n        }),\n        field(\"n2:meta\", function(state) {\n          return {\n            \"@\": {\n              \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n            },\n            \"n2:deviceID\": \"867066029216796\",\n            \"n2:timeStart\": new Date().toISOString(),\n            \"n2:timeEnd\": new Date().toISOString(),\n            \"n2:username\": \"api\",\n            \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---ZW-IFC-2024C---SalesForce----CommCare---Training-Sessions": {
          "enabled": true,
          "id": "075ada8d-d020-4ff0-901b-5b277b264158",
          "target_job_id": "b1425bcb-b6d2-4f95-b3c0-f12dc8419b7c",
          "source_trigger_id": "4ec0a12c-f838-4841-9591-5f40c1903e4c",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW IFC 2024C SalesForce CommCare Training Sessions",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zw_2024c\""
        }
      }
    },
    "Coffee---ZW-Nespresso--Ag----c2---SalesForce----CommCare---Project-Roles": {
      "id": "135247a1-0648-4f74-a84f-a99183fd1c03",
      "name": "Coffee - ZW Nespresso -Ag- - c2 - SalesForce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.961870Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "fed8fbbf-335b-4a97-bd66-357776c31e66",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---ZW-Nespresso--Ag----c2---SalesForce----CommCare---Project-Roles": {
          "id": "40fd490a-cd12-42de-a943-212b9f38ac72",
          "name": "Coffee - ZW Nespresso -Ag- - c2 - SalesForce -- CommCare - Project Roles",
          "body": "//Coffee - ZW Nespresso (Ag) - c2 | SalesForce --> CommCare | Project Roles\n//coffee_zim_c2_agronomy\n//{\"uniqueProjectKey\":\"coffee_zim_c2_agronomy\",\"source\":\"SF\",\"jobType\":\"Project Role\"}\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"FFGs_Observed\", null),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_zim_c2_ag_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFGs_Observed\": null\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---ZW-Nespresso--Ag----c2---SalesForce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "a86c9be8-3f14-4f96-a373-567864b1ea48",
          "target_job_id": "40fd490a-cd12-42de-a943-212b9f38ac72",
          "source_trigger_id": "fed8fbbf-335b-4a97-bd66-357776c31e66",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW Nespresso Ag c2 SalesForce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zim_c2_ag\""
        }
      }
    },
    "Coffee---ZW-Nespresso--Ag----c2---SalesForce----CommCare---Training-Sessions": {
      "id": "9840b111-f5c3-4451-9bab-1228f64a8ca6",
      "name": "Coffee - ZW Nespresso -Ag- - c2 - SalesForce -- CommCare - Training Sessions",
      "inserted_at": "2025-03-20T03:44:07.968077Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "c9fc89bb-bf65-4521-9b24-17a9ac024820",
          "type": "webhook"
        }
      },
      "jobs": {
        "Coffee---ZW-Nespresso--Ag----c2---SalesForce----CommCare---Training-Sessions": {
          "id": "6126fd5e-5bf4-4639-94af-877f88224bdd",
          "name": "Coffee - ZW Nespresso -Ag- - c2 - SalesForce -- CommCare - Training Sessions",
          "body": "//Coffee - ZW C1 - C2018 | SalesForce --> CommCare | Training Sessions\n//{\"jobType\":\"Training Session\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_zim_c2_ag\"}\n\n\neach(\n    \"$.data.trainingSessions[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"name\": \"New Training Session\",\n            \"uiVersion\": \"1\",\n            \"version\": \"148\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n          };\n        }),\n        field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n        field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n        field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n        field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n        field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n        field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n        field(\"Current_Previous_Name\", function(state){\n          return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n        }),\n        field(\"Training_Session_Name\", function(state) {\n          return (\n            dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n          );\n        }),\n        field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n        field(\"Case_Id\", dataValue(\"sessionId\")),\n        field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n        field(\"subcase_0\", function(state) {\n          return {\n            \"n0:case\": {\n              \"@\": {\n                \"case_id\": dataValue(\"sessionId\")(state),\n                \"date_modified\": new Date().toISOString(),\n                \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n                \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n              },\n              \"n0:create\": {\n                \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n                \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n                \"n0:case_type\": \"coffee_zim_c2_ag_training_session\"\n              },\n              \"n0:update\": {\n                \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n                \"n0:Date\": new Date().toISOString(),\n                \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n                \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n                \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n                \"n0:Current_Previous_Name\": function(){\n                  return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n                },\n                \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n                \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n                \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n                \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n                \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n              },\n              \"n0:index\":  {\n                \"n0:parent\" : {\n                  \"@\": {\n                    \"case_type\": \"coffee_zim_c2_ag_training_group\"\n                  },\n                  \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n                }\n              }\n            }\n          };\n        }),\n        field(\"n1:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n            }\n          };\n        }),\n        field(\"n2:meta\", function(state) {\n          return {\n            \"@\": {\n              \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n            },\n            \"n2:deviceID\": \"867066029216796\",\n            \"n2:timeStart\": new Date().toISOString(),\n            \"n2:timeEnd\": new Date().toISOString(),\n            \"n2:username\": \"api\",\n            \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Coffee---ZW-Nespresso--Ag----c2---SalesForce----CommCare---Training-Sessions": {
          "enabled": true,
          "id": "1624222b-7c0f-48a6-acab-5555488eefb4",
          "target_job_id": "6126fd5e-5bf4-4639-94af-877f88224bdd",
          "source_trigger_id": "c9fc89bb-bf65-4521-9b24-17a9ac024820",
          "condition_type": "js_expression",
          "condition_label": "Coffee ZW Nespresso Ag c2 SalesForce CommCare Training Sessions",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zim_c2_ag\""
        }
      }
    },
    "Production---Coffee-DRC-GCA-Kabare-C2023---SalesForce----CommCare---Training-Groups": {
      "id": "03f4bb25-f8de-4466-a9f8-d4b9dcd75bba",
      "name": "Production - Coffee DRC GCA Kabare C2023 - SalesForce -- CommCare - Training Groups",
      "inserted_at": "2025-03-20T03:44:07.973109Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "e044c9b8-0d3c-4298-aa7f-8c0be6bb081f",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-DRC-GCA-Kabare-C2023---SalesForce----CommCare---Training-Groups": {
          "id": "ae663ded-6665-4fe6-b80a-a78e6cdc1795",
          "name": "Production - Coffee DRC GCA Kabare C2023 - SalesForce -- CommCare - Training Groups",
          "body": "// Training Group = CUG.\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/B9AE4CBF-B571-4038-9C90-3D5D47DFDB90\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_drc_gca_kabare_c2023_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_drc_gca_kabare_c2023_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-DRC-GCA-Kabare-C2023---SalesForce----CommCare---Training-Groups": {
          "enabled": true,
          "id": "625c1266-0a77-44fd-8049-e5375c628c6d",
          "target_job_id": "ae663ded-6665-4fe6-b80a-a78e6cdc1795",
          "source_trigger_id": "e044c9b8-0d3c-4298-aa7f-8c0be6bb081f",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee DRC GCA Kabare C2023 SalesForce CommCare Training Groups",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_drc_gca_kabare_c2023\""
        }
      }
    },
    "Production---Coffee-DRC---SalesForce----CommCare---Project-Roles": {
      "id": "e3731aef-0436-462c-a765-2cebb5ed4ce1",
      "name": "Production - Coffee DRC - SalesForce -- CommCare - Project Roles",
      "inserted_at": "2025-03-20T03:44:07.978967Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "ddbd3f89-e254-4f0b-8084-cf72f5b7733e",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-DRC---SalesForce----CommCare---Project-Roles": {
          "id": "f2505351-aa0b-4ff5-a738-635b541f11f9",
          "name": "Production - Coffee DRC - SalesForce -- CommCare - Project Roles",
          "body": "// Project Roles\n//Production - Coffee DRC | SalesForce --> CommCare | Project Roles\n\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Staff\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/332E700A-B5AC-4A20-8A8B-82CFD6DED9A7\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_drc_agr_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"mjuma\",\n          \"n1:userID\": \"f1ffc61aa02f30f7c078ddc5a95f48a9\"\n        };\n      })\n    )\n  )\n);// Your job goes here.\n\n// Version control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-DRC---SalesForce----CommCare---Project-Roles": {
          "enabled": true,
          "id": "ed7d0a39-e7e1-4c9b-91a0-69a773d66971",
          "target_job_id": "f2505351-aa0b-4ff5-a738-635b541f11f9",
          "source_trigger_id": "ddbd3f89-e254-4f0b-8084-cf72f5b7733e",
          "condition_type": "js_expression",
          "condition_label": "Production Coffee DRC SalesForce CommCare Project Roles",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_ca_svc\""
        }
      }
    },
    "Production---Coffee-ZIM---SalesForce----CommCare---Training-Participants": {
      "id": "6b6cddca-87ac-42f6-83bc-a0124fa21cb9",
      "name": "Production - Coffee ZIM - SalesForce -- CommCare - Training Participants",
      "inserted_at": "2025-03-20T03:44:07.984503Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "2ef7f577-b9f5-4744-a268-1266dc022c48",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-ZIM---SalesForce----CommCare---Training-Participants": {
          "id": "c4c85427-e276-44e1-bb38-37831d58c1c1",
          "name": "Production - Coffee ZIM - SalesForce -- CommCare - Training Participants",
          "body": "//Production - Coffee ZIM | SalesForce --> CommCare | Training Participants\n\neach(\n  \"$.data.participants[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3F3D264F-4EC7-4C56-AC43-3E4A143E6C1E\",\n          \"uiVersion\": \"1\",\n          \"version\": \"325\",\n          \"name\": \"New Participant\",\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name;\n      }),\n      field(\"First_Name\", dataValue(\"participantName\")),\n      field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n      field(\"Last_Name\", dataValue(\"participantLastName\")),\n      field(\"Age\", dataValue(\"participantAge\")),\n      field(\"Gender\", dataValue(\"participantGender\")),\n      field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n      field(\"Farmer_Id\", dataValue(\"tnsId\")),\n      field(\"Farmer_Number\", function(state){\n        var tnsId = dataValue(\"tnsId\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        return farmerNumber;\n      }),\n      field(\"Cooperative_Membership_Number\", dataValue(\"participantOtherIDNumber\")),\n      field(\"Household_Id\", dataValue(\"householdId\")),\n      field(\"Household_Number\", dataValue(\"householdName\")),\n      field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n      field(\"Status\", dataValue(\"status\")),\n      field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Name_Household_Concat\", function(state){\n        var name = '';\n        var tnsId = dataValue(\"tnsId\")(state);\n        var hhNumber = dataValue(\"householdName\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        \n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name+' '+hhNumber+'-'+farmerNumber;\n      }),\n      \n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_zim_participant\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:First_Name\": dataValue(\"participantName\")(state),\n            \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n            \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n            \"n0:Age\": dataValue(\"participantAge\")(state),\n            \"n0:Gender\": dataValue(\"participantGender\")(state),\n            \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n            \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Farmer_Number\": function(){\n              var tnsId = dataValue(\"tnsId\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              return farmerNumber;\n            },\n            \"n0:Cooperative_Membership_Number\": dataValue(\"participantOtherIDNumber\")(state),\n            \"n0:Household_Id\": dataValue(\"householdId\")(state),\n            \"n0:Household_Number\": dataValue(\"householdName\")(state),\n            \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n            \"n0:Status\": dataValue(\"status\")(state),\n            \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n            \"n0:Name_Household_Concat\": function(){\n              var name = '';\n              var tnsId = dataValue(\"tnsId\")(state);\n              var hhNumber = dataValue(\"householdName\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              \n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name+' '+hhNumber+'-'+farmerNumber;\n            },\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_zim_training-group\"\n              },\n              \"#\": dataValue(\"trainingGroupId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n1:deviceID\": \"867066029216796\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-ZIM---SalesForce----CommCare---Training-Participants": {
          "enabled": true,
          "id": "977aef23-f467-4d0f-9b81-d5eb5b6df91b",
          "target_job_id": "c4c85427-e276-44e1-bb38-37831d58c1c1",
          "source_trigger_id": "2ef7f577-b9f5-4744-a268-1266dc022c48",
          "condition_type": "js_expression",
          "condition_label": "Production - Coffee ZIM | SalesForce --> CommCare | Training Participants",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zim\""
        }
      }
    },
    "Production---Coffee-ZIM---SalesForce----CommCare---Training-Sessions": {
      "id": "e2f541bd-008d-439b-a082-71a8b7517546",
      "name": "Production - Coffee ZIM - SalesForce -- CommCare - Training Sessions",
      "inserted_at": "2025-03-20T03:44:07.989552Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "88cc8bd2-52dc-4e75-9d21-b77540cc51fd",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Coffee-ZIM---SalesForce----CommCare---Training-Sessions": {
          "id": "5ced0595-4051-4a9e-810b-eef5fd3306c4",
          "name": "Production - Coffee ZIM - SalesForce -- CommCare - Training Sessions",
          "body": "//Coffee - ZW C1 - C2018 | SalesForce --> CommCare | Training Sessions\n//{\"jobType\":\"Training Session\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_zim\"}\n\n\neach(\n    \"$.data.trainingSessions[*]\",\n    submit(\n      fields(\n        field(\"@\", function(state) {\n          return {\n            \"name\": \"New Training Session\",\n            \"uiVersion\": \"1\",\n            \"version\": \"148\",\n            \"xmlns\": \"http://openrosa.org/formdesigner/1a91006be1e0b81d4cc2ceaf84188e3db80bd955\",\n            \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n          };\n        }),\n        field(\"Session_1_Date\", dataValue(\"sessionOneDate\")),\n        field(\"Session_2_Date\", dataValue(\"sessionTwoDate\")),\n        field(\"Training_Group_Name\", dataValue(\"trainingGroupName\")),\n        field(\"Secondary_Parent_Id\", dataValue(\"trainingGroupResponsibleStaff\")),\n        field(\"Module_Name\", dataValue(\"trainingModuleName\")),\n        field(\"Module_Number\", dataValue(\"trainingModuleNumber\")),\n        field(\"Current_Previous_Name\", function(state){\n          return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n        }),\n        field(\"Training_Session_Name\", function(state) {\n          return (\n            dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state)\n          );\n        }),\n        field(\"Current_Previous\", dataValue(\"currentPrevious\")),\n        field(\"Case_Id\", dataValue(\"sessionId\")),\n        field(\"Parent_Id\", dataValue(\"trainingGroupCommCareId\")),\n        field(\"subcase_0\", function(state) {\n          return {\n            \"n0:case\": {\n              \"@\": {\n                \"case_id\": dataValue(\"sessionId\")(state),\n                \"date_modified\": new Date().toISOString(),\n                \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n                \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n              },\n              \"n0:create\": {\n                \"n0:case_name\": dataValue(\"trainingModuleNumber\")(state)+' '+dataValue(\"trainingModuleName\")(state),\n                \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n                \"n0:case_type\": \"coffee_zim_training_session\"\n              },\n              \"n0:update\": {\n                \"n0:Case_Id\": dataValue(\"sessionId\")(state),\n                \"n0:Date\": new Date().toISOString(),\n                \"n0:Module_Name\": dataValue(\"trainingModuleName\")(state),\n                \"n0:Module_Number\": dataValue(\"trainingModuleNumber\")(state),\n                \"n0:Current_Previous\": dataValue(\"currentPrevious\")(state),\n                \"n0:Current_Previous_Name\": function(){\n                  return '('+dataValue(\"currentPrevious\")(state)+') '+dataValue(\"trainingModuleName\")(state);\n                },\n                \"n0:Parent_Id\": dataValue(\"trainingGroupCommCareId\")(state),\n                \"n0:Session_1_Date\": dataValue(\"sessionOneDate\")(state),\n                \"n0:Session_2_Date\": dataValue(\"sessionTwoDate\")(state),\n                \"n0:Training_Group_Name\": dataValue(\"trainingGroupName\")(state),\n                \"n0:Secondary_Parent_Id\": dataValue(\"trainingGroupResponsibleStaff\")(state)\n              },\n              \"n0:index\":  {\n                \"n0:parent\" : {\n                  \"@\": {\n                    \"case_type\": \"coffee_zim_training_group\"\n                  },\n                  \"#\": dataValue(\"trainingGroupCommCareId\")(state)\n                }\n              }\n            }\n          };\n        }),\n        field(\"n1:case\", function(state) {\n          return {\n            \"@\": {\n              \"case_id\": dataValue(\"sessionId\")(state),\n              \"date_modified\": new Date().toISOString(),\n              \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n              \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n            }\n          };\n        }),\n        field(\"n2:meta\", function(state) {\n          return {\n            \"@\": {\n              \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n            },\n            \"n2:deviceID\": \"867066029216796\",\n            \"n2:timeStart\": new Date().toISOString(),\n            \"n2:timeEnd\": new Date().toISOString(),\n            \"n2:username\": \"api\",\n            \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n          };\n        })\n      )\n    )\n  );\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Coffee-ZIM---SalesForce----CommCare---Training-Sessions": {
          "enabled": true,
          "id": "f23a1540-ec9a-45d9-b602-d3712750df19",
          "target_job_id": "5ced0595-4051-4a9e-810b-eef5fd3306c4",
          "source_trigger_id": "88cc8bd2-52dc-4e75-9d21-b77540cc51fd",
          "condition_type": "js_expression",
          "condition_label": "Production - Coffee ZIM | SalesForce --> CommCare | Training Sessions",
          "condition_expression": "state.data.jobType == \"Training Session\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_zim\""
        }
      }
    },
    "Production---Participants---ET-CREW-C2024---SalesForce----CommCare": {
      "id": "2de17c48-2982-47c9-acf5-12317923b30b",
      "name": "Production - Participants - ET CREW C2024 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:07.995569Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "c946e860-7c77-49ff-81a6-85b239d5fe7b",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Participants---ET-CREW-C2024---SalesForce----CommCare": {
          "id": "c8c5d1ab-fc88-48e9-8dfd-e39491567ee1",
          "name": "Production - Participants - ET CREW C2024 - SalesForce -- CommCare",
          "body": "// Your job goes here.// JOB PURPOSE :: This is a job for sending Participants for Coffee - ET CREW C2024\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: ET CREW C2024\n// JOB NAME :: Production - Participants - ET CREW C2024 - SalesForce -- CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_hwg_jcp__crew_c2024\"}\n// AUTHOR :: Yves Mugenga | ymugenga@tns.org\n\neach(\n  \"$.data.participants[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3E266629-AFD8-4A1C-8825-1DCDDF24E5A8\",\n          \"uiVersion\": \"1\",\n          \"version\": \"325\",\n          \"name\": \"New Participant\",\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name;\n      }),\n      field(\"First_Name\", dataValue(\"participantName\")),\n      field(\"Middle_Name\", dataValue(\"participantMiddleName\")),\n      field(\"Last_Name\", dataValue(\"participantLastName\")),\n      field(\"Age\", dataValue(\"participantAge\")),\n      field(\"Gender\", dataValue(\"participantGender\")),\n      field(\"Phone_Number\", dataValue(\"participantPhoneNumber\")),\n      field(\"Farmer_Id\", dataValue(\"tnsId\")),\n      field(\"Farmer_Number\", function(state){\n        var tnsId = dataValue(\"tnsId\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        return farmerNumber;\n      }),\n      field(\"Cooperative_Membership_Number\", dataValue(\"participantOtherIDNumber\")),\n      field(\"Household_Id\", dataValue(\"householdId\")),\n      field(\"Household_Number\", dataValue(\"householdName\")),\n      field(\"Number_of_Trees\", dataValue(\"householdFarmSize\")),\n      field(\"Parent_Id\", dataValue(\"trainingGroupId\")),\n      field(\"Status\", dataValue(\"status\")),\n      field(\"Primary_Household_Member\", dataValue(\"participantPrimaryHouseholdMember\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Name_Household_Concat\", function(state){\n        var name = '';\n        var tnsId = dataValue(\"tnsId\")(state);\n        var hhNumber = dataValue(\"householdName\")(state);\n        var farmerNumber = tnsId.substr(tnsId.length-1,1);\n        \n        if(dataValue(\"participantName\")(state) !== null) {\n          name = dataValue(\"participantName\")(state);\n        }\n        if(dataValue(\"participantMiddleName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantMiddleName\")(state);\n        }\n        if(dataValue(\"participantLastName\")(state) !== null) {\n          name = name+' '+dataValue(\"participantLastName\")(state);\n        }\n        return name+' '+hhNumber+'-'+farmerNumber;\n      }),\n      \n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_hwg_jcp_crew_c2024_participant\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:First_Name\": dataValue(\"participantName\")(state),\n            \"n0:Middle_Name\": dataValue(\"participantMiddleName\")(state),\n            \"n0:Last_Name\": dataValue(\"participantLastName\")(state),\n            \"n0:Age\": dataValue(\"participantAge\")(state),\n            \"n0:Gender\": dataValue(\"participantGender\")(state),\n            \"n0:Phone_Number\": dataValue(\"participantPhoneNumber\")(state),\n            \"n0:Farmer_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Farmer_Number\": function(){\n              var tnsId = dataValue(\"tnsId\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              return farmerNumber;\n            },\n            \"n0:Cooperative_Membership_Number\": dataValue(\"participantOtherIDNumber\")(state),\n            \"n0:Household_Id\": dataValue(\"householdId\")(state),\n            \"n0:Household_Number\": dataValue(\"householdName\")(state),\n            \"n0:Number_of_Trees\": dataValue(\"householdFarmSize\")(state),\n            \"n0:Status\": dataValue(\"status\")(state),\n            \"n0:Primary_Household_Member\": dataValue(\"participantPrimaryHouseholdMember\")(state),\n            \"n0:Name_Household_Concat\": function(){\n              var name = '';\n              var tnsId = dataValue(\"tnsId\")(state);\n              var hhNumber = dataValue(\"householdName\")(state);\n              var farmerNumber = tnsId.substr(tnsId.length-1,1);\n              \n              if(dataValue(\"participantName\")(state) !== null) {\n                name = dataValue(\"participantName\")(state);\n              }\n              if(dataValue(\"participantMiddleName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantMiddleName\")(state);\n              }\n              if(dataValue(\"participantLastName\")(state) !== null) {\n                name = name+' '+dataValue(\"participantLastName\")(state);\n              }\n              return name+' '+hhNumber+'-'+farmerNumber;\n            },\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Parent_Id\": dataValue(\"trainingGroupId\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_et_hwg_jcp_crew_c2024_training_group\"\n              },\n              \"#\": dataValue(\"trainingGroupId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n1\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n1:deviceID\": \"867066029216796\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Participants---ET-CREW-C2024---SalesForce----CommCare": {
          "enabled": true,
          "id": "586f0da0-e62f-42f4-ab0c-119d3bb3b9cb",
          "target_job_id": "c8c5d1ab-fc88-48e9-8dfd-e39491567ee1",
          "source_trigger_id": "c946e860-7c77-49ff-81a6-85b239d5fe7b",
          "condition_type": "js_expression",
          "condition_label": "Production Participants CREW C2024 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Participant\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_hwg_jcp_crew_c2024\""
        }
      }
    },
    "Production---Project-Role---ET-HWG-JCP-C2023---SalesForce----CommCare": {
      "id": "611dd541-b8bf-4ae0-aa61-39acbfccedcd",
      "name": "Production - Project Role - ET HWG JCP C2023 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:08.000686Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "b1b97027-5350-4cc4-b356-a2b9c983a47e",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Project-Role---ET-HWG-JCP-C2023---SalesForce----CommCare": {
          "id": "8d339099-dff2-4e7c-bf64-488e4412284c",
          "name": "Production - Project Role - ET HWG JCP C2023 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending project roles for Coffee Herz Cohort 2023\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET HWG JCP coffee_et_hwg_jcp_c2023_staff\n// JOB NAME :: Production | Project Role - ET HWG JCP C2023 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_hwg_jcp_c2023\"}\n// AUTHOR ::  Yves Mugenga| ymugenga@tns.org\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/CBD34B15-1442-4548-9B2D-C9937E3CB347\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"FFGs_Observed\", null),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_hwg_jcp_c2023_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:FFGs_Observed\": null,\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Project-Role---ET-HWG-JCP-C2023---SalesForce----CommCare": {
          "enabled": true,
          "id": "b8d842d2-be7f-46b8-b9ab-68e0ed57f3a4",
          "target_job_id": "8d339099-dff2-4e7c-bf64-488e4412284c",
          "source_trigger_id": "b1b97027-5350-4cc4-b356-a2b9c983a47e",
          "condition_type": "js_expression",
          "condition_label": "Production Project Role ET HWG JCP C2023 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_hwg_jcp_c2023\""
        }
      }
    },
    "Production---Project-Role---ET-HWG-JCP-CREW-C2024---SalesForce----CommCare": {
      "id": "4385c594-7d9d-48b5-958b-9cf5f578b318",
      "name": "Production - Project Role - ET HWG JCP CREW C2024 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:08.006018Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "6ef11418-b49e-4d73-bbe5-7bae0880d53a",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Project-Role---ET-HWG-JCP-CREW-C2024---SalesForce----CommCare": {
          "id": "29c86cba-9f19-4b2b-8894-c7fbb4859785",
          "name": "Production - Project Role - ET HWG JCP CREW C2024 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending project roles for Coffee Herz Cohort 2022\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET HWG JCP CREW C2024\n// JOB NAME :: Production | Project Role - ET HWG JCP CREW C2024 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_hwg_jcp_crew_c2024\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/CBD34B15-1442-4548-9B2D-C9937E3CB347\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"FFGs_Observed\", null),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_hwg_jcp_crew_c2024_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:FFGs_Observed\": null,\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Project-Role---ET-HWG-JCP-CREW-C2024---SalesForce----CommCare": {
          "enabled": true,
          "id": "8cc1ffdb-53e6-4ea4-aff8-b8cf0bd225dd",
          "target_job_id": "29c86cba-9f19-4b2b-8894-c7fbb4859785",
          "source_trigger_id": "6ef11418-b49e-4d73-bbe5-7bae0880d53a",
          "condition_type": "js_expression",
          "condition_label": "Production Project Role ET HWG CREW JCP C2024 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_hwg_jcp_crew_c2024\""
        }
      }
    },
    "Production---Project-Role---ET-Regrow-YG--Ag--C2023---SalesForce----CommCare": {
      "id": "856793ef-e498-46f9-96e9-5e6f2d6c685a",
      "name": "Production - Project Role - ET Regrow YG -Ag- C2023 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:08.011434Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "e3921e40-53a3-4070-b790-fc8665b8ab16",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Project-Role---ET-Regrow-YG--Ag--C2023---SalesForce----CommCare": {
          "id": "8f1919f3-7e83-4d6a-b81e-2806a1bb6bb1",
          "name": "Production - Project Role - ET Regrow YG -Ag- C2023 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending project roles for Coffee ET Yirga Regrow 2022C\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET Regrow Yirga (Ag) C2023\n// JOB NAME :: Production | Project Role - ET Regrow YG (Ag) C2023 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Project Role\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_regrow_ag_c2\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n// EDITED :: Emmanuel Mwaka | emwaka@tns.org\n\neach(\n  \"$.data.projectRoles[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Project Role\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/CBD34B15-1442-4548-9B2D-C9937E3CB347\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        return name;\n      }),\n      field(\"TNS_Id\", dataValue(\"tnsId\")),\n      field(\"City\", dataValue(\"locationName\")),\n      field(\"Role\", dataValue(\"roleForCommCare\")),\n      field(\"Case_Id\", dataValue(\"commCareCaseId\")),\n      field(\"Current_Module\", dataValue(\"currentModule\")),\n      field(\"Current_Module_Name\", dataValue(\"currentModuleName\")),\n      field(\"Previous_Module\", dataValue(\"previousModule\")),\n      field(\"Previous_Module_Name\", dataValue(\"previousModuleName\")),\n      field(\"FFGs_Observed\", null),\n      field(\"Name_id_concat\", function(state){\n        var name = '';\n        if(dataValue(\"staffName\")(state) !== null) {\n          name = dataValue(\"staffName\")(state);\n        }\n        if(dataValue(\"tnsId\")(state) !== null) {\n          name = name+' '+dataValue(\"tnsId\")(state);\n        }\n        return name;\n      }),\n      field(\"Salesforce_Staff_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"commCareCaseId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": function(){\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              return name;\n            },\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_regrow_ag_c2_staff\"\n          },\n          \"n0:update\": {\n            \"n0:Case_Id\": dataValue(\"commCareCaseId\")(state),\n            \"n0:Name_Id_Concat\": function() {\n              var name = '';\n              if(dataValue(\"staffName\")(state) !== null) {\n                name = dataValue(\"staffName\")(state);\n              }\n              if(dataValue(\"tnsId\")(state) !== null) {\n                name = name+' '+dataValue(\"tnsId\")(state);\n              }\n              return name;\n            },\n            \"n0:Role\": dataValue(\"roleForCommCare\")(state),\n            \"n0:City\": dataValue(\"locationName\")(state),\n            \"n0:TNS_Id\": dataValue(\"tnsId\")(state),\n            \"n0:Current_Module\": dataValue(\"currentModule\")(state),\n            \"n0:Current_Module_Name\": dataValue(\"currentModuleName\")(state),\n            \"n0:Previous_Module\": dataValue(\"previousModule\")(state),\n            \"n0:Previous_Module_Name\": dataValue(\"previousModuleName\")(state),\n            \"n0:FFGs_Observed\": null,\n            \"n0:Salesforce_Staff_Id\": dataValue(\"staffId\")(state)\n          }\n        };\n      }),\n      field(\"n1:meta\", function(state) {\n        return {\n          \"@\": {\"xmlns:n1\": \"http://openrosa.org/jr/xforms\"},\n          \"n1:deviceID\": \"tiny_little_openfn_robots_with_impeccable_moustaches\",\n          \"n1:timeStart\": new Date().toISOString(),\n          \"n1:timeEnd\": new Date().toISOString(),\n          \"n1:username\": \"api\",\n          \"n1:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@v1.5.1",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Project-Role---ET-Regrow-YG--Ag--C2023---SalesForce----CommCare": {
          "enabled": true,
          "id": "20ef504d-e74b-4ce5-94f0-6f1dba256b92",
          "target_job_id": "8f1919f3-7e83-4d6a-b81e-2806a1bb6bb1",
          "source_trigger_id": "e3921e40-53a3-4070-b790-fc8665b8ab16",
          "condition_type": "js_expression",
          "condition_label": "Production Project Roles Regrow Yirga C2023 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Project Role\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_regrow_ag_c2\""
        }
      }
    },
    "Production---Training-Groups---ET-GAC-CREW-C2025---SalesForce----CommCare": {
      "id": "0b326b15-e080-4d83-9fc6-faf77932b8d4",
      "name": "Production - Training Groups - ET GAC CREW C2025 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:08.016828Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "d6b389e1-35c2-47de-ab54-3b98a9af8023",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Training-Groups---ET-GAC-CREW-C2025---SalesForce----CommCare": {
          "id": "8fe02796-c965-488c-ac48-4a3ed2321dd2",
          "name": "Production - Training Groups - ET GAC CREW C2025 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending training groups for Coffee - ET GAC CREW C2025\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET GAC CREW C2025\n// JOB NAME :: Production | Training Groups - ET HWG GAC C2025 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_hwg_jcp_crew_c2025\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_hwg_jcp_crew_c2025_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_et_hwg_jcp_crew_c2025_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Training-Groups---ET-GAC-CREW-C2025---SalesForce----CommCare": {
          "enabled": true,
          "id": "16430d60-9310-4406-8d8e-e52ed4f1b271",
          "target_job_id": "8fe02796-c965-488c-ac48-4a3ed2321dd2",
          "source_trigger_id": "d6b389e1-35c2-47de-ab54-3b98a9af8023",
          "condition_type": "js_expression",
          "condition_label": "Production Training Groups ET GAC CREW C2025 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_hwg_jcp_crew_c2025\""
        }
      }
    },
    "Production---Training-Groups---ET-HWG-JCP-CREW-C2024---SalesForce----CommCare": {
      "id": "3e057763-af14-4705-916e-45ca7b7a615d",
      "name": "Production - Training Groups - ET HWG JCP CREW C2024 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:08.023013Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "b3a7afc8-82aa-497c-a8c4-08f15596d6ee",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Training-Groups---ET-HWG-JCP-CREW-C2024---SalesForce----CommCare": {
          "id": "9565d638-2642-4b08-beea-49df9be7aca0",
          "name": "Production - Training Groups - ET HWG JCP CREW C2024 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending training groups for Coffee - ET HWG JCP CREW C2024\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET HWG JCP CREW C2024\n// JOB NAME :: Production | Training Groups - ET HWG JCP CREW C2024 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_hwg_jcp_crew_c2024\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_hwg_jcp_crew_c2024_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_et_hwg_jcp_crew_c2024_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Training-Groups---ET-HWG-JCP-CREW-C2024---SalesForce----CommCare": {
          "enabled": true,
          "id": "7ca2c59b-5de2-4b41-ba39-64ce0caa77fc",
          "target_job_id": "9565d638-2642-4b08-beea-49df9be7aca0",
          "source_trigger_id": "b3a7afc8-82aa-497c-a8c4-08f15596d6ee",
          "condition_type": "js_expression",
          "condition_label": "Production Training Groups ET HWG JCP CREW C2024 SalesForce CommCare",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_hwg_jcp_crew_c2024\""
        }
      }
    },
    "Production---Training-Groups---ET-Regrow-YG--Ag-C2024---SalesForce----CommCare": {
      "id": "a5513715-a64f-4389-9ce7-00d29044b641",
      "name": "Production - Training Groups - ET Regrow YG -Ag C2024 - SalesForce -- CommCare",
      "inserted_at": "2025-03-20T03:44:08.028866Z",
      "lock_version": 3,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "d530f4f7-1e97-4330-9bce-39ae9de7dc6b",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Training-Groups---ET-Regrow-YG--Ag-C2024---SalesForce----CommCare": {
          "id": "fbc3b3b4-4374-4158-bfb0-79ab31f2c645",
          "name": "Production - Training Groups - ET Regrow YG -Ag C2024 - SalesForce -- CommCare",
          "body": "// JOB PURPOSE :: This is a job for sending training groups for Coffee ET - Regrow Yirga Agronomy C2024\n// DATA FLOW :: Salesforce --> TO --> CommCare\n// TARGET APPS :: Coffee - ET Regrow Yirga (Ag) C2024\n// JOB NAME :: Production | Training Groups - ET Regrow YG (Ag) C2024 | SalesForce --> CommCare\n// JOB TRIGGER :: {\"jobType\":\"Training Group\",\"source\":\"SF\",\"uniqueProjectKey\":\"coffee_et_regrow_ag_c3\"}\n// AUTHOR :: Mathew Juma | mjuma@tns.org\n\neach(\n  \"$.data.trainingGroups[*]\",\n  submit(\n    fields(\n      field(\"@\", function(state) {\n        return {\n          \"name\": \"New Training Group\",\n          \"uiVersion\": \"1\",\n          \"version\": \"1\",\n          \"xmlns\": \"http://openrosa.org/formdesigner/3FA54AF1-A35E-4163-BDB0-5094F709753C\",\n          \"xmlns:jrm\": \"http://dev.commcarehq.org/jr/xforms\"\n        };\n      }),\n      field(\"Name\", dataValue(\"trainingGroupName\")),\n      field(\"FFG_Number\", dataValue(\"tnsId\")),\n      field(\"Location\", dataValue(\"locationName\")),\n      field(\"Measurement_Group\", dataValue(\"measurementGroup\")),\n      field(\"Cooperative_ID\", dataValue(\"cooperative\")),\n      field(\"Household_Counter\", dataValue(\"householdCounter\")),\n      field(\"Name_Id_Concat\", function(state) {\n        return (\n          //dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state)\n          dataValue(\"trainingGroupName\")(state)\n        );\n      }),\n      field(\"Parent_Id\", dataValue(\"staffId\")),\n      field(\"n0:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n0\": \"http://commcarehq.org/case/transaction/v2\"\n          },\n          \"n0:create\": {\n            \"n0:case_name\": dataValue(\"trainingGroupName\")(state),\n            \"n0:owner_id\": dataValue(\"ccMobileWorkerGroupId\")(state),\n            \"n0:case_type\": \"coffee_et_regrow_ag_c3_training_group\"\n          },\n          \"n0:update\": {\n            \"n0:Location\": dataValue(\"locationName\")(state),\n            \"n0:Market\": dataValue(\"market\")(state),\n            \"n0:Household_Counter\": dataValue(\"householdCounter\")(state),\n            \"n0:Name_Id_Concat\": function(){\n              //var name = dataValue(\"trainingGroupName\")(state)+' '+dataValue(\"tnsId\")(state);\n              var name = dataValue(\"trainingGroupName\")(state);\n              return name;\n            },\n            \"n0:Parent_Id\": dataValue(\"staffId\")(state),\n            \"n0:FFG_Number\": dataValue(\"tnsId\")(state),\n            \"n0:Measurement_Group\": dataValue(\"measurementGroup\")(state),\n            \"n0:Cooperative_ID\": dataValue(\"cooperative\")(state)\n          },\n          \"n0:index\": {\n            \"n0:parent\" : {\n              \"@\": {\n                \"case_type\": \"coffee_et_regrow_ag_c3_staff\"\n              },\n              \"#\": dataValue(\"staffId\")(state)\n            }\n          }\n        };\n      }),\n      field(\"n1:case\", function(state) {\n        return {\n          \"@\": {\n            \"case_id\": dataValue(\"trainingGroupId\")(state),\n            \"date_modified\": new Date().toISOString(),\n            \"user_id\": \"e926526fc13b126fffdb6d001f25b269\",\n            \"xmlns:n1\": \"http://commcarehq.org/case/transaction/v2\"\n          }\n        };\n      }),\n      field(\"n2:meta\", function(state) {\n        return {\n          \"@\": {\n            \"xmlns:n2\": \"http://openrosa.org/jr/xforms\"\n          },\n          \"n2:deviceID\": \"PIMA API\",\n          \"n2:timeStart\": new Date().toISOString(),\n          \"n2:timeEnd\": new Date().toISOString(),\n          \"n2:username\": \"api\",\n          \"n2:userID\": \"e926526fc13b126fffdb6d001f25b269\"\n        };\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-commcare@latest",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Production---Training-Groups---ET-Regrow-YG--Ag-C2024---SalesForce----CommCare": {
          "enabled": true,
          "id": "0f50aaf8-fbdc-4a91-8607-8acc302158e0",
          "target_job_id": "fbc3b3b4-4374-4158-bfb0-79ab31f2c645",
          "source_trigger_id": "d530f4f7-1e97-4330-9bce-39ae9de7dc6b",
          "condition_type": "js_expression",
          "condition_label": "Production Training Groups Regrow Yirga C2024 Salesforce CommCare",
          "condition_expression": "state.data.jobType == \"Training Group\" && state.data.source == \"SF\" && state.data.uniqueProjectKey == \"coffee_et_regrow_ag_c3\""
        }
      }
    },
    "Global---Training-Attendance---CommCare----SalesForce": {
      "id": "3d0fb905-e6ac-457f-9452-8352f8d886e5",
      "name": "Global - Training Attendance - CommCare -- SalesForce",
      "inserted_at": "2025-03-20T15:31:51.373046Z",
      "lock_version": 4,
      "triggers": {
        "webhook": {
          "enabled": false,
          "id": "d7de32ad-e275-479b-bc25-1c2450d845fc",
          "type": "webhook"
        }
      },
      "jobs": {
        "Global---Training-Attendance---CommCare----SalesForce": {
          "id": "1afdacaf-4e35-4363-9a17-264713404586",
          "name": "Global - Training Attendance - CommCare -- SalesForce",
          "body": "//Coffee - ZW C2021 | Training Attendance | CommCare --> SalesForce\n\n//ATTENDANCE REGISTRATION JOB {COMMCARE TO SALESFORCE}\neach(\n  \"$.data\",\n  upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n    fields(\n      field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n      field(\"Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Number_in_Attendance__c\", dataValue(\"form.attendance_count\")),\n      field(\"Session_Photo_URL__c\", function(state) {\n          var photoUrl = '';\n          if(dataValue(\"form.photo\")(state) !== undefined && dataValue(\"form.photo\")(state) !== '') {\n            photoUrl = \"https://www.commcarehq.org/a/\"+dataValue(\"domain\")(state)+\"/api/form/attachment/\"+dataValue(\"form.meta.instanceID\")(state)+\"/\"+dataValue(\"form.photo\")(state);  \n          }\n          return photoUrl;\n      }),\n      field(\"Date__c\", dataValue(\"form.date\")),\n      field('Location_GPS__Latitude__s', (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[0];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return '';\n      }),\n      field('Location_GPS__Longitude__s', (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[1];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return '';\n      }),\n      field('Altitude__c', (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[2];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return '';\n      })\n      )\n    )\n  );\n\nbeta.each(\n  function(state) {\n    if (state.data.form.present_participants) {\n      return state.data.form.present_participants.split(\" \").map(\n        function(pId) {\n          return {\n            participant: pId,\n            session: dataValue(\"form.training_session\")(state),\n            submission: dataValue(\"form.training_session\")(state)+pId,\n            sessionPhoto: dataValue(\"form.photo\")(state)\n          };\n        }\n      );\n    }\n  },\n  upsert(\"Attendance__c\", \"Submission_ID__c\",\n    fields(\n      field(\"Submission_ID__c\", dataValue(\"submission\")),\n      field(\"Status__c\", \"Present\"),\n      relationship(\"Training_Session__r\", \"CommCare_Case_Id__c\", dataValue(\"session\")),\n      relationship(\"Participant__r\", \"CommCare_Case_Id__c\", dataValue(\"participant\"))\n    )\n  )\n);\neach(\n  \"$.data\",\n  upsert(\"Training_Session__c\", \"CommCare_Case_Id__c\",\n    fields(\n      field(\"CommCare_Case_Id__c\", dataValue(\"form.training_session\")),\n      field(\"Updated_from_CommCare__c\", true)\n    )\n  )\n);\n\n//Version Control\n",
          "adaptor": "@openfn/language-salesforce@5.0.5",
          "project_credential_id": null
        }
      },
      "edges": {
        "webhook->Global---Training-Attendance---CommCare----SalesForce": {
          "enabled": true,
          "id": "541d9651-0a0f-4e82-af16-bd8cc667538e",
          "target_job_id": "1afdacaf-4e35-4363-9a17-264713404586",
          "source_trigger_id": "d7de32ad-e275-479b-bc25-1c2450d845fc",
          "condition_type": "js_expression",
          "condition_label": "Global Training Attendance CommCare SalesForce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Training Attendance\" && state.data[\"app_id\"] == \"5096d2fa0ab840ffaaa62e7736cfecdd\""
        }
      }
    },
    "Production---Farm-Visit----ET-All---CommCare----Salesforce": {
      "id": "e11767b7-dcde-47f0-a8ca-167c832d19f4",
      "name": "Production - Farm Visit -- ET All - CommCare -- Salesforce",
      "inserted_at": "2025-03-24T04:29:07.999958Z",
      "lock_version": 7,
      "triggers": {
        "webhook": {
          "enabled": true,
          "id": "da2d1993-127d-444e-be66-45e2196b3804",
          "type": "webhook"
        }
      },
      "jobs": {
        "Production---Farm-Visit----ET-All---CommCare----Salesforce": {
          "id": "78e98440-2f51-420b-80a4-d2e051a4f332",
          "name": "Production - Farm Visit -- ET All - CommCare -- Salesforce",
          "body": "//insert the farm visit record - FT Level\neach(\n  \"$.data\",\n  upsertIf(\n    state.data.form['@name'] == 'Farm Visit Full',\n    \"Farm_Visit__c\",\n    \"FV_Submission_ID__c\",\n    fields(\n      field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n      field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n      field(\"Farm_Visit_Type__c\", dataValue(\"form.survey_type\")),\n      field(\"Training_Group__c\", dataValue(\"form.case.@case_id\")),\n      field(\"Farm_Visited__c\", dataValue(\"form.farm_being_visted\")),\n      field(\"Primary_Farmer_PIMA_ID__c\", dataValue(\"form.farm_being_visted\")),\n      field(\"Secondary_Farmer__c\", function (state) {\n        var secondaryFarmer = \"\";\n        if (\n          dataValue(\"form.secondary_farmer_available\")(state) == \"yes\" &&\n          dataValue(\"form.secondary_farmer\")(state) !== \"\"\n        ) {\n          secondaryFarmer = dataValue(\"form.secondary_farmer\");\n        }\n        return secondaryFarmer;\n      }),\n      field(\"Secondary_Farmer_PIMA_ID__c\", function (state) {\n        var secondaryFarmer = \"\";\n        if (\n          dataValue(\"form.secondary_farmer_available\")(state) == \"yes\" &&\n          dataValue(\"form.secondary_farmer\")(state) !== \"\"\n        ) {\n          secondaryFarmer = dataValue(\"form.secondary_farmer\");\n        }\n        return secondaryFarmer;\n      }),\n      field(\n        \"Visit_Has_Training__c\",\n        dataValue(\"form.is_this_a_farm_training_visit\")\n      ),\n      field(\"Training_Session__c\", dataValue(\"form.training_session\")),\n      field(\"Total_Farmers_Visited__c\", dataValue(\"form.attendance_count\")),\n      field(\"Date_Visited__c\", dataValue(\"form.date_of_visit\")),\n      field(\"visit_comments__c\", dataValue(\"form.farm_visit_comments\")),\n      field(\"Farmer_Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Farm_Visit_Photo_Url__c\", function (state) {\n        var farmVisitPhotoUrl = \"\";\n        if (\n          dataValue(\"form.farm_visit_photo\")(state) !== undefined &&\n          dataValue(\"form.farm_visit_photo\")(state) !== \"\"\n        ) {\n          farmVisitPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.farm_visit_photo\")(state);\n        }\n        return farmVisitPhotoUrl;\n      }),\n      field(\"Signature__c\", function (state) {\n        var recorderSignatureUrl = \"\";\n        if (\n          dataValue(\"form.signature_of_farmer_trainer\")(state) !== undefined &&\n          dataValue(\"form.signature_of_farmer_trainer\")(state) !== \"\"\n        ) {\n          recorderSignatureUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.signature_of_farmer_trainer\")(state);\n        }\n        return recorderSignatureUrl;\n      }),\n      field(\"Location_GPS__Latitude__s\", (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.best_practice_questions.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[0];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return \"\";\n      }),\n      field(\"Location_GPS__Longitude__s\", (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.best_practice_questions.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[1];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return \"\";\n      }),\n      field(\"Altitude__c\", (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.best_practice_questions.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[2];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return \"\";\n      })\n    )\n  )\n);\n\n//insert the farm visit record\neach(\n  \"$.data\",\n  upsertIf(\n    state.data.form['@name'] == 'Farm Visit - AA',\n    \"Farm_Visit__c\",\n    \"FV_Submission_ID__c\",\n    fields(\n      field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n      field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n      field(\"Farm_Visit_Type__c\", dataValue(\"form.survey_type\")),\n      field(\"Training_Group__c\", dataValue(\"form.training_group\")),\n      relationship(\"Farm_Visited__r\", \"CommCare_Case_Id__c\", function(state){\n          const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n          if(visitedFarmers){\n            return visitedFarmers.split(\" \")[0];\n          }\n        }),\n        field(\"Primary_Farmer_PIMA_ID__c\", function(state){\n          const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n          if(visitedFarmers){\n            return visitedFarmers.split(\" \")[0];\n          }\n        }),\n      field(\n        \"Visit_Has_Training__c\",\n        dataValue(\"form.is_this_a_farm_training_visit\")\n      ),\n      // relationship(\"Secondary_Farmer__r\", \"CommCare_Case_Id__c\", function(state){\n      //   const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n      //   var result = null;\n      //   if(visitedFarmers.length > 1){\n      //     result = visitedFarmers.split(\" \")[1];\n      //   }\n      //   return result;\n      // }),\n      \n      // field(\"Secondary_Farmer_PIMA_ID__c\", function(state){\n      //   const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n      //   var result = null;\n      //   if(visitedFarmers.length > 1){\n      //     result = visitedFarmers.split(\" \")[1];\n      //   }\n      //   return result;\n      // }),\n      field(\"Training_Session__c\", dataValue(\"form.training_session\")),\n      field(\"Total_Farmers_Visited__c\", dataValue(\"form.attendance_count\")),\n      field(\"Date_Visited__c\", dataValue(\"form.date_of_visit\")),\n      field(\"visit_comments__c\", dataValue(\"form.farm_visit_comments\")),\n      field(\"Farmer_Trainer__c\", dataValue(\"form.trainer\")),\n      field(\"Farm_Visit_Photo_Url__c\", function (state) {\n        var farmVisitPhotoUrl = \"\";\n        if (\n          dataValue(\"form.farm_visit_photo\")(state) !== undefined &&\n          dataValue(\"form.farm_visit_photo\")(state) !== \"\"\n        ) {\n          farmVisitPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.farm_visit_photo\")(state);\n        }\n        return farmVisitPhotoUrl;\n      }),\n      field(\"Signature__c\", function (state) {\n        var recorderSignatureUrl = \"\";\n        if (\n          dataValue(\"form.signature_of_farmer_trainer\")(state) !== undefined &&\n          dataValue(\"form.signature_of_farmer_trainer\")(state) !== \"\"\n        ) {\n          recorderSignatureUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\"form.signature_of_farmer_trainer\")(state);\n        }\n        return recorderSignatureUrl;\n      }),\n      field(\"Location_GPS__Latitude__s\", (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.best_practice_questions.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[0];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return \"\";\n      }),\n      field(\"Location_GPS__Longitude__s\", (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.best_practice_questions.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[1];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return \"\";\n      }),\n      field(\"Altitude__c\", (state) => {\n        // define this once, it's constant...\n        const coords = state.data.form.best_practice_questions.gps_coordinates;\n        // write your contional\n        if (coords) {\n          return coords.split(\" \")[2];\n        }\n        // the 'else' is unnecessary, return '' if there are no coords\n        return \"\";\n      }),\n      field('FV_AA_Farmer_1_Attended_Any_Training__c', function(state){\n        var result = '';\n        if(dataValue('form.farmer_1_questions.attended_training')(state) == 1){\n          result = 'Yes';\n        }\n        else if(dataValue('form.farmer_1_questions.attended_training')(state) == 0){\n          result = 'No';\n        }\n        return result;\n      }),\n      field('FV_AA_Farmer_2_Attended_Any_Training__c', function(state){\n        var result = '';\n        if(dataValue('form.farmer_2_questions.attended_training')(state) == 1){\n          result = 'Yes';\n        }\n        else if(dataValue('form.farmer_2_questions.attended_training')(state) == 0){\n          result = 'No';\n        }\n        return result;\n      }),\n      field('FV_AA_Farmer_1_Trainings_Attended__c', dataValue('form.farmer_1_questions.number_of_trainings')),\n      field('FV_AA_Farmer_2_Trainings_Attended__c', dataValue('form.farmer_2_questions.number_of_trainings')),\n      field('FV_AA_Visit_Done_By_AA__c', 'Yes')\n    )\n  )\n);\n  \n  // Update Household Record - FV AA\n  each(\"$.data\", \n    upsertIf(state.data.form['@name'] == 'Farm Visit - AA', \n      \"Household__c\", \"Id\",\n      fields(\n        field(\"Id\", state.data.form.case[\"@case_id\"]),\n        field(\"FV_AA_Visited__c\", dataValue(\"form.case.update.FV_AA_Visited\")(state)),\n        relationship(\n          \"Latest_Farm_Visit_Record__r\",\n          \"FV_Submission_ID__c\",\n          \"FV-\" + dataValue(\"id\")(state)\n          )\n        )\n      )\n  );\n    \n    // update FV with secondary Farmer\n    each(\n      \"$.data\",\n      upsertIf(\n        state.data.form.count_selected_farmers === '2',\n        \"Farm_Visit__c\",\n        \"FV_Submission_ID__c\",\n        fields(\n          field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n          relationship(\"Secondary_Farmer__r\", \"CommCare_Case_Id__c\", function(state){\n            const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n            var result = null;\n            if(visitedFarmers.length > 1){\n              result = visitedFarmers.split(\" \")[1];\n            }\n            return result;\n          }),\n          \n          field(\"Secondary_Farmer_PIMA_ID__c\", function(state){\n            const visitedFarmers = dataValue(\"form.farm_being_visted\")(state);\n            var result = null;\n            if(visitedFarmers.length > 1){\n              result = visitedFarmers.split(\" \")[1];\n            }\n            return result;\n          })\n          )\n        )\n      );\n\n//Best Practices :: Main Stem && Weeding &&  Shade Control && Record Keeping && Compost && Erosion Control && Nutrition\neach(\n  \"$.data\",\n  upsert(\n    \"FV_Best_Practices__c\",\n    \"FV_Submission_ID__c\",\n    fields(\n      field(\"Name__c\", \"FV-\" + dataValue(\"id\")(state)),\n      field(\"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n      relationship(\"Farm_Visit__r\", \"FV_Submission_ID__c\", \"FV-\" + dataValue(\"id\")(state)),\n      // NUTRITION\n      field(\"Color_of_coffee_tree_leaves__c\", function (state) {\n        var colorOfCoffeeLeaves = dataValue(\n          \"form.best_practice_questions.nutrition.are_the_leave_green_or_yellow_pale_green\"\n        )(state);\n        var returnColorOfCoffeeLeaves = \"\";\n\n        if (\n          colorOfCoffeeLeaves !== undefined &&\n          colorOfCoffeeLeaves !== \"\" &&\n          colorOfCoffeeLeaves == 0\n        ) {\n          returnColorOfCoffeeLeaves =\n            \"5% or more (5 or more in 100) of the leaves are yellow, pale green or brown.\";\n        }\n\n        if (\n          colorOfCoffeeLeaves !== undefined &&\n          colorOfCoffeeLeaves !== \"\" &&\n          colorOfCoffeeLeaves == 1\n        ) {\n          returnColorOfCoffeeLeaves =\n            \"Nearly all leaves are dark green and less than 5% (less than 5 in 100) are yellow, pale green, or brown.\";\n        }\n\n        return returnColorOfCoffeeLeaves;\n      }),\n\n      // WEEDING\n      // ##### LOOK: Has the coffee field been dug, including under the canopy?\n      field(\"has_coffee_field_been_dug__c\", function (state) {\n        var hasCoffeeBeenDug = dataValue(\n          \"form.best_practice_questions.weeding.look_has_the_coffee_field_been_dug\"\n        )(state);\n        var returnhasCoffeeBeenDug = \"\";\n\n        if (hasCoffeeBeenDug == 0) {\n          returnhasCoffeeBeenDug = \"No\";\n        }\n\n        if (hasCoffeeBeenDug == 1) {\n          returnhasCoffeeBeenDug = \"Yes\";\n        }\n\n        return returnhasCoffeeBeenDug;\n      }),\n      // ##### LOOK: How many weeds are ___under the tree canopy___ in ___most___ of the field, how big are the weeds?\n\n      field(\"how_many_weeds_under_canopy_and_how_big__c\", function (state) {\n        var weedsUnderCanopy = dataValue(\n          \"form.best_practice_questions.weeding.how_many_weeds_under_canopy_and_how_big_are_they\"\n        )(state);\n        var returnWeedsUnderCanopy = \"\";\n\n        if (weedsUnderCanopy == 1) {\n          returnWeedsUnderCanopy =\n            \"Few small weeds (less than 30cm) under the tree canopy\";\n        }\n\n        if (weedsUnderCanopy == 2) {\n          returnWeedsUnderCanopy =\n            \"Many small weeds under the tree canopy (ground is covered with weeds)\";\n        }\n\n        if (weedsUnderCanopy == 3) {\n          returnWeedsUnderCanopy =\n            \"Many large weeds under the tree canopy (ground is covered with weeds)\";\n        }\n\n        return returnWeedsUnderCanopy;\n      }),\n\n      // STUMPING\n      field(\"stumping_method_on_majority_of_trees__c\", function (state) {\n        var treeStumped = dataValue(\n          \"form.best_practice_questions.stumping.stumping_methods_used_on_majority_of_trees\"\n        )(state);\n        var returnIsTreeStumped = \"\";\n\n        if (treeStumped == 0) {\n          returnIsTreeStumped = \"No\";\n        }\n\n        if (treeStumped == 1) {\n          returnIsTreeStumped = \"Yes\";\n        }\n\n        return returnIsTreeStumped;\n      }),\n\n      field(\"year_stumping__c\", function (state) {\n        var yearStumped = dataValue(\n          \"form.best_practice_questions.stumping.year_stumping\"\n        )(state);\n        var appId = dataValue(\"app_id\")(state);\n        var returnYearStumped = \"\";\n\n        if (yearStumped !== undefined) {\n          var multipleOptions = yearStumped.split(\" \");\n          // The first if statement is added for apps that use multiple selection\n          if (\n            (appId = \"8f77f25440e5412ba0820a39271374f0\") &&\n            multipleOptions.length > 1\n          ) {\n            if (multipleOptions.length == 2) {\n              returnYearStumped = \"Two Stumping Periods\";\n            }\n\n            if (multipleOptions.length == 3) {\n              returnYearStumped = \"All Stumping Periods\";\n            }\n          } // else for apps that still use single selection for this question\n          else {\n            // For HWG 2022C 0 means is for the year 2022\n            if (\n              yearStumped == 0 &&\n              (appId == \"8f77f25440e5412ba0820a39271374f0\" ||\n                appId == \"e226fd89f1ff41debde611a81daa9970\")\n            ) {\n              returnYearStumped =\n                \"January to March 2022 just after the training started\";\n            }\n\n            if (\n              yearStumped == 0 &&\n              (appId == \"d63cdcf6b9d849548413ca356871cd3a\" ||\n                appId == \"e9fb922a1526447b9485b26c4a1b8eb5\")\n            ) {\n              returnYearStumped =\n                \"January to March 2023 just after the training started\";\n            }\n\n            // For HWG 2022C 1 means is for the year 2023\n            if (\n              yearStumped == 1 &&\n              (appId == \"8f77f25440e5412ba0820a39271374f0\" ||\n                appId == \"e226fd89f1ff41debde611a81daa9970\")\n            ) {\n              returnYearStumped =\n                \"January to March 2023 at the start of the second year of training.\";\n            }\n\n            if (\n              yearStumped == 1 &&\n              (appId == \"d63cdcf6b9d849548413ca356871cd3a\" ||\n                appId == \"e9fb922a1526447b9485b26c4a1b8eb5\")\n            ) {\n              returnYearStumped =\n                \"January to March 2024 at the start of the second year of training.\";\n            }\n\n            // Stumping for year 3 ET HWG JCP 2022C FV\n            if (\n              yearStumped == 3 &&\n              appId == \"8f77f25440e5412ba0820a39271374f0\"\n            ) {\n              returnYearStumped =\n                \"January to March 2024 at the start of the thrid year of training\";\n            }\n\n            if(yearStumped == 1 && appId==\"f079b0daae1d4d34a89e331dc5a72fbd\"){\n              {\n              returnYearStumped =\n                \"January to March 2025 at the start of the first year of training\";\n            }\n            }\n\n            if (yearStumped == \"both_periods\") {\n              returnYearStumped = \"Both Stumping Periods\";\n            }\n          }\n        }\n\n        return returnYearStumped;\n      }),\n\n      field(\n        \"number_of_trees_stumped__c\",\n        dataValue(\"form.best_practice_questions.stumping.total_stumped_trees\")\n      ),\n\n      field(\n        \"main_stems_in_majority_coffee_trees__c\",\n        dataValue(\n          \"form.best_practice_questions.stumping.look_on_average_how_many_main_stems_are_on_the_stumped_trees_note_to_traine\"\n        )\n      ),\n\n      //shade management\n      field(\"level_of_shade_present_on_the_farm__c\", function (state) {\n        var levelOfShadeOnPlot = dataValue(\n          \"form.best_practice_questions.shade_control.level_of_shade_present_on_the_farm\"\n        )(state);\n        var returnLevelOfShadeOnPlot = \"\";\n\n        if (levelOfShadeOnPlot == 0) {\n          returnLevelOfShadeOnPlot = \"NO shade, less than 5%\";\n        }\n\n        if (levelOfShadeOnPlot == 1) {\n          returnLevelOfShadeOnPlot = \"Light shade, 5 to 20%\";\n        }\n\n        if (levelOfShadeOnPlot == 2) {\n          returnLevelOfShadeOnPlot = \"Medium shade, 20 to 40%\";\n        }\n\n        if (levelOfShadeOnPlot == 3) {\n          returnLevelOfShadeOnPlot = \"Heavy shade, over 40%\";\n        }\n\n        return returnLevelOfShadeOnPlot;\n      }),\n\n      // Shade photo\n\n      field(\"photo_of_level_of_shade_on_the_plot__c\", function (state) {\n        var photoUrl = dataValue(\n          \"form.best_practice_questions.shade_control.photo_of_level_of_shade_on_the_plot\"\n        )(state);\n        var returnPhotoUrl = \"\";\n\n        if (photoUrl !== undefined && photoUrl !== \"\") {\n          returnPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            photoUrl;\n        }\n\n        return returnPhotoUrl;\n      }),\n\n      //compost manure\n      field(\"do_you_have_compost_manure__c\", function (state) {\n        var haveCompostManure = dataValue(\n          \"form.best_practice_questions.compost.do_you_have_compost_manure\"\n        )(state);\n        var returnHaveCompostManure = \"\";\n\n        if (\n          haveCompostManure !== undefined &&\n          haveCompostManure !== \"\" &&\n          haveCompostManure == 0\n        ) {\n          returnHaveCompostManure = \"No\";\n        }\n\n        if (\n          haveCompostManure !== undefined &&\n          haveCompostManure !== \"\" &&\n          haveCompostManure == 1\n        ) {\n          returnHaveCompostManure = \"Yes\";\n        }\n\n        return returnHaveCompostManure;\n      }),\n\n      // Photo of compost\n      field(\"photo_of_the_compost_manure__c\", function (state) {\n        var compostPhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.compost.photo_of_the_compost_manure\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.compost.photo_of_the_compost_manure\"\n          )(state) !== \"\"\n        ) {\n          compostPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.compost.photo_of_the_compost_manure\"\n            )(state);\n        }\n\n        return compostPhotoUrl;\n      }),\n\n      //erosion control photo\n      field(\"take_a_photo_of_erosion_control__c\", function (state) {\n        var photoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.erosion_control.photo_of_erosion_control_method\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.erosion_control.photo_of_erosion_control_method\"\n          )(state) !== \"\"\n        ) {\n          photoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.erosion_control.photo_of_erosion_control_method\"\n            )(state);\n        }\n\n        return photoUrl;\n      }),\n\n      // Stumping Photo\n      field(\"photos_of_stumped_coffee_trees__c\", function (state) {\n        var photoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.stumping.photos_of_stumped_coffee_trees\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.stumping.photos_of_stumped_coffee_trees\"\n          )(state) !== \"\"\n        ) {\n          photoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            dataValue(\n              \"form.best_practice_questions.stumping.photos_of_stumped_coffee_trees\"\n            )(state);\n        }\n\n        return photoUrl;\n      }),\n\n      // Weeding Photo\n      field(\"photo_of_weeds_under_the_canopy__c\", function (state) {\n        var weedsPhotoUrl = dataValue(\n          \"form.best_practice_questions.weeding.photo_of_weeds_under_the_canopy\"\n        )(state);\n        var returnWeedsPhotoUrl = \"\";\n\n        if (weedsPhotoUrl !== undefined && weedsPhotoUrl !== \"\") {\n          returnWeedsPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            weedsPhotoUrl;\n        }\n\n        return returnWeedsPhotoUrl;\n      }),\n\n      //record keeping\n      field(\"do_you_have_a_record_book__c\", function (state) {\n        var haveRecordBook = dataValue(\n          \"form.best_practice_questions.record_keeping.do_you_have_a_record_book\"\n        )(state);\n        var returnHaveRecordBook = \"\";\n\n        if (haveRecordBook == 0) {\n          returnHaveRecordBook = \"No\";\n        }\n\n        if (haveRecordBook == 1) {\n          returnHaveRecordBook = \"Yes\";\n        }\n\n        return returnHaveRecordBook;\n      }),\n\n      field(\"are_there_records_on_the_record_book__c\", function (state) {\n        var recordsOnRecordBook = dataValue(\n          \"form.best_practice_questions.record_keeping.are_there_records_on_the_record_book\"\n        )(state);\n        var returnRecordsOnRecordBook = \"\";\n\n        if (\n          recordsOnRecordBook !== undefined &&\n          recordsOnRecordBook !== \"\" &&\n          recordsOnRecordBook == 0\n        ) {\n          returnRecordsOnRecordBook = \"No\";\n        }\n\n        if (\n          recordsOnRecordBook !== undefined &&\n          recordsOnRecordBook !== \"\" &&\n          recordsOnRecordBook == 1\n        ) {\n          returnRecordsOnRecordBook = \"Yes\";\n        }\n\n        return returnRecordsOnRecordBook;\n      }),\n\n      field(\"take_a_photo_of_the_record_book__c\", function (state) {\n        var recordBookPhotoUrl = \"\";\n        if (\n          dataValue(\n            \"form.best_practice_questions.record_keeping.take_a_photo_of_the_record_book\"\n          )(state) !== undefined &&\n          dataValue(\n            \"form.best_practice_questions.record_keeping.take_a_photo_of_the_record_book\"\n          )(state) !== \"\"\n        ) {\n          recordBookPhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n              dataValue(\"domain\")(state) +\n              \"/api/form/attachment/\" +\n              dataValue(\"form.meta.instanceID\")(state) +\n              \"/\" +\n              dataValue(\n                \"form.best_practice_questions.record_keeping.take_a_photo_of_the_record_book\"\n              )(state) !==\n              undefined &&\n            dataValue(\n              \"form.best_practice_questions.record_keeping.take_a_photo_of_the_record_book\"\n            )(state);\n        }\n\n        return recordBookPhotoUrl;\n      }),\n\n      // Beekeeping Questions\n      field(\n        \"do_you_keep_bees__c\",\n        dataValue(\n          \"form.question1.ask_do_you_keep_bees_if_yes_ask_can_you_show_me_were_you_keep_your_bees\"\n        )\n      ),\n\n      field(\n        \"number_of_bee_hives__c\",\n        dataValue(\n          \"form.question1.look_and_ask_how_many_hives_do_you_have_of_each_type\"\n        )\n      ),\n\n      field(\n        \"number_of_bee_hives_transitional__c\",\n        dataValue(\n          \"form.question1.look_and_ask_how_many_hives_do_you_have_of_each_type_transitional\"\n        )\n      ),\n\n      field(\n        \"number_of_bee_hives_traditional__c\",\n        dataValue(\n          \"form.question1.look_and_ask_how_many_hives_do_you_have_of_each_type_traditional\"\n        )\n      ),\n\n      field(\"take_a_photo_showing_the_modern_hives__c\", function (state) {\n        var hivePhotoUrl = dataValue(\n          \"form.question1.take_a_photo_showing_the_modern_hives_note_to_trainer_dont_get_too_close_to\"\n        )(state);\n        var returnHivePhotoUrl = \"\";\n\n        if (hivePhotoUrl !== undefined && hivePhotoUrl !== \"\") {\n          returnHivePhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            hivePhotoUrl;\n        }\n\n        return returnHivePhotoUrl;\n      }),\n\n      field(\"take_a_photo_of_the_transitional_hive__c\", function (state) {\n        var hivePhotoUrl = dataValue(\n          \"form.question1.take_a_photo_showing_the_transitional_hives__note_to_trainer_dont_get_too_c\"\n        )(state);\n        var returnHivePhotoUrl = \"\";\n\n        if (hivePhotoUrl !== undefined && hivePhotoUrl !== \"\") {\n          returnHivePhotoUrl =\n            \"https://www.commcarehq.org/a/\" +\n            dataValue(\"domain\")(state) +\n            \"/api/form/attachment/\" +\n            dataValue(\"form.meta.instanceID\")(state) +\n            \"/\" +\n            hivePhotoUrl;\n        }\n\n        return returnHivePhotoUrl;\n      }),\n\n      field(\n        \"how_many_years_have_you_been_beekeeping__c\",\n        dataValue(\"form.question1.ask_how_many_years_have_you_been_beekeeping\")\n      ),\n\n      field(\n        \"did_you_start_beekeeping_before_feb_2023__c\",\n        dataValue(\n          \"form.question1.ask_did_you_start_beekeeping_before_february_2023\"\n        )\n      )\n    )\n  )\n);\n\n//Farm Visit Best Practice Results\n//loop through methods of erosion control and insert into database :: Erosion Control BP\n\nbeta.each(\n  function (state) {\n    //incoming erosion data\n    var best_practice_results_data = dataValue(\n      \"form.best_practice_questions.erosion_control.methods_of_erosion_control\"\n    )(state);\n\n    if (best_practice_results_data !== undefined) {\n      return best_practice_results_data.split(\" \").map(function (resultId) {\n        return {\n          result_data: resultId,\n          best_result_submission:\n            \"FVBPN-\" + dataValue(\"id\")(state) + \"_erosion_\" + resultId,\n          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n        };\n      });\n    }\n  },\n  upsert(\n    \"FV_Best_Practice_Results__c\",\n    \"Best_Practice_Result_Submission_ID__c\",\n    fields(\n      field(\n        \"Best_Practice_Result_Submission_ID__c\",\n        dataValue(\"best_result_submission\")\n      ), //best result submission ID\n      relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n      field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n      field(\"Best_Practice_Result_Type__c\", \"Erosion Control\"), //this is the actual result type\n      field(\"Best_Practice_Result_Description__c\", function (state) {\n        var returnResults = \"\";\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"1\"\n        ) {\n          returnResults = \"Grasses such as vetiver planted in rows\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"2\"\n        ) {\n          returnResults = \"Mulch\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"3\"\n        ) {\n          returnResults = \"Water traps\";\n        }\n\n        // if (\n        //   dataValue(\"result_data\")(state) !== undefined &&\n        //   dataValue(\"result_data\")(state) == \"4\"\n        // ) {\n        //   returnResults = \"Physical barriers. (e.g. rocks)\";\n        // }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"5\"\n        ) {\n          returnResults = \"Terraces\";\n        }\n\n        // if (\n        //   dataValue(\"result_data\")(state) !== undefined &&\n        //   dataValue(\"result_data\")(state) == \"6\"\n        // ) {\n        //   returnResults = \"Contour planting\";\n        // }\n\n        // if (\n        //   dataValue(\"result_data\")(state) !== undefined &&\n        //   dataValue(\"result_data\")(state) == \"7\"\n        // ) {\n        //   returnResults = \"Bean or Arachis cover crop between the rows\";\n        // }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"0\"\n        ) {\n          returnResults = \"No erosion control method seen\";\n        }\n\n        return returnResults;\n      })\n    )\n  )\n);\n\n//loop through chemical/fertilizier applied and insert into database :: Nutrition BP\nbeta.each(\n  function (state) {\n    //incoming chemical/fertilizer used data\n    var best_practice_results_data = dataValue(\n      \"form.best_practice_questions.nutrition.type_chemical_applied_on_coffee_last_12_months\"\n    )(state);\n\n    if (best_practice_results_data !== undefined) {\n      return best_practice_results_data.split(\" \").map(function (resultId) {\n        return {\n          result_data: resultId,\n          best_result_submission:\n            \"FVBPN-\" + dataValue(\"id\")(state) + \"_fertilizer_\" + resultId,\n          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n        };\n      });\n    }\n  },\n  upsert(\n    \"FV_Best_Practice_Results__c\",\n    \"Best_Practice_Result_Submission_ID__c\",\n    fields(\n      field(\n        \"Best_Practice_Result_Submission_ID__c\",\n        dataValue(\"best_result_submission\")\n      ), //best result submission ID\n      relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n      field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n      field(\n        \"Best_Practice_Result_Type__c\",\n        \"Chemicals and Fertilizers Applied\"\n      ), //this is the actual result type\n      field(\"Best_Practice_Result_Description__c\", function (state) {\n        var returnResults = \"\";\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"1\"\n        ) {\n          returnResults = \"Compost, homemade or pulp compost\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"2\"\n        ) {\n          returnResults = \"Manure\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"0\"\n        ) {\n          returnResults = \"Did not apply any fertilizer in past 12 months\";\n        }\n\n        return returnResults;\n      })\n    )\n  )\n);\n\n//loop through methods of controlling coffee berry borer :: Integrated Pest and Disease Management BP\nbeta.each(\n  function (state) {\n    //incoming coffee berry borer data\n    var best_practice_results_data = dataValue(\n      \"form.best_practice_questions.pest_disease_management.methods_of_controlling_white_stem_borer\"\n    )(state);\n\n    if (best_practice_results_data !== undefined) {\n      return best_practice_results_data.split(\" \").map(function (resultId) {\n        return {\n          result_data: resultId,\n          best_result_submission:\n            \"FVBPN-\" + dataValue(\"id\")(state) + \"_cbb_\" + resultId,\n          farm_visit_submission: \"FV-\" + dataValue(\"id\")(state),\n        };\n      });\n    }\n  },\n  upsert(\n    \"FV_Best_Practice_Results__c\",\n    \"Best_Practice_Result_Submission_ID__c\",\n    fields(\n      field(\n        \"Best_Practice_Result_Submission_ID__c\",\n        dataValue(\"best_result_submission\")\n      ), //best result submission ID\n      relationship(\"FV_Best_Practices__r\", \"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")),\n      field(\"FV_Submission_ID__c\", dataValue(\"farm_visit_submission\")), //farm visit submission_id\n      field(\n        \"Best_Practice_Result_Type__c\",\n        \"Management of Coffee Berry Borer (CBB)\"\n      ), //this is the actual result type\n      field(\"Best_Practice_Result_Description__c\", function (state) {\n        var returnResults = \"\";\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"1\"\n        ) {\n          returnResults = \"Encourage natural predators and parasites\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"2\"\n        ) {\n          returnResults =\n            \"Strip all berries at the end of the harvest or collect fallen berries\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"3\"\n        ) {\n          returnResults = \"Harvest ripe cherries regularly\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"4\"\n        ) {\n          returnResults = \"Use berry borer traps\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"5\"\n        ) {\n          returnResults = \"Use compost or manure, to keep the tree healthy\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"6\"\n        ) {\n          returnResults =\n            \"Use good agricultural practices such as weeding or mulching to reduce stress and keep trees healthy\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"7\"\n        ) {\n          returnResults = \"Stump old coffee\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"8\"\n        ) {\n          returnResults = \"Plant disease resistant varieties\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"9\"\n        ) {\n          returnResults = \"Prune to keep the canopy open\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"10\"\n        ) {\n          returnResults = \"Uproot wilt infected coffee trees and burn\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"11\"\n        ) {\n          returnResults = \"Smooth the bark at the base of the tree\";\n        }\n\n        if (\n          dataValue(\"result_data\")(state) !== undefined &&\n          dataValue(\"result_data\")(state) == \"0\"\n        ) {\n          returnResults = \"Does not know any methods\";\n        }\n\n        return returnResults;\n      })\n    )\n  )\n);\n",
          "adaptor": "@openfn/language-salesforce@4.6.11",
          "project_credential_id": "55f298ba-f7d3-442c-9c27-ff1825d583f6"
        }
      },
      "edges": {
        "webhook->Production---Farm-Visit----ET-All---CommCare----Salesforce": {
          "enabled": true,
          "id": "65306ebd-1110-403c-9440-07a7ac52cf10",
          "target_job_id": "78e98440-2f51-420b-80a4-d2e051a4f332",
          "source_trigger_id": "da2d1993-127d-444e-be66-45e2196b3804",
          "condition_type": "js_expression",
          "condition_label": "Production - Farm Visit ET All | CommCare Salesforce",
          "condition_expression": "state.data.form[\"survey_type\"] == \"Farm Visit Full - ET\""
        }
      }
    }
  }
}